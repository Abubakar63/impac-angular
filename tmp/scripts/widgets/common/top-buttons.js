(function () {
var module;

module = angular.module('maestrano.analytics.widgets-common.top-buttons', ['maestrano.assets']);

module.controller('CommonTopButtonsCtrl', [
  '$scope', '$rootScope', 'DhbAnalyticsSvc', 'AssetPath', 'TemplatePath', function($scope, $rootScope, DhbAnalyticsSvc, AssetPath, TemplatePath) {
    var w;
    w = $scope.parentWidget;
    $scope.showCloseActive = false;
    $scope.showEditActive = false;
    $scope.showConfirmDelete = false;
    $scope.closeWidgetButtonImage = AssetPath['impac/close-widget.png'];
    $scope.closeWidgetButtonImageActive = AssetPath['impac/close-widget-pink.png'];
    w.isEditMode = false;
    $scope.deleteWidget = function() {
      return DhbAnalyticsSvc.widgets["delete"](w.id, w.parentDashboard).then((function() {}), function(errors) {
        return w.errors = Utilities.processRailsError(errors);
      });
    };
    return $scope.toogleEditMode = function() {
      if (!w.isLoading) {
        if (w.isEditMode) {
          return w.initSettings();
        } else {
          return w.isEditMode = true;
        }
      }
    };
  }
]);

module.directive('commonTopButtons', [
  'TemplatePath', function(TemplatePath) {
    return {
      restrict: 'A',
      scope: {
        parentWidget: '='
      },
      templateUrl: TemplatePath['analytics/widgets/common/top-buttons.html'],
      controller: 'CommonTopButtonsCtrl'
    };
  }
]);
})();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndpZGdldHMvY29tbW9uL3RvcC1idXR0b25zLmpzLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxJQUFBOztBQUFBLE1BQUEsR0FBUyxPQUFPLENBQUMsTUFBUixDQUFlLGdEQUFmLEVBQWdFLENBQUMsa0JBQUQsQ0FBaEU7O0FBRVQsTUFBTSxDQUFDLFVBQVAsQ0FBa0Isc0JBQWxCLEVBQ0U7RUFBQyxRQUFELEVBQVcsWUFBWCxFQUF5QixpQkFBekIsRUFBNEMsV0FBNUMsRUFBeUQsY0FBekQsRUFDQSxTQUFDLE1BQUQsRUFBUyxVQUFULEVBQXFCLGVBQXJCLEVBQXNDLFNBQXRDLEVBQWlELFlBQWpEO0FBRUUsUUFBQTtJQUFBLENBQUEsR0FBSSxNQUFNLENBQUM7SUFFWCxNQUFNLENBQUMsZUFBUCxHQUF5QjtJQUN6QixNQUFNLENBQUMsY0FBUCxHQUF3QjtJQUN4QixNQUFNLENBQUMsaUJBQVAsR0FBMkI7SUFFM0IsTUFBTSxDQUFDLHNCQUFQLEdBQWdDLFNBQVUsQ0FBQSx3QkFBQTtJQUMxQyxNQUFNLENBQUMsNEJBQVAsR0FBc0MsU0FBVSxDQUFBLDZCQUFBO0lBRWhELENBQUMsQ0FBQyxVQUFGLEdBQWU7SUFFZixNQUFNLENBQUMsWUFBUCxHQUFzQixTQUFBO2FBQ3BCLGVBQWUsQ0FBQyxPQUFPLENBQUMsUUFBRCxDQUF2QixDQUErQixDQUFDLENBQUMsRUFBakMsRUFBcUMsQ0FBQyxDQUFDLGVBQXZDLENBQXVELENBQUMsSUFBeEQsQ0FDRSxDQUFDLFNBQUEsR0FBQSxDQUFELENBREYsRUFFRyxTQUFDLE1BQUQ7ZUFDQyxDQUFDLENBQUMsTUFBRixHQUFXLFNBQVMsQ0FBQyxpQkFBVixDQUE0QixNQUE1QjtNQURaLENBRkg7SUFEb0I7V0FTdEIsTUFBTSxDQUFDLGNBQVAsR0FBd0IsU0FBQTtNQUN0QixJQUFHLENBQUMsQ0FBQyxDQUFDLFNBQU47UUFDRSxJQUFHLENBQUMsQ0FBQyxVQUFMO2lCQUVFLENBQUMsQ0FBQyxZQUFGLENBQUEsRUFGRjtTQUFBLE1BQUE7aUJBS0UsQ0FBQyxDQUFDLFVBQUYsR0FBZSxLQUxqQjtTQURGOztJQURzQjtFQXRCMUIsQ0FEQTtDQURGOztBQWtDQSxNQUFNLENBQUMsU0FBUCxDQUFpQixrQkFBakIsRUFBcUM7RUFBQyxjQUFELEVBQWlCLFNBQUMsWUFBRDtBQUNwRCxXQUFPO01BQ0wsUUFBQSxFQUFVLEdBREw7TUFFTCxLQUFBLEVBQU87UUFDTCxZQUFBLEVBQWMsR0FEVDtPQUZGO01BS0wsV0FBQSxFQUFhLFlBQWEsQ0FBQSwyQ0FBQSxDQUxyQjtNQU1MLFVBQUEsRUFBWSxzQkFOUDs7RUFENkMsQ0FBakI7Q0FBckMiLCJmaWxlIjoid2lkZ2V0cy9jb21tb24vdG9wLWJ1dHRvbnMuanMuanMiLCJzb3VyY2VSb290IjoiL3NvdXJjZS8iLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnbWFlc3RyYW5vLmFuYWx5dGljcy53aWRnZXRzLWNvbW1vbi50b3AtYnV0dG9ucycsWydtYWVzdHJhbm8uYXNzZXRzJ10pXG5cbm1vZHVsZS5jb250cm9sbGVyKCdDb21tb25Ub3BCdXR0b25zQ3RybCcsXG4gIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnRGhiQW5hbHl0aWNzU3ZjJywgJ0Fzc2V0UGF0aCcsICdUZW1wbGF0ZVBhdGgnLFxuICAoJHNjb3BlLCAkcm9vdFNjb3BlLCBEaGJBbmFseXRpY3NTdmMsIEFzc2V0UGF0aCwgVGVtcGxhdGVQYXRoKSAtPlxuXG4gICAgdyA9ICRzY29wZS5wYXJlbnRXaWRnZXRcblxuICAgICRzY29wZS5zaG93Q2xvc2VBY3RpdmUgPSBmYWxzZVxuICAgICRzY29wZS5zaG93RWRpdEFjdGl2ZSA9IGZhbHNlXG4gICAgJHNjb3BlLnNob3dDb25maXJtRGVsZXRlID0gZmFsc2VcblxuICAgICRzY29wZS5jbG9zZVdpZGdldEJ1dHRvbkltYWdlID0gQXNzZXRQYXRoWydpbXBhYy9jbG9zZS13aWRnZXQucG5nJ11cbiAgICAkc2NvcGUuY2xvc2VXaWRnZXRCdXR0b25JbWFnZUFjdGl2ZSA9IEFzc2V0UGF0aFsnaW1wYWMvY2xvc2Utd2lkZ2V0LXBpbmsucG5nJ11cblxuICAgIHcuaXNFZGl0TW9kZSA9IGZhbHNlXG5cbiAgICAkc2NvcGUuZGVsZXRlV2lkZ2V0ID0gLT5cbiAgICAgIERoYkFuYWx5dGljc1N2Yy53aWRnZXRzLmRlbGV0ZSh3LmlkLCB3LnBhcmVudERhc2hib2FyZCkudGhlbihcbiAgICAgICAgKC0+KVxuICAgICAgICAsKGVycm9ycykgLT5cbiAgICAgICAgICB3LmVycm9ycyA9IFV0aWxpdGllcy5wcm9jZXNzUmFpbHNFcnJvcihlcnJvcnMpXG4gICAgICApXG4gICAgICAjIFJlZnJlc2ggbmVlZGVkIHRvIGRpc3BsYXkgdGhlICdhZGQgYSB3aWRnZXQnIG1lc3NhZ2UgaW4gY2FzZSBvZiBubyB3aWRnZXRcbiAgICAgICMgKS5maW5hbGx5KC0+IERoYkFuYWx5dGljc1N2Yy5sb2FkKHRydWUpKVxuXG4gICAgJHNjb3BlLnRvb2dsZUVkaXRNb2RlID0gLT5cbiAgICAgIGlmICF3LmlzTG9hZGluZ1xuICAgICAgICBpZiB3LmlzRWRpdE1vZGVcbiAgICAgICAgICAjIExpa2UgYSBwcmVzcyBvbiAnQ2FuY2VsJyBidXR0b25cbiAgICAgICAgICB3LmluaXRTZXR0aW5ncygpXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAjIE90aGVyd2lzZSwgd2UgcGFzcyBpbiBlZGl0IG1vZGVcbiAgICAgICAgICB3LmlzRWRpdE1vZGUgPSB0cnVlXG5dKVxuXG5tb2R1bGUuZGlyZWN0aXZlKCdjb21tb25Ub3BCdXR0b25zJywgWydUZW1wbGF0ZVBhdGgnLCAoVGVtcGxhdGVQYXRoKSAtPlxuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgc2NvcGU6IHtcbiAgICAgIHBhcmVudFdpZGdldDogJz0nXG4gICAgfSxcbiAgICB0ZW1wbGF0ZVVybDogVGVtcGxhdGVQYXRoWydhbmFseXRpY3Mvd2lkZ2V0cy9jb21tb24vdG9wLWJ1dHRvbnMuaHRtbCddLFxuICAgIGNvbnRyb2xsZXI6ICdDb21tb25Ub3BCdXR0b25zQ3RybCdcbiAgfVxuXSkiXX0=