(function () {
var module;

module = angular.module('maestrano.analytics.widget-sales-aged', ['maestrano.assets']);

module.controller('WidgetSalesAgedCtrl', [
  '$scope', 'DhbAnalyticsSvc', 'ChartFormatterSvc', '$filter', function($scope, DhbAnalyticsSvc, ChartFormatterSvc, $filter) {
    var getSettingsCount, w;
    w = $scope.widget;
    w.initContext = function() {
      if ($scope.isDataFound = angular.isDefined(w.content) && !_.isEmpty(w.content.aged_sales) && !_.isEmpty(w.content.dates)) {
        $scope.filterOptions = [
          {
            label: 'value sold (incl. taxes)',
            value: 'gross_value_sold'
          }, {
            label: 'value sold (excl. taxes)',
            value: 'net_value_sold'
          }, {
            label: 'quantity sold',
            value: 'quantity_sold'
          }
        ];
        return $scope.filter = _.find($scope.filterOptions, function(o) {
          return w.metadata && w.metadata.filter === o.value;
        }) || $scope.filterOptions[0];
      }
    };
    w.format = function() {
      var all_values_are_positive, inputData, options, values;
      if ($scope.isDataFound) {
        all_values_are_positive = true;
        inputData = [];
        values = w.content.aged_sales[$scope.filter.value];
        $scope.formattedDates = _.map(w.content.dates, function(date) {
          if (w.metadata && w.metadata.hist_parameters && w.metadata.hist_parameters.period === "YEARLY") {
            return $filter('date')(date, 'yyyy');
          } else if (w.metadata && w.metadata.hist_parameters && w.metadata.hist_parameters.period === "QUARTERLY") {
            return $filter('date')(date, 'MMM-yy');
          } else if (w.metadata && w.metadata.hist_parameters && (w.metadata.hist_parameters.period === "WEEKLY" || w.metadata.hist_parameters.period === "DAILY")) {
            return $filter('date')(date, 'dd-MMM');
          } else {
            return $filter('date')(date, 'MMM');
          }
        });
        inputData.push({
          title: $scope.filter.label,
          labels: $scope.formattedDates,
          values: values
        });
        angular.forEach(values, function(value) {
          return all_values_are_positive && (all_values_are_positive = value >= 0);
        });
        options = {
          scaleBeginAtZero: all_values_are_positive,
          showXLabels: true,
          datasetFill: true,
          pointDot: true
        };
        return w.chart = ChartFormatterSvc.lineChart(inputData, options);
      }
    };
    $scope.$watch((function() {
      return $scope.filter;
    }), function(filter) {
      return w.format();
    }, true);
    $scope.getTotal = function(anIndex) {
      if ($scope.isDataFound && anIndex >= 0 && anIndex < w.content.aged_sales[$scope.filter.value].length) {
        return w.content.aged_sales[$scope.filter.value][anIndex];
      }
    };
    $scope.getLastDate = function() {
      if ($scope.isDataFound) {
        return _.last(w.content.dates);
      }
    };
    $scope.getClassColor = function(prev, value) {
      if (value < prev) {
        return 'negative';
      } else if (value > prev) {
        return 'positive';
      } else {
        return null;
      }
    };
    getSettingsCount = function() {
      if (w.settings != null) {
        return w.settings.length;
      } else {
        return 0;
      }
    };
    $scope.$watch(getSettingsCount, function(total) {
      if (total >= 3) {
        return w.loadContent();
      }
    });
    return w;
  }
]);

module.directive('widgetSalesAged', function() {
  return {
    restrict: 'A',
    link: function(scope, element) {
      element.addClass("sales");
      return element.addClass("aged");
    },
    controller: 'WidgetSalesAgedCtrl'
  };
});
})();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndpZGdldHMvd2lkZ2V0LXNhbGVzLWFnZWQuanMuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLElBQUE7O0FBQUEsTUFBQSxHQUFTLE9BQU8sQ0FBQyxNQUFSLENBQWUsdUNBQWYsRUFBdUQsQ0FBQyxrQkFBRCxDQUF2RDs7QUFFVCxNQUFNLENBQUMsVUFBUCxDQUFrQixxQkFBbEIsRUFBd0M7RUFDdEMsUUFEc0MsRUFDNUIsaUJBRDRCLEVBQ1QsbUJBRFMsRUFDWSxTQURaLEVBRXRDLFNBQUMsTUFBRCxFQUFTLGVBQVQsRUFBMEIsaUJBQTFCLEVBQTZDLE9BQTdDO0FBRUUsUUFBQTtJQUFBLENBQUEsR0FBSSxNQUFNLENBQUM7SUFFWCxDQUFDLENBQUMsV0FBRixHQUFnQixTQUFBO01BQ2QsSUFBRyxNQUFNLENBQUMsV0FBUCxHQUFxQixPQUFPLENBQUMsU0FBUixDQUFrQixDQUFDLENBQUMsT0FBcEIsQ0FBQSxJQUFnQyxDQUFDLENBQUMsQ0FBQyxPQUFGLENBQVUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFwQixDQUFqQyxJQUFvRSxDQUFDLENBQUMsQ0FBQyxPQUFGLENBQVUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFwQixDQUE3RjtRQUVFLE1BQU0sQ0FBQyxhQUFQLEdBQXVCO1VBQ3JCO1lBQUMsS0FBQSxFQUFPLDBCQUFSO1lBQW9DLEtBQUEsRUFBTyxrQkFBM0M7V0FEcUIsRUFFckI7WUFBQyxLQUFBLEVBQU8sMEJBQVI7WUFBb0MsS0FBQSxFQUFPLGdCQUEzQztXQUZxQixFQUdyQjtZQUFDLEtBQUEsRUFBTyxlQUFSO1lBQXlCLEtBQUEsRUFBTyxlQUFoQztXQUhxQjs7ZUFLdkIsTUFBTSxDQUFDLE1BQVAsR0FBZ0IsQ0FBQyxDQUFDLElBQUYsQ0FBTyxNQUFNLENBQUMsYUFBZCxFQUE2QixTQUFDLENBQUQ7aUJBQzNDLENBQUMsQ0FBQyxRQUFGLElBQWMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxNQUFYLEtBQXFCLENBQUMsQ0FB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TUFBTSxDQUFDLFdBQWxDO2VBQUEsQ0FBQyxDQUFDLElBQUYsQ0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQWpCLEVBQUE7O0lBRG1CO0lBR3JCLE1BQU0sQ0FBQyxhQUFQLEdBQXVCLFNBQUMsSUFBRCxFQUFNLEtBQU47TUFFckIsSUFBRyxLQUFBLEdBQVEsSUFBWDtBQUNFLGVBQU8sV0FEVDtPQUFBLE1BRUssSUFBRyxLQUFBLEdBQVEsSUFBWDtBQUNILGVBQU8sV0FESjtPQUFBLE1BQUE7QUFHSCxlQUFPLEtBSEo7O0lBSmdCO0lBbUJ2QixnQkFBQSxHQUFtQixTQUFBO01BQ2pCLElBQUcsa0JBQUg7QUFDRSxlQUFPLENBQUMsQ0FBQyxRQUFRLENBQUMsT0FEcEI7T0FBQSxNQUFBO0FBR0UsZUFBTyxFQUhUOztJQURpQjtJQU9uQixNQUFNLENBQUMsTUFBUCxDQUFjLGdCQUFkLEVBQWdDLFNBQUMsS0FBRDtNQUM5QixJQUFtQixLQUFBLElBQVMsQ0FBNUI7ZUFBQSxDQUFDLENBQUMsV0FBRixDQUFBLEVBQUE7O0lBRDhCLENBQWhDO0FBR0EsV0FBTztFQXhGVCxDQUZzQztDQUF4Qzs7QUE2RkEsTUFBTSxDQUFDLFNBQVAsQ0FBaUIsaUJBQWpCLEVBQW9DLFNBQUE7QUFDbEMsU0FBTztJQUNMLFFBQUEsRUFBVSxHQURMO0lBRUwsSUFBQSxFQUFNLFNBQUMsS0FBRCxFQUFRLE9BQVI7TUFDSixPQUFPLENBQUMsUUFBUixDQUFpQixPQUFqQjthQUNBLE9BQU8sQ0FBQyxRQUFSLENBQWlCLE1BQWpCO0lBRkksQ0FGRDtJQUtKLFVBQUEsRUFBWSxxQkFMUjs7QUFEMkIsQ0FBcEMiLCJmaWxlIjoid2lkZ2V0cy93aWRnZXQtc2FsZXMtYWdlZC5qcy5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdtYWVzdHJhbm8uYW5hbHl0aWNzLndpZGdldC1zYWxlcy1hZ2VkJyxbJ21hZXN0cmFuby5hc3NldHMnXSlcblxubW9kdWxlLmNvbnRyb2xsZXIoJ1dpZGdldFNhbGVzQWdlZEN0cmwnLFtcbiAgJyRzY29wZScsICdEaGJBbmFseXRpY3NTdmMnLCAnQ2hhcnRGb3JtYXR0ZXJTdmMnLCAnJGZpbHRlcicsXG4gICgkc2NvcGUsIERoYkFuYWx5dGljc1N2YywgQ2hhcnRGb3JtYXR0ZXJTdmMsICRmaWx0ZXIpIC0+XG5cbiAgICB3ID0gJHNjb3BlLndpZGdldFxuXG4gICAgdy5pbml0Q29udGV4dCA9IC0+XG4gICAgICBpZiAkc2NvcGUuaXNEYXRhRm91bmQgPSBhbmd1bGFyLmlzRGVmaW5lZCh3LmNvbnRlbnQpICYmICFfLmlzRW1wdHkody5jb250ZW50LmFnZWRfc2FsZXMpICYmICFfLmlzRW1wdHkody5jb250ZW50LmRhdGVzKVxuXG4gICAgICAgICRzY29wZS5maWx0ZXJPcHRpb25zID0gW1xuICAgICAgICAgIHtsYWJlbDogJ3ZhbHVlIHNvbGQgKGluY2wuIHRheGVzKScsIHZhbHVlOiAnZ3Jvc3NfdmFsdWVfc29sZCd9LFxuICAgICAgICAgIHtsYWJlbDogJ3ZhbHVlIHNvbGQgKGV4Y2wuIHRheGVzKScsIHZhbHVlOiAnbmV0X3ZhbHVlX3NvbGQnfSxcbiAgICAgICAgICB7bGFiZWw6ICdxdWFudGl0eSBzb2xkJywgdmFsdWU6ICdxdWFudGl0eV9zb2xkJ30sXG4gICAgICAgIF1cbiAgICAgICAgJHNjb3BlLmZpbHRlciA9IF8uZmluZCgkc2NvcGUuZmlsdGVyT3B0aW9ucywgKG8pIC0+XG4gICAgICAgICAgdy5tZXRhZGF0YSAmJiB3Lm1ldGFkYXRhLmZpbHRlciA9PSBvLnZhbHVlXG4gICAgICAgICkgfHwgJHNjb3BlLmZpbHRlck9wdGlvbnNbMF1cblxuICAgIHcuZm9ybWF0ID0gLT5cbiAgICAgIGlmICRzY29wZS5pc0RhdGFGb3VuZFxuICAgICAgICBhbGxfdmFsdWVzX2FyZV9wb3NpdGl2ZSA9IHRydWVcbiAgICAgICAgXG4gICAgICAgIGlucHV0RGF0YSA9IFtdXG4gICAgICAgIHZhbHVlcyA9IHcuY29udGVudC5hZ2VkX3NhbGVzWyRzY29wZS5maWx0ZXIudmFsdWVdXG5cbiAgICAgICAgJHNjb3BlLmZvcm1hdHRlZERhdGVzID0gXy5tYXAgdy5jb250ZW50LmRhdGVzLCAoZGF0ZSkgLT5cbiAgICAgICAgICBpZiB3Lm1ldGFkYXRhICYmIHcubWV0YWRhdGEuaGlzdF9wYXJhbWV0ZXJzICYmIHcubWV0YWRhdGEuaGlzdF9wYXJhbWV0ZXJzLnBlcmlvZCA9PSBcIllFQVJMWVwiXG4gICAgICAgICAgICAkZmlsdGVyKCdkYXRlJykoZGF0ZSwgJ3l5eXknKVxuICAgICAgICAgIGVsc2UgaWYgdy5tZXRhZGF0YSAmJiB3Lm1ldGFkYXRhLmhpc3RfcGFyYW1ldGVycyAmJiB3Lm1ldGFkYXRhLmhpc3RfcGFyYW1ldGVycy5wZXJpb2QgPT0gXCJRVUFSVEVSTFlcIlxuICAgICAgICAgICAgJGZpbHRlcignZGF0ZScpKGRhdGUsICdNTU0teXknKVxuICAgICAgICAgIGVsc2UgaWYgdy5tZXRhZGF0YSAmJiB3Lm1ldGFkYXRhLmhpc3RfcGFyYW1ldGVycyAmJiAody5tZXRhZGF0YS5oaXN0X3BhcmFtZXRlcnMucGVyaW9kID09IFwiV0VFS0xZXCIgfHwgdy5tZXRhZGF0YS5oaXN0X3BhcmFtZXRlcnMucGVyaW9kID09IFwiREFJTFlcIilcbiAgICAgICAgICAgICRmaWx0ZXIoJ2RhdGUnKShkYXRlLCAnZGQtTU1NJylcbiAgICAgICAgICBlbHNlICBcbiAgICAgICAgICAgICRmaWx0ZXIoJ2RhdGUnKShkYXRlLCAnTU1NJylcbiAgICAgICAgICBcbiAgICAgICAgaW5wdXREYXRhLnB1c2goe3RpdGxlOiAkc2NvcGUuZmlsdGVyLmxhYmVsLCBsYWJlbHM6ICRzY29wZS5mb3JtYXR0ZWREYXRlcywgdmFsdWVzOiB2YWx1ZXN9KVxuICAgICAgICBcbiAgICAgICAgYW5ndWxhci5mb3JFYWNoKHZhbHVlcywgKHZhbHVlKSAtPlxuICAgICAgICAgIGFsbF92YWx1ZXNfYXJlX3Bvc2l0aXZlICYmPSB2YWx1ZSA+PSAwXG4gICAgICAgIClcblxuICAgICAgICBvcHRpb25zID0ge1xuICAgICAgICAgIHNjYWxlQmVnaW5BdFplcm86IGFsbF92YWx1ZXNfYXJlX3Bvc2l0aXZlLFxuICAgICAgICAgIHNob3dYTGFiZWxzOiB0cnVlLFxuICAgICAgICAgIGRhdGFzZXRGaWxsOiB0cnVlLFxuICAgICAgICAgIHBvaW50RG90OiB0cnVlLFxuICAgICAgICB9XG5cbiAgICAgICAgdy5jaGFydCA9IENoYXJ0Rm9ybWF0dGVyU3ZjLmxpbmVDaGFydChpbnB1dERhdGEsb3B0aW9ucylcblxuICAgICRzY29wZS4kd2F0Y2ggKC0+ICRzY29wZS5maWx0ZXIpLCAoZmlsdGVyKSAtPlxuICAgICAgdy5mb3JtYXQoKVxuICAgICx0cnVlXG5cbiAgICAkc2NvcGUuZ2V0VG90YWwgPSAoYW5JbmRleCkgLT5cbiAgICAgIGlmICRzY29wZS5pc0RhdGFGb3VuZCAmJiBhbkluZGV4ID49MCAmJiBhbkluZGV4IDwgdy5jb250ZW50LmFnZWRfc2FsZXNbJHNjb3BlLmZpbHRlci52YWx1ZV0ubGVuZ3RoXG4gICAgICAgIHJldHVybiB3LmNvbnRlbnQuYWdlZF9zYWxlc1skc2NvcGUuZmlsdGVyLnZhbHVlXVthbkluZGV4XVxuXG4gICAgJHNjb3BlLmdldExhc3REYXRlID0gLT5cbiAgICAgIF8ubGFzdCh3LmNvbnRlbnQuZGF0ZXMpIGlmICRzY29wZS5pc0RhdGFGb3VuZFxuXG4gICAgJHNjb3BlLmdldENsYXNzQ29sb3IgPSAocHJldix2YWx1ZSkgLT5cbiAgICAgICMgaWYgKHBhcnNlRmxvYXQocHJldikgJiYgcGFyc2VGbG9hdCh2YWx1ZSkpXG4gICAgICBpZiB2YWx1ZSA8IHByZXZcbiAgICAgICAgcmV0dXJuICduZWdhdGl2ZSdcbiAgICAgIGVsc2UgaWYgdmFsdWUgPiBwcmV2XG4gICAgICAgIHJldHVybiAncG9zaXRpdmUnXG4gICAgICBlbHNlXG4gICAgICAgIHJldHVybiBudWxsXG5cblxuICAgICMgLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgICMgVE9ETzogUmVmYWN0b3Igb25jZSB3ZSBoYXZlIHVuZGVyc3Rvb2QgZXhhY3RseSBob3cgdGhlIGFuZ3VsYXJqcyBjb21waWxhdGlvbiBwcm9jZXNzIHdvcmtzOlxuICAgICMgaW4gdGhpcyBvcmRlciwgd2Ugc2hvdWxkOlxuICAgICMgMS0gY29tcGlsZSBpbXBhYy13aWRnZXQgY29udHJvbGxlclxuICAgICMgMi0gY29tcGlsZSB0aGUgc3BlY2lmaWMgd2lkZ2V0IHRlbXBsYXRlL2NvbnRyb2xsZXJcbiAgICAjIDMtIGNvbXBpbGUgdGhlIHNldHRpbmdzIHRlbXBsYXRlcy9jb250cm9sbGVyc1xuICAgICMgNC0gY2FsbCB3aWRnZXQubG9hZENvbnRlbnQoKSAoaWRlYWxseSwgZnJvbSBpbXBhYy13aWRnZXQsIG9uY2UgYSBjYWxsYmFjayBcbiAgICAjICAgICBhc3Nlc3NpbmcgdGhhdCBldmVyeXRoaW5nIGlzIGNvbXBpbGVkIGFuIHJlYWR5IGlzIHJlY2VpdmVkKVxuICAgIGdldFNldHRpbmdzQ291bnQgPSAtPlxuICAgICAgaWYgdy5zZXR0aW5ncz9cbiAgICAgICAgcmV0dXJuIHcuc2V0dGluZ3MubGVuZ3RoXG4gICAgICBlbHNlXG4gICAgICAgIHJldHVybiAwXG5cbiAgICAjIHRpbWUgcmFuZ2UgKyBvcmdhbml6YXRpb25faWRzIHBhcmFtLXNlbGVjdG9yXG4gICAgJHNjb3BlLiR3YXRjaCBnZXRTZXR0aW5nc0NvdW50LCAodG90YWwpIC0+XG4gICAgICB3LmxvYWRDb250ZW50KCkgaWYgdG90YWwgPj0gM1xuXG4gICAgcmV0dXJuIHdcbl0pXG5cbm1vZHVsZS5kaXJlY3RpdmUoJ3dpZGdldFNhbGVzQWdlZCcsIC0+XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdBJyxcbiAgICBsaW5rOiAoc2NvcGUsIGVsZW1lbnQpIC0+XG4gICAgICBlbGVtZW50LmFkZENsYXNzKFwic2FsZXNcIilcbiAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoXCJhZ2VkXCIpXG4gICAgLGNvbnRyb2xsZXI6ICdXaWRnZXRTYWxlc0FnZWRDdHJsJ1xuICB9XG4pIl19