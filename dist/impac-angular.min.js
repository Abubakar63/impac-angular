!function(){"use strict";angular.module("maestrano.impac",["impac.config","impac.services","impac.filters","impac.components","ui.sortable","ui.bootstrap"]),angular.module("impac.components",["impac.components.dashboard","impac.components.dashboard-selector","impac.components.chart","impac.components.widget","impac.components.widgets","impac.components.widgets-settings","impac.components.widgets-common","impac.components.templates"]),angular.module("impac.components.widgets",["impac.components.widgets.accounts-accounting-values","impac.components.widgets.accounts-assets-summary","impac.components.widgets.accounts-balance-sheet","impac.components.widgets.accounts-balance","impac.components.widgets.accounts-cash-summary","impac.components.widgets.accounts-comparison","impac.components.widgets.accounts-custom-calculation","impac.components.widgets.accounts-expenses-revenue","impac.components.widgets.accounts-payable-receivable","impac.components.widgets.accounts-profit-and-loss","impac.components.widgets.hr-employee-details","impac.components.widgets.hr-employees-list","impac.components.widgets.hr-leaves-balance","impac.components.widgets.hr-leaves-schedule","impac.components.widgets.hr-payroll-summary","impac.components.widgets.hr-payroll-taxes","impac.components.widgets.hr-salaries-summary","impac.components.widgets.hr-superannuation-accruals","impac.components.widgets.hr-timesheets","impac.components.widgets.hr-workforce-summary","impac.components.widgets.invoices-aged-payables-receivables","impac.components.widgets.invoices-list","impac.components.widgets.invoices-summary","impac.components.widgets.sales-aged","impac.components.widgets.sales-break-even","impac.components.widgets.sales-comparison","impac.components.widgets.sales-customer-details","impac.components.widgets.sales-cycle","impac.components.widgets.sales-forecast","impac.components.widgets.sales-growth","impac.components.widgets.sales-leads-funnel","impac.components.widgets.sales-leads-list","impac.components.widgets.sales-list","impac.components.widgets.sales-margin","impac.components.widgets.sales-number-of-leads","impac.components.widgets.sales-opportunities-funnel","impac.components.widgets.sales-performance","impac.components.widgets.sales-segmented-turnover","impac.components.widgets.sales-summary","impac.components.widgets.sales-top-opportunities"]),angular.module("impac.components.widgets-settings",["impac.components.widgets-settings.account","impac.components.widgets-settings.accounts-list","impac.components.widgets-settings.chart-filters","impac.components.widgets-settings.formula","impac.components.widgets-settings.hist-mode","impac.components.widgets-settings.organizations","impac.components.widgets-settings.param-selector","impac.components.widgets-settings.params-picker","impac.components.widgets-settings.time-range","impac.components.widgets-settings.width"]),angular.module("impac.components.widgets-common",["impac.components.widgets-common.top-buttons","impac.components.widgets-common.data-not-found","impac.components.widgets-common.editable-title"]),angular.module("impac.filters",[]),angular.module("impac.services",["impac.services.routes","impac.services.linking","impac.services.theming","impac.services.assets","impac.services.analytics","impac.services.chart-formatter","impac.services.message-bus","impac.services.utilities"]),angular.module("impac.config",[]).config(["$httpProvider",function(t){t.defaults.headers.common.Accept="application/json",t.defaults.headers.common["Content-Type"]="application/json"}]),angular.module("impac.components.templates",[]).run(["$templateCache",function(t){t.put("chart/chart.tmpl.html",'<canvas ng-hide="isExternalTemplate()" id="myChart"></canvas>'),t.put("dashboard/create.modal.html",'<div class="modal-header">\n  <div class="close" type="button" ng-click="close()" >×</div>\n  <h3>Create New Dashboard</h3>\n</div>\n\n<div class="modal-body">\n  <div class="row">\n    <div class="col-sm-12">\n      <div class="alert alert-error" ng-show="errors">\n        <button class="close" ng-click="errors=\'\'">×</button>\n        <ul>\n          <li ng-repeat="error in errors">{{error}}</li>\n        </ul>\n      </div>\n    </div>\n  </div>\n  \n  <!-- Create a new dashboard -->\n  <div class="row dashboard-form">\n    <div class="col-sm-10 col-sm-offset-1">\n      <form class="form-horizontal" role="form">\n        <div class="form-group">\n          <label class="col-sm-2 control-label">Name</label>\n          <div class="col-sm-10">\n            <input type=\'text\' class="form-control" ng-model="model.name" placeholder="E.g: Cash Accounts Monitoring" required>\n          </div>\n        </div>\n    \n        <div class="form-group" ng-show="isMultiCompanyAvailable()">\n          <label class="col-sm-2 control-label">Type</label>\n          <div class="col-sm-10">\n            <div class="btn-group" role="group">\n              <button type="button" ng-click="selectMode(\'single\')" ng-class="btnBlassFor(\'single\')">Current Company</button>\n              <button type="button" ng-click="selectMode(\'multi\')" ng-class="btnBlassFor(\'multi\')">Multi Company</button>\n            </div>\n          </div>\n        </div>\n        \n        <!-- Single Company mode -->\n        <div class="form-group" ng-show="isCurrentOrganizationShown()">\n          <div ng-show="!canAccessAnalyticsForCurrentOrganization()" class="text-center text-purple">\n            <div class="spacer1"></div>\n            <p>\n              Oops! Only Admins and Super Admins can create dashboards for company {{currentOrganization.name}}.\n              <span ng-show="isMultiCompanyAvailable()">Please select a "Multi Company" dashboard to select data from other companies.</span>\n            </p>\n          </div>\n        </div>\n        \n        <!-- Multi Company mode -->\n        <div class="form-group" ng-show="isSelectOrganizationShown()">\n          <label class="col-sm-2 control-label">Companies</label>\n          <div class="col-sm-10">\n            <ul class="list-unstyled">\n              <li ng-repeat="organization in organizations" >\n                <input type="checkbox" ng-model="organization.$selected" ng-disabled="!canAccessAnalyticsData(organization)"> \n                {{organization.name}} \n                <span ng-show="organization.is_customer_account">(customer)</span>\n                <span ng-show="!canAccessAnalyticsData(organization)">\n                  <em><small>\n                    &nbsp;\n                    &nbsp;\n                    <i class="fa fa-exclamation-circle text-danger" tooltip="Only Admins and Super Admins can access analytics data for this company"></i>\n                  </small></em>\n                </span>\n              </li>\n            </ul>\n          </div>\n        </div>\n      </form>\n      \n      <!-- End row col -->\n    </div>\n    \n    <!-- End Dashboard form -->\n  </div>\n  \n  \n  \n</div>\n\n<div class="modal-footer">\n  <div class="row">\n    <div class="col-sm-12">\n      <button class="btn btn-shaded" ng-click="close()" ng-hide="isLoading" ng-disabled="isLoading">Cancel</button>\n      <button class="btn btn-info" ng-click="proceed()" ng-hide="isLoading" ng-disabled="proceedDisabled()">Add</button>\n      <img ng-src="{{loadingGif}}" ng-show="isLoading" alt="Loading">\n    </div>\n  </div>\n</div>'),t.put("dashboard/dashboard.tmpl.html",'<!-- DASHBOARD -->\n<div class="analytics">\n  <div mno-star-wizard=true modal-open=\'starWizardModal.value\'></div>\n\n  <!-- Title and Dashboard selection -->\n  <div id="head-title">\n    <!--&lt;!&ndash; Heading TODO: add these variables to dashboard ctrl &ndash;&gt;-->\n    <!--<h2 ng-show="showDhbHeadin">-->\n      <!--<img ng-src="{{impacTitleLogo}}" style="float: left; margin-right: 15px;" />-->\n      <!--<div class="text-info" style="padding-top:12px; height: 48px;">{{dhbHeadingText}}</div>-->\n      <!--<div class="text-info" style="padding-top:12px; height: 48px;"></div>-->\n    <!--</h2>-->\n\n    <dashboard-selector id="module__dashboard-selector"></dashboard-selector>\n  </div>\n\n  <!-- Widgets selection container -->\n  <div id="widget-selector" collapse="!showWidgetSelector" ng-if="!customWidgetSelector.path">\n    <div class="title">\n      <i class="fa fa-times-circle" ng-click="hideWidgetSelector()"/>\n      <span class="badge confirmation">Widget added!</span>\n      Select the widgets you want to add to your dashboard.\n    </div>\n\n    <div class="row top-container">\n      <div class="col-md-3 categories">\n        <div class="row header">\n          All categories\n        </div>\n        <div class="row lines">\n          <div class="col-md-12" style="padding: 3px 12px;">\n            <p ng-click="selectCategory(\'accounts\')" ng-class="isCategorySelected(\'accounts\') ? \'selected\' : none">Accounting</p>\n            <p ng-click="selectCategory(\'invoices\')" ng-class="isCategorySelected(\'invoices\') ? \'selected\' : none">Invoicing</p>\n            <p ng-click="selectCategory(\'hr\')" ng-class="isCategorySelected(\'hr\') ? \'selected\' : none">HR / Payroll</p>\n            <p ng-click="selectCategory(\'sales\')" ng-class="isCategorySelected(\'sales\') ? \'selected\' : none">Sales</p>\n          </div>\n        </div>\n\n        <div class="arrow" ng-style="getSelectedCategoryTop()">\n          <div class="square"></div>\n          <i class="fa fa-caret-right"></i>\n        </div>\n\n      </div>\n\n      <div class="col-md-9 widgets">\n        <div class="row header">\n          {{getSelectedCategoryName() | titleize}}\n        </div>\n        <div class="row lines">\n          <div class="col-md-4" ng-repeat="widgetPattern in getWidgetsForSelectedCategory()" style="padding: 0px 8px;">\n            <p ng-click="addWidget(widgetPattern.path, widgetPattern.metadata)" tooltip="{{widgetPattern.desc}}" tooltip-placement="{{$index < 9 ? \'bottom\' : \'top\'}}" tooltip-animation="false"  tooltip-append-to-body="true" tooltip-class="impac-widget-selector-tooltip"><i class="fa fa-{{widgetPattern.icon}}" /> {{widgetPattern.name}} <i class="fa fa-plus-circle" /></p>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class="bottom">\n      <span class="suggestion">\n        Can\'t find the widget you\'re looking for? <a ng-click="modal.widgetSuggestion.open()">Give us your suggestions here!</a>\n      </span>\n    </div>\n  </div>\n\n  <!-- custom widget selector template configured from ImpacThemingProvider -->\n  <div id="custom-widget-selector" ng-if="customWidgetSelector.path" ng-include="customWidgetSelector.path"></div>\n\n\n  <!-- Errors -->\n  <div class="alert alert-error" ng-show="errors">\n    <button class="close" ng-click="errors=\'\'">×</button>\n    <ul>\n      <li ng-repeat="error in errors">{{error}}</li>\n    </ul>\n  </div>\n\n  <div class=\'spacer1\'></div>\n\n  <div id="no-widget-container" class="text-center ng-hide" ng-show=\'(showChooseDhbMsg || showNoWidgetsMsg) && !isLoading\'>\n\n    <img ng-src="{{impacDashboardBackground}}" class="bg">\n\n    <div class="impac-info-message">\n      <!-- First Time Dashboard Creation -->\n      <div class="ng-hide" ng-show=\'showChooseDhbMsg && !isLoading\'>\n        <div class=\'hidden-xs\'>\n          <div class=\'spacer4\'></div>\n          <div class="row">\n            <div class="col-md-8 col-md-offset-2">\n              <div class="testimonial promo-dark">\n                <p><b>It\'s time to add a reporting dashboard!</b></p><p>In 2 clicks, you\'ll be able to visualize how your business is performing.</p>\n              </div>\n            </div>\n          </div>\n          <div class=\'spacer2\'></div>\n        </div>\n        <div class="align-center">\n          <button ng-click="modal.createDashboard.open()" class=\'btn btn-lg btn-warning\'><span class=\'fa fa-plus\'></span> Create a Dashboard!</button>\n        </div>\n      </div>\n\n      <!-- Empty Dashboard -->\n      <div class="ng-hide" ng-show=\'showNoWidgetsMsg && !isLoading\'>\n        <div class=\'hidden-xs\'>\n          <div class=\'spacer4\'></div>\n          <div class="row">\n            <div class="col-md-8 col-md-offset-2">\n              <div class="testimonial promo-dark">\n                <p><b>Now it\'s time to select the metrics you want to see!</b></p><p>Add widgets to your dashboard to help make an Impac!™ to your business.</p>\n              </div>\n            </div>\n          </div>\n          <div class="spacer2"></div>\n        </div>\n        <div class="align-center">\n          <button ng-disabled="showWidgetSelector" ng-click="showWidgetSelector=true" class=\'btn btn-lg btn-warning\'><span class=\'fa fa-plus\'></span> Add a new Widget</button>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- First Time Dashboard Creation -->\n  <div class="row text-center" ng-show=\'showChooseDhbMsg && !isLoading\'>\n    <div class="spacer2 hidden-xs"></div>\n    <div class=\'col-md-8 col-md-offset-2\'>\n      <p class="text-muted"><small><em>Note: dashboards you create will only be accessible by you. Dashboard sharing across users will be added soon.</em></small></p>\n    </div>\n  </div>\n\n  <!-- Widgets -->\n  <div class=\'row\'>\n    <div id="widgets-container" ui-sortable="sortableOptions" ng-model="currentDhb.widgets">\n      <div impac-widget widget="widget" is-accessibility="accessibility" parent-dashboard="currentDhb" ng-repeat="widget in currentDhb.widgets" class="widget-item" ng-class="widget.getColClass()" />\n      <!-- Add Widget Tile, enabled & customised in ImpacThemingProvider -->\n      <div ng-if="isAddChartEnabled" class="unsortable" ng-click="addChartTileOnClick()">\n        <div class="col-md-6 widget-item add-chart">\n          <div class="a-content">+ chart</div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'),t.put("dashboard/delete.modal.html",'<div class="modal-header">\n  <div class="close" type="button" ng-click="close()" >×</div>\n  <h3>Delete Dashboard</h3>\n</div>\n\n<div class="modal-body">\n  <div class="row">\n    <div class="col-sm-12">\n      <div class="alert alert-error" ng-show="errors">\n        <button class="close" ng-click="errors=\'\'">×</button>\n        <ul>\n          <li ng-repeat="error in errors">{{error}}</li>\n        </ul>\n      </div>\n    </div>\n  </div>\n\n  <!-- Create a new widget -->\n  <p>Are you sure you want to delete this analytics dashboard?</p>\n  \n</div>\n\n<div class="modal-footer">\n  <div class="row">\n    <div class="col-sm-12">\n      <button class="btn btn-shaded" ng-click="close()" ng-hide="isLoading" ng-disabled="isLoading">Cancel</button>\n      <button class="btn btn-danger" ng-click="proceed()" ng-hide="isLoading" ng-disabled="isLoading">Delete</button>\n      <img ng-src="{{loadingGif}}" ng-show="isLoading" alt="Loading">\n    </div>\n    \n  </div>\n</div>'),t.put("dashboard/widget-suggestion.modal.html",'<div class="modal-header">\n  <div class="close" type="button" ng-click="close()" >×</div>\n  <h3>Suggest a widget</h3>\n</div>\n\n<div class="modal-body">\n  \n  <div class="row">\n    <div class="col-md-6">\n      <label>What would you name your widget?</label><br />\n      <input type="text" ng-model="widgetDetails.name" ng-disabled="isLoading" />\n    </div>\n    <div class="col-md-6">\n      <label>In which category?</label><br />\n      <input type="text" ng-model="widgetDetails.category" ng-disabled="isLoading" />\n    </div>\n  </div>\n\n  <div class="spacer1" />\n\n  <div class="row">\n    <div class="col-md-12">\n      <label>What kind of information would your widget display?</label><br />\n      <textarea ng-model="widgetDetails.description" ng-disabled="isLoading" />\n    </div>\n  </div>\n\n  <div class="spacer1" ng-show="isLoading" />\n\n  <div class="row" ng-show="isLoading">\n    <div class="col-md-12 text-center">\n      <h3 class="thanks-message">{{userName | titleize}}, thanks a lot for helping us improve Impac!&trade;</h3>\n    </div>\n  </div>\n  \n</div>\n\n<div class="modal-footer">\n  <div class="row">\n    <div class="col-sm-12" ng-class="isLoading ? \'text-center\' : null">\n      <button class="btn btn-shaded" ng-click="close()" ng-hide="isLoading">Cancel</button>\n      <button class="btn btn-info" ng-click="proceed()" ng-hide="isLoading" ng-disabled="!(widgetDetails.name && widgetDetails.category && widgetDetails.description)">Send your suggestion</button>\n      <img ng-src="{{loadingGif}}" ng-show="isLoading" alt="Loading">\n    </div>\n  </div>\n</div>'),t.put("dashboard-selector/bootstrap-tabs.tmpl.html",'<div class="row">\n  <div class="buttons-bar col-md-12">\n    <tabset type="{{selectorType}}">\n      <tab ng-repeat="dhb in dhbCtrl.dashboardsList" select="dhbCtrl.selectDashboard(dhb.id)" active="dhb.active">\n        <tab-heading>\n          {{dhb.full_name}}\n          <a href="" class="close-link">\n            <i class="fa fa-times" ng-click="dhbCtrl.modal.deleteDashboard.open()"></i>\n          </a>\n        </tab-heading>\n      </tab>\n      <tab active="false" ng-if=\'isAccessibilityEnabled\' ng-click="toogleAccessibilityMode()">\n        <tab-heading>\n          <a href=""><i class="fa fa-wheelchair"></i></a>\n        </tab-heading>\n      </tab>\n      <tab active="false" ng-click="dhbCtrl.modal.createDashboard.open()">\n        <tab-heading>\n          <a href="">+</a>\n        </tab-heading>\n      </tab>\n    </tabset>\n  </div>\n</div>\n'),t.put("dashboard-selector/dropdown.tmpl.html",'<div class="row">\n  <div class="buttons-bar col-md-6">\n    <h4 ng-hide=\'dhbCtrl.showChooseDhbMsg\' class=\'dashboard-title\' ng-click="dhbCtrl.toogleShowDashboardsList()">\n      {{dhbCtrl.currentDhb.full_name}}\n      <i class="fa fa-chevron-down" style="font-size: 18px;"></i>\n      <i ng-hide="dhbCtrl.showChangeDhbName" class="fa fa-pencil" tooltip="Change name" tooltip-animation="false" tooltip-append-to-body="true" ng-click="dhbCtrl.toogleShowChangeDhbName(dhbCtrl.currentDhb)"></i>\n    </h4>\n\n    <div collapse="!dhbCtrl.showDashboardsList" class=\'dashboard-select\'>\n      <div ng-hide="dhb.id == dhbCtrl.currentDhbId" class=\'option\' ng-repeat="dhb in dhbCtrl.dashboardsList">\n        <span class="name" ng-click="dhbCtrl.selectDashboard(dhb.id)">{{dhb.full_name}}</span>\n        <i ng-hide="dhbCtrl.showChangeDhbName" class="fa fa-pencil" tooltip="Change name" tooltip-animation="false" tooltip-append-to-body="true" ng-click="dhbCtrl.toogleShowChangeDhbName(dhb)"/>\n      </div>\n\n      <div ng-show="dhbCtrl.showCreateDhb" class="option create" ng-click="dhbCtrl.modal.createDashboard.open() ; dhbCtrl.showChangeDhbName = false"><i class="fa fa-plus" /> Create Dashboard</div>\n    </div>\n\n    <div ng-show="dhbCtrl.showChangeDhbName" class="change-name">\n      <p>Change dashboard name:</p>\n      <input type="text" class="form-control" id="changeDhbNameInput" ng-model="dhbCtrl.dashboardToChange.name" ng-keyup="dhbCtrl.checkChangeDhbNameAndConfirm($event)"/>\n      <button class="btn btn-sm btn-default" ng-click="dhbCtrl.showChangeDhbName=false">Cancel</button>\n      <button class="btn btn-sm btn-success" style="margin-left: 10px" ng-click="dhbCtrl.updateDhbName()">Confirm</button>\n    </div>\n\n    <p ng-hide=\'dhbCtrl.showChooseDhbMsg\' class="data-source-label">\n      <small><b>Source:</b> {{dhbCtrl.currentDhb.organizationsNames}}</small>\n    </p>\n  </div>\n\n  <p ng-hide=\'dhbCtrl.showChooseDhbMsg\' class="data-source-label">\n    <small><b>Source:</b> {{dhbCtrl.currentDhb.organizationsNames}}</small>\n  </p>\n\n  <div class=\'buttons-bar col-md-6\'>\n    <div class=\'actions-panel\'>\n      <button ng-click="toogleAccessibilityMode()" class=\'btn btn-info\' ng-show=\'isAccessibilityEnabled\' ng-disabled="showWidgetSelector"><span class=\'fa fa-wheelchair\'></span></button>\n      <button ng-click="dhbCtrl.showWidgetSelector = true" class=\'btn btn-warning\' ng-show="dhbCtrl.showCreateWidget" ng-disabled="dhbCtrl.showWidgetSelector"><span class=\'fa fa-plus\'></span> Add Widget</button>\n      <button ng-click="dhbCtrl.modal.createDashboard.open()" class=\'btn btn-warning\' ng-show="dhbCtrl.showCreateDhb"><span class=\'fa fa-pencil-square-o\'></span> Create Dashboard</button>\n      <!-- <button id=\'data-upload-wizard\' ng-click=\'dhbCtrl.openStarWizard()\' class=\'btn btn-success hidden-xs\' ><span class=\'fa fa-upload\'></span> Data Upload</button> -->\n      <button ng-click="dhbCtrl.modal.deleteDashboard.open()" class=\'btn btn-danger hidden-xs\' ng-show="dhbCtrl.showDeleteDhb" tooltip="Delete Dashboard"><span class=\'fa fa-trash-o\'></span> </button>\n    </div>\n  </div>\n</div>\n'),t.put("widget/widget.tmpl.html",'<!-- Class wrapper: widget-item -->\n<!-- TODO: rename (impac-widget) -->\n\n<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div ng-show="isTemplateLoaded()" class="content" ng-class="templateName">\n\n  <div ng-show="widget.isLoading">\n    <div class="loader" align="center">\n      Your data is being retrieved...\n      <img class="gif" ng-src="{{loaderImage}}"/>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isLoading" ng-include="widgetContentTemplate()" />\n\n</div>\n\n<div ng-hide="isTemplateLoaded()" class="content">\n  <div class="loader" align="center">\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n</div>\n'),t.put("widgets/accounts-accounting-values.tmpl.html",'<div widget-accounts-accounting-values>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div ng-show="isDataFound">\n      <div setting-hist-mode parent-widget= "widget" />\n\n      <div ng-hide="widget.isHistoryMode" class="current">\n        <div class="price">\n           {{ getCurrentPrice() | mnoCurrency : getCurrency() : false }}\n        </div>\n        <div class="currency">{{getCurrency()}}</div>\n        <div class="legend">{{getLegend()}}</div>\n      </div>\n\n      <!-- the display condition must be an "if" and its value must change for the chart to be drawn again -->\n      <div ng-if="widget.isHistoryMode" class="history chart-container">\n        <div dhb-chart data="widget.chart"></div>\n        <div class="legend">{{getLegend()}}</div>\n      </div>\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n  \n</div>'),t.put("widgets/accounts-assets-summary.tmpl.html",'<div widget-accounts-assets-summary>\n      \n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div ng-if="isDataFound" class="chart-container">\n      <div dhb-chart data="widget.chart"></div>\n      <div class="legend">\n        <span ng-repeat="valuePair in widget.content.summary">\n          <span style="font-weight: bold; color: {{getAccountColor(valuePair)}};">{{valuePair.label}}</span>: {{valuePair.total | mnoCurrency : getCurrency()}}\n          <br />\n        </span>\n      </div>\n    </div>\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/accounts-balance.tmpl.html",'<div widget-accounts-balance>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div ng-hide="!isDataFound" setting-account parent-widget="widget" class="part" />\n    <div ng-hide="!isDataFound" setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div ng-show="isDataFound">\n      <!-- Will be hidden once an account is selected -->\n      <div setting-account ng-hide="widget.selectedAccount" parent-widget="widget" label=\'Select an account to monitor\' />\n\n      <!-- All the below divs will remain hidden until an account is selected -->\n      <div setting-hist-mode ng-show="widget.selectedAccount" parent-widget="widget" />\n\n      <!-- the display condition must be an "if" and its value must change for the chart to be drawn again -->\n      <div ng-if="widget.isHistoryMode && widget.selectedAccount" class="chart-container">\n        <div dhb-chart data="widget.chart"></div>\n        <div class="legend">{{getName()}}</div>\n      </div>\n\n      <div ng-hide="widget.isHistoryMode || !widget.selectedAccount">\n        <h3>{{getName()}}</h3>\n        <div class="price">\n           {{ getCurrentBalance() | mnoCurrency : getCurrency() : false }}\n        </div>\n        <div class="currency">{{getCurrency()}}</div>\n      </div>\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found />\n  </div>\n\n</div>'),t.put("widgets/accounts-balance-sheet.tmpl.html",'<div widget-accounts-balance-sheet>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound">\n\n      <div class="widget-lines-container">\n        <div class="row widget-line header">\n          <div class="col-sm-6 text-center">Compare with previous: <span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period"/></div>\n          <div class="col-sm-3 text-right">{{widget.content.dates[0] | date : "d-MMM"}}</div>\n          <div class="col-sm-3 text-right">{{widget.content.dates[1] | date : "d-MMM"}}</div>\n        </div>\n        <div class="row widget-line total" ng-repeat="category in categories" >\n          <div class="row widget-line" >\n            <div class="col-sm-1" ng-click="toogleCollapsed(category)" style="cursor: pointer;"><i class="fa" ng-class="isCollapsed(category) ? "fa-plus-square-o" : "fa-minus-square-o"" /></div>\n            <div class="col-sm-5"><strong>{{category | titleize}}</strong></div>\n            <div class="col-sm-3 text-right"><strong>{{widget.content.summary[category].totals[0] | mnoCurrency : widget.content.summary[category].currency}}</strong></div>\n            <div class="col-sm-3 text-right"><strong>{{widget.content.summary[category].totals[1] | mnoCurrency : widget.content.summary[category].currency}}</strong></div>\n          </div>\n          <div collapse="isCollapsed(category)">\n            <div class="row widget-line" ng-repeat="account in widget.content.summary[category].accounts" >\n              <div class="col-sm-1" />\n              <div class="col-sm-5">{{account.name | titleize}}</div>\n              <div class="col-sm-3 text-right">{{account.totals[0] | mnoCurrency : account.currency}}</div>\n              <div class="col-sm-3 text-right">{{account.totals[1] | mnoCurrency : account.currency}}</div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/accounts-cash-summary.tmpl.html",'<div widget-accounts-cash-summary>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound" class="row" >\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" />\n\n        <div class="widget-lines-container">\n          <div class="row widget-line header">\n            <div class="col-sm-1" />\n            <div class="col-sm-5"></div>\n            <div class="col-sm-3 text-right">{{getLastDate() | date : "d-MMM"}}</div>\n            <div class="col-sm-3 text-right">Variance</div>\n          </div>\n          <div class="row widget-line total" ng-repeat="statement in widget.content.summary" >\n            <div class="row widget-line" ng-class="isSelected(statement) ? \'selected\' : null" >\n              <div class="col-sm-1" ng-click="toogleCollapsed(statement)"><i class="fa" ng-class="isCollapsed(statement) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" /></div>\n              <div class="col-sm-5" ng-click="toogleSelectedElement(statement)"><strong>{{getName(statement) | titleize}}</strong></div>\n              <div class="col-sm-3 text-right" ng-click="toogleSelectedElement(statement)"><strong>{{getLastValue(statement) | mnoCurrency : statement.currency}}</strong></div>\n              <div class="col-sm-3 text-right" ng-click="toogleSelectedElement(statement)" ng-class="getVarianceClassColor(getLastVariance(statement))"><strong>{{getLastVariance(statement)}}</strong></div>\n            </div>\n            <div collapse="isCollapsed(statement)">\n              <div class="row widget-line" ng-click="toogleSelectedElement(account)" ng-repeat="account in statement.accounts" ng-class="isSelected(account) ? \'selected\' : null" >\n                <div class="col-sm-1" />\n                <div class="col-sm-5">{{account.name}}</div>\n                <div class="col-sm-3 text-right">{{getLastValue(account) | mnoCurrency : account.currency }}</div>\n                <div class="col-sm-3 text-right" ng-class="getVarianceClassColor(getLastVariance(account))">{{getLastVariance(account)}}</div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n        <h4>{{getName(selectedElement) | titleize}}</h4>\n        <div class="chart-container" ng-if="isDataFound && widget.isExpanded()">\n          <div dhb-chart data="widget.chart"></div>\n        </div>\n        <div class="legend">{{(widget.metadata.hist_parameters.period || "Monthly") | titleize}} Cash Flow</div>\n        <div class="widget-lines-container">\n          <div class="row widget-line">\n            <div class="col-sm-2 text-center" ng-repeat="date in dates" style="padding: 5px 0px;">\n              <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;">{{date | date : "d-MMM"}}</div></div>\n              <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;">{{selectedElement.cash_flows[$index] | mnoCurrency : selectedElement.currency }}</div></div>\n              <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;" ng-class="getVarianceClassColor(selectedElement.variances[$index])">{{formatVariance(selectedElement.variances[$index])}}</div></div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n    \n</div>'),t.put("widgets/accounts-comparison.tmpl.html",'<div widget-accounts-comparison>\n  <div setting-accounts-list parent-widget="widget" />\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound">\n      <div ng-hide="hasAccountsSelected()" class="row">\n        <h5>Select which accounts you wish to compare.</h5>\n        <div class="col-md-6">\n          <div class="input-group">\n            <select ng-model="movedAccount" ng-options="account.name + \' (\' + formatAmount(account) + \')\' for account in widget.remainingAccounts" class="form-control" ng-show="widget.hasEditAbility" ng-change="addAccount(movedAccount)"></select>\n          </div>\n        </div>\n      </div>\n\n      <div ng-if="hasAccountsSelected()">\n        <div class="row">\n          <div class="col-md-12 chart-container">\n            <div dhb-chart data="widget.chart" />\n          </div>\n        </div>\n\n        <div class="row">\n          <div class="col-md-12">\n            <div class="widget-lines-container">\n              <div class="widget-line" ng-repeat="account in widget.selectedAccounts">\n                <button class="close" ng-click="removeAccount(account)" ng-show="widget.hasDeleteAbility">\n                  x\n                </button>\n                <i style="float: right; margin-right: 10px;">{{formatAmount(account)}}</i>\n                <i class="fa fa-circle" style="margin: 0px 8px; color: {{getAccountColor(account)}}" />\n                {{account.name}}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class="row">\n          <div class="add-account">\n            <div class="input-group">\n              <select ng-model="movedAccount" ng-options="account.name + \' (\' + formatAmount(account) + \')\' for account in widget.remainingAccounts track by account.uid" class="form-control" ng-show="widget.hasDeleteAbility" ng-change="addAccount(movedAccount)" ng-disabled="widget.selectedAccounts.length >= 15 || widget.remainingAccounts.length == 0">\n                <option value="" disabled selected>+ ADD ACCOUNT</option>\n              </select>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/accounts-custom-calculation.tmpl.html",'<div widget-accounts-custom-calculation>\n\n  <div setting-organizations parent-widget="widget" ng-hide="true" />\n  <div setting-accounts-list parent-widget="widget" />\n  <div setting-formula parent-widget="widget" />\n\n  <h3 ng-show="widget.hasEditAbility && !widget.isFormulaCorrect">\n    <a href="" ng-click="formulaModal.open()">Create a custom calculation</a>\n  </h3>\n  \n  <div class="price" ng-show="widget.isFormulaCorrect">\n    {{widget.evaluatedFormula}}\n  </div>\n  <!-- Should be put in a tooltip/popover instead -->\n<!--     <div class="legend" ng-show="widget.isFormulaCorrect">\n    {{widget.legend}}\n  </div> -->\n\n</div>'),t.put("widgets/accounts-custom-calculation/formula.modal.html",'<div class="modal-custom-calculation">\n  <div class="modal-header">\n    <div class="close" type="button" ng-click="formulaModal.cancel()" >×</div>\n    <h3>Custom Calculation</h3>\n  </div>\n\n  <div class="modal-body">\n    <div class="row">\n      <div class="col-sm-12">\n        <div class="alert alert-error" ng-show="formulaModal.errors">\n          <button class="close" ng-click="formulaModal.errors=\'\'">×</button>\n          <ul>\n            <li ng-repeat="error in formulaModal.errors">{{error}}</li>\n          </ul>\n        </div>\n      </div>\n    </div>\n\n    <!-- <div class=\'analytics\'>  -->\n      \n      <div class="edit">\n        <div setting-organizations parent-widget="widget" class="part" />\n      </div>\n\n      <p>Make a custom equation with your accounts, and save it as a widget. To create an equation, simply select your accounts in the list, and use the classical operators (example: ({1} + {2}) / {3})</p>\n\n      <div class=\'row\'>\n        <div ng-show="widget.isLoading" class=\'col-md-6 loader\' align="center">\n          Your data is being retrieved...\n          <img class="gif" ng-src="{{loaderImage}}"/>\n        </div>\n\n        <div ng-hide="widget.isLoading" class=\'col-md-6\'>\n          <div class=\'widget-line\' ng-repeat=\'account in widget.selectedAccounts\'>\n            <div class=\'row\'>\n              <div class=\'col-md-6\'>\n                {{$index+1}} - {{account.name}}\n              </div>\n              <div class=\'col-md-6\'>\n                {{account.current_balance | mnoCurrency : account.currency}}\n                <button class="close" ng-click="removeAccountFromFormula(account)" ng-show="widget.hasEditAbility"><span class=\'fa fa-times-circle\'></span></button>\n              </div>\n            </div>\n          </div>\n\n          <div class=\'input-group\' ng-show="widget.hasEditAbility">\n            <select ng-model="movedAccount" ng-options="account.name + \' (\' + widget.formatAmount(account) + \')\' for account in widget.remainingAccounts" class=\'form-control\' ng-change=\'addAccountToFormula(movedAccount)\'><select>\n          </div>\n        </div>\n        \n        <div class=\'col-md-6\'>\n          <p>Type your formula just below:</p>\n          <input class=\'form-control\' ng-model="widget.formula">\n\n          <p>Result: {{widget.evaluatedFormula}}</p>\n          <p>Legend: {{widget.legend}}</p>\n        </div>\n      </div>\n    <!-- </div> -->\n  </div>\n\n  <div class="modal-footer">\n    <div class="row">\n      <div class="col-sm-12">\n        <button class="btn btn-gray" ng-click="formulaModal.cancel()" ng-hide="widget.isLoading" ng-disabled="isLoading">Cancel</button>\n        <button class="btn btn-warning" ng-click="formulaModal.proceed()" ng-hide="widget.isLoading" ng-disabled=\'!widget.isFormulaCorrect || widget.isLoading\'>Save</button>\n        <img ng-src="{{loaderImage}}" ng-show="widget.isLoading" alt="Loading">\n      </div>\n      \n    </div>\n  </div>\n</div>'),t.put("widgets/accounts-expenses-revenue.tmpl.html",'<div widget-accounts-expenses-revenue>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div ng-show="isDataFound">\n      <div setting-hist-mode parent-widget="widget" />\n\n      <!-- the display condition must be an "if" and its value must change for the chart to be drawn again -->\n      <div ng-if="widget.isHistoryMode && !widget.isLoading" class="chart-container">\n        <div dhb-chart data="widget.hist_chart"></div>\n        <div class="legend">\n          <span class="negative2">Expenses</span> -\n          <span class="positive2">Revenue</span>\n        </div>\n      </div>\n\n      <div ng-if="!widget.isHistoryMode && !widget.isLoading" class="chart-container">\n        <div dhb-chart data="widget.cur_chart"></div>\n        <div class="legend">\n          <span class="negative2">Expenses: {{getCurrentExpenses() | mnoCurrency : getCurrency()}}</span>\n          </br>\n          <span class="positive2">Revenue: {{getCurrentRevenue() | mnoCurrency : getCurrency()}}</span>\n        </div>\n      </div>\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/accounts-payable-receivable.tmpl.html",'<div widget-accounts-payable-receivable>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div ng-show="isDataFound">\n      <div setting-hist-mode parent-widget="widget" />\n\n      <!-- the display condition must be an "if" and its value must change for the chart to be drawn again -->\n      <div ng-if="widget.isHistoryMode" class="chart-container">\n        <div dhb-chart data="widget.chart"></div>\n        <div class="legend">\n          <span class="negative2">Payable</span> -\n          <span class="positive2">Receivable</span>\n        </div>\n      </div>\n\n      <div ng-hide="widget.isHistoryMode">\n        <div class="receivable">\n          <h3>Accounts Receivable</h3>\n          <div class="price positive2">\n             {{getCurrentReceivable() | mnoCurrency : getCurrency() : false}}\n          </div>\n          <div class="currency">{{getCurrency()}}</div>\n        </div>\n\n        <div class="payable">\n          <h3>Accounts Payable</h3>\n          <div class="price negative2">\n            {{getCurrentPayable() | mnoCurrency : getCurrency() : false}}\n          </div>\n          <div class="currency">{{getCurrency()}}</div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/accounts-profit-and-loss.tmpl.html",'<div widget-accounts-profit-and-loss>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound" class="row" >\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" />\n\n        <div class="widget-lines-container">\n          <div class="row widget-line header">\n            <div class="col-sm-8">{{(widget.metadata.hist_parameters.period || "Monthly") | titleize}} Profit and Loss</div>\n            <div class="col-sm-4 text-right">{{getLastDate() | date : "d-MMM"}}</div>\n          </div>\n          <div class="row widget-line total" ng-repeat="statement in widget.content.summary" >\n            <div class="row widget-line" ng-class="isSelected(statement) ? \'selected\' : null" >\n              <div class="col-sm-1" ng-click="toogleCollapsed(statement)"><i ng-show="statement.accounts" class="fa" ng-class="isCollapsed(statement) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" /></div>\n              <div class="col-sm-7" ng-click="toogleSelectedElement(statement)"><strong>{{getName(statement) | titleize}}</strong></div>\n              <div class="col-sm-4 text-right" ng-class="getClassColor(getLastValue(statement))" ng-click="toogleSelectedElement(statement)"><strong>{{getLastValue(statement) | mnoCurrency : statement.currency}}</strong></div>\n            </div>\n            <div collapse="isCollapsed(statement)">\n              <div class="row widget-line" ng-click="toogleSelectedElement(account)" ng-repeat="account in statement.accounts" ng-class="isSelected(account) ? \'selected\' : null" >\n                <div class="col-sm-1" />\n                <div class="col-sm-7">{{account.name}}</div>\n                <div class="col-sm-4 text-right" ng-class="getClassColor(getLastValue(account))">{{getLastValue(account) | mnoCurrency : account.currency}}</div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n        <h4>{{(widget.metadata.hist_parameters.period || "Monthly") | titleize}} Profit and Loss</h4>\n        <div ng-show="selectedElements.length < 2" class="legend">{{getName(selectedElements[0]) | titleize}}</div>\n\n        <div class="chart-container" ng-if="isDataFound && widget.isExpanded()">\n          <div dhb-chart data="widget.chart"></div>\n        </div>\n\n        <div ng-show="selectedElements.length < 2" class="widget-lines-container">\n          <div class="row widget-line">\n            <div class="col-sm-2 text-center" ng-repeat="date in dates" style="padding: 5px 0px;">\n              <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;">{{date | date : "d-MMM"}}</div></div>\n              <div class="row widget-line"><div class="col-sm-12" ng-class="getClassColor(selectedElements[0].totals[$index])" style="padding: 0px;">{{selectedElements[0].totals[$index] | mnoCurrency : selectedElements[0].currency}}</div></div>\n            </div>\n          </div>\n        </div>\n\n        <div ng-hide="selectedElements.length < 2" class="widget-lines-container">\n          <div class="widget-line" ng-repeat="element in selectedElements">\n            <i style="float: right; margin-right: 10px;" ng-class="getClassColor(getLastValue(element))">{{getLastValue(element) | mnoCurrency : element.currency}}</i>\n            <i class="fa fa-circle" style="margin: 0px 8px; color: {{getElementChartColor($index)}}" />\n            {{getName(element) | titleize}}\n          </div>\n        </div>\n\n      </div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/hr-employee-details.tmpl.html",'<div widget-hr-employee-details>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound" class="row" >\n\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="3" max="6" class="settings width" />\n        <div setting-param-selector parent-widget="widget" param="employee_uid" options="employeesOptions" selected="selectedEmployee" class="row title" />\n\n        <div class="details-container">\n          <div class="row">\n            <div class="col-md-4"><label>Job Title</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().job_title || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Company</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().company || getSingleCompanyName()}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Phone</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().phone || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Email</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().email || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Date of birth</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().dob || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Gender</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().gender || "-" }}</pre></div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel" ng-show="widget.isExpanded()">\n        <div class="legend">Salary calculation period: <span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period" /></div>\n        <div class="details-container">\n          <div class="row">\n            <div class="col-md-4"><label>Salary</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().salary || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Address</label></div>\n            <div class="col-md-8"><pre>{{formatAddress(getEmployee().address) || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Job location</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().location || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Supervisor</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().supervisor || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Statuts</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().employment_status || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Note</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().note || "-" }}</pre></div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/hr-employees-list.tmpl.html",'<div widget-hr-employees-list>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound" >\n\n      <div class="legend">\n        <strong>{{widget.content.total.employees}}</strong> employee{{widget.content.total.employees > 1 ? "s" : null}} - Average salary rate (<span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period"/>): <strong>{{widget.content.total.average_rate | mnoCurrency : widget.content.total.currency}}</strong>\n      </div>\n\n      <div class="widget-lines-container">\n        <div class="row widget-line header">\n          <div class="col-sm-2">Company</div>\n          <div class="col-sm-3">Employee</div>\n          <div class="col-sm-2">Title</div>\n          <div class="col-sm-3">Phone</div>\n          <div class="col-sm-2">Salary</div>\n        </div>\n        <div class="row widget-line" ng-repeat="employee in widget.content.employees" >\n          <div class="col-sm-2">{{employee.company || getSingleCompanyName()}}</div>\n          <div class="col-sm-3">{{employee.lastname}} {{employee.firstname}}</div>\n          <div class="col-sm-2"><i>{{employee.job_title}}</i></div>\n          <div class="col-sm-3">{{employee.phone}}</div>\n          <div class="col-sm-2"><i>{{getEmployeeSalary(employee)}}</i></div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/hr-leaves-balance.tmpl.html",'<div widget-hr-leaves-balance>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound" >\n\n      <div setting-param-selector parent-widget="widget" param="employee_id" options="employeesOptions" selected="selectedEmployee" class="selector" />\n\n      <div class="widget-lines-container">\n        <div class="widget-line">\n          <i style="float: right; margin-right: 10px;">{{getEmployee().total_leaves}} h</i>\n          Accrued\n        </div>\n        <div class="widget-line">\n          <i style="float: right; margin-right: 10px;">{{getEmployee().total_timeoff}} h</i>\n          Used\n        </div>\n      </div>\n\n      <h3>Leave Balance</h3>\n      <div class="balance">{{(getEmployee().total_leaves - getEmployee().total_timeoff)}} hours</div>\n      <div class="legend">\n        <span>(from {{widget.content.dates[0] | date : "MMM-d"}} to {{widget.content.dates[widget.content.dates.length - 1] | date : "MMM-d"}})</span>\n      </div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/hr-leaves-schedule.tmpl.html",'<div widget-hr-leaves-schedule>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound">\n\n      <div widget-component-calendar ng-model="eventSources"></div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/hr-payroll-summary.tmpl.html",'<div widget-hr-payroll-summary>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound" class="row" >\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" />\n\n        <div class="widget-lines-container">\n          <div class="row widget-line header">\n            <div class="col-sm-12">Payroll Summary - {{getPeriod()}}</div>\n          </div>\n          <div class="row widget-line total" ng-repeat="statement in widget.content.summary" >\n            <div class="row widget-line" ng-class="isSelected(statement) ? \'selected\' : null" >\n              <div class="col-sm-1" ng-click="toogleCollapsed(statement)"><i ng-show="statement.employees" class="fa" ng-class="isCollapsed(statement) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" /></div>\n              <div class="col-sm-7" ng-click="toogleSelectedElement(statement)"><strong>{{getName(statement) | titleize}}</strong></div>\n              <div class="col-sm-4 text-right" ng-click="toogleSelectedElement(statement)">\n                <strong>{{getLastValue(statement) | mnoCurrency : statement.currency}}</strong>\n              </div>\n            </div>\n            <div collapse="isCollapsed(statement)">\n              <div class="row widget-line" ng-click="toogleSelectedElement(employee)" ng-repeat="employee in statement.employees" ng-class="isSelected(employee) ? \'selected\' : null" >\n                <div class="col-sm-1" />\n                <div class="col-sm-7">{{employee.name}}</div>\n                <div class="col-sm-4 text-right">\n                  <span>{{getLastValue(employee) | mnoCurrency : employee.currency}}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n        <h4>{{(widget.content.hist_parameters.period || "Monthly") | titleize}} Payroll Summary</h4>\n\n        <div setting-hist-mode parent-widget="widget" />\n\n        <div ng-show="selectedElements.length < 2" class="legend">{{getName(selectedElements[0]) | titleize}}</div>\n\n        <div class="chart-container" ng-if="isDataFound && widget.isExpanded()">\n          <div ng-if="widget.isHistoryMode" dhb-chart data="widget.hist_chart"></div>\n          <div ng-if="!widget.isHistoryMode" dhb-chart data="widget.cur_chart"></div>\n        </div>\n\n        <div ng-show="selectedElements.length < 2" class="widget-lines-container">\n          <div ng-show="getTrackedField()" class="legend">{{getTrackedField()}}</div>\n          <div class="row widget-line">\n            <div class="col-sm-2 text-center" ng-repeat="date in widget.content.dates" style="padding: 5px 0px;">\n              <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;">{{formatDate(date)}}</div></div>\n              <div class="row widget-line">\n                <div class="col-sm-12" style="padding: 0px;">{{selectedElements[0].totals[$index] | mnoCurrency : selectedElements[0].currency }}</div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div ng-hide="selectedElements.length < 2" class="widget-lines-container">\n\n          <div ng-if="widget.isHistoryMode" class="widget-line header">\n            <span ng-show="getTrackedField()">{{getTrackedField()}} - </span>From {{widget.content.dates[0] | date : "MMM-d"}} to {{widget.content.dates[widget.content.dates.length - 1] | date : "MMM-d"}}\n          </div>\n          <div ng-if="!widget.isHistoryMode" class="widget-line header">\n            <span ng-show="getTrackedField()">{{getTrackedField()}} - </span>{{getPeriod()}}\n          </div>\n\n          <div class="widget-line" ng-repeat="element in selectedElements">\n            <i style="float: right; margin-right: 10px;">\n              <span ng-if="widget.isHistoryMode">{{getTotalSum(element) | mnoCurrency : element.currency}}</span>\n              <span ng-if="!widget.isHistoryMode">{{getLastValue(element) | mnoCurrency : element.currency}}</span>\n            </i>\n            <i class="fa fa-circle" style="margin: 0px 8px; color: {{getElementChartColor($index)}}" />\n            {{getName(element) | titleize}}\n          </div>\n\n        </div>\n\n      </div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/hr-payroll-taxes.tmpl.html",'<div widget-hr-payroll-taxes>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div ng-show="isDataFound">\n      <div setting-hist-mode parent-widget= "widget" />\n\n      <div ng-hide="widget.isHistoryMode" class="current">\n        <div class="price">{{getCurrentPrice() | mnoCurrency : getCurrency() : false}}</div>\n        <div class="currency">{{getCurrency()}}</div>\n        <div class="legend">Taxes upon workforce costs<br />{{getPeriod()}}</div>\n      </div>\n\n      <!-- the display condition must be an "if" and its value must change for the chart to be drawn again -->\n      <div ng-if="widget.isHistoryMode" class="history chart-container">\n        <div dhb-chart data="widget.chart"></div>\n        <div class="legend">Taxes upon workforce costs</div>\n      </div>\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>\n'),t.put("widgets/hr-salaries-summary.tmpl.html",'<div widget-hr-salaries-summary>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div align="center" ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound" class="row">\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="3" max="6" class="settings width" />\n\n        <h3 class="left">Average Salary Rate</h3>\n        <div class="price">\n           {{widget.content.total.average_rate | mnoCurrency : widget.content.total.currency}}\n        </div>\n        <div class="currency" setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period"/>\n        <div class="legend">\n          <span>({{widget.content.total.employees}} employee{{widget.content.total.employees > 1 ? "s" : null}} with known salary)</span>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel" ng-show="widget.isExpanded()">\n        <h3 class="right">Filter: <span setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter"/></h3>\n        <div class="chart-container" ng-if="isDataFound && widget.isExpanded()">\n          <div dhb-chart data="widget.chart"></div>\n        </div>\n        <div class="widget-lines-container">\n          <div class="widget-line" ng-repeat="data in widget.content.summary.data">\n            <i style="float: right; margin-right: 10px;"><b>{{data.value | mnoCurrency : widget.content.total.currency}} (av.)</b></i>\n            <i ng-hide="widget.content.summary.filter==\'age_range\'" class="fa fa-circle" style="margin: 0px 8px; color: {{getColorByIndex($index)}}" />\n            {{data.label}}\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/hr-superannuation-accruals.tmpl.html",'<div widget-hr-superannuation-accruals>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound" class="row" >\n\n      <div setting-param-selector parent-widget="widget" param="employee_id" options="employeesOptions" selected="selectedEmployee" class="currency" />\n\n      <h3>Superannuation Balance</h3>\n      <div class="price">{{getEmployee().total_super | mnoCurrency : getEmployee().currency}}</div>\n      <div class="legend">\n        <span>(from {{widget.content.dates[0] | date : \'MMM-d\'}} to {{widget.content.dates[widget.content.dates.length - 1] | date : \'MMM-d\'}})</span>\n      </div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/hr-timesheets.tmpl.html",'<div widget-hr-timesheets>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound">\n\n      <div setting-param-selector parent-widget="widget" param="employee_id" options="employeesOptions" selected="selectedEmployee" class="currency" />\n\n      <div class="widget-lines-container">\n        <div class="row widget-line header">\n          <div class="col-sm-12">From {{widget.content.dates[0] | date : \'MMM-d\'}} to {{widget.content.dates[widget.content.dates.length - 1] | date : \'MMM-d\'}}</div>\n        </div>\n        <div class="row widget-line total" >\n          <div class="row widget-line" >\n            <div class="col-sm-1" ng-click="toogleCollapsed(\'total_time_worked\')" style="cursor: pointer;"><i class="fa" ng-class="isCollapsed(\'total_time_worked\') ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" /></div>\n            <div class="col-sm-7"><strong>Total Time Worked</strong></div>\n            <div class="col-sm-4 text-right"><strong>{{getEmployeeTimeWorked()}} h</strong></div>\n          </div>\n          <div collapse="isCollapsed(\'total_time_worked\')">\n            <div class="row widget-line">\n              <div class="col-sm-1" />\n              <div class="col-sm-11"><i>Activities detail not found</i></div>\n            </div>\n          </div>\n        </div>\n\n        <div class="row widget-line total" >\n          <div class="row widget-line" >\n            <div class="col-sm-1" ng-click="toogleCollapsed(\'total_time_of\')" style="cursor: pointer;"><i class="fa" ng-class="isCollapsed(\'total_time_of\') ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" /></div>\n            <div class="col-sm-7"><strong>Total Time Off</strong></div>\n            <div class="col-sm-4 text-right"><strong>{{getEmployeeTimeOff()}} h</strong></div>\n          </div>\n          <div collapse="isCollapsed(\'total_time_of\')">\n            <div class="row widget-line">\n              <div class="col-sm-1" />\n              <div class="col-sm-7">PTO</div>\n              <div class="col-sm-4 text-right">0 h</div>\n            </div>\n            <div class="row widget-line">\n              <div class="col-sm-1" />\n              <div class="col-sm-7">Vacation</div>\n              <div class="col-sm-4 text-right">0 h</div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/hr-workforce-summary.tmpl.html",'<div widget-hr-workforce-summary>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div align="center" ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound" class="row">\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="3" max="6" class="settings width" />\n\n        <h3 class="left">Total Workforce</h3>\n        <div class="price">\n           {{getTotalWorkforce() | mnoCurrency : getCurrency()}}\n        </div>\n        <div class="currency" setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period"/>\n        <div class="legend">\n          <span>({{getNumberOfEmployees()}} employee{{getNumberOfEmployees() > 1 ? \'s\' : null}} with known salary)</span>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel" ng-show="widget.isExpanded()">\n        <h3 class="right">Filter: <span setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter"/></h3>\n        <div class="chart-container" ng-if="isDataFound && widget.isExpanded()">\n          <div dhb-chart data="widget.chart"></div>\n        </div>\n        <div class="widget-lines-container">\n          <div class="widget-line" ng-repeat="data in widget.content.summary.data">\n            <i style="float: right; margin-right: 10px;"><b>{{((data.value / widget.content.total.amount)*100).toFixed()}}%</b></i>\n            <i class="fa fa-circle" style="margin: 0px 8px; color: {{getColorByIndex($index)}}" />\n            {{widget.content.summary.filter == "salary_range" ? formatSalaryRange(data) : data.label}}\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/invoices-aged-payables-receivables.tmpl.html",'<div widget-invoices-aged-payables-receivables>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound" class="row" >\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" />\n\n        <div class="widget-lines-container">\n          <div class="row widget-line header">\n            <div class="col-sm-8">Aged Payables & Receivables</div>\n            <div class="col-sm-4 text-right">{{widget.content.dates[0] | date : \'MMM-d\'}} to {{widget.content.dates[widget.content.dates.length - 1] | date : \'MMM-d\'}}</div>\n          </div>\n\n          <!-- Payables -->\n          <div class="row widget-line total">\n            <div class="row widget-line" ng-class="isSelected(widget.content.payables) ? \'selected\' : null" >\n              <div class="col-sm-1" ng-click="toogleCollapsed(widget.content.payables)">\n                <i ng-show="widget.content.payables.suppliers" class="fa" ng-class="isCollapsed(widget.content.payables) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" />\n              </div>\n              <div class="col-sm-7" ng-click="toogleSelectedElement(widget.content.payables)">\n                <strong>Aged Payables</strong>\n              </div>\n              <div class="col-sm-4 text-right" ng-click="toogleSelectedElement(widget.content.payables)">\n                <strong>{{getTotalSum(widget.content.payables) | mnoCurrency : widget.content.payables.currency}}</strong>\n              </div>\n            </div>\n            <div ng-hide="isCollapsed(widget.content.payables)">\n              <div class="row widget-line" ng-click="toogleSelectedElement(supplier)" ng-repeat="supplier in widget.content.payables.suppliers" ng-class="isSelected(supplier) ? \'selected\' : null" >\n                <div class="col-sm-1" />\n                <div class="col-sm-7">{{supplier.name}}</div>\n                <div class="col-sm-4 text-right">\n                  <span>{{getTotalSum(supplier) | mnoCurrency : supplier.currency}}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <!-- Receivables -->\n          <div class="row widget-line total">\n            <div class="row widget-line" ng-class="isSelected(widget.content.receivables) ? \'selected\' : null" >\n              <div class="col-sm-1" ng-click="toogleCollapsed(widget.content.receivables)">\n                <i ng-show="widget.content.receivables.customers" class="fa" ng-class="isCollapsed(widget.content.receivables) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" />\n              </div>\n              <div class="col-sm-7" ng-click="toogleSelectedElement(widget.content.receivables)">\n                <strong>Aged Receivables</strong>\n              </div>\n              <div class="col-sm-4 text-right" ng-click="toogleSelectedElement(widget.content.receivables)">\n                <strong>{{getTotalSum(widget.content.receivables) | mnoCurrency : widget.content.receivables.currency}}</strong>\n              </div>\n            </div>\n            <div ng-hide="isCollapsed(widget.content.receivables)">\n              <div class="row widget-line" ng-click="toogleSelectedElement(customer)" ng-repeat="customer in widget.content.receivables.customers" ng-class="isSelected(customer) ? \'selected\' : null" >\n                <div class="col-sm-1" />\n                <div class="col-sm-7">{{customer.name}}</div>\n                <div class="col-sm-4 text-right">\n                  <span>{{getTotalSum(customer) | mnoCurrency : customer.currency}}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n        <h4>{{(widget.content.hist_parameters.period || "Monthly") | titleize}} Aged Payables and Receivables</h4>\n\n        <div ng-show="selectedElements.length < 2" class="legend">{{getName(selectedElements[0]) | titleize}}</div>\n\n        <div class="chart-container" ng-if="isDataFound && widget.isExpanded()">\n          <div dhb-chart data="widget.chart"></div>\n        </div>\n\n        <div ng-show="selectedElements.length < 2" class="widget-lines-container">\n          <div class="row widget-line">\n            <div class="col-sm-2 text-center" ng-repeat="date in widget.content.dates" style="padding: 5px 0px;">\n              <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;">{{date | date : \'MMM-d\'}}</div></div>\n              <div class="row widget-line">\n                <div class="col-sm-12" style="padding: 0px;">{{selectedElements[0].totals[$index] | mnoCurrency : selectedElements[0].currency}}</div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div ng-hide="selectedElements.length < 2" class="widget-lines-container">\n\n          <div class="widget-line header">\n            Total from {{widget.content.dates[0] | date : \'MMM-d\'}} to {{widget.content.dates[widget.content.dates.length - 1] | date : \'MMM-d\'}}\n          </div>\n\n          <div class="widget-line" ng-repeat="element in selectedElements">\n            <i style="float: right; margin-right: 10px;">\n              <span>{{getTotalSum(element) | mnoCurrency : element.currency}}</span>\n            </i>\n            <i class="fa fa-circle" style="margin: 0px 8px; color: {{getElementChartColor($index)}}" />\n            {{getName(element) | titleize}}\n          </div>\n\n        </div>\n\n      </div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/invoices-list.accessible.tmpl.html",'<div widget-invoices-list>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <table class="table widget-lines-container" ng-hide="widget.isEditMode">\n\n    <!-- Header line -->\n    <tr class="widget-line header">\n      <td>{{entityTypeCap}}</td>\n      <td>Paid</td>\n      <td>Due</td>\n      <td>Invoiced</td>\n    </tr>\n\n    <!-- Data not found line -->\n    <tr class="widget-line" ng-hide="isDataFound">\n      <td>No {{orderBy}}invoice found for your {{entityType}}</td>\n    </tr>\n    \n    <!-- Content lines -->\n    <tr class="widget-line" ng-show="isDataFound" ng-repeat="entity in widget.content.entities">\n      <td>{{entity.name}}</td>\n      <td><i>{{entity.total_paid | mnoCurrency : entity.currency}}</i></td>\n      <td><i>{{entity.total_due | mnoCurrency : entity.currency}}</i></td>\n      <td><i>{{entity.total_invoiced | mnoCurrency : entity.currency}}</i></td>\n    </tr>\n\n  </table>\n\n</div>\n'),t.put("widgets/invoices-list.tmpl.html",'<div widget-invoices-list>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode" class="widget-lines-container">\n\n    <!-- Header line -->\n    <!-- when large widget -->\n    <div class="row widget-line header" ng-show="widget.width > 3">\n      <div class="col-sm-4">{{entityTypeCap}}</div>\n      <div class="col-sm-7">\n        <div class="col-xs-4">Paid</div>\n        <div class="col-xs-4">Due</div>\n        <div class="col-xs-4">Invoiced</div>\n      </div>\n    </div>\n\n    <!-- when small widget -->\n    <div class="row widget-line header" ng-hide="widget.width > 3">\n      <div class="col-xs-7">{{entityTypeCap}}</div>\n      <div class="col-xs-4" ng-show="orderBy == \'paid \'">Paid</div>\n      <div class="col-xs-4" ng-show="orderBy == \'due \'">Due</div>\n      <div class="col-xs-4" ng-hide="orderBy == \'paid \' || orderBy == \'due \'">Invoiced</div>\n    </div>\n\n    <!-- Data not found line -->\n    <div class="row widget-line" ng-hide="isDataFound">\n      <div class="col-xs-11">No {{orderBy}}invoice found for your {{entityType}}</div>\n    </div>\n\n    <!-- Content lines -->\n    <!-- when large widget -->\n    <div ng-if="widget.width > 3" class="row widget-line" ng-show="isDataFound" ng-repeat="entity in widget.content.entities" tooltip-trigger="mouseenter" tooltip-placement="top" tooltip-html-unsafe="{{getInvoices(entity)}}" tooltip-animation="false" tooltip-append-to-body="true" tooltip-class="impac-widgets-tooltip">\n      <div class="col-sm-4">{{entity.name}}</div>\n      <div class="col-sm-7">\n        <div class="col-xs-4"><i>{{entity.total_paid | mnoCurrency : entity.currency}}</i></div>\n        <div class="col-xs-4"><i>{{entity.total_due | mnoCurrency : entity.currency}}</i></div>\n        <div class="col-xs-4"><i>{{entity.total_invoiced | mnoCurrency : entity.currency}}</i></div>\n      </div>\n      <div class="col-sm-1"><i class="fa fa-info-circle" /></div>\n    </div>\n\n    <!-- when small widget -->\n    <div ng-if="widget.width <= 3" class="row widget-line" ng-show="isDataFound" ng-repeat="entity in widget.content.entities" tooltip-trigger="mouseenter" tooltip-placement="top" tooltip-html-unsafe="{{getInvoices(entity)}}" tooltip-animation="false" tooltip-append-to-body="true" tooltip-class="impac-widgets-tooltip">\n      <div class="col-xs-7">{{entity.name}}</div>\n      <div class="col-xs-4" ng-show="orderBy == \'paid \'"><i>{{entity.total_paid | mnoCurrency : entity.currency}}</i></div>\n      <div class="col-xs-4" ng-show="orderBy == \'due \'"><i>{{entity.total_due | mnoCurrency : entity.currency}}</i></div>\n      <div class="col-xs-4" ng-hide="orderBy == \'paid \' || orderBy == \'due \'"><i>{{entity.total_invoiced | mnoCurrency : entity.currency}}</i></div>\n      <div><i class="fa fa-info-circle" /></div>\n    </div>\n\n  </div>\n\n</div>\n'),t.put("widgets/invoices-summary.tmpl.html",'<div widget-invoices-summary>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-chart-filters parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div align="center" ng-hide="widget.isEditMode">\n    <div class="chart-container" ng-if="isDataFound">\n      <div dhb-chart data="widget.chart"></div>\n      <div class="legend">\n        <span>{{widget.content.legend}}</span>\n      </div>\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-aged.tmpl.html",'<div widget-sales-aged>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound" class="center">\n\n      <div setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter" no-reload truncate-no="60" style="text-align: center;"/>\n\n      <div class="chart-container">\n        <div dhb-chart data="widget.chart"></div>\n      </div>\n      <div class="legend">From {{widget.content.dates[0]}} to {{getLastDate()}}</div>\n\n      <div class="widget-lines-container">\n        <!-- <div class="row widget-line"> -->\n          <div class="col-sm-2 text-center" ng-repeat="date in formattedDates track by $index" style="padding: 5px 0px;">\n            <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;">{{date}}</div></div>\n            <div class="row widget-line">\n            <div ng-hide="filter.value == \'quantity_sold\'" class="col-sm-12" ng-class="getClassColor(getTotal($index - 1),getTotal($index))" style="padding: 0px;">\n              {{getTotal($index) | mnoCurrency : widget.content.currency : false}}\n              <br />\n              {{widget.content.currency}}\n            </div>\n            <div ng-show="filter.value == \'quantity_sold\'" class="col-sm-12" ng-class="getClassColor(getTotal($index - 1),getTotal($index))" style="padding: 0px;">\n              {{getTotal($index)}}\n            </div>\n          </div>\n        <!-- </div> -->\n      </div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-break-even.tmpl.html",'<div widget-sales-break-even>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound" class="align-center">\n\n      <div class="legend">From {{widget.content.period.from | date : \'d MMM yyyy\'}} to {{widget.content.period.to | date : \'d MMM yyyy\'}}</div>\n\n      <div class="block to-date">\n        <div class="title">Sales to Date</div>\n        <div class="price">{{widget.content.sales.to_date | mnoCurrency : widget.content.currency : false}}</div>\n        Target: <span class="edit-target" style="float: right;" editable-text="threshold" buttons="no" onaftersave="widget.updateSettings()">\n          {{threshold | mnoCurrency : widget.content.currency : false}}\n        </span>\n      </div>\n\n      <div ng-show="widget.content.break_even" class="block to-breakeven">\n        <div class="title">Projection to Break-Even</div>\n        <span ng-show="isTargetMet()">Your sales already exceed your target by:</span>\n        <div class="price">{{getVariance() | mnoCurrency : widget.content.currency : false}}</div>\n        <span ng-hide="isTargetMet()">\n          Projected date: <span style="float: right;">{{getProjectedDate() | date : \'d-MM-yy\'}}</span>\n          <br />\n          Opportunities to close: <span style="float: right;">{{getOpportunitiesToClose()}}</span>\n        </span>\n      </div>\n      <div ng-show="widget.content.break_even" class="legend">{{widget.content.break_even.eligible_opportunities}} eligible opportunities</div>\n\n      <div ng-hide="widget.content.break_even" class="block to-breakeven">\n        <span class="edit-target" editable-text="threshold" buttons="no" onaftersave="widget.updateSettings()">\n          <div class="define-text">Click to define your sales target</div>\n        </span>\n      </div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-comparison.tmpl.html",'<div widget-sales-comparison>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound" class="row" >\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" />\n\n        <div class="row legend center">\n          Compare by: <div setting-param-selector parent-widget="widget" style="display: inline;" param="criteria" options="criteriaOptions" selected="criteria" truncate-no="30" />\n           ---\n          See: <div setting-param-selector parent-widget="widget" style="display: inline;" param="filter" options="filterOptions" selected="filter" truncate-no="30" no-reload />\n        </div>\n\n        <div class="widget-lines-container" style="max-height: 530px;">\n          <div class="row widget-line header">\n            <div class="col-sm-12">Total sales from {{widget.content.dates[0]}} to {{getLastDate()}}</div>\n          </div>\n          <div class="row widget-line total" ng-repeat="statement in widget.content.sales_comparison" >\n            <div class="row widget-line" ng-class="isSelected(statement) ? \'selected\' : null" >\n              <div class="col-sm-1" ng-click="toogleCollapsed(statement)"><i ng-show="statement.sales" class="fa" ng-class="isCollapsed(statement) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" /></div>\n              <div class="col-sm-7" ng-click="toogleSelectedElement(statement)"><strong>{{statement.name | titleize}}</strong></div>\n              <div ng-show="filter.value == \'quantity_sold\'" class="col-sm-4 text-right" ng-click="toogleSelectedElement(statement)"><strong>{{getTotalForPeriod(statement)}}</strong></div>\n              <div ng-hide="filter.value == \'quantity_sold\'" class="col-sm-4 text-right" ng-click="toogleSelectedElement(statement)"><strong>{{getTotalForPeriod(statement) | mnoCurrency : statement.currency}}</strong></div>\n            </div>\n            <div collapse="isCollapsed(statement)">\n              <div class="row widget-line" ng-click="toogleSelectedElement(sale)" ng-repeat="sale in statement.sales" ng-class="isSelected(sale) ? \'selected\' : null" >\n                <div class="col-sm-1" />\n                <div class="col-sm-7">{{sale.name}}</div>\n                <div ng-show="filter.value == \'quantity_sold\'" class="col-sm-4 text-right">{{getTotalForPeriod(sale)}}</div>\n                <div ng-hide="filter.value == \'quantity_sold\'" class="col-sm-4 text-right">{{getTotalForPeriod(sale) | mnoCurrency : sale.currency}}</div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n        <div class="chart-container" ng-if="selectedElements.length > 0 && widget.isExpanded()">\n          <div dhb-chart data="widget.chart"></div>\n        </div>\n\n        <div class="widget-lines-container">\n          <div class="row widget-line header">\n            <div class="col-sm-12">Total sales from {{widget.content.dates[0]}} to {{getLastDate()}}</div>\n          </div>\n          <div class="widget-line" ng-repeat="element in selectedElements">\n            <i ng-show="filter.value == \'quantity_sold\'" style="float: right; margin-right: 10px;">{{getTotalForPeriod(element)}}</i>\n            <i ng-hide="filter.value == \'quantity_sold\'" style="float: right; margin-right: 10px;">{{getTotalForPeriod(element) | mnoCurrency : element.currency}}</i>\n            <i class="fa fa-circle" style="margin: 0px 8px; color: {{getElementChartColor($index)}}" />\n            {{element.name | titleize}}\n          </div>\n        </div>\n\n      </div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-customer-details.tmpl.html",'<div widget-sales-customer-details>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound" class="row" >\n\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="3" max="6" class="settings width" />\n        <div setting-param-selector parent-widget="widget" param="customer_uid" options="customersOptions" selected="selectedCustomer" class="row title" />\n\n        <div class="details-container">\n          <div class="row">\n            <div class="col-md-4"><label>Email</label></div>\n            <div class="col-md-8"><pre>{{getCustomer().email}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Phone</label></div>\n            <div class="col-md-8"><pre>{{getCustomer().phone}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Website</label></div>\n            <div class="col-md-8"><pre>{{getCustomer().website}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Contact</label></div>\n            <div class="col-md-8"><pre>{{getCustomer().contact}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>City</label></div>\n            <div class="col-md-8"><pre>{{getCustomer().city}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Country</label></div>\n            <div class="col-md-8"><pre>{{getCustomer().country}}</pre></div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel" ng-show="widget.isExpanded()">\n        <div class="details-container">\n          <div class="row" style="border-bottom: solid 1px #e6e6e6; margin-bottom: 10px; padding-bottom: 5px;">\n            <div class="col-md-3"><label>Address</label></div>\n            <div class="col-md-9"><pre>{{formatAddress(getCustomer().full_address)}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-12 center legend">From {{getFromDate() | date : \'d MMM yyyy\'}} to {{getToDate() | date : \'d MMM yyyy\'}}:</div>\n          </div>\n          <div class="row">\n            <div class="col-md-5"><label>Total invoiced</label></div>\n            <div class="col-md-7"><pre>{{getCustomer().total_invoiced | mnoCurrency : getCustomer().currency}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-5"><label>Total paid</label></div>\n            <div class="col-md-7"><pre>{{getCustomer().total_paid | mnoCurrency : getCustomer().currency}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-5"><label>Total due</label></div>\n            <div class="col-md-7"><pre>{{getCustomer().total_due | mnoCurrency : getCustomer().currency}}</pre></div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-cycle.tmpl.html",'<div widget-sales-cycle>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-params-picker options="statusOptions" param="status_selection" parent-widget="widget" class="part" />\n    <div setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div align="center" ng-hide="widget.isEditMode">\n    <div class="chart-container" ng-if="isDataFound">\n      <div dhb-chart data="widget.chart"></div>\n      <div class="legend">\n        <span>Your sales cycle represents how much time your leads stay set to each status</span>\n      </div>\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-forecast.tmpl.html",'<div widget-sales-forecast>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound" >\n\n      <div class="chart-container">\n        <div dhb-chart data="widget.chart"></div>\n      </div>\n\n      <div class="widget-lines-container" style="max-height: 340px;">\n        <div class="row widget-line header">\n          <div class="col-sm-12">Projection on the next 6 months</div>\n        </div>\n        <div class="row widget-line total" ng-repeat="date in widget.content.dates.slice(6) track by $index" ng-init="collapsed = true" >\n          <div class="row widget-line" >\n            <div class="col-sm-6" ng-click="collapsed = !collapsed">{{date | date : \'MMMM yyyy\'}}</div>\n            <div class="col-sm-6 text-right"><strong>{{widget.content.totals.slice(6)[$index] | mnoCurrency : widget.content.currency}}</strong></div>\n          </div>\n          <div collapse="collapsed">\n            <div class="row widget-line" ng-repeat="opp in widget.content.opportunities.slice(6)[$index]" >\n              <div class="col-sm-6">{{opp.name}}</div>\n              <div class="col-sm-6 text-right">{{getOpportunityAmount(opp) | mnoCurrency : getOpportunityCurrency(opp)}}</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-growth.tmpl.html",'<div widget-sales-growth>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound">\n\n      <div class="selector">\n        <div setting-param-selector parent-widget="widget" param="product" options="productOptions" selected="product"/>\n        <div ng-show="product.value != -1" setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter"/>\n      </div>\n\n      <div class="chart-container" ng-if="isDataFound && product.value != -1">\n        <div dhb-chart data="widget.chart"></div>\n      </div>\n\n      <div ng-show="product.value != -1" class="legend text-center">{{getSelectedProduct().name}}</div>\n      <div class="price text-center" ng-hide="isDataQuantity || product.value == -1" tooltip="total for last period">{{getCurrentValue() | mnoCurrency : getSelectedProduct().currency}}</div>\n      <div class="price text-center" ng-show="isDataQuantity && product.value != -1" tooltip="total for last period">{{getCurrentValue()}}</div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-leads-funnel.tmpl.html",'<div widget-sales-leads-funnel>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-params-picker options="statusOptions" param="status_selection" parent-widget="widget" class="part" />\n    <div setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound" class="row" >\n\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" />\n\n        <div class="legend">Your leads sales funnel from {{widget.content.from | date : \'d MMM yyyy\'}} to {{widget.content.to | date : \'d MMM yyyy\'}}</div>\n\n        <div class="funnel-container">\n          <div class="tile" ng-repeat="elem in funnel" ng-click="toogleSelectStatus(elem.status)">\n            <div class="colored-area" ng-style="elem.coloredWidth" ng-class="isSelected(elem.status) ? \'selected\' : \'\'">{{elem.number}}</div>\n            <div class="main-text" ng-style="elem.statusWidth">{{elem.status | titleize}}</div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n\n        <div ng-hide="selectedStatus" class="currency">\n          Select a status to display a list of the corresponding leads\n        </div>\n\n        <div ng-show="selectedStatus" class="widget-lines-container">\n          <div class="row widget-line total" ng-repeat="lead in getSelectedLeads()" tooltip-trigger="mouseenter" tooltip-placement="top" tooltip-html-unsafe="{{getLeadDescription(lead)}}" tooltip-animation="false"  tooltip-append-to-body="true" tooltip-class="impac-widgets-tooltip">\n            <div class="row widget-line" >\n              <div class="col-sm-7">\n                {{lead.first_name | titleize}} {{lead.last_name | titleize}}\n                <span ng-show="lead.organization">({{lead.organization}})</span>\n              </div>\n              <div class="col-sm-5 text-right"><strong>{{lead.lead_status | titleize}}</strong></div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-leads-list.tmpl.html",'<div widget-sales-leads-list>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound">\n\n      <div class="widget-lines-container">\n        <div class="row widget-line total" ng-repeat="lead in widget.content.leads" tooltip-trigger="mouseenter" tooltip-placement="top" tooltip-html-unsafe="{{getLeadDescription(lead)}}" tooltip-animation="false" tooltip-append-to-body="true" tooltip-class="impac-widgets-tooltip">\n          <div class="row widget-line" >\n            <div class="col-sm-7">\n              {{lead.first_name | titleize}} {{lead.last_name | titleize}}\n              <span ng-show="lead.organization">({{lead.organization}})</span>\n            </div>\n            <div class="col-sm-5 text-right"><strong>{{lead.lead_status | titleize}}</strong></div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-list.tmpl.html",'<div widget-sales-list>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound">\n\n      <div class="selector">\n        See: <span setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter"/> for this <span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period"/>\n        ({{widget.content.hist_parameters.from | date : "d MMM"}} to {{widget.content.hist_parameters.to | date : "d MMM"}})\n      </div>\n\n      <div class="widget-lines-container">\n        <div class="row widget-line total" ng-repeat="company in widget.content.summary" >\n          <div class="row widget-line" >\n            <div class="col-sm-1" ng-click="toogleCollapsed(company.name)" style="cursor: pointer;"><i class="fa" ng-class="isCollapsed(company.name) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" /></div>\n            <div class="col-sm-7"><strong>{{company.name | titleize}}</strong></div>\n            <div class="col-sm-4 text-right" ng-show="{{filter.value.match(\'quantity\')}}"><strong>{{company.total}}</strong></div>\n            <div class="col-sm-4 text-right" ng-hide="{{filter.value.match(\'quantity\')}}"><strong>{{company.total | mnoCurrency : company.currency}}</strong></div>\n          </div>\n          <div collapse="isCollapsed(company.name)">\n            <div class="row widget-line" ng-repeat="product in company.products" >\n              <div class="col-sm-1" />\n              <div class="col-sm-7">{{product.name | titleize}}</div>\n              <div class="col-sm-4 text-right" ng-show="{{filter.value.match(\'quantity\')}}"><strong>{{product.total}}</strong></div>\n              <div class="col-sm-4 text-right" ng-hide="{{filter.value.match(\'quantity\')}}"><strong>{{product.total | mnoCurrency : product.currency}}</strong></div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-margin.tmpl.html",'<div widget-sales-margin>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div ng-show="isDataFound">\n      <div setting-hist-mode parent-widget= "widget" />\n\n      <div ng-hide="widget.isHistoryMode" class="current">\n        <div class="price">\n           {{ getTotalMargin() | mnoCurrency : getCurrency()}}\n        </div>\n        <div class="legend">\n          Total sold - Total purchased\n          </br>\n          {{getTimeSpan()}}\n          </br>\n          <div setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter" no-reload />\n        </div>\n      </div>\n\n      <!-- the display condition must be an "if" and its value must change for the chart to be drawn again -->\n      <div ng-if="widget.isHistoryMode" class="history chart-container">\n        <div dhb-chart data="widget.chart"></div>\n        <div class="legend">Total sold - Total purchased</div>\n      </div>\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>\n'),t.put("widgets/sales-number-of-leads.tmpl.html",'<div widget-sales-number-of-leads>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound" class="align-center">\n      <div class="selector">\n        Leads for this <span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period"/>\n      </div>\n\n      <div class="stats">\n        <div class="stat row align-left" ng-repeat="carac in [\'new\', \'converted\', \'lost\']">\n          <div class="col-md-6 title" style="padding: 0px;">{{carac | titleize}}</div>\n          <div class="col-md-6" style="padding: 0px;">\n            <span class="variation" ng-class="formatNumberOfLeads(carac).color">{{formatNumberOfLeads(carac).variation}}</span>\n            <span class="nominal">{{formatNumberOfLeads(carac).nominal}}</span>\n          </div>\n        </div>\n      </div>\n\n      <div class="legend">\n      {{widget.content.number_of_leads.total[1]}} leads in total\n      </div>\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-performance.tmpl.html",'<div widget-sales-performance>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound">\n\n      <div class="widget-lines-container" style="max-height: 235px;">\n        <div class="row widget-line header">\n          <div class="col-sm-4">Users/Teams</div>\n          <div class="col-sm-4 text-right">Win ratio</div>\n          <div class="col-sm-4 text-right">Total won</div>\n        </div>\n        <div class="row widget-line total" ng-repeat="assignee in widget.content.assignees" ng-init="collapsed=true">\n          <div class="row widget-line" style="cursor: pointer;" ng-click="collapsed=!collapsed">\n            <div class="col-sm-4"><strong>{{assignee.name | titleize}}</strong></div>\n            <div class="col-sm-4 text-right"><strong>{{assignee.win_ratio}} %</strong></div>\n            <div class="col-sm-4 text-right"><strong>{{assignee.total_won | mnoCurrency : \'AUD\'}}</strong></div>\n          </div>\n          <div collapse="collapsed">\n            <div class="row widget-line" ng-repeat="opp in assignee.opportunities">\n              <div class="col-sm-4">{{opp.name}}</div>\n              <div class="col-sm-4 text-right">{{opp.sales_stage}}</div>\n              <div class="col-sm-4 text-right">{{getOpportunityAmount(opp)}}</div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-opportunities-funnel.tmpl.html",'<div widget-sales-opportunities-funnel>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-params-picker options="statusOptions" param="sales_stage_selection" parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound" class="row" >\n\n      <div ng-class="widget.isExpanded() ? \'col-md-6\': \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" />\n\n        <div class="legend">Your opportunities, sorted by sales stage</div>\n\n        <div class="funnel-container">\n          <div class="tile" ng-repeat="elem in funnel" ng-click="toogleSelectStatus(elem.status)">\n            <div class="colored-area" ng-style="elem.coloredWidth" ng-class="isSelected(elem.status) ? \'selected\' : \'\'">{{elem.number}}</div>\n            <div class="main-text" ng-style="elem.statusWidth">{{elem.status | titleize}}</div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n\n        <div ng-hide="selectedStatus" class="currency">\n          Select a sales stage to display a list of the corresponding opportunities\n        </div>\n\n        <div ng-show="selectedStatus" class="widget-lines-container">\n          <div class="row widget-line total" ng-repeat="opp in getSelectedOpportunities()">\n            <div class="row widget-line" >\n              <div class="col-sm-6">\n                {{opp.name | titleize}}\n              </div>\n              <div class="col-sm-6 text-right"><strong>{{getOppDetails(opp)}}</strong></div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-segmented-turnover.tmpl.html",'<div widget-sales-segmented-turnover>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-time-range parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div align="center" ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound" class="row">\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="3" max="6" class="settings width"></div>\n\n        <div class="selector">Filter: <span setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter"/></div>\n        <div class="chart-container" ng-if="isDataFound">\n          <div dhb-chart data="widget.chart"></div>\n        </div>\n        <div class="widget-lines-container">\n          <div class="widget-line">\n            Average price range\n          </div>\n          <div class="widget-line" ng-repeat="range in widget.content.ranges">\n            <i style="float: right; margin-right: 10px;">{{range.percentage}}%</i>\n            <i class="fa fa-circle" style="margin: 0px 8px; color: {{getColorByIndex($index)}}" />\n            {{getRangeLabel(range.label)}}\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel" ng-show="widget.isExpanded()">\n        <i class="fa fa-info-circle" style="float: left;" tooltip="This widget segments your revenue by products average price range and propose an analysis of its composition" />\n        <h3 style="margin: 25px 10px; text-align: center;">{{getMaxRange().percentage.toFixed()}}% of your revenue comes from products sold at an average price between {{getMaxRange().label.split(\'-\')[0] | mnoCurrency : widget.content.currency}} and {{getMaxRange().label.split(\'-\')[1] | mnoCurrency : widget.content.currency}}.</h3>\n        <div class=\'analysis hidden-md\' >{{getAnalysis()}}</div>\n      </div>\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-summary.tmpl.html",'<div widget-sales-summary>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n    <div setting-chart-filters parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div align="center" ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound" class="selector">\n      See: <span setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter"/>\n      for this <span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period"/>\n      ({{widget.content.hist_parameters.from | date : \'d MMM\'}} to {{widget.content.hist_parameters.to | date : \'d MMM\'}})\n    </div>\n\n    <div class="chart-container" ng-if="isDataFound && !incorrectPeriod">\n      <div dhb-chart data="widget.chart"></div>\n    </div>\n\n    <div class="data-not-found" ng-if="incorrectPeriod">\n      <div class="message">No data found for this period<br/> Please select another one</div>\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets-common/data-not-found.tmpl.html",'<div class="data-not-found">\n	<img ng-src="{{bgImage}}" />\n	<div class="message">\n	  {{content.mainMessage}}\n    <!-- TODO: provider for html hyperlinks? -->\n		<a ng-href="{{content.linkUrl}}" target="_blank">\n			{{content.linkMessage}}\n		</a>\n	</div>\n</div>\n'),t.put("widgets/sales-top-opportunities.tmpl.html",'<div widget-sales-top-opportunities>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n\n    <div align="right">\n      <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="isDataFound">\n\n      <div class="legend">\n        Total potential: <b>{{widget.content.total_potential | mnoCurrency : widget.content.currency || "AUD"}}</b> - <b>{{widget.content.eligible_opportunities}}</b> eligible opportunities\n      </div>\n\n      <div class="opps-container">\n        <div class="tile" ng-repeat="opp in widget.content.opportunities track by $index" ng-class="getOppClass($index)">\n          <div class="colored-area">{{$index +1 }}</div>\n          <div class="main-text">\n            {{opp.name | titleize}}\n            <br />\n            <i style="font-size: 13px;">{{getOppDetails(opp)}}</i>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n  </div>\n    \n</div>'),t.put("widgets-common/editable-title.tmpl.html",'<div class="visible-lg title-wrapper" ng-if="parentWidget.width >= 3 && parentWidget.width < 6">\n  <div ng-show="parentWidget.hasEditAbility" class="title" editable-text="parentWidget.name" buttons="no" onaftersave="updateName()">\n  	{{parentWidget.name | truncate:25:"."}}\n  </div>\n\n  <div ng-hide="parentWidget.hasEditAbility" class="title">\n  	{{parentWidget.name | truncate:25:"."}}\n  </div>\n</div>\n\n<div class="visible-lg title-wrapper" ng-if="parentWidget.width >= 6">\n  <div ng-show="parentWidget.hasEditAbility" class="title" editable-text="parentWidget.name" buttons="no" onaftersave="updateName()">\n  	{{parentWidget.name | truncate:60:"."}}\n  </div>\n\n  <div ng-hide="parentWidget.hasEditAbility" class="title">\n  	{{parentWidget.name | truncate:60:"."}}\n  </div>\n</div>\n\n<div class="visible-md visible-sm title-wrapper" ng-if="parentWidget.width == 3 && parentWidget.width < 6">\n  <div ng-show="parentWidget.hasEditAbility" class="title" editable-text="parentWidget.name" buttons="no" onaftersave="updateName()">\n  	{{parentWidget.name | truncate:18:"."}}\n  </div>\n\n  <div ng-hide="parentWidget.hasEditAbility" class="title">\n  	{{parentWidget.name | truncate:18:"."}}\n  </div>\n</div>\n\n<div class="visible-md visible-sm title-wrapper" ng-if="parentWidget.width >= 6">\n  <div ng-show="parentWidget.hasEditAbility" class="title" editable-text="parentWidget.name" buttons="no" onaftersave="updateName()">\n  	{{parentWidget.name | truncate:45:"."}}\n  </div>\n\n  <div ng-hide="parentWidget.hasEditAbility" class="title">\n  	{{parentWidget.name | truncate:45:"."}}\n  </div>\n</div>\n\n<div class="visible-xs title-wrapper">\n  <div ng-show="parentWidget.hasEditAbility" class="title" editable-text="parentWidget.name" buttons="no" onaftersave="updateName()">\n  	{{parentWidget.name | truncate:30:"."}}\n  </div>\n\n  <div ng-hide="parentWidget.hasEditAbility" class="title">\n  	{{parentWidget.name | truncate:30:"."}}\n  </div>\n</div>'),t.put("widgets-common/top-buttons.tmpl.html",'<div id="module__top-buttons">\n  <div ng-mouseenter="showCloseActive=true" ng-mouseleave="showCloseActive=false" class="delete-widget" ng-show="parentWidget.hasDeleteAbility">\n    <button class="btn btn-close top-button" ng-click="showConfirmDelete = !showConfirmDelete">\n      <i class="fa fa-times-circle-o fa-lg"></i>\n    </button>\n  </div>\n\n  <div ng-mouseenter="showEditActive=true" ng-mouseleave="showEditActive=false" class="edit-widget" ng-show="parentWidget.hasEditAbility">\n    <button class="btn top-button btn-edit" ng-click="toogleEditMode()">\n      <i class="fa fa-cog fa-lg"></i>\n    </button>\n  </div>\n\n  <div class="refresh-widget">\n    <button class="btn top-button btn-refresh" ng-click="parentWidget.loadContent(true)">\n      <i class="fa fa-refresh"></i>\n    </button>\n  </div>\n\n  <div class="confirm-delete-popover" ng-show="showConfirmDelete">\n  	<h4>Are you sure you want to delete this widget ?</h4>\n  	<p>(it will not erase your data)</p>\n  	<button ng-click="showConfirmDelete = false" class="btn btn-sm btn-default">Cancel</button>\n  	<button ng-click="deleteWidget()" class="btn btn-sm btn-danger" style="margin-left: 10px;">Delete</button>\n  </div>\n</div>\n'),t.put("widgets-settings/account.tmpl.html",'<h5>{{label}}</h5>\n<div class="input-group settings select-account">\n	<select ng-model="parentWidget.selectedAccount" ng-options="account.name + \' (\' + formatAmount(account) + \')\' for account in parentWidget.content.account_list track by account.uid" class="form-control" />\n</div>'),t.put("widgets-settings/chart-filters.tmpl.html",'<div class="settings chart-filters">\n  <h5>Chart filters</h5>\n  <div class="row">\n    <div class="col-md-6">\n      <input type="radio" ng-model="filterCriteria" value="number">\n      <label for="number" ng-click="filterCriteria = \'number\'">Top {{filterValueNumber}} {{entityType}}</label>\n    </div>\n    <div class="col-md-6">\n      <input type="range" ng-model="filterValueNumber" ng-change="filterCriteria = \'number\'" min="3" max="{{maxEntities}}" step="1">\n    </div>\n  </div>\n  <div class="row">\n    <div class="col-md-6">\n      <input type="radio" ng-model="filterCriteria" value="percentage">\n      <label for="percentage" ng-click="filterCriteria = \'percentage\'">Top {{filterValuePercentage}}% {{filterLabel}}</label>\n    </div>\n    <div class="col-md-6">\n      <input type="range" ng-model="filterValuePercentage" ng-change="filterCriteria = \'percentage\'" min="20" max="100" step="5">\n    </div>\n  </div>\n</div>\n'),t.put("widgets-settings/hist-mode.tmpl.html",'<div class="settings hist-mode-choser">\n  <div align="center" class="options">\n    <a ng-click="toogleHistMode(\'current\')" ng-class="!parentWidget.isHistoryMode ? \'active\' : \'inactive\'">current</a> |\n    <a ng-click="toogleHistMode(\'history\')" ng-class="parentWidget.isHistoryMode ? \'active\' : \'inactive\'">history</a>\n  </div>\n  <div class="{{parentWidget.isHistoryMode ? \'arrow-container right\' : \'arrow-container left\'}}">\n    <div class="arrow" />\n    <div class="arrow-border" />\n  </div>\n</div>'),t.put("widgets-settings/organizations.tmpl.html",'<div class="settings organizations">\n  <h5>Select Companies</h5>\n\n  <div class="widget-lines-container">\n    <div class="widget-line" ng-repeat="org in dashboardOrganizations">\n      {{org.label}}\n      <i ng-class="isOrganizationSelected(org.uid) ? \'fa fa-toggle-on\' : \'fa fa-toggle-off\'" ng-click="toogleSelectOrganization(org.uid)" tooltip="{{isOrganizationSelected(org.uid) ? \'disable\' : \'enable\'}}" tooltip-append-to-body="true" />\n    </div>\n  </div>\n</div>'),t.put("widgets-settings/param-selector.tmpl.html",'<span class="settings param-selector">\n	<a ng-click="toogleShowOptions()">{{selected.label | titleize | truncate : getTruncateValue() : "..." : false}} <i class="fa fa-chevron-down" /></a>\n	<div class="options-container" collapse="!showOptions">\n		<div ng-repeat="option in options" ng-click="selectOption(option)">\n			{{option.label | titleize}}\n		</div>\n	</div>\n</span>'),t.put("widgets-settings/params-picker.tmpl.html",'<h5>{{formattedParam | titleize}}</h5>\n<div class="settings params-picker">\n  <div style="margin-bottom: 8px;">\n    The selected criteria will be displayed in this order (drag/drop to modify):\n  </div>\n  <div ui:sortable="sortableOptions" ng-model="options" class="input-group">\n    <span ng-repeat="parameter in options track by $index" class="parameter" ng-class="!parameter.selected ? \'unchecked\' : \'\'">\n      <span class="badge">{{$index + 1}}</span>\n      {{parameter.label | titleize}}\n      <input type="checkbox" ng-model="parameter.selected" />\n    </span>\n  </div>\n</div>'),t.put("widgets-settings/time-range.tmpl.html",'<h5>Time range</h5>\n<div class="settings time-range">\n	<div class="row">\n	  <div class="col-md-12">\n	    Show last {{numberOfPeriods}} {{periodToUnit()}}\n	  </div>\n	</div>\n	<div class="row input-group" align="center" style="margin: 0; margin-top: 3px;">\n	  <div class="col-xs-6" style="padding: 0; padding-right: 5px;">\n	    <select ng-model="selectedPeriod" ng-options="period.toLowerCase() for period in PERIODS track by period" class="form-control" style="height: 22px; margin-top: 0; padding: 0; padding-left: 1px; padding-bottom: 1px;"></select>\n	  </div>\n	  <div class="col-xs-6" style="padding: 0;">\n	    <input type="range" ng-model="numberOfPeriods" min="1" max="12" step="1">\n	  </div>\n	</div>\n</div>'),t.put("widgets-settings/width.tmpl.html",'<i class="fa fa-angle-double-left reduce" ng-show="expanded" ng-click="parentWidget.toogleExpanded()" tooltip="reduce"/>\n<i class="fa fa-angle-double-right expand" ng-hide="expanded" ng-click="parentWidget.toogleExpanded()" tooltip="expand"/>')
}])}(),function(){"use strict";angular.module("impac.services.analytics",[]).factory("DhbAnalyticsSvc",["$http","$q","$window","$timeout","$log","ImpacLinking","ImpacRoutes",function(t,e,n,i,a,s,o){var l,r;return l=r={},r.defaultConfig={delay:6e5},r.config={id:null,organizationId:null,timerId:null,$q:null},r.data=[],r.organizations=[],r.isLocked=!1,s.getOrganizations().then(function(t){return r.organizations=t,r.organizations.length>0?r.config.organizationId=r.organizations[0].id:void 0}),r.getId=function(){return!r.config.id&&r.data.length>0?r.config.id=r.data[0].id:r.config.id},r.getDashboards=function(){return r.data},r.getOrganizationId=function(){return r.config.organizationId},r.configure=function(t){return angular.copy(t,r.config),angular.extend(r.config,r.defaultConfig)},r.load=function(e){return null==e&&(e=!1),(null==l.config.$q||e)&&(l.config.$q=t.get(o.baseDhbPath()).then(function(t){return angular.copy(t.data,l.data)})),l.config.$q},r.dashboards={},r.dashboards.create=function(e){var n,i;return i={dashboard:e},(n=i.dashboard).organization_id||(n.organization_id=l.config.organizationId),t.post(o.createDhbPath(),i).then(function(t){var e;return e=t.data,l.data.push(e),l.config.id=e.id,e})},r.dashboards["delete"]=function(e){return t["delete"](o.deleteDhbPath(e)).then(function(){var t;return l.config.id=null,t=l.data,l.data=_.reject(l.data,function(t){return t.id===e})})},r.dashboards.update=function(e,n,i){var s;return null==i&&(i=!0),s={dashboard:n},t.put(o.updateDhbPath(e),s).then(function(t){var n;return n=_.findWhere(l.data,{id:e}),i?angular.extend(n,t.data):void 0},function(t){return a.error(t)})},r.widgets={},r.widgets.create=function(e,n){var i;return i={widget:n},t.post(o.createWidgetPath(e),i).then(function(t){var n,i;return i=t.data,n=_.findWhere(l.data,{id:e}),n.widgets.push(i),i})},r.widgets.show=function(e,n){return null==n&&(n=!1),s.getSsoSession().then(function(i){var a;return a={owner:e.owner,sso_session:i,metadata:e.metadata,engine:e.category},n&&angular.extend(a,{refresh_cache:!0}),a.metadata.organization_ids=a.metadata.organization_ids,t.post(o.showWidgetPath(),a)},function(t){return a.error("Unable to retrieve widget data due to session auth fail.",t)})},r.widgets["delete"]=function(e,n){return t["delete"](o.deleteWidgetPath(e)).then(function(){return n.widgets=_.reject(n.widgets,function(t){return t.id===e})})},r.widgets.update=function(e,n){var i;return i={widget:n},t.put(o.updateWidgetPath(e.id),i)},r}])}.call(this),function(){"use strict";angular.module("impac.services.assets",[]).provider("ImpacAssets",function(){var t,e,n;return n=this,e={dataNotFound:null,impacTitleLogo:null,impacDashboardBackground:null,noWarning:!1},n.configure=function(t){return angular.extend(e,t)},t=function(t){var n;return n=this,n.get=function(n){var i,a;return a="",i="impac-angular warning: There are missing assets ("+n+"), please refer to the including assets section in the docs.",null!=e[n]?a=e[n]:e.noWarning||t.warn(i),a},n},t.$inject=["$log"],n.$get=t,n})}.call(this),function(){"use strict";angular.module("impac.components.chart",[]).directive("dhbChart",["$templateCache","$compile","$timeout",function(t,e,n){return{restrict:"A",scope:{data:"="},template:t.get("chart/chart.tmpl.html"),link:function(t,e){var i,a;return a={bezierCurve:!0,pointDotRadius:3,responsive:!0,scaleShowLabels:!0,scaleShowLabelBackdrop:!0,scaleBeginAtZero:!0,scaleShowGridLines:!0},i=null,t.draw=function(){var n,s,o;switch(_.isEmpty(t.data.options)||angular.extend(a,t.data.options),null!==i&&i.destroy(),n=e.children().get(0),s=n.getContext("2d"),t.data.chartType){case"Bar":i=new Chart(s).Bar(t.data.data,a);break;case"Line":i=new Chart(s).Line(t.data.data,a);break;case"Pie":angular.extend(a,{tooltipFixed:!0}),i=new Chart(s).Pie(t.data.data,a)}return o=angular.element(n).parent().width()},t.$watch(function(){return t.data},function(e){return null!=e?n(function(){return t.draw()},100):void 0},!0)}}}])}.call(this),function(){"use strict";angular.module("impac.services.chart-formatter",[]).service("ChartFormatterSvc",["ImpacTheming",function(t){var e,n,i,a,s,o,l,r;n=this,e=t.get().chartColors,this.getPositiveColor=function(){return e.positive},this.getNegativeColor=function(){return e.negative},this.getOthersColor=function(){return e.others},this.getColor=function(t){return e.array[t%e.array.length]},i=function(t){return t.replace(/#/,"")},o=function(t){return parseInt(i(t).substring(0,2),16)},s=function(t){return parseInt(i(t).substring(2,4),16)},a=function(t){return parseInt(i(t).substring(4,6),16)},l=function(t){return[o(t),s(t),a(t)].join(",")},r=function(t,e){return"rgba("+l(t)+","+e+")"},this.lineChart=function(t,e,i){var a;return null==e&&(e={}),null==i&&(i=!1),a=0,{chartType:"Line",options:e,data:{labels:t[0].labels,datasets:_.map(t,function(t){var e;return e=i?0===a?n.getNegativeColor():n.getPositiveColor():n.getColor(a),a++,{label:t.title,data:t.values,fillColor:r(e,.3),strokeColor:e,pointColor:e,pointStrokeColor:e,pointHighlightFill:e,pointHighlightStroke:r(e,.3)}})}}},this.barChart=function(t,e,i){var a;return null==e&&(e={}),null==i&&(i=!0),a=0,{chartType:"Bar",options:e,data:{labels:[""],datasets:_.map(t.values,function(e){var s;return s=n.getColor(a),a++,null==e&&(e=0,s="rgba(0,0,0,0)"),i&&0>e&&(e=-e),{label:t.labels[a]||"",data:[e],fillColor:s,strokeColor:s,highlightFill:s,highlightStroke:s}})}}},this.pieChart=function(t,e,i){var a;return null==e&&(e={}),null==i&&(i=!1),a=0,{chartType:"Pie",options:e,data:_.map(t,function(t){var e;return e=i?0===a?n.getNegativeColor():n.getPositiveColor():n.getColor(a),a++,{value:t.value,label:t.label,color:e,highlight:r(e,.7)}})}}}])}.call(this),function(){"use strict";angular.module("impac.components.dashboard-selector",[]).directive("dashboardSelector",["$log","$compile","$templateCache","$http","ImpacTheming",function(t,e,n,i,a){return{restrict:"E",scope:{},controller:["$scope",function(t){return t.dhbCtrl=t.$parent,t.$watch("dhbCtrl.dashboardsList",function(t){return t&&t.length?_.forEach(t,function(t){return t.active=!1}):void 0}),t.$watch("dhbCtrl.currentDhbId",function(e){return e?_.forEach(t.dhbCtrl.dashboardsList,function(t){return t.id===e?t.active=!0:void 0}):void 0},!0),t.toogleAccessibilityMode=function(){return t.dhbCtrl.accessibility=!t.dhbCtrl.accessibility,angular.forEach(t.dhbCtrl.currentDhb.widgets,function(t){return t.loadContent()})},t}],link:function(s,o){var l,r,d,c,u,g,h;switch(u=a.get().dhbSelectorConfig,s.isAccessibilityEnabled=u.accessibilityEnabled,u.customTmplPath?r=u.customTmplPath:s.selectorType=u.selectorType,g=null,h=function(t){return g=t},s.selectorType){case"dropdown":h("dashboard-selector/dropdown.tmpl.html");break;case"tabs":h("dashboard-selector/bootstrap-tabs.tmpl.html");break;case"pills":h("dashboard-selector/bootstrap-tabs.tmpl.html");break;default:h(r)}return d=function(){return i.get(g,{cache:n}).then(function(e){return e&&e.data&&e.data.length||t.warn("dashboardSelector custom template: no content found"),l(e.data)},function(e){return t.error("Error retrieving custom template: ",e)})},c=function(){return l(n.get(g))},l=function(t){return o.html(t).show(),e(o.contents())(s)},r?d():c()}}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.dashboard",[]),t.controller("ImpacDashboardCtrl",["$scope","$http","$q","$filter","$modal","$log","$timeout","$templateCache","DhbAnalyticsSvc","MsgBus","Utilities","ImpacAssets","ImpacTheming",function(t,e,n,i,a,s,o,l,r,d,c,u,g){var h,p,m,v,f;return t.impacTitleLogo=u.get("impacTitleLogo"),t.impacDashboardBackground=u.get("impacDashboardBackground"),t.accessibility=!1,t.widgetsList=[],t.isLoading=!0,t.starWizardModal={value:!1},d.publish("starWizardModal",t.starWizardModal),t.openStarWizard=function(){return t.starWizardModal.value=!0},r.load().then(function(){return t.currentDhbId=r.getId(),t.refreshDashboards(),t.isLoading=!1}),t.refreshDashboards=function(){return t.dashboardsList=r.getDashboards(),t.dashboardsList.length&&null!=t.dashboardsList[0].widgets_templates&&(t.widgetsList=t.dashboardsList[0].widgets_templates),t.currentDhb=_.where(t.dashboardsList,{id:t.currentDhbId})[0],null===t.currentDhb&&(t.currentDhb=t.dashboardsList[0],t.currentDhbId=null!=t.currentDhb&&t.currentDhb.id||null),angular.isDefined(t.currentDhb)&&(t.currentDhb.organizationsNames=_.map(t.currentDhb.data_sources,function(t){return t.label}).join(", ")),t.setDisplay()},t.getCurrentDhbWidgetsNumber=function(){return t.currentDhb&&t.currentDhb.widgets?t.currentDhb.widgets.length:0},t.$watch(t.getCurrentDhbWidgetsNumber,function(){return t.setDisplay()}),t.showWidgetSelector=!1,t.customWidgetSelector=g.get().widgetSelectorConfig,t.isAddChartEnabled=g.get().addChartTile.show,t.addChartTileOnClick=function(){var e;return e=g.get().addChartTile.onClickOptions.triggers,_.forEach(e,function(e){switch(e.type){case"objectProperty":return t[e.target][e.property]=e.value}})},t.setDisplay=function(){var e,n,i;return e=null!=t.currentDhbId,i=e&&t.dashboardsList.length>1,n=e?t.currentDhb.widgets.length>0:!1,!e||n||t.customWidgetSelector.path||o(function(){return t.showWidgetSelector=!0},300),t.showDashboardsList=!1,t.showChangeDhbName=!1,t.showCreateDhb=!0,t.showDeleteDhb=e,t.showCreateWidget=e,t.showChooseDhbMsg=!e,t.showNoWidgetsMsg=e&&!n&&g.get().showNoWidgetMessages,t.canManageWidgets=!0},t.selectDashboard=function(e){return t.currentDhbId=e,t.refreshDashboards()},t.toogleShowDashboardsList=function(){return t.showChangeDhbName?void 0:t.showDashboardsList=t.dashboardsList.length>1||t.showCreateDhb?!t.showDashboardsList:!1},t.toogleShowChangeDhbName=function(e){var n;return n=angular.copy(e),t.dashboardToChange={},t.dashboardToChange.id=n.id,t.dashboardToChange.name=n.full_name,t.showChangeDhbName=!t.showChangeDhbName,o(function(){var t;return t=$("#changeDhbNameInput"),t.select(),t.focus()},100)},t.checkChangeDhbNameAndConfirm=function(e){return 13===e.keyCode&&t.updateDhbName(),27===e.keyCode?t.showChangeDhbName=!1:void 0},t.updateDhbName=function(){return null==t.dashboardToChange||_.isEmpty(t.dashboardToChange.name)?void 0:(r.dashboards.update(t.dashboardToChange.id,{name:t.dashboardToChange.name}),_.find(t.dashboardsList,function(e){return e.id===t.dashboardToChange.id}).full_name=t.dashboardToChange.name,t.showChangeDhbName=!1)},t.hideWidgetSelector=function(){return t.showWidgetSelector=!1},t.selectedCategory="accounts",t.isCategorySelected=function(e){return null!=t.selectedCategory&&null!=e?t.selectedCategory===e:!1},t.selectCategory=function(e){return t.selectedCategory=e},t.getSelectedCategoryName=function(){if(null==t.selectedCategory)return!1;switch(t.selectedCategory){case"accounts":return"Accounting";case"invoices":return"Invoicing";case"hr":return"HR / Payroll";case"sales":return"Sales";default:return!1}},t.getSelectedCategoryTop=function(){if(null==t.selectedCategory)return!1;switch(t.selectedCategory){case"accounts":return{top:"33px"};case"invoices":return{top:"64px"};case"hr":return{top:"95px"};case"sales":return{top:"126px"};default:return{top:"9999999px"}}},t.getWidgetsForSelectedCategory=function(){return null!=t.selectedCategory&&null!=t.widgetsList?_.select(t.widgetsList,function(e){return e.path.split("/")[0]===t.selectedCategory}):[]},t.addWidget=function(e,n){var i;return null==n&&(n=null),i={widget_category:e},null!=n&&angular.extend(i,{metadata:n}),angular.element("#widget-selector").css("cursor","progress"),angular.element("#widget-selector .top-container .row.lines p").css("cursor","progress"),r.widgets.create(t.currentDhbId,i).then(function(){return t.errors="",angular.element("#widget-selector").css("cursor","auto"),angular.element("#widget-selector .top-container .row.lines p").css("cursor","pointer"),angular.element("#widget-selector .badge.confirmation").fadeTo(250,1),o(function(){return angular.element("#widget-selector .badge.confirmation").fadeTo(700,0)},4e3)},function(e){return t.errors=c.processRailsError(e),angular.element("#widget-selector").css("cursor","auto"),angular.element("#widget-selector .top-container .row.lines p").css("cursor","pointer")})["finally"](function(){return t.setDisplay()})},t.modal={},t.modal.createDashboard=h=t.$new(!0),t.modal.deleteDashboard=p=t.$new(!0),t.modal.widgetSuggestion=m=t.$new(!0),h.config={action:"create",instance:{backdrop:"static",template:l.get("dashboard/create.modal.html"),size:"md",windowClass:"inverse connec-analytics-modal",scope:h}},h.open=function(){var t;return t=h,t.model={name:null},t.organizations=angular.copy(r.organizations),t.currentOrganization=_.findWhere(t.organizations,{id:r.getOrganizationId()}),t.selectMode("single"),t.loadingGif=u.get("loader-darkblue-bg.gif"),t.$instance=a.open(t.config.instance),t.isLoading=!1},h.close=function(){return h.$instance.close()},h.proceed=function(){var e,n,i;return i=h,i.isLoading=!0,e={name:i.model.name},n="multi"===i.mode?_.select(i.organizations,function(t){return t.$selected}):[{id:r.getOrganizationId()}],n.length>0&&(e.organization_ids=_.pluck(n,"id")),r.dashboards.create(e).then(function(e){return i.errors="",t.currentDhbId=e.id,i.close()},function(t){return i.errors=c.processRailsError(t)})["finally"](function(){return t.refreshDashboards()})},h.proceedDisabled=function(){var t,e,n;return n=h,e=_.select(n.organizations,function(t){return t.$selected}),t=!n.model.name||""===n.model.name,t||(t=0===e.length),t||(t=0===_.select(e,function(t){return n.canAccessAnalyticsData(t)}).length),n.isLoading||!1},h.btnBlassFor=function(t){var e;return e=h,t===e.mode?"btn btn-sm btn-warning active":"btn btn-sm btn-default"},h.selectMode=function(t){var e;return e=h,_.each(e.organizations,function(t){return t.$selected=!1}),e.currentOrganization.$selected="single"===t,e.mode=t},h.isSelectOrganizationShown=function(){return"multi"===h.mode},h.isCurrentOrganizationShown=function(){return"single"===h.mode},h.canAccessAnalyticsForCurrentOrganization=function(){var t;return t=h,t.canAccessAnalyticsData(t.currentOrganization)},h.isMultiCompanyAvailable=function(){return h.organizations.length>1&&h.multiOrganizationReporting},h.canAccessAnalyticsData=function(t){return t.current_user_role&&("Super Admin"===t.current_user_role||"Admin"===t.current_user_role)},p.config={action:"delete",instance:{backdrop:"static",template:l.get("dashboard/delete.modal.html"),size:"md",windowClass:"inverse",scope:p}},p.open=function(){var t;return t=p,t.loadingGif=u.get("loader-darkblue-bg.gif"),t.$instance=a.open(t.config.instance),t.isLoading=!1},p.close=function(){return p.$instance.close()},p.proceed=function(){var e;return e=p,e.isLoading=!0,r.dashboards["delete"](t.currentDhbId).then(function(){return e.errors="",t.currentDhbId=r.getId(),e.close()},function(t){return e.errors=c.processRailsError(t)})["finally"](function(){return t.refreshDashboards()})},m.widgetDetails={},m.config={instance:{backdrop:"static",template:l.get("dashboard/widget-suggestion.modal.html"),size:"md",windowClass:"inverse impac-widget-suggestion",scope:m}},m.open=function(){var t;return t=m,t.userName=UserSvc.document.user.name,t.loadingGif=u.get("loader-darkblue-bg.gif"),t.$instance=a.open(t.config.instance),t.isLoading=!1},m.close=function(){return m.$instance.close()},m.proceed=function(){var t,n;return n=m,n.isLoading=!0,t={widget_name:n.widgetDetails.name,widget_category:n.widgetDetails.category,widget_description:n.widgetDetails.description},e.post("/js_api/v1/mailers",{template:"widget_suggestion",opts:t}),o(function(){return n.close(),n.widgetDetails={},n.isLoading=!1},3e3)},t.sortableOptions={stop:v=function(){var e;return e={widgets_order:_.pluck(t.currentDhb.widgets,"id")},r.dashboards.update(t.currentDhbId,e,!1)},start:f=function(t,e){return e.placeholder.css("width",e.item.width()-1),e.placeholder.css("height",e.item.height())},opacity:.5,delay:150,tolerance:"pointer",placeholder:"placeHolderBox",cursor:"move",revert:250,cancel:".unsortable",handle:".top-line"}}]),t.directive("impacDashboard",["$templateCache",function(t){return{restrict:"EA",scope:{dashboards:"="},template:t.get("dashboard/dashboard.tmpl.html"),controller:"ImpacDashboardCtrl"}}])}.call(this),function(){"use strict";angular.module("impac.services.linking",[]).provider("ImpacLinking",function(){var t,e,n;return n=this,e={ssoSession:null,organizations:null},n.linkData=function(t){_.forIn(e,function(n,i){var a;if(a=t[i],null==a)throw"Missing core data ("+i+") to run impac-angular, please refer to impac.services.linking module or impac-angular README.md on required provider configurations.";return e[i]=a})},t=function(t){var n;return n=this,n.getSsoSession=function(){var n;return n=t.defer(),e.ssoSession().then(function(t){return n.resolve(t)},function(t){return n.reject(t)}),n.promise},n.getOrganizations=function(){var n;return n=t.defer(),e.organizations().then(function(t){return n.resolve(t)},function(t){return n.reject(t)}),n.promise},n},t.$inject=["$q"],n.$get=t,n})}.call(this),function(){"use strict";angular.module("impac.services.routes",[]).provider("ImpacRoutes",function(){var t,e,n;return n=this,e={dhbBasePath:"/mnoe/jpi/v1/impac/dashboards",widgetBasePath:"/mnoe/jpi/v1/impac/widgets",showWidgetPath:"http://localhost:4000/api/v1/get_widget"},n.configureRoutes=function(t){return angular.extend(e,t)},t=function(){var t;return t=this,t.baseDhbPath=function(){return e.dhbBasePath},t.showDhbPath=function(t){return e.dhbBasePath+"/"+t},t.createDhbPath=function(){return e.dhbBasePath},t.updateDhbPath=function(e){return t.showDhbPath(e)},t.deleteDhbPath=function(e){return t.showDhbPath(e)},t.showWidgetPath=function(){return e.showWidgetPath},t.widgetBasePath=function(t){return e.widgetBasePath+"/"+t},t.createWidgetPath=function(e){return t.showDhbPath(e)+"/widgets"},t.updateWidgetPath=function(e){return t.widgetBasePath(e)},t.deleteWidgetPath=function(e){return t.widgetBasePath(e)},t},t.$inject=[],n.$get=t,n})}.call(this),function(){"use strict";angular.module("impac.services.message-bus",[]).service("MsgBus",function(){var t;t={dashboardGrid:{},controlBarFilter:{},controlBarQuickFilter:{},orgaSharingModal:{},appConnectModal:{},page:{},pane:{},errors:[],autostopQueue:[],notificationQueue:[],params:{}},this.publish=function(e,n){return t[e]=n},this.subscribe=function(e){return function(){return t[e]}}})}.call(this),function(){"use strict";angular.module("impac.services.theming",[]).provider("ImpacTheming",function(){var t,e,n;return n=this,e={chartColors:{positive:"#3FC4FF",negative:"#1DE9B6",array:["#1de9b6","#7c4dff","#ffc928","#3fc4ff","#ff8e01","#c6ff00","#d500fa","#ff6e41","#ffeb3c","#ff1844"]},dhbSelectorConfig:{selectorType:"dropdown",customTmplPath:null,accessibilityEnabled:!1},dataNotFoundConfig:{mainMessage:"Data not found",linkMessage:"Are you missing an app?",linkUrl:""},widgetSelectorConfig:{path:null},addChartTile:{show:!1,onClickOptions:{triggers:[]}},noWidgetMsg:{show:!0}},n.configure=function(t){return angular.extend(e,t)},t=function(){var t;return t=this,t.get=function(){return e},t},t.$inject=[],n.$get=t,n})}.call(this),function(){"use strict";angular.module("impac.services.utilities",[]).service("Utilities",function(){this.processRailsError=function(t){var e;return e=[],t.status&&401===t.status?e.push("Sorry! You are not authorized to perform this action"):t.data&&" "!==t.data?angular.isArray(t.data)?_.each(t.data,function(t){var n;return n=t.charAt(0).toUpperCase()+t.slice(1),e.push(""+n)}):angular.isObject(t.data)?_.each(t.data,function(t,n){var i;return i=n.charAt(0).toUpperCase()+n.slice(1),angular.isArray(t)?_.each(t,function(t){return i.match(/base/i)?e.push(t):e.push(i+" "+t)}):i.match(/base/i)?e.push(t):e.push(i+" "+t)}):angular.isString(t.data)?e.push(t.data):e.push("Potentially a system or communication error. Please retry later."):e.push("Potentially a system or communication error. Please retry later."),e}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widget",[]),t.controller("ImpacWidgetCtrl",["$scope","$timeout","$log","DhbAnalyticsSvc","Utilities",function(t,e,n,i,a){var s,o,l;return t.loaderImage="",s=function(t,e){return angular.forEach(e,function(e,n){return t[n]&&t[n].constructor&&t[n].constructor===Object?s(t[n],e):t[n]=e})},l=t.widget||{},l.parentDashboard||(l.parentDashboard=t.parentDashboard),l.settings=[],l.isLoading=!0,l.hasEditAbility=!0,l.hasDeleteAbility=!0,l.loadContent=function(e){return null==e&&(e=!1),l.isLoading=!0,i.widgets.show(l,e).then(function(e){var i;return n.debug("widget loadContent SUCCESS: ",e),i=e.data,i.content||(i.content={}),i.originalName=i.name,angular.extend(l,i),t.isAccessibility?(l.initialWidth=l.width,l.width=12):l.initialWidth&&(l.width=l.initialWidth),l.initContext(),l.initSettings(),l.isLoading=!1,angular.isDefined(l.format)?l.format():void 0},function(t){return l.errors=a.processRailsError(t),l.isLoading=!1})},l.initSettings=function(){return angular.forEach(l.settings,function(t){return t.initialize()}),l.isEditMode=!1,!0},l.updateSettings=function(t){var e;return null==t&&(t=!0),e={},angular.forEach(l.settings,function(t){return s(e,t.toMetadata())}),_.isEmpty(e)||o(e,t),!0},o=function(t,e){var n;return null==e&&(e=!0),_.isEmpty(t)?void 0:(n={metadata:t},e&&(l.isLoading=!0),i.widgets.update(l,n).then(function(t){return angular.extend(l,t.data),e?l.loadContent():void 0},function(t){return l.errors=a.processRailsError(t),l.isLoading=!1}))},l.getColClass=function(){return"col-md-"+l.width}}]),t.directive("impacWidget",["$templateCache",function(t){return{restrict:"A",scope:{parentDashboard:"=",widget:"=",isAccessibility:"="},controller:"ImpacWidgetCtrl",link:function(e){return e.widgetContentTemplate=function(){var n,i;return n=angular.copy(e.widget.category).split("/"),n.splice(2),e.templateName=n.join("-").replace(/_/g,"-"),i="widgets/"+e.templateName+".tmpl.html",e.isAccessibility&&(t.get("widgets/"+e.templateName+".accessible.tmpl.html")&&(i="widgets/"+e.templateName+".accessible.tmpl.html"),e.templateName=e.templateName+" accessible"),i},e.isTemplateLoaded=function(){return!!t.get(e.widgetContentTemplate())}},templateUrl:"widget/widget.tmpl.html"}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-common.data-not-found",[]),t.directive("commonDataNotFound",["$templateCache","ImpacAssets","ImpacTheming",function(t,e,n){return{restrict:"A",scope:{widgetEngine:"="},controller:["$scope",function(t){var i,a;return t.bgImage="",t.content=n.get().dataNotFoundConfig,i=e.get("dataNotFound"),t.widgetEngine&&i.length>0?(a=i.split(""),a="/"!==a[a.length-1]?a.concat("/").join(""):a.join(""),t.bgImage=a+t.widgetEngine+".png"):void 0}],template:t.get("widgets-common/data-not-found.tmpl.html")}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-common.editable-title",[]),t.controller("CommonEditableTitleCtrl",["$scope","DhbAnalyticsSvc",function(t,e){var n;return n=t.parentWidget,t.updateName=function(){var t;return 0===n.name.length?(n.name=n.originalName,"Incorrect name"):(t={name:n.name},e.widgets.update(n,t).then(function(t){return n.originalName=n.name,angular.extend(n,t.data)},function(){return n.name=n.originalName}))}}]),t.directive("commonEditableTitle",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"="},template:t.get("widgets-common/editable-title.tmpl.html"),controller:"CommonEditableTitleCtrl"}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-common.top-buttons",[]),t.controller("CommonTopButtonsCtrl",["$scope","$rootScope","$log","DhbAnalyticsSvc","ImpacAssets",function(t,e,n,i){var a;return a=t.parentWidget,t.showCloseActive=!1,t.showEditActive=!1,t.showConfirmDelete=!1,a.isEditMode=!1,t.deleteWidget=function(){return i.widgets["delete"](a.id,a.parentDashboard).then(function(){return n.debug("Successfully removed widget!")},function(t){return a.errors=Utilities.processRailsError(t),n.error("Error deleting widget: ",t)})},t.toogleEditMode=function(){return a.isLoading?void 0:a.isEditMode?a.initSettings():a.isEditMode=!0}}]),t.directive("commonTopButtons",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"="},template:t.get("widgets-common/top-buttons.tmpl.html"),controller:"CommonTopButtonsCtrl"}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-accounting-values",[]),t.controller("WidgetAccountsAccountingValuesCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(t,e,n){var i,a;return a=t.widget,a.initContext=function(){return t.isDataFound=null!=a.content&&null!=a.content.accounting},a.format=function(){var e,i,s,o;return t.isDataFound?(i=angular.copy(a.content.accounting),s={title:i.type,labels:i.dates,values:i.values},e=!0,angular.forEach(i.values,function(t){return e&&(e=t>=0)}),o={scaleBeginAtZero:e,showXLabels:!1},a.chart=n.lineChart([s],o)):void 0},t.getCurrentPrice=function(){return t.isDataFound?_.last(a.content.accounting.values):void 0},t.getCurrency=function(){return t.isDataFound?a.content.accounting.currency:void 0},t.getLegend=function(){return t.isDataFound?a.content.accounting.legend:void 0},i=function(){return null!=a.settings?a.settings.length:0},t.$watch(i,function(t){return 3===t?a.loadContent():void 0}),a}]),t.directive("widgetAccountsAccountingValues",function(){return{restrict:"A",controller:"WidgetAccountsAccountingValuesCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-assets-summary",[]),t.controller("WidgetAccountsAssetsSummaryCtrl",["$scope","ChartFormatterSvc",function(t,e){var n,i;return i=t.widget,i.initContext=function(){return t.isDataFound=angular.isDefined(i.content)&&!_.isEmpty(i.content.summary)},i.format=function(){var n,a;return t.isDataFound?(n=_.map(i.content.summary,function(t){return{label:t.label,value:t.total}}),a={percentageInnerCutout:50,tooltipFontSize:12},i.chart=e.pieChart(n,a)):void 0},t.getCurrency=function(){return t.isDataFound?i.content.currency:void 0},t.getAccountColor=function(n){return t.isDataFound?e.getColor(_.indexOf(i.content.summary,n)):void 0},n=function(){return null!=i.settings?i.settings.length:0},t.$watch(n,function(t){return 1===t?i.loadContent():void 0}),i}]),t.directive("widgetAccountsAssetsSummary",function(){return{restrict:"A",controller:"WidgetAccountsAssetsSummaryCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-balance",[]),t.controller("WidgetAccountsBalanceCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(t,e,n){var i,a;return a=t.widget,a.initContext=function(){return t.isDataFound=null!=a.content&&!_.isEmpty(a.content.account_list)},a.format=function(){var e,i,s,o;return t.isDataFound&&null!=a.selectedAccount?(i=angular.copy(a.selectedAccount),s={title:i.name,labels:a.content.dates,values:i.balances},e=!0,angular.forEach(i.balances,function(t){return e&&(e=t>=0)}),o={scaleBeginAtZero:e,showXLabels:!1},a.chart=n.lineChart([s],o)):void 0},t.getName=function(){return null!=a.selectedAccount?a.selectedAccount.name:void 0},t.getCurrentBalance=function(){return null!=a.selectedAccount?a.selectedAccount.current_balance:void 0},t.getCurrency=function(){return null!=a.selectedAccount?a.selectedAccount.currency:void 0},i=function(){return null!=a.settings?a.settings.length:0},t.$watch(i,function(t){return t>=5?a.loadContent():void 0}),a}]),t.directive("widgetAccountsBalance",function(){return{restrict:"A",controller:"WidgetAccountsBalanceCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-balance-sheet",[]),t.controller("WidgetAccountsBalanceSheetCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(t){var e,n,i;return i=t.widget,i.initContext=function(){return(t.isDataFound=angular.isDefined(i.content)&&!_.isEmpty(i.content.summary)&&!_.isEmpty(i.content.dates))?(t.periodOptions=[{label:"Year",value:"YEARLY"},{label:"Quarter",value:"QUARTERLY"},{label:"Month",value:"MONTHLY"},{label:"Week",value:"WEEKLY"},{label:"Day",value:"DAILY"}],t.period=_.find(t.periodOptions,function(t){return t.value===i.content.period})||t.periodOptions[2],t.dates=i.content.dates,t.unCollapsed=i.metadata.unCollapsed||[],t.categories=Object.keys(i.content.summary)):void 0},t.toogleCollapsed=function(e){return null!=e?(_.find(t.unCollapsed,function(t){return e===t})?t.unCollapsed=_.reject(t.unCollapsed,function(t){return t===e}):t.unCollapsed.push(e),i.updateSettings(!1)):void 0},t.isCollapsed=function(e){return null!=e?_.find(t.unCollapsed,function(t){return e===t})?!1:!0:void 0},n={},n.initialized=!1,n.initialize=function(){return n.initialized=!0},n.toMetadata=function(){return{unCollapsed:t.unCollapsed}},i.settings.push(n),e=function(){return null!=i.settings?i.settings.length:0},t.$watch(e,function(t){return t>=3?i.loadContent():void 0}),i}]),t.directive("widgetAccountsBalanceSheet",function(){return{restrict:"A",controller:"WidgetAccountsBalanceSheetCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-cash-summary",[]),t.controller("WidgetAccountsCashSummaryCtrl",["$scope","ChartFormatterSvc","$filter",function(t,e,n){var i,a,s,o;return o=t.widget,o.initContext=function(){return(t.isDataFound=angular.isDefined(o.content)&&!_.isEmpty(o.content.summary)&&!_.isEmpty(o.content.dates))&&(t.dates=o.content.dates,t.unCollapsed=o.metadata.unCollapsed||[],o.metadata.selectedElement&&(t.selectedElement=_.find(o.content.summary,function(t){return t.name===o.metadata.selectedElement.name}),t.selectedElement||angular.forEach(o.content.summary,function(e){return null!=e.accounts?t.selectedElement||(t.selectedElement=_.find(e.accounts,function(t){return t.id===o.metadata.selectedElement.id})):void 0})),null==t.selectedElement)?o.width=6:void 0},o.format=function(){var i,a,s,l,r;return t.isDataFound&&null!=t.selectedElement?(a=angular.copy(t.selectedElement),l=_.map(o.content.dates,function(t){return null!=o.metadata.hist_parameters&&"YEARLY"===o.metadata.hist_parameters.period?n("date")(t,"yyyy"):null!=o.metadata.hist_parameters&&"QUARTERLY"===o.metadata.hist_parameters.period?n("date")(t,"MMM-yy"):null==o.metadata.hist_parameters||"WEEKLY"!==o.metadata.hist_parameters.period&&"DAILY"!==o.metadata.hist_parameters.period?n("date")(t,"MMM"):n("date")(t,"dd-MMM")}),s={title:a.name,labels:l,values:a.cash_flows},i=!0,angular.forEach(a.cash_flows,function(t){return i&&(i=t>=0)}),r={scaleBeginAtZero:i,showXLabels:!0},o.chart=e.lineChart([s],r)):void 0},t.getLastDate=function(){return null!=t.dates?_.last(t.dates):void 0},t.getLastValue=function(t){return null!=t.cash_flows?_.last(t.cash_flows):void 0},t.formatVariance=function(t){return null!=t?t>0?"+"+t+" %":t+" %":"n/a"},t.getLastVariance=function(e){return null!=e.variances&&null!=_.last(e.variances)?t.formatVariance(_.last(e.variances)):"n/a"},t.getVarianceClassColor=function(t){return parseInt(t)>0?"positive":parseInt(t)<0?"negative":null},t.getName=function(t){return null!=t&&null!=t.name?t.name.replace("_"," "):void 0},t.toogleSelectedElement=function(e){return t.isSelected(e)?(t.selectedElement=null,o.isExpanded()?o.toogleExpanded():o.updateSettings(!1)):(t.selectedElement=angular.copy(e),o.format(),o.isExpanded()?o.updateSettings(!1):o.toogleExpanded())},t.isSelected=function(e){return null!=e&&null!=t.selectedElement?null!=e.id&&t.selectedElement.id&&e.id===t.selectedElement.id||e.name===t.selectedElement.name?!0:!1:!1},t.toogleCollapsed=function(e){return null!=e&&null!=e.name?(_.find(t.unCollapsed,function(t){return e.name===t})?t.unCollapsed=_.reject(t.unCollapsed,function(t){return t===e.name}):t.unCollapsed.push(e.name),o.updateSettings(!1)):void 0},t.isCollapsed=function(e){return null!=e&&null!=e.name?_.find(t.unCollapsed,function(t){return e.name===t})?!1:!0:void 0},s={},s.initialized=!1,s.initialize=function(){return s.initialized=!0},s.toMetadata=function(){return{unCollapsed:t.unCollapsed}
},o.settings.push(s),a={},a.initialized=!1,a.initialize=function(){return a.initialized=!0},a.toMetadata=function(){return{selectedElement:t.selectedElement}},o.settings.push(a),i=function(){return null!=o.settings?o.settings.length:0},t.$watch(i,function(t){return 5===t?o.loadContent():void 0}),o}]),t.directive("widgetAccountsCashSummary",function(){return{restrict:"A",controller:"WidgetAccountsCashSummaryCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-comparison",[]),t.controller("WidgetAccountsComparisonCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s;return s=t.widget,s.initContext=function(){return t.isDataFound=null!=s.content&&!_.isEmpty(s.content.complete_list),t.movedAccount={}},s.format=function(){var t,e;for(t={labels:[],values:[]},_.map(s.selectedAccounts,function(e){return t.labels.push(e.name),t.values.push(e.current_balance)});t.values.length<15;)t.labels.push(""),t.values.push(null);return e={showTooltips:!1,showXLabels:!1,barDatasetSpacing:9},s.chart=n.barChart(t,e)},t.hasAccountsSelected=function(){return s.selectedAccounts&&s.selectedAccounts.length>0},t.getAccountColor=function(t){return n.getColor(_.indexOf(s.selectedAccounts,t))},t.addAccount=function(t){return s.moveAccountToAnotherList(t,s.remainingAccounts,s.selectedAccounts),s.format()},t.removeAccount=function(t){return s.moveAccountToAnotherList(t,s.selectedAccounts,s.remainingAccounts),s.format()},t.formatAmount=function(t){return i("mnoCurrency")(t.current_balance,t.currency)},a=function(){return null!=s.settings?s.settings.length:0},t.$watch(a,function(t){return t>=2?s.loadContent():void 0}),s}]),t.directive("widgetAccountsComparison",function(){return{restrict:"A",controller:"WidgetAccountsComparisonCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-custom-calculation",[]),t.controller("WidgetAccountsCustomCalculationCtrl",["$scope","$timeout","$modal","DhbAnalyticsSvc","$templateCache",function(t,e,n,i,a){var s,o;return o=t.widget,t.loaderImage="",o.initContext=function(){return t.movedAccount={},t.isDataFound=null!=o.content&&!_.isEmpty(o.content.complete_list)},t.addAccountToFormula=function(t){return o.selectedAccounts.length>0?o.formula+=" + {"+(o.selectedAccounts.length+1)+"}":o.formula="{1}",o.moveAccountToAnotherList(t,o.remainingAccounts,o.selectedAccounts,!1)},t.removeAccountFromFormula=function(t){var e,n,i,a,s,l,r,d;for(r=_.map(o.selectedAccounts,function(t){return t.uid}),l=_.reject(r,function(e){return e===t.uid}),n=_.first(_.difference(r,l)),e=_.indexOf(r,n)+1,d=1===e?"{"+e+"\\}\\s*(-|\\*|\\/|\\+)*\\s*":"\\s*(-|\\*|\\/|\\+)*\\s*\\{"+e+"\\}",s=angular.copy(o.formula).replace(new RegExp(d,"g"),""),i=e+1;i<=r.length;)a="\\{"+i+"\\}",s=s.replace(new RegExp(a,"g"),"{"+(i-1)+"}"),i++;return o.formula=angular.copy(s),o.moveAccountToAnotherList(t,o.selectedAccounts,o.remainingAccounts,!1)},t.formulaModal={},t.formulaModal.config={instance:{backdrop:"static",template:a.get("widgets/accounts-custom-calculation/formula.modal.html"),size:"lg",scope:t,keyboard:!1}},t.formulaModal.open=function(){var i;return o.settings=angular.copy(_.reject(o.settings,function(t){return"organizations"===t.key})),i=t.formulaModal,i.$instance=n.open(i.config.instance),e(function(){return o.initSettings()},200)},t.$watch(function(){return o.selectedOrganizations},function(t){return _.isEmpty(t)?void 0:o.updateSettings()},!0),t.formulaModal.cancel=function(){return o.initSettings(),t.formulaModal.close()},t.formulaModal.proceed=function(){return o.updateSettings(!1),t.formulaModal.close()},t.formulaModal.close=function(){return t.formulaModal.$instance.close()},t.$watch(function(){return o.isEditMode},function(e,n){return e&&!n?t.formulaModal.open():void 0}),s=function(){return null!=o.settings?o.settings.length:0},t.$watch(s,function(e){return 3!==e||t.blockLoadContent?void 0:(o.loadContent(),t.blockLoadContent=!0)}),o}]),t.directive("widgetAccountsCustomCalculation",function(){return{restrict:"A",controller:"WidgetAccountsCustomCalculationCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-expenses-revenue",[]),t.controller("WidgetAccountsExpensesRevenueCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(t,e,n){var i,a;return a=t.widget,a.initContext=function(){return t.isDataFound=null!=a.content&&null!=a.content.values},a.format=function(){var e,i,s,o,l;return t.isDataFound?(i=[{title:"Expenses ("+t.getCurrency()+")",labels:a.content.dates,values:a.content.values.expenses},{title:"Revenue ("+t.getCurrency()+")",labels:a.content.dates,values:a.content.values.revenue}],e=!0,angular.forEach(a.content.values.expenses,function(t){return e&&(e=t>=0)}),angular.forEach(a.content.values.revenue,function(t){return e&&(e=t>=0)}),s={scaleBeginAtZero:e,showXLabels:!1},a.hist_chart=n.lineChart(i,s,!0),o=[{label:"Expenses ("+t.getCurrency()+")",value:t.getCurrentExpenses()},{label:"Revenue ("+t.getCurrency()+")",value:t.getCurrentRevenue()}],l={tooltipFontSize:12,percentageInnerCutout:0},a.cur_chart=n.pieChart(o,l,!0)):void 0},t.getCurrentRevenue=function(){return t.isDataFound?_.last(a.content.values.revenue):void 0},t.getCurrentExpenses=function(){return t.isDataFound?_.last(a.content.values.expenses):void 0},t.getCurrency=function(){return t.isDataFound?a.content.currency:void 0},i=function(){return null!=a.settings?a.settings.length:0},t.$watch(i,function(t){return t>=3?a.loadContent():void 0}),a}]),t.directive("widgetAccountsExpensesRevenue",function(){return{restrict:"A",controller:"WidgetAccountsExpensesRevenueCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-payable-receivable",[]),t.controller("WidgetAccountsPayableReceivableCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(t,e,n){var i,a;return a=t.widget,a.initContext=function(){return t.isDataFound=null!=a.content&&null!=a.content.values},a.format=function(){var e,i,s;return t.isDataFound?(i=[{title:"Payable",labels:a.content.dates,values:a.content.values.payables},{title:"Receivable",labels:a.content.dates,values:a.content.values.receivables}],e=!0,angular.forEach(a.content.values.payables,function(t){return e&&(e=t>=0)}),angular.forEach(a.content.values.receivables,function(t){return e&&(e=t>=0)}),s={scaleBeginAtZero:e,showXLabels:!1},a.chart=n.lineChart(i,s,!0)):void 0},t.getCurrentPayable=function(){return t.isDataFound?_.last(a.content.values.payables):void 0},t.getCurrentReceivable=function(){return t.isDataFound?_.last(a.content.values.receivables):void 0},t.getCurrency=function(){return t.isDataFound?a.content.currency:void 0},i=function(){return null!=a.settings?a.settings.length:0},t.$watch(i,function(t){return 3===t?a.loadContent():void 0}),a}]),t.directive("widgetAccountsPayableReceivable",function(){return{restrict:"A",controller:"WidgetAccountsPayableReceivableCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-profit-and-loss",[]),t.controller("WidgetAccountsProfitAndLossCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s,o,l;return l=t.widget,l.initContext=function(){return!(t.isDataFound=angular.isDefined(l.content)&&!_.isEmpty(l.content.summary)&&!_.isEmpty(l.content.dates))||(t.dates=l.content.dates,t.unCollapsed=l.metadata.unCollapsed||[],l.metadata.selectedElements&&(t.selectedElements=[],angular.forEach(l.metadata.selectedElements,function(e){var n;return n=_.find(l.content.summary,function(t){return t.name===e.name}),n||angular.forEach(l.content.summary,function(t){return null!=t.accounts?n||(n=_.find(t.accounts,function(t){return e.id===t.id})):void 0}),n?t.selectedElements.push(n):void 0})),null!=t.selectedElements&&t.selectedElements.length>0)?void 0:l.width=6},l.format=function(){var e,a,s;return t.isDataFound&&null!=t.selectedElements&&t.selectedElements.length>0?(e=!0,a=[],angular.forEach(t.selectedElements,function(t){var n,s;return n=angular.copy(t),s=_.map(l.content.dates,function(t){return l.metadata.hist_parameters&&"YEARLY"===l.metadata.hist_parameters.period?i("date")(t,"yyyy"):l.metadata.hist_parameters&&"QUARTERLY"===l.metadata.hist_parameters.period?i("date")(t,"MMM-yy"):!l.metadata.hist_parameters||"WEEKLY"!==l.metadata.hist_parameters.period&&"DAILY"!==l.metadata.hist_parameters.period?i("date")(t,"MMM"):i("date")(t,"dd-MMM")}),a.push({title:n.name,labels:s,values:n.totals}),angular.forEach(n.totals,function(t){return e&&(e=t>=0)})}),s={scaleBeginAtZero:e,showXLabels:!0,datasetFill:1===t.selectedElements.length,pointDot:1===t.selectedElements.length},l.chart=n.lineChart(a,s)):void 0},t.getElementChartColor=function(t){return n.getColor(t)},t.getLastDate=function(){return null!=t.dates?_.last(t.dates):void 0},t.getLastValue=function(t){return null!=t.totals?_.last(t.totals):void 0},t.getClassColor=function(t){return parseInt(t)>0?"positive":parseInt(t)<0?"negative":null},t.getName=function(t){return null!=t&&null!=t.name?t.name.replace(/_/g," "):void 0},t.toogleSelectedElement=function(e){return t.isSelected(e)?(t.selectedElements=_.reject(t.selectedElements,function(t){return e.id?t.id===e.id:t.name===e.name}),l.format(),l.isExpanded()&&0===t.selectedElements.length?l.toogleExpanded():l.updateSettings(!1)):(t.selectedElements||(t.selectedElements=[]),t.selectedElements.push(e),l.format(),l.isExpanded()?l.updateSettings(!1):l.toogleExpanded())},t.isSelected=function(e){return null!=e&&null!=t.selectedElements?_.find(t.selectedElements,function(t){return e.id?t.id===e.id:t.name===e.name})?!0:!1:!1},t.toogleCollapsed=function(e){return null!=e&&null!=e.name?(_.find(t.unCollapsed,function(t){return e.name===t})?t.unCollapsed=_.reject(t.unCollapsed,function(t){return t===e.name}):t.unCollapsed.push(e.name),l.updateSettings(!1)):void 0},t.isCollapsed=function(e){return null!=e&&null!=e.name?_.find(t.unCollapsed,function(t){return e.name===t})?!1:!0:void 0},o={},o.initialized=!1,o.initialize=function(){return o.initialized=!0},o.toMetadata=function(){return{unCollapsed:t.unCollapsed}},l.settings.push(o),s={},s.initialized=!1,s.initialize=function(){return s.initialized=!0},s.toMetadata=function(){return{selectedElements:t.selectedElements}},l.settings.push(s),a=function(){return null!=l.settings?l.settings.length:0},t.$watch(a,function(t){return t>=5?l.loadContent():void 0}),l}]),t.directive("widgetAccountsProfitAndLoss",function(){return{restrict:"A",controller:"WidgetAccountsProfitAndLossCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.hr-employee-details",[]),t.controller("WidgetHrEmployeeDetailsCtrl",["$scope","DhbAnalyticsSvc","Utilities","$filter",function(t,e,n,i){var a,s;return s=t.widget,s.initContext=function(){return(t.isDataFound=!_.isEmpty(s.content.employees))?(t.periodOptions=[{label:"Yearly",value:"yearly"},{label:"Monthly",value:"monthly"},{label:"Weekly",value:"weekly"},{label:"Hourly",value:"hourly"}],t.period=s.metadata&&s.metadata.period?_.find(t.periodOptions,function(t){return t.value===s.metadata.period.toLowerCase()})||t.periodOptions[0]:t.periodOptions[0],t.employeesOptions=_.map(s.content.employees,function(t){return{value:t.uid,label:t.lastname+" "+t.firstname}}),t.selectedEmployee={value:t.getEmployee().uid,label:t.getEmployee().lastname+" "+t.getEmployee().firstname}):void 0},t.getSingleCompanyName=function(){var t,e;return s.content&&s.content.organizations?(e=s.content.organizations[0],t=_.find(s.parentDashboard.data_sources,function(t){return t.uid===e}),t.label):void 0},t.getEmployee=function(){var e;return t.isDataFound?(e=s.metadata&&s.metadata.employee_uid?angular.copy(_.find(s.content.employees,function(t){return t.uid===s.metadata.employee_uid})||s.content.employees[0]):angular.copy(s.content.employees[0]),e.salary&&(e.salary=i("mnoCurrency")(e.salary.amount,e.salary.currency)),e):!1},t.formatAddress=function(t){return angular.isDefined(t)?t.replace(/, /g,",\n"):void 0},a=function(){return null!=s.settings?s.settings.length:0},t.$watch(a,function(t){return t>=4?s.loadContent():void 0}),s}]),t.directive("widgetHrEmployeeDetails",function(){return{restrict:"A",controller:"WidgetHrEmployeeDetailsCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.hr-employees-list",[]),t.controller("WidgetHrEmployeesListCtrl",["$scope","DhbAnalyticsSvc","Utilities","$filter",function(t,e,n,i){var a,s;return s=t.widget,s.initContext=function(){return(t.isDataFound=!_.isEmpty(s.content.total)&&!_.isEmpty(s.content.employees))?(t.periodOptions=[{label:"Yearly",value:"yearly"},{label:"Monthly",value:"monthly"},{label:"Weekly",value:"weekly"},{label:"Hourly",value:"hourly"}],t.period=_.find(t.periodOptions,function(t){return t.value===s.content.total.period.toLowerCase()})||t.periodOptions[0]):void 0},t.getSingleCompanyName=function(){var t,e;return s.content&&s.content.organizations?(e=s.content.organizations[0],t=_.find(s.parentDashboard.data_sources,function(t){return t.uid===e}),t.label):void 0},t.getEmployeeSalary=function(t){return null!=t.salary?i("mnoCurrency")(t.salary.amount,s.content.total.currency):"-"},a=function(){return null!=s.settings?s.settings.length:0},t.$watch(a,function(t){return 2===t?s.loadContent():void 0}),s}]),t.directive("widgetHrEmployeesList",function(){return{restrict:"A",controller:"WidgetHrEmployeesListCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.hr-leaves-balance",[]),t.controller("WidgetHrLeavesBalanceCtrl",["$scope","DhbAnalyticsSvc","Utilities",function(t){var e,n;return n=t.widget,n.initContext=function(){return(t.isDataFound=!_.isEmpty(n.content.employees)&&!_.isEmpty(n.content.dates))?(t.employeesOptions=_.map(n.content.employees,function(t){return{value:t.id,label:t.lastname+" "+t.firstname}}),t.selectedEmployee={value:t.getEmployee().id,label:t.getEmployee().lastname+" "+t.getEmployee().firstname}):void 0},t.getEmployee=function(){return t.isDataFound?n.metadata&&n.metadata.employee_id?_.find(n.content.employees,function(t){return t.id===n.metadata.employee_id})||n.content.employees[0]:n.content.employees[0]:!1},e=function(){return null!=n.settings?n.settings.length:0},t.$watch(e,function(t){return t>=3?n.loadContent():void 0}),n}]),t.directive("widgetHrLeavesBalance",function(){return{restrict:"A",controller:"WidgetHrLeavesBalanceCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.hr-leaves-schedule",[]),t.controller("WidgetHrLeavesScheduleCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(t){var e,n;return n=t.widget,t.eventSources=[],n.initContext=function(){var e;return(t.isDataFound=angular.isDefined(n.content)&&!_.isEmpty(n.content.summary))?(e=[],angular.forEach(n.content.summary,function(t){return e.push({title:t.employee_name+" - "+t.title,start:t.start_date,end:t.end_date})}),t.eventSources=angular.copy(e)):void 0},e=function(){return null!=n.settings?n.settings.length:0},t.$watch(e,function(t){return t>=1?n.loadContent():void 0}),n}]),t.directive("widgetHrLeavesSchedule",function(){return{restrict:"A",controller:"WidgetHrLeavesScheduleCtrl"}}),t.directive("widgetComponentCalendar",function(){return{scope:{events:"=ngModel"},restrict:"A",link:function(t,e){var n,i;return n={header:{left:"prev",center:"title",right:"next"},contentHeight:204},i=function(){return t.events},t.$watch(i,function(i){return i.length>0?(e.fullCalendar("destroy"),angular.extend(n,{events:t.events}),e.fullCalendar(n)):void 0},!0)}}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.hr-payroll-summary",[]),t.controller("WidgetHrPayrollSummaryCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s,o,l;return l=t.widget,l.initContext=function(){return!(t.isDataFound=angular.isDefined(l.content)&&!_.isEmpty(l.content.summary)&&!_.isEmpty(l.content.dates))||(t.unCollapsed=l.metadata.unCollapsed||[],l.metadata.selectedElements&&(t.selectedElements=[],angular.forEach(l.metadata.selectedElements,function(e){var n;return n=_.find(l.content.summary,function(t){return t.name===e.name}),n||angular.forEach(l.content.summary,function(t){return null!=t.employees?n||(n=_.find(t.employees,function(t){return e.id===t.id})):void 0}),n?t.selectedElements.push(n):void 0})),null!=t.selectedElements&&t.selectedElements.length>0)?void 0:l.width=6},l.format=function(){var e,a,s,o,r,d;return t.isDataFound&&null!=t.selectedElements&&t.selectedElements.length>0?(e=!0,a=[],s=_.map(l.content.dates,function(t){return l.metadata.hist_parameters&&"YEARLY"===l.metadata.hist_parameters.period?i("date")(t,"yyyy"):l.metadata.hist_parameters&&"QUARTERLY"===l.metadata.hist_parameters.period?i("date")(t,"MMM-yy"):!l.metadata.hist_parameters||"WEEKLY"!==l.metadata.hist_parameters.period&&"DAILY"!==l.metadata.hist_parameters.period?i("date")(t,"MMM"):i("date")(t,"dd-MMM")}),angular.forEach(t.selectedElements,function(t){var n;return n=angular.copy(t),a.push({title:n.name,labels:s,values:n.totals}),angular.forEach(n.totals,function(t){return e&&(e=t>=0)})}),o={scaleBeginAtZero:e,showXLabels:!0,datasetFill:1===t.selectedElements.length,pointDot:1===t.selectedElements.length},l.hist_chart=n.lineChart(a,o),r=_.map(t.selectedElements,function(e){return{label:i("titleize")(t.getName({name:e.name})),value:t.getLastValue(e)}}),d={showTooltips:!0,percentageInnerCutout:50,tooltipFontSize:12},l.cur_chart=n.pieChart(r,d)):void 0},t.getElementChartColor=function(t){return n.getColor(t)},t.getLastValue=function(t){return null!=t.totals?t.totals[t.totals.length-2]:void 0},t.getTotalSum=function(t){return null!=t.totals?_.reduce(t.totals,function(t,e){return t+e},0):void 0},t.getName=function(t){return null!=t&&null!=t.name?"total_leaves"===t.name?"Total Leaves Accruals":"total_super"===t.name?"Total Superannuation Accruals":"total_reimbursement"===t.name?"Total Reimbursements":"total_tax"===t.name?"Total Taxes":"total_timeoff"===t.name?"Total Time Off":t.name.replace(/_/g," "):void 0},t.getTrackedField=function(){var e,n;return null==t.selectedElements||_.isEmpty(t.selectedElements)||null==t.selectedElements[0].id?void 0:(n=t.selectedElements[0].id.split("-")[0],e=!0,angular.forEach(t.selectedElements,function(t){return e&&(e=t.id&&n===t.id.split("-")[0])}),e?t.getName({name:n}):null)},t.formatDate=function(t){if(null==l.content.hist_parameters)return i("date")(t,"MMM");switch(l.content.hist_parameters.period){case"DAILY":return i("date")(t,"dd-MMM");case"WEEKLY":return i("date")(t,"dd-MMM");case"MONTHLY":return i("date")(t,"MMM");case"QUARTERLY":return i("date")(t,"MMM-yy");case"YEARLY":return i("date")(t,"yyyy");default:return i("date")(t,"MMM")}},t.toogleSelectedElement=function(e){return t.isSelected(e)?(t.selectedElements=_.reject(t.selectedElements,function(t){return e.id?t.id===e.id:t.name===e.name}),l.format(),l.isExpanded()&&0===t.selectedElements.length?l.toogleExpanded():l.updateSettings(!1)):(t.selectedElements||(t.selectedElements=[]),t.selectedElements.push(e),l.format(),l.isExpanded()?l.updateSettings(!1):l.toogleExpanded())},t.isSelected=function(e){return null!=e&&null!=t.selectedElements?_.find(t.selectedElements,function(t){return e.id?t.id===e.id:t.name===e.name})?!0:!1:!1},t.toogleCollapsed=function(e){return null!=e&&null!=e.name?(_.find(t.unCollapsed,function(t){return e.name===t})?t.unCollapsed=_.reject(t.unCollapsed,function(t){return t===e.name}):t.unCollapsed.push(e.name),l.updateSettings(!1)):void 0},t.getPeriod=function(){var e,n;return t.isDataFound&&l.content.hist_parameters?(n=l.content.hist_parameters.period||"MONTHLY",e="day","DAILY"!==n&&(e=n.substr(0,n.length-2).toLowerCase()),"last "+e):"last MONTH"},t.isCollapsed=function(e){return null!=e&&null!=e.name?_.find(t.unCollapsed,function(t){return e.name===t})?!1:!0:void 0},o={},o.initialized=!1,o.initialize=function(){return o.initialized=!0},o.toMetadata=function(){return{unCollapsed:t.unCollapsed}},l.settings.push(o),s={},s.initialized=!1,s.initialize=function(){return s.initialized=!0},s.toMetadata=function(){return{selectedElements:t.selectedElements}},l.settings.push(s),a=function(){return null!=l.settings?l.settings.length:0},t.$watch(a,function(t){return t>=6?l.loadContent():void 0}),l}]),t.directive("widgetHrPayrollSummary",function(){return{restrict:"A",controller:"WidgetHrPayrollSummaryCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.hr-payroll-taxes",[]),t.controller("WidgetHrPayrollTaxesCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(t,e,n){var i,a;return a=t.widget,a.initContext=function(){return t.isDataFound=null!=a.content&&a.content.total_tax&&a.content.dates},a.format=function(){var e,i,s;return t.isDataFound?(i={title:"Payroll Taxes",labels:a.content.dates,values:a.content.total_tax},e=!0,angular.forEach(a.content.total_tax,function(t){return e&&(e=t>=0)}),s={scaleBeginAtZero:e,showXLabels:!1},a.chart=n.lineChart([i],s)):void 0},t.getCurrentPrice=function(){return t.isDataFound?_.last(a.content.total_tax):void 0},t.getCurrency=function(){return t.isDataFound?a.content.currency||"USD":void 0},t.getPeriod=function(){var e,n;return t.isDataFound&&a.content.hist_parameters?(n=a.content.hist_parameters.period||"MONTHLY",e="day","DAILY"!==n&&(e=n.substr(0,n.length-2).toLowerCase()),"(current "+e+")"):void 0},i=function(){return null!=a.settings?a.settings.length:0},t.$watch(i,function(t){return t>=3?a.loadContent():void 0}),a}]),t.directive("widgetHrPayrollTaxes",function(){return{restrict:"A",controller:"WidgetHrPayrollTaxesCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.hr-salaries-summary",[]),t.controller("WidgetHrSalariesSummaryCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(t,e,n){var i,a;return a=t.widget,a.initContext=function(){return(t.isDataFound=null!=a.content.summary&&!_.isEmpty(a.content.summary.data))?(t.periodOptions=[{label:"Yearly",value:"yearly"},{label:"Monthly",value:"monthly"},{label:"Weekly",value:"weekly"},{label:"Hourly",value:"hourly"}],t.period=_.find(t.periodOptions,function(t){return t.value===a.content.total.period.toLowerCase()})||t.periodOptions[0],t.filterOptions=[{label:"Gender",value:"gender"},{label:"Age Range",value:"age_range"},{label:"Job Title",value:"job_title"}],t.filter=_.find(t.filterOptions,function(t){return t.value===a.content.summary.filter})||t.filterOptions[0]):void 0},a.format=function(){var e,i,s,o;if(t.isDataFound){if(e={labels:_.map(a.content.summary.data,function(t){return t.label}),values:_.map(a.content.summary.data,function(t){return t.value})},"gender"===t.filter.value)return i={showTooltips:!1},a.chart=n.barChart(e,i);if("job_title"===t.filter.value)return i={showTooltips:!1,showXLabels:!1,barDatasetSpacing:15},a.chart=n.barChart(e,i);if("age_range"===t.filter.value)return"unknown"===_.last(e.labels)&&(e.labels.pop(),e.values.pop()),s=[{title:"Average salary",labels:e.labels,values:e.values}],o={scaleBeginAtZero:!0,showXLabels:!1},a.chart=n.lineChart(s,o)}},t.getColorByIndex=function(t){return n.getColor(t)},i=function(){return null!=a.settings?a.settings.length:0},t.$watch(i,function(t){return 4===t?a.loadContent():void 0}),a}]),t.directive("widgetHrSalariesSummary",function(){return{restrict:"A",controller:"WidgetHrSalariesSummaryCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.hr-superannuation-accruals",[]),t.controller("WidgetHrSuperannuationAccrualsCtrl",["$scope","DhbAnalyticsSvc","Utilities",function(t){var e,n;return n=t.widget,n.initContext=function(){return(t.isDataFound=!_.isEmpty(n.content.employees)&&!_.isEmpty(n.content.dates))?(t.employeesOptions=_.map(n.content.employees,function(t){return{value:t.id,label:t.lastname+" "+t.firstname}}),t.selectedEmployee={value:t.getEmployee().id,label:t.getEmployee().lastname+" "+t.getEmployee().firstname}):void 0},t.getEmployee=function(){return t.isDataFound?n.metadata&&n.metadata.employee_id?_.find(n.content.employees,function(t){return t.id===n.metadata.employee_id})||n.content.employees[0]:n.content.employees[0]:!1},e=function(){return null!=n.settings?n.settings.length:0},t.$watch(e,function(t){return t>=3?n.loadContent():void 0}),n}]),t.directive("widgetHrSuperannuationAccruals",function(){return{restrict:"A",controller:"WidgetHrSuperannuationAccrualsCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.hr-timesheets",[]),t.controller("WidgetHrTimesheetsCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(t){var e,n,i;return i=t.widget,i.initContext=function(){return(t.isDataFound=angular.isDefined(i.content)&&!_.isEmpty(i.content.employees)&&!_.isEmpty(i.content.dates))?(t.employeesOptions=_.map(i.content.employees,function(t){return{value:t.id,label:t.lastname+" "+t.firstname}}),t.selectedEmployee={value:t.getEmployee().id,label:t.getEmployee().lastname+" "+t.getEmployee().firstname},t.unCollapsed=i.metadata.unCollapsed||[]):void 0},t.toogleCollapsed=function(e){return null!=e?(_.find(t.unCollapsed,function(t){return e===t})?t.unCollapsed=_.reject(t.unCollapsed,function(t){return t===e}):t.unCollapsed.push(e),i.updateSettings(!1)):void 0},t.isCollapsed=function(e){return null!=e?_.find(t.unCollapsed,function(t){return e===t})?!1:!0:void 0},t.getEmployee=function(){return t.isDataFound?i.metadata&&i.metadata.employee_id?_.find(i.content.employees,function(t){return t.id===i.metadata.employee_id})||i.content.employees[0]:i.content.employees[0]:!1},t.getEmployeeTimeWorked=function(){var e;return(e=t.getEmployee())?_.find(i.content.employees,function(t){return t.id===e.id}).total_time_worked:void 0},t.getEmployeeTimeOff=function(){var e;return(e=t.getEmployee())?_.find(i.content.employees,function(t){return t.id===e.id}).total_time_off:void 0},n={},n.initialized=!1,n.initialize=function(){return n.initialized=!0},n.toMetadata=function(){return{unCollapsed:t.unCollapsed}},i.settings.push(n),e=function(){return null!=i.settings?i.settings.length:0},t.$watch(e,function(t){return t>=4?i.loadContent():void 0}),i}]),t.directive("widgetHrTimesheets",function(){return{restrict:"A",controller:"WidgetHrTimesheetsCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.hr-workforce-summary",[]),t.controller("WidgetHrWorkforceSummaryCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s;return s=t.widget,s.initContext=function(){return(t.isDataFound=null!=s.content.summary&&!_.isEmpty(s.content.summary.data))?(t.periodOptions=[{label:"Yearly",value:"yearly"},{label:"Monthly",value:"monthly"},{label:"Weekly",value:"weekly"},{label:"Hourly",value:"hourly"}],t.period=_.find(t.periodOptions,function(t){return t.value===s.content.total.period.toLowerCase()})||t.periodOptions[0],t.filterOptions=[{label:"Gender",value:"gender"},{label:"Age Range",value:"age_range"},{label:"Salary Range",value:"salary_range"},{label:"Job Title",value:"job_title"}],t.filter=_.find(t.filterOptions,function(t){return t.value===s.content.summary.filter})||t.filterOptions[0]):void 0},s.format=function(){var e,i,a,o;return t.isDataFound?"salary_range"===t.filter.value?(e={labels:_.map(s.content.summary.data,function(e){return t.formatSalaryRange(e)}),values:_.map(s.content.summary.data,function(t){return t.value})},i={showTooltips:!1,showXLabels:!1,barDatasetSpacing:15},s.chart=n.barChart(e,i)):(a=_.map(s.content.summary.data,function(t){return{label:t.label,value:t.value}}),o={showTooltips:!0,percentageInnerCutout:50,tooltipFontSize:12},s.chart=n.pieChart(a,o)):void 0},t.getTotalWorkforce=function(){return t.isDataFound?s.content.total.amount:void 0},t.getNumberOfEmployees=function(){return t.isDataFound?s.content.total.employees:void 0},t.getCurrency=function(){return t.isDataFound?s.content.total.currency:void 0},t.formatSalaryRange=function(t){var e,n;return e=i("mnoCurrency")(t.label.split("-")[0],t.currency,!1),n=i("mnoCurrency")(t.label.split("-")[1],t.currency,!1),[e,n].join(" - ")},t.getColorByIndex=function(t){return n.getColor(t)},a=function(){return null!=s.settings?s.settings.length:0},t.$watch(a,function(t){return 4===t?s.loadContent():void 0}),s}]),t.directive("widgetHrWorkforceSummary",function(){return{restrict:"A",controller:"WidgetHrWorkforceSummaryCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.invoices-aged-payables-receivables",[]),t.controller("WidgetInvoicesAgedPayablesReceivablesCtrl",["$scope","$log","$filter","DhbAnalyticsSvc","ChartFormatterSvc",function(t,e,n,i,a){var s,o,l,r;return r=t.widget,r.initContext=function(){return!(t.isDataFound=!(!angular.isDefined(r.content)||_.isEmpty(r.content.payables)&&_.isEmpty(r.content.receivables)||_.isEmpty(r.content.dates)))||(t.unCollapsed=r.metadata.unCollapsed||[],r.metadata.selectedElements&&(t.selectedElements=[],angular.forEach(r.metadata.selectedElements,function(e){var n;return"aged_payables"===e.name&&(n=r.content.payables),"aged_receivables"!==e.name||n||(n=r.content.receivables),n||(n=_.find(r.content.payables.suppliers,function(t){return t.id===e.id})),n||(n=_.find(r.content.receivables.customers,function(t){return t.id===e.id})),n?t.selectedElements.push(n):void 0})),null!=t.selectedElements&&t.selectedElements.length>0)?void 0:r.width=6},r.format=function(){var e,i,s,o;return t.isDataFound&&null!=t.selectedElements&&t.selectedElements.length>0?(e=!0,i=[],s=_.map(r.content.dates,function(t){return r.metadata.hist_parameters&&"YEARLY"===r.metadata.hist_parameters.period?n("date")(t,"yyyy"):r.metadata.hist_parameters&&"QUARTERLY"===r.metadata.hist_parameters.period?n("date")(t,"MMM-yy"):!r.metadata.hist_parameters||"WEEKLY"!==r.metadata.hist_parameters.period&&"DAILY"!==r.metadata.hist_parameters.period?n("date")(t,"MMM"):n("date")(t,"dd-MMM")}),angular.forEach(t.selectedElements,function(t){var n;return n=angular.copy(t),i.push({title:n.name,labels:s,values:n.totals}),angular.forEach(n.totals,function(t){return e&&(e=t>=0)})}),o={scaleBeginAtZero:e,showXLabels:!0,datasetFill:1===t.selectedElements.length,pointDot:1===t.selectedElements.length},r.chart=a.lineChart(i,o)):void 0},t.getElementChartColor=function(t){return null!=t?a.getColor(t):void 0},t.getLastValue=function(t){return null!=t&&null!=t.totals?_.last(t.totals):void 0},t.getTotalSum=function(t){return null!=t&&null!=t.totals?_.reduce(t.totals,function(t,e){return t+e},0):void 0},t.getName=function(t){return null!=t&&null!=t.name?t.name.replace(/_/g," "):void 0},t.getPeriod=function(){var e,n;return t.isDataFound&&r.content.hist_parameters?(n=r.content.hist_parameters.period||"MONTHLY",e="day","DAILY"!==n&&(e=n.substr(0,n.length-2).toLowerCase()),"current "+e):"current month"},t.toogleSelectedElement=function(e){return t.isSelected(e)?(t.selectedElements=_.reject(t.selectedElements,function(t){return e.id?t.id===e.id:t.name===e.name}),r.format(),r.isExpanded()&&0===t.selectedElements.length?r.toogleExpanded():r.updateSettings(!1)):(t.selectedElements||(t.selectedElements=[]),t.selectedElements.push(e),r.format(),r.isExpanded()?r.updateSettings(!1):r.toogleExpanded())},t.isSelected=function(e){return null!=e&&null!=t.selectedElements?_.find(t.selectedElements,function(t){return e.id?t.id===e.id:t.name===e.name})?!0:!1:!1},t.toogleCollapsed=function(e){return null!=e&&null!=e.name?(_.find(t.unCollapsed,function(t){return e.name===t})?t.unCollapsed=_.reject(t.unCollapsed,function(t){return t===e.name}):t.unCollapsed.push(e.name),r.updateSettings(!1)):void 0},t.isCollapsed=function(e){return null!=e&&null!=e.name?_.find(t.unCollapsed,function(t){return e.name===t})?!1:!0:void 0},l={},l.initialized=!1,l.initialize=function(){return l.initialized=!0},l.toMetadata=function(){return{unCollapsed:t.unCollapsed}},r.settings.push(l),o={},o.initialized=!1,o.initialize=function(){return o.initialized=!0
},o.toMetadata=function(){return{selectedElements:t.selectedElements}},r.settings.push(o),s=function(){return null!=r.settings?r.settings.length:0},t.$watch(s,function(t){return t>=5?r.loadContent():void 0}),r}]),t.directive("widgetInvoicesAgedPayablesReceivables",function(){return{restrict:"A",controller:"WidgetInvoicesAgedPayablesReceivablesCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.invoices-list",[]),t.controller("WidgetInvoicesListCtrl",["$scope","DhbAnalyticsSvc","Utilities","$filter",function(t,e,n,i){var a,s;return s=t.widget,s.initContext=function(){return t.isDataFound=!_.isEmpty(s.content.entities)},t.entityType=s.metadata.entity,t.entityTypeCap=_.capitalize(s.metadata.entity),t.orderBy="name"===s.metadata.order_by||"total_invoiced"===s.metadata.order_by?"":_.last(s.metadata.order_by.split("_")).concat(" "),t.getInvoices=function(t){var e,n;return n=["<strong>"+t.name+"</strong>"],e=1,angular.forEach(t.invoices,function(t){var a,s;return s=""!==t.transaction_no?" ("+t.transaction_no+")":"",a="partially paid"===t.tooltip_status?" ("+i("mnoCurrency")(t.paid,t.currency,!1)+" over "+i("mnoCurrency")(t.invoiced,t.currency,!1)+")":" ("+i("mnoCurrency")(t.invoiced,t.currency,!1)+")",n.push("#"+e+s+" - "+t.tooltip_status+a),e++}),n.join("<br />")},a=function(){return null!=s.settings?s.settings.length:0},t.$watch(a,function(t){return 1===t?s.loadContent():void 0}),s}]),t.directive("widgetInvoicesList",function(){return{restrict:"A",controller:"WidgetInvoicesListCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.invoices-summary",[]),t.controller("WidgetInvoicesSummaryCtrl",["$scope","DhbAnalyticsSvc","Utilities","ChartFormatterSvc",function(t,e,n,i){var a,s;return s=t.widget,s.initContext=function(){return t.isDataFound=!_.isEmpty(s.content.summary)},s.format=function(){var e,n;return t.isDataFound?(e=_.map(s.content.summary,function(t){return{label:t.name,value:t.total}}),n={percentageInnerCutout:50,tooltipFontSize:12},s.chart=i.pieChart(e,n)):void 0},a=function(){return null!=s.settings?s.settings.length:0},t.$watch(a,function(t){return 2===t?s.loadContent():void 0}),s}]),t.directive("widgetInvoicesSummary",function(){return{restrict:"A",controller:"WidgetInvoicesSummaryCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-aged",[]),t.controller("WidgetSalesAgedCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s;return s=t.widget,s.initContext=function(){return(t.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.aged_sales)&&!_.isEmpty(s.content.dates))?(t.filterOptions=[{label:"value sold (incl. taxes)",value:"gross_value_sold"},{label:"value sold (excl. taxes)",value:"net_value_sold"},{label:"quantity sold",value:"quantity_sold"}],t.filter=_.find(t.filterOptions,function(t){return s.metadata&&s.metadata.filter===t.value})||t.filterOptions[0]):void 0},s.format=function(){var e,a,o,l;return t.isDataFound?(e=!0,a=[],l=s.content.aged_sales[t.filter.value],t.formattedDates=_.map(s.content.dates,function(t){return s.metadata&&s.metadata.hist_parameters&&"YEARLY"===s.metadata.hist_parameters.period?i("date")(t,"yyyy"):s.metadata&&s.metadata.hist_parameters&&"QUARTERLY"===s.metadata.hist_parameters.period?i("date")(t,"MMM-yy"):s.metadata&&s.metadata.hist_parameters&&("WEEKLY"===s.metadata.hist_parameters.period||"DAILY"===s.metadata.hist_parameters.period)?i("date")(t,"dd-MMM"):i("date")(t,"MMM")}),a.push({title:t.filter.label,labels:t.formattedDates,values:l}),angular.forEach(l,function(t){return e&&(e=t>=0)}),o={scaleBeginAtZero:e,showXLabels:!0,datasetFill:!0,pointDot:!0},s.chart=n.lineChart(a,o)):void 0},t.$watch(function(){return t.filter},function(){return s.format()},!0),t.getTotal=function(e){return t.isDataFound&&e>=0&&e<s.content.aged_sales[t.filter.value].length?s.content.aged_sales[t.filter.value][e]:void 0},t.getLastDate=function(){return t.isDataFound?_.last(s.content.dates):void 0},t.getClassColor=function(t,e){return t>e?"negative":e>t?"positive":null},a=function(){return null!=s.settings?s.settings.length:0},t.$watch(a,function(t){return t>=3?s.loadContent():void 0}),s}]),t.directive("widgetSalesAged",function(){return{restrict:"A",controller:"WidgetSalesAgedCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-break-even",[]),t.controller("WidgetSalesBreakEvenCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s,o;return o=t.widget,o.initContext=function(){return t.isDataFound=angular.isDefined(o.content)&&!_.isEmpty(o.content.sales),t.threshold=o.metadata.threshold},t.getProjectedDate=function(){var e;return t.isDataFound&&o.content.break_even?(""+o.content.break_even.projected_date).match("After")?(e=angular.copy(o.content.break_even.projected_date).replace("After ",""),"> "+i("date")(e,"d-MM-yy")):o.content.break_even.projected_date:void 0},t.getOpportunitiesToClose=function(){var e;return t.isDataFound&&o.content.break_even?(""+o.content.break_even.opportunities_to_close).match(">")?(e=angular.copy(o.content.break_even.opportunities_to_close).replace(">",""),"> "+e):o.content.break_even.opportunities_to_close:void 0},t.isTargetMet=function(){return t.isDataFound&&o.content.break_even?o.content.break_even.variance<0:void 0},t.getVariance=function(){return t.isDataFound&&o.content.break_even?Math.abs(o.content.break_even.variance):void 0},s={},s.initialized=!1,s.initialize=function(){return s.initialized=!0},s.toMetadata=function(){return{threshold:t.threshold}},o.settings.push(s),a=function(){return null!=o.settings?o.settings.length:0},t.$watch(a,function(t){return t>=3?o.loadContent():void 0}),o}]),t.directive("widgetSalesBreakEven",function(){return{restrict:"A",controller:"WidgetSalesBreakEvenCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-comparison",[]),t.controller("WidgetSalesComparisonCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s,o,l;return l=t.widget,l.initContext=function(){return(t.isDataFound=angular.isDefined(l.content)&&!_.isEmpty(l.content.sales_comparison)&&!_.isEmpty(l.content.dates))&&(t.unCollapsed=l.metadata.unCollapsed||[],t.filterOptions=[{label:"value sold (incl. taxes)",value:"gross_value_sold"},{label:"value sold (excl. taxes)",value:"net_value_sold"},{label:"quantity sold",value:"quantity_sold"}],t.filter=_.find(t.filterOptions,function(t){return l.metadata&&l.metadata.filter===t.value})||t.filterOptions[0],t.criteriaOptions=[{label:"products",value:"default"},{label:"locations",value:"location"},{label:"industries",value:"industry"},{label:"customers",value:"customer"}],t.criteria=_.find(t.criteriaOptions,function(t){return l.metadata&&l.metadata.criteria===t.value})||t.criteriaOptions[0],l.metadata.selectedElements)?(t.selectedElements=[],angular.forEach(l.metadata.selectedElements,function(e){var n;return n=_.find(l.content.sales_comparison,function(t){return t.name===e.name}),n||angular.forEach(l.content.sales_comparison,function(t){return null!=t.sales?n||(n=_.find(t.sales,function(t){return e.id===t.id})):void 0}),n?t.selectedElements.push(n):void 0})):void 0},l.format=function(){var e,a,s;return t.isDataFound&&null!=t.selectedElements&&t.selectedElements.length>0?(e=!0,a=[],angular.forEach(t.selectedElements,function(n){var s,o;return s=angular.copy(n),o=_.map(l.content.dates,function(t){return l.metadata.hist_parameters&&"YEARLY"===l.metadata.hist_parameters.period?i("date")(t,"yyyy"):l.metadata.hist_parameters&&"QUARTERLY"===l.metadata.hist_parameters.period?i("date")(t,"MMM-yy"):!l.metadata.hist_parameters||"WEEKLY"!==l.metadata.hist_parameters.period&&"DAILY"!==l.metadata.hist_parameters.period?i("date")(t,"MMM"):i("date")(t,"dd-MMM")}),a.push({title:s.name,labels:o,values:s.totals[t.filter.value]}),angular.forEach(s.totals,function(t){return e&&(e=t>=0)})}),s={scaleBeginAtZero:e,showXLabels:!0,datasetFill:!1,pointDot:!1},l.chart=n.lineChart(a,s)):void 0},t.$watch(function(){return t.filter},function(){return l.format()},!0),t.getLastDate=function(){return t.isDataFound?_.last(l.content.dates):void 0},t.getTotalForPeriod=function(e){return null!=e.totals&&t.filter?_.reduce(e.totals[t.filter.value],function(t,e){return t+e},0):void 0},t.getElementChartColor=function(t){return n.getColor(t)},t.toogleSelectedElement=function(e){return t.isSelected(e)?(t.selectedElements=_.reject(t.selectedElements,function(t){return e.id?t.id===e.id:t.name===e.name}),l.format(),l.isExpanded()&&0===t.selectedElements.length?l.toogleExpanded():l.updateSettings(!1)):(t.selectedElements||(t.selectedElements=[]),t.selectedElements.push(e),l.format(),l.isExpanded()?l.updateSettings(!1):l.toogleExpanded())},t.isSelected=function(e){return null!=e&&null!=t.selectedElements?_.find(t.selectedElements,function(t){return e.id?t.id===e.id:t.name===e.name})?!0:!1:!1},t.toogleCollapsed=function(e){return null!=e&&null!=e.name?(_.find(t.unCollapsed,function(t){return e.name===t})?t.unCollapsed=_.reject(t.unCollapsed,function(t){return t===e.name}):t.unCollapsed.push(e.name),l.updateSettings(!1)):void 0},t.isCollapsed=function(e){return null!=e&&null!=e.name?_.find(t.unCollapsed,function(t){return e.name===t})?!1:!0:void 0},o={},o.initialized=!1,o.initialize=function(){return o.initialized=!0},o.toMetadata=function(){return{unCollapsed:t.unCollapsed}},l.settings.push(o),s={},s.initialized=!1,s.initialize=function(){return s.initialized=!0},s.toMetadata=function(){return{selectedElements:t.selectedElements}},l.settings.push(s),a=function(){return null!=l.settings?l.settings.length:0},t.$watch(a,function(t){return t>=7?l.loadContent():void 0}),l}]),t.directive("widgetSalesComparison",function(){return{restrict:"A",controller:"WidgetSalesComparisonCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-customer-details",[]),t.controller("WidgetSalesCustomerDetailsCtrl",["$scope","DhbAnalyticsSvc","Utilities","$filter",function(t){var e,n;return n=t.widget,n.initContext=function(){return(t.isDataFound=!_.isEmpty(n.content.customers))?(t.customersOptions=_.map(n.content.customers,function(t){return{value:t.uid,label:t.name}}),t.selectedCustomer={value:t.getCustomer().uid,label:t.getCustomer().name}):void 0},t.getCustomer=function(){var e;return t.isDataFound?e=n.metadata&&n.metadata.customer_uid?angular.copy(_.find(n.content.customers,function(t){return t.uid===n.metadata.customer_uid})||n.content.customers[0]):angular.copy(n.content.customers[0]):!1},t.formatAddress=function(t){return angular.isDefined(t)?t.replace(/, /g,",\n"):void 0},t.getFromDate=function(){return t.isDataFound?n.content.from:void 0},t.getToDate=function(){return t.isDataFound?n.content.to:void 0},e=function(){return null!=n.settings?n.settings.length:0},t.$watch(e,function(t){return t>=4?n.loadContent():void 0}),n}]),t.directive("widgetSalesCustomerDetails",function(){return{restrict:"A",controller:"WidgetSalesCustomerDetailsCtrl"}})}.call(this),function(){"use strict";var t,e=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};t=angular.module("impac.components.widgets.sales-cycle",[]),t.controller("WidgetSalesCycleCtrl",["$scope","DhbAnalyticsSvc","Utilities","ChartFormatterSvc","$filter",function(t,n,i,a,s){var o,l;return l=t.widget,l.initContext=function(){return(t.isDataFound=angular.isDefined(l.content)&&!_.isEmpty(l.content.status_average_durations))?(t.unit=(l.metadata.unit||l.content.unit||"days").toLowerCase(),t.statusOptions=_.compact(_.map(l.metadata.status_selection,function(t){return angular.isDefined(l.content.status_average_durations[t])?{label:t,selected:!0}:void 0})),angular.forEach(l.content.status_average_durations,function(n,i){return!l.metadata.status_selection||e.call(l.metadata.status_selection,i)>=0?_.isEmpty(l.metadata.status_selection)?t.statusOptions.push({label:i,selected:!0}):void 0:t.statusOptions.push({label:i,selected:!1})})):void 0},l.format=function(){var e,n;return t.isDataFound?(e=_.compact(_.map(t.statusOptions,function(e){var n;return n=l.content.status_average_durations[e.label],e.selected&&angular.isDefined(n)?{label:s("titleize")(e.label)+": "+n+" "+t.unit,value:n}:void 0})),n={percentageInnerCutout:50,tooltipFontSize:12},l.chart=a.pieChart(e,n)):void 0},o=function(){return null!=l.settings?l.settings.length:0},t.$watch(o,function(t){return t>=3?l.loadContent():void 0}),l}]),t.directive("widgetSalesCycle",function(){return{restrict:"A",controller:"WidgetSalesCycleCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-forecast",[]),t.controller("WidgetSalesForecastCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s;return s=t.widget,s.initContext=function(){return t.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.dates)&&!_.isEmpty(s.content.totals)},s.format=function(){var e,a,o,l;return t.isDataFound?(e=!0,a=_.map(s.content.dates,function(t){return i("date")(t,"MMM-yy")}),o=[{title:"Sales Performance",labels:a,values:s.content.totals}],angular.forEach(s.content.totals,function(t){return e&&(e=t>=0)}),l={scaleBeginAtZero:e,showXLabels:!0,datasetFill:!0,pointDot:!1},s.chart=n.lineChart(o,l)):void 0},t.getOpportunityAmount=function(e){return t.isDataFound&&!_.isEmpty(e)?e.amount&&e.amount.amount?e.amount.amount:"-":void 0},t.getOpportunityCurrency=function(e){return t.isDataFound&&!_.isEmpty(e)?e.amount&&e.amount.currency?e.amount.currency:s.content.currency?s.content.currency:"AUD":void 0},a=function(){return null!=s.settings?s.settings.length:0},t.$watch(a,function(t){return t>=1?s.loadContent():void 0}),s}]),t.directive("widgetSalesForecast",function(){return{restrict:"A",controller:"WidgetSalesForecastCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-growth",[]),t.controller("WidgetSalesGrowthCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(t,e,n){var i,a;return a=t.widget,t.isDataQuantity=!0,t.getSelectedProduct=function(){return t.isDataFound?_.find(a.content.summary,function(e){return e.id===t.product.value}):void 0},t.getCurrentValue=function(){return null!=t.getSelectedProduct()?_.last(t.getSelectedProduct().totals):void 0},t.getCurrentDate=function(){return t.isDataFound?_.last(a.content.dates):void 0},a.initContext=function(){return(t.isDataFound=angular.isDefined(a.content)&&!_.isEmpty(a.content.summary)&&!_.isEmpty(a.content.dates))?(t.productOptions=_.flatten(_.map(a.content.summary,function(t){return{label:t.code,value:t.id}})),t.product=_.find(t.productOptions,function(t){return t.value===a.content.product})||{label:"SELECT PRODUCT",value:-1},t.filterOptions=[{label:"value sold (incl. taxes)",value:"gross_value_sold"},{label:"value sold (excl. taxes)",value:"net_value_sold"},{label:"quantity sold",value:"quantity_sold"},{label:"value purchased (incl. taxes)",value:"gross_value_purchased"},{label:"value purchased (excl. taxes)",value:"net_value_purchased"},{label:"quantity purchased",value:"quantity_purchased"}],t.filter=_.find(t.filterOptions,function(t){return t.value===a.content.filter})||t.filterOptions[0],t.isDataQuantity=t.filter.value.match("quantity")):void 0},a.format=function(){var e,i,s,o;return t.isDataFound&&t.product&&(i=t.getSelectedProduct())?(s={title:i.name,labels:a.content.dates,values:i.totals},e=!0,angular.forEach(i.totals,function(t){return e&&(e=t>=0)}),o={scaleBeginAtZero:e,showXLabels:!1},a.chart=n.lineChart([s],o)):void 0},i=function(){return null!=a.settings?a.settings.length:0},t.$watch(i,function(t){return t>=4?a.loadContent():void 0}),a}]),t.directive("widgetSalesGrowth",function(){return{restrict:"A",controller:"WidgetSalesGrowthCtrl"}})}.call(this),function(){"use strict";var t,e=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};t=angular.module("impac.components.widgets.sales-leads-funnel",[]),t.controller("WidgetSalesLeadsFunnelCtrl",["$scope","DhbAnalyticsSvc","Utilities","ChartFormatterSvc","$filter",function(t,n,i,a,s){var o,l,r;return r=t.widget,r.initContext=function(){return(t.isDataFound=angular.isDefined(r.content)&&!_.isEmpty(r.content.leads_per_status))?(t.statusOptions=_.compact(_.map(r.metadata.status_selection,function(t){return angular.isDefined(r.content.leads_per_status[t])?{label:t,selected:!0}:void 0})),angular.forEach(r.content.leads_per_status,function(n,i){return!r.metadata.status_selection||e.call(r.metadata.status_selection,i)>=0?_.isEmpty(r.metadata.status_selection)?t.statusOptions.push({label:i,selected:!0}):void 0:t.statusOptions.push({label:i,selected:!1})})):void 0},r.format=function(){var e;return t.isDataFound&&(e=0,angular.forEach(t.statusOptions,function(t){var n;return n=r.content.leads_per_status[t.label].total,t.selected&&angular.isDefined(n)&&n>e?e=n:void 0}),e>0)?t.funnel=_.compact(_.map(t.statusOptions,function(t){var n,i,a;return a=r.content.leads_per_status[t.label].total,n=(100*(a/e)-10).toFixed(),i=8>n?92:100-n,t.selected&&angular.isDefined(a)?{status:t.label,number:a,coloredWidth:{width:n+"%"},statusWidth:{width:i+"%"}}:void 0})):void 0},t.getImpacColor=function(t){return a.getColor(t)},t.toogleSelectStatus=function(e){return t.selectedStatus=t.selectedStatus&&t.selectedStatus===e?null:e,!r.isExpanded()&&t.selectedStatus?r.toogleExpanded():r.updateSettings(!1)},t.isSelected=function(e){return t.selectedStatus&&e===t.selectedStatus},t.getSelectedLeads=function(){return t.isDataFound&&t.selectedStatus?r.content.leads_per_status[t.selectedStatus].leads:void 0},t.getLeadDescription=function(t){var e,n;return n=[],e=["<strong>"],t.first_name&&e.push(s("titleize")(t.first_name)),t.last_name&&e.push(s("titleize")(t.last_name)),e.push("</strong>"),n.push(e.join(" ")),n.push("Status: "+s("titleize")(t.lead_status)),t.organization&&n.push("Organization: "+s("titleize")(t.organization)),t.opportunities&&(n.push("<strong>Opportunities:</strong>"),angular.forEach(t.opportunities,function(t){var e;return e=[],t.code&&e.push("#"+t.code),t.name&&e.push(""+t.name),t.amount&&e.push(s("mnoCurrency")(t.amount.total_amount,"USD",!1)),t.probability&&e.push(t.probability+"%"),t.sales_stage&&e.push(""+t.sales_stage),n.push(e.join(" - "))})),n.join("<br />")},l={},l.initialized=!1,l.initialize=function(){return angular.isDefined(r.content.leads_per_status[r.metadata.selected_status])&&(t.selectedStatus=r.metadata.selected_status),l.initialized=!0},l.toMetadata=function(){return{selected_status:t.selectedStatus}},r.settings.push(l),o=function(){return null!=r.settings?r.settings.length:0},t.$watch(o,function(t){return t>=5?r.loadContent():void 0}),r}]),t.directive("widgetSalesLeadsFunnel",function(){return{restrict:"A",controller:"WidgetSalesLeadsFunnelCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-leads-list",[]),t.controller("WidgetSalesLeadsListCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s;return s=t.widget,s.initContext=function(){return t.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.leads)},t.getLeadDescription=function(t){var e,n;return n=[],e=["<strong>"],t.first_name&&e.push(i("titleize")(t.first_name)),t.last_name&&e.push(i("titleize")(t.last_name)),e.push("</strong>"),n.push(e.join(" ")),n.push("Status: "+i("titleize")(t.lead_status)),t.organization&&n.push("Organization: "+i("titleize")(t.organization)),t.opportunities&&(n.push("<strong>Opportunities:</strong>"),angular.forEach(t.opportunities,function(t){var e;return e=[],t.code&&e.push("#"+t.code),t.name&&e.push(""+t.name),t.amount&&e.push(i("mnoCurrency")(t.amount.total_amount,"USD",!1)),t.probability&&e.push(t.probability+"%"),t.sales_stage&&e.push(""+t.sales_stage),n.push(e.join(" - "))})),n.join("<br />")},a=function(){return null!=s.settings?s.settings.length:0},t.$watch(a,function(t){return t>=1?s.loadContent():void 0}),s}]),t.directive("widgetSalesLeadsList",function(){return{restrict:"A",controller:"WidgetSalesLeadsListCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-list",[]),t.controller("WidgetSalesListCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(t){var e,n,i;return i=t.widget,i.initContext=function(){return(t.isDataFound=angular.isDefined(i.content)&&!_.isEmpty(i.content.summary))?(t.periodOptions=[{label:"year",value:"YEARLY"},{label:"quarter",value:"QUARTERLY"},{label:"month",value:"MONTHLY"},{label:"week",value:"WEEKLY"},{label:"day",value:"DAILY"}],t.period=_.find(t.periodOptions,function(t){return t.value===i.content.hist_parameters.period})||t.periodOptions[0],t.filterOptions=[{label:"value sold (incl. taxes)",value:"gross_value_sold"},{label:"value sold (excl. taxes)",value:"net_value_sold"},{label:"quantity sold",value:"quantity_sold"},{label:"value purchased (incl. taxes)",value:"gross_value_purchased"},{label:"value purchased (excl. taxes)",value:"net_value_purchased"},{label:"quantity purchased",value:"quantity_purchased"}],t.filter=_.find(t.filterOptions,function(t){return t.value===i.content.filter})||t.filterOptions[0],t.unCollapsed=i.metadata.unCollapsed||[]):void 0},t.toogleCollapsed=function(e){return null!=e?(_.find(t.unCollapsed,function(t){return e===t})?t.unCollapsed=_.reject(t.unCollapsed,function(t){return t===e}):t.unCollapsed.push(e),i.updateSettings(!1)):void 0},t.isCollapsed=function(e){return null!=e?_.find(t.unCollapsed,function(t){return e===t})?!1:!0:void 0},n={},n.initialized=!1,n.initialize=function(){return n.initialized=!0},n.toMetadata=function(){return{unCollapsed:t.unCollapsed}},i.settings.push(n),e=function(){return null!=i.settings?i.settings.length:0},t.$watch(e,function(t){return t>=3?i.loadContent():void 0}),i}]),t.directive("widgetSalesList",function(){return{restrict:"A",controller:"WidgetSalesListCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-margin",[]),t.controller("WidgetSalesMarginCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s;return s=t.widget,s.initContext=function(){return t.isDataFound=null!=s.content&&null!=s.content.margins&&null!=s.content.dates,t.filterOptions=[{label:"Including taxes",value:"gross_margin"},{label:"Excluding taxes",value:"net_margin"}],t.filter=null!=s.metadata&&"net_margin"===s.metadata.filter?t.filterOptions[1]:t.filterOptions[0]},s.format=function(){var e,i,a,o;return t.isDataFound?(o=null!=s.metadata&&"net_margin"===s.metadata.filter?s.content.margins.net:s.content.margins.gross,i={title:"Gross margin",labels:s.content.dates,values:o},e=!0,angular.forEach(o,function(t){return e&&(e=t>=0)}),a={scaleBeginAtZero:e,showXLabels:!1},s.chart=n.lineChart([i],a)):void 0},t.getTotalMargin=function(){return t.isDataFound?null!=s.metadata&&"net_margin"===s.metadata.filter?_.reduce(s.content.margins.net,function(t,e){return t+e},0):_.reduce(s.content.margins.gross,function(t,e){return t+e},0):void 0},t.getCurrency=function(){return t.isDataFound?s.content.currency||"USD":void 0},t.getTimeSpan=function(){return t.isDataFound?"From "+i("date")(_.first(s.content.dates),"d MMM yy")+" to "+i("date")(_.last(s.content.dates),"d MMM yy"):void 0},a=function(){return null!=s.settings?s.settings.length:0},t.$watch(a,function(t){return t>=4?s.loadContent():void 0}),s}]),t.directive("widgetSalesMargin",function(){return{restrict:"A",controller:"WidgetSalesMarginCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-number-of-leads",[]),t.controller("WidgetSalesNumberOfLeadsCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(t){var e,n,i;return i=t.widget,i.initContext=function(){return(t.isDataFound=angular.isDefined(i.content)&&!_.isEmpty(i.content.number_of_leads))?(t.periodOptions=[{label:"year",value:"YEARLY"},{label:"quarter",value:"QUARTERLY"},{label:"month",value:"MONTHLY"},{label:"week",value:"WEEKLY"},{label:"day",value:"DAILY"}],t.period=_.find(t.periodOptions,function(t){return t.value===i.metadata.period})||t.periodOptions[3]):void 0},t.formatNumberOfLeads=function(e){var a,s,o,l,r,d;if(s=0,o="- %",!t.isDataFound)return{nominal:s,variation:o,color:""};if(l=angular.copy(i.content.number_of_leads),r=0,a="","new"===e&&l.total&&2===l.total.length)r=l.total[1]-l.total[0],d=n(l.total),d>0?a="green":0>d&&(a="red");else if("converted"===e&&l.converted&&2===l.converted.length)r=l.converted[1],d=n(l.converted),d>0?a="green":0>d&&(a="red");else{if("lost"!==e||!l.lost||2!==l.lost.length)return{nominal:s,variation:o,color:a};r=l.lost[1],d=n(l.lost),0>d?a="green":d>0&&(a="red")}return r>0?s="+"+r:0>r&&(s=r),d&&d>0?o="+"+d.toFixed(0)+"%":d&&0>d&&(o=d.toFixed(0)+"%"),{nominal:s,variation:o,color:a}},n=function(t){var e;return e=0!==t[0]?100*(t[1]/t[0]-1):"- "},e=function(){return null!=i.settings?i.settings.length:0},t.$watch(e,function(t){return t>=2?i.loadContent():void 0}),i}]),t.directive("widgetSalesNumberOfLeads",function(){return{restrict:"A",controller:"WidgetSalesNumberOfLeadsCtrl"}})}.call(this),function(){"use strict";var t,e=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};t=angular.module("impac.components.widgets.sales-opportunities-funnel",[]),t.controller("WidgetSalesOpportunitiesFunnelCtrl",["$scope","DhbAnalyticsSvc","Utilities","ChartFormatterSvc","$filter",function(t,n,i,a,s){var o,l,r;return r=t.widget,r.initContext=function(){return(t.isDataFound=angular.isDefined(r.content)&&!_.isEmpty(r.content.opps_per_sales_stage))?(t.statusOptions=_.compact(_.map(r.metadata.sales_stage_selection,function(t){return angular.isDefined(r.content.opps_per_sales_stage[t])?{label:t,selected:!0}:void 0})),angular.forEach(r.content.opps_per_sales_stage,function(n,i){return!r.metadata.sales_stage_selection||e.call(r.metadata.sales_stage_selection,i)>=0?_.isEmpty(r.metadata.sales_stage_selection)?t.statusOptions.push({label:i,selected:!0}):void 0:t.statusOptions.push({label:i,selected:!1})})):void 0},r.format=function(){var e;return t.isDataFound&&(e=0,angular.forEach(t.statusOptions,function(t){var n;return n=r.content.opps_per_sales_stage[t.label].total,t.selected&&angular.isDefined(n)&&n>e?e=n:void 0}),e>0)?t.funnel=_.compact(_.map(t.statusOptions,function(t){var n,i,a;return a=r.content.opps_per_sales_stage[t.label].total,n=(100*(a/e)-10).toFixed(),i=8>n?92:100-n,t.selected&&angular.isDefined(a)?{status:t.label,number:a,coloredWidth:{width:n+"%"},statusWidth:{width:i+"%"}}:void 0})):void 0},t.getImpacColor=function(t){return a.getColor(t)},t.toogleSelectStatus=function(e){return t.selectedStatus=t.selectedStatus&&t.selectedStatus===e?null:e,!r.isExpanded()&&t.selectedStatus?r.toogleExpanded():r.updateSettings(!1)},t.isSelected=function(e){return t.selectedStatus&&e===t.selectedStatus},t.getSelectedOpportunities=function(){return t.isDataFound&&t.selectedStatus?r.content.opps_per_sales_stage[t.selectedStatus].opps:void 0},t.getOppDetails=function(t){var e;return e=[],t.amount&&e.push(s("mnoCurrency")(t.amount.amount,t.amount.currency||"AUD")),t.probability&&e.push("prob. "+t.probability+"%"),e.join(" / ")},l={},l.initialized=!1,l.initialize=function(){return angular.isDefined(r.content.opps_per_sales_stage[r.metadata.selected_status])&&(t.selectedStatus=r.metadata.selected_status),l.initialized=!0},l.toMetadata=function(){return{selected_status:t.selectedStatus}},r.settings.push(l),o=function(){return null!=r.settings?r.settings.length:0},t.$watch(o,function(t){return t>=4?r.loadContent():void 0}),r}]),t.directive("widgetSalesOpportunitiesFunnel",function(){return{restrict:"A",controller:"WidgetSalesOpportunitiesFunnelCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-performance",[]),t.controller("WidgetSalesPerformanceCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s;return s=t.widget,s.initContext=function(){return t.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.assignees)},t.getOpportunityAmount=function(e){var n;return t.isDataFound&&!_.isEmpty(e)?e.amount&&e.amount.amount?(n=e.amount.amount,i("mnoCurrency")(n,e.amount.currency||"AUD")):"-":void 0},a=function(){return null!=s.settings?s.settings.length:0},t.$watch(a,function(t){return t>=1?s.loadContent():void 0}),s}]),t.directive("widgetSalesPerformance",function(){return{restrict:"A",controller:"WidgetSalesPerformanceCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-segmented-turnover",[]),t.controller("WidgetSalesSegmentedTurnoverCtrl",["$scope","$filter","ChartFormatterSvc",function(t,e,n){var i,a;return a=t.widget,a.initContext=function(){return(t.isDataFound=!_.isEmpty(a.content.dates)&&!_.isEmpty(a.content.ranges))?(t.filterOptions=[{label:"Gross revenue (incl. taxes)",value:"gross"},{label:"Net revenue (excl. taxes)",value:"net"}],t.filter=_.find(t.filterOptions,function(t){return t.value===a.content.filter})||t.filterOptions[0]):void 0},a.format=function(){var e,i;return t.isDataFound?(e={labels:_.map(a.content.ranges,function(t){return t.label}),values:_.map(a.content.ranges,function(t){return t.value})},i={showTooltips:!1,showXLabels:!1,barDatasetSpacing:15},a.chart=n.barChart(e,i)):void 0},t.getAnalysis=function(){return t.isDataFound?a.content.ranges[0].percentage+a.content.ranges[1].percentage>50?"Your less expensive products bring you most of your revenue.":a.content.ranges[3].percentage+a.content.ranges[4].percentage>50?"Your most expensive products bring you most of your revenue.":"Your revenue is balanced between your different products segments.":void 0},t.getColorByIndex=function(t){return n.getColor(t)},t.getRangeLabel=function(t){var n;return n=t.split("-"),_.map(n,function(t){return e("mnoCurrency")(t,a.content.currency,!1)}).join(" - ")},t.getMaxRange=function(){var e,n;return t.isDataFound?(e=0,n=a.content.ranges[0],angular.forEach(a.content.ranges,function(t){return t.percentage>e&&(n=angular.copy(t)),e=Math.max(e,t.percentage)}),n):void 0},i=function(){return null!=a.settings?a.settings.length:0},t.$watch(i,function(t){return t>=4?a.loadContent():void 0}),a}]),t.directive("widgetSalesSegmentedTurnover",function(){return{restrict:"A",controller:"WidgetSalesSegmentedTurnoverCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-summary",[]),t.controller("WidgetSalesSummaryCtrl",["$scope","DhbAnalyticsSvc","Utilities","ChartFormatterSvc",function(t,e,n,i){var a,s;return s=t.widget,s.initContext=function(){return(t.isDataFound=!_.isEmpty(s.content.hist_parameters))?(t.incorrectPeriod=_.isEmpty(s.content.summary),t.periodOptions=[{label:"year",value:"YEARLY"},{label:"quarter",value:"QUARTERLY"},{label:"month",value:"MONTHLY"},{label:"week",value:"WEEKLY"},{label:"day",value:"DAILY"}],t.period=_.find(t.periodOptions,function(t){return t.value===s.content.hist_parameters.period})||t.periodOptions[0],t.filterOptions=[{label:"value sold (incl. taxes)",value:"gross_value_sold"},{label:"value sold (excl. taxes)",value:"net_value_sold"},{label:"quantity sold",value:"quantity_sold"},{label:"value purchased (incl. taxes)",value:"gross_value_purchased"},{label:"value purchased (excl. taxes)",value:"net_value_purchased"},{label:"quantity purchased",value:"quantity_purchased"}],"customer"===s.metadata.criteria&&(t.filterOptions=[t.filterOptions[0],t.filterOptions[1],t.filterOptions[2]]),t.filter=_.find(t.filterOptions,function(t){return t.value===s.content.filter})||t.filterOptions[0]):void 0},s.format=function(){var e,n;return t.isDataFound?(e=_.map(s.content.summary,function(t){var e;return e=t.company?(t.code||t.location||t.industry||t.customer)+" ("+t.company+")":t.code||t.location||t.industry||t.customer,{label:e,value:t.total}
}),n={percentageInnerCutout:50,tooltipFontSize:12},s.chart=i.pieChart(e,n)):void 0},a=function(){return null!=s.settings?s.settings.length:0},t.$watch(a,function(t){return t>=4?s.loadContent():void 0}),s}]),t.directive("widgetSalesSummary",function(){return{restrict:"A",controller:"WidgetSalesSummaryCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-top-opportunities",[]),t.controller("WidgetSalesTopOpportunitiesCtrl",["$scope","DhbAnalyticsSvc","Utilities","ChartFormatterSvc","$filter",function(t,e,n,i,a){var s,o;return o=t.widget,o.initContext=function(){return t.isDataFound=angular.isDefined(o.content)&&!_.isEmpty(o.content.opportunities)},t.getOppDetails=function(t){var e;return e=[],t.amount&&e.push(a("mnoCurrency")(t.amount.amount,t.amount.currency||"AUD")),t.probability&&e.push("proba "+t.probability+"%"),t.sales_stage&&e.push(t.sales_stage),e.join(" / ")},t.getOppClass=function(t){switch(t){case 0:return"first";case 1:return"second";case 2:return"second";default:return""}},s=function(){return null!=o.settings?o.settings.length:0},t.$watch(s,function(t){return t>=1?o.loadContent():void 0}),o}]),t.directive("widgetSalesTopOpportunities",function(){return{restrict:"A",controller:"WidgetSalesTopOpportunitiesCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-settings.account",[]),t.controller("SettingAccountCtrl",["$scope","$filter",function(t,e){var n,i;return i=t.parentWidget,n={},n.key="account",n.isInitialized=!1,n.initialize=function(){return i.selectedAccount=null,null!=i.content&&null!=i.content.account_list&&null!=i.metadata&&null!=i.metadata.account_uid?(i.selectedAccount=_.find(i.content.account_list,function(t){return t.uid===i.metadata.account_uid}),n.isInitialized=!0):void 0},n.toMetadata=function(){return null!=i.selectedAccount?{account_uid:i.selectedAccount.uid}:void 0},t.formatAmount=function(t){return e("mnoCurrency")(t.current_balance,t.currency)},i.settings||(i.settings=[]),i.settings.push(n)}]),t.directive("settingAccount",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"=",label:"@"},link:function(t){return t.label?void 0:t.label="Account to monitor"},template:t.get("widgets-settings/account.tmpl.html"),controller:"SettingAccountCtrl"}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-settings.accounts-list",[]),t.controller("SettingAccountsListCtrl",["$scope",function(t){var e,n,i,a;return a=t.parentWidget,a.moveAccountToAnotherList=function(t,i,s,o){return null==o&&(o=!0),n(t,i),e(t,s),o?a.updateSettings(!1):void 0},n=function(t,e){return _.isEmpty(e)?void 0:angular.copy(_.reject(e,function(e){return t.uid===e.uid}),e)},e=function(t,e){return null!=t?(e||(e=[]),e.push(t)):void 0},i={},i.key="accounts-list",i.initialize=function(){return i.isInitialized=!1,a.remainingAccounts=[],a.selectedAccounts=[],null==a.content||_.isEmpty(a.content.complete_list)?void 0:(a.remainingAccounts=angular.copy(a.content.complete_list),_.isEmpty(a.metadata.accounts_list)||angular.forEach(a.metadata.accounts_list,function(t){var e;return e=_.find(a.content.complete_list,function(e){return e.uid===t}),a.moveAccountToAnotherList(e,a.remainingAccounts,a.selectedAccounts,!1)}),i.isInitialized=!0)},i.toMetadata=function(){return i.isInitialized?{accounts_list:_.map(a.selectedAccounts,function(t){return t.uid})}:void 0},a.settings||(a.settings=[]),a.settings.push(i)}]),t.directive("settingAccountsList",function(){return{restrict:"A",scope:{parentWidget:"="},controller:"SettingAccountsListCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-settings.chart-filters",[]),t.controller("SettingChartFiltersCtrl",["$scope",function(t){var e,n;return n=t.parentWidget,e={},e.key="chart-filters",e.isInitialized=!1,e.initialize=function(){return null!=n.content.chart_filter&&(t.filterCriteria=n.content.chart_filter.criteria)?(t.maxEntities=n.content.chart_filter.max,t.entityType=n.content.chart_filter.entity_type,t.filterLabel=n.content.chart_filter.filter_label.replace(/_/g," "),"number"===t.filterCriteria?(t.filterValuePercentage=80,t.filterValueNumber=n.content.chart_filter.value):(t.filterValuePercentage=n.content.chart_filter.value,t.filterValueNumber=Math.round(t.maxEntities/2)),e.isInitialized=!0):void 0},e.toMetadata=function(){var e;return null!=n.content.chart_filter?(e="percentage"===t.filterCriteria?t.filterValuePercentage:t.filterValueNumber,{chart_filter:{criteria:t.filterCriteria,value:e}}):{}},n.settings||(n.settings=[]),n.settings.push(e)}]),t.directive("settingChartFilters",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"="},template:t.get("widgets-settings/chart-filters.tmpl.html"),controller:"SettingChartFiltersCtrl"}}])}.call(this),function(){"use strict";var module;module=angular.module("impac.components.widgets-settings.formula",[]),module.controller("SettingFormulaCtrl",["$scope","$filter",function($scope,$filter){var authorized_regex,evaluateFormula,formatFormula,getFormula,setting,w;return w=$scope.parentWidget,w.formula="",authorized_regex=new RegExp("^(\\{|\\d|\\}|\\/|\\+|-|\\*|\\(|\\)|\\s|\\.)*$"),setting={},setting.key="formula",setting.isInitialized=!1,setting.initialize=function(){return null!=w.metadata&&null!=w.metadata.formula?(w.formula=w.metadata.formula,setting.isInitialized=!0):w.formula=""},setting.toMetadata=function(){return evaluateFormula(),w.isFormulaCorrect?{formula:w.formula}:{formula:""}},getFormula=function(){return w.formula},w.formatAmount=function(t){return $filter("mnoCurrency")(t.current_balance,t.currency)},$scope.$watch(getFormula,function(){return evaluateFormula()}),evaluateFormula=function(){var e,error,i,legend,str;str=angular.copy(w.formula),legend=angular.copy(w.formula),i=1,angular.forEach(w.selectedAccounts,function(t){var e;return e="\\{"+i+"\\}",str=str.replace(new RegExp(e,"g"),t.current_balance_no_format),legend=legend.replace(new RegExp(e,"g"),t.name),i++}),str.match(authorized_regex)||(w.isFormulaCorrect=!1,w.evaluatedFormula="invalid expression");try{w.evaluatedFormula=eval(str).toFixed(2)}catch(error){e=error,w.evaluatedFormula="invalid expression"}return null==w.evaluatedFormula||"invalid expression"===w.evaluatedFormula||"Infinity"===w.evaluatedFormula||"-Infinity"===w.evaluatedFormula?w.isFormulaCorrect=!1:(formatFormula(),w.legend=legend,w.isFormulaCorrect=!0)},formatFormula=function(){var t,e;return!w.formula.match(/\//g)&&null!=w.selectedAccounts&&(e=w.selectedAccounts[0])&&(t=e.currency)?w.evaluatedFormula=$filter("mnoCurrency")(w.evaluatedFormula,t):void 0},w.settings||(w.settings=[]),w.settings.push(setting)}]),module.directive(function(){return{restrict:"A",scope:{parentWidget:"="},controller:"SettingFormulaCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-settings.hist-mode",[]),t.controller("SettingHistModeCtrl",["$scope","DhbAnalyticsSvc",function(t){var e,n;return n=t.parentWidget,n.isHistoryMode=!1,t.toogleHistMode=function(t){return n.isHistoryMode&&"history"===t||!n.isHistoryMode&&"current"===t?void 0:(n.isHistoryMode=!n.isHistoryMode,n.updateSettings(!1))},e={},e.key="hist-mode",e.isInitialized=!1,e.initialize=function(){var t;return null!=n.content&&null!=n.content.hist_parameters&&(t=n.content.hist_parameters.mode)?(n.isHistoryMode="history"===t?!0:!1,e.isInitialized=!0):void 0},e.toMetadata=function(){var t;return t=n.isHistoryMode?"history":"current",{hist_parameters:{mode:t}}},n.settings||(n.settings=[]),n.settings.push(e)}]),t.directive("settingHistMode",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"="},template:t.get("widgets-settings/hist-mode.tmpl.html"),controller:"SettingHistModeCtrl"}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-settings.organizations",[]),t.controller("SettingOrganizationsCtrl",["$scope","$log",function(t){var e,n;return n=t.parentWidget,t.dashboardOrganizations=n.parentDashboard.data_sources,n.selectedOrganizations={},t.isOrganizationSelected=function(t){return!!n.selectedOrganizations[t]},t.toogleSelectOrganization=function(t){return n.selectedOrganizations[t]=!n.selectedOrganizations[t]},e={},e.key="organizations",e.isInitialized=!1,e.initialize=function(){return null!=n.metadata&&null!=n.metadata.organization_ids?(angular.forEach(n.metadata.organization_ids,function(t){return n.selectedOrganizations[t]=!0}),e.isInitialized=!0):void 0},e.toMetadata=function(){var t;return t=_.compact(_.map(n.selectedOrganizations,function(t,e){return t?e:void 0})),{organization_ids:t}},n.settings||(n.settings=[]),n.settings.push(e)}]),t.directive("settingOrganizations",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"="},template:t.get("widgets-settings/organizations.tmpl.html"),controller:"SettingOrganizationsCtrl"}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-settings.param-selector",[]),t.controller("SettingParamSelectorCtrl",["$scope",function(t){var e,n;return t.showOptions=!1,t.toogleShowOptions=function(){return t.showOptions=!t.showOptions},t.selectOption=function(e){return e!==t.selected&&(t.selected=e,n.updateSettings(!t.noReload)),t.toogleShowOptions()},t.getTruncateValue=function(){return parseInt(t.truncateNo)||20},n=t.parentWidget,e={},e.key="param-selector",e.isInitialized=!1,e.initialize=function(){return null!=n.content?e.isInitialized=!0:void 0},e.toMetadata=function(){var e;return e={},e[""+t.param]=t.selected.value,e},n.settings||(n.settings=[]),n.settings.push(e)}]),t.directive("settingParamSelector",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"=",param:"@",options:"=",selected:"=",truncateNo:"@"},link:function(t,e,n){return t.noReload="undefined"!=typeof n.noReload,t.truncateNo=n.truncateNo||20},template:t.get("widgets-settings/param-selector.tmpl.html"),controller:"SettingParamSelectorCtrl"}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-settings.params-picker",[]),t.controller("SettingParamsPickerCtrl",["$scope","DhbAnalyticsSvc",function(t){var e,n;return n=t.parentWidget,e={},e.key="params-picker",e.isInitialized=!1,e.initialize=function(){return t.sortableOptions={"ui-floating":!0,tolerance:"pointer"},_.isEmpty(t.options)?e.isInitialized=!0:void 0},e.toMetadata=function(){var e;return e={},e[""+t.param]=_.compact(_.map(t.options,function(t){return t.selected?t.label:void 0})),e},n.settings||(n.settings=[]),n.settings.push(e)}]),t.directive("settingParamsPicker",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"=",param:"@",options:"="},link:function(t){return t.formattedParam=t.param.replace("_"," ")},template:t.get("widgets-settings/params-picker.tmpl.html"),controller:"SettingParamsPickerCtrl"}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-settings.time-range",[]),t.controller("SettingTimeRangeCtrl",["$scope","$log",function(t){var e,n;return n=t.parentWidget,t.numberOfPeriods=(new Date).getMonth()+1,t.selectedPeriod="MONTHLY",t.PERIODS=["DAILY","WEEKLY","MONTHLY","QUARTERLY","YEARLY"],t.periodToUnit=function(){var e,n,i;return e=t.numberOfPeriods,n=t.selectedPeriod,i="DAILY"!==n?n.substring(0,n.length-2).toLowerCase():"day",e>1&&(i=i.concat("s")),i},e={},e.key="time-range",e.isInitialized=!1,e.initialize=function(){var i;return null!=n.metadata&&(i=n.metadata.hist_parameters)?(null!=i.period&&(t.selectedPeriod=i.period),null!=i.number_of_periods&&(t.numberOfPeriods=i.number_of_periods),e.isInitialized=!0):void 0},e.toMetadata=function(){return{hist_parameters:{period:t.selectedPeriod,number_of_periods:t.numberOfPeriods}}},n.settings||(n.settings=[]),n.settings.push(e)}]),t.directive("settingTimeRange",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"="},template:t.get("widgets-settings/time-range.tmpl.html"),controller:"SettingTimeRangeCtrl"}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-settings.width",[]),t.controller("SettingWidthCtrl",["$scope","$log",function(t){var e,n;return n=t.parentWidget,n.toogleExpanded=function(){return t.expanded=!t.expanded,n.updateSettings(!1),n.width=t.expanded?parseInt(t.max):parseInt(t.min)},e={},e.key="width",e.isInitialized=!1,n.isExpanded=function(){return t.expanded},e.initialize=function(){return null!=n.width?(t.expanded=n.width===parseInt(t.max),e.isInitialized=!0):void 0},e.toMetadata=function(){var e;return e=t.expanded?t.max:t.min,{width:parseInt(e)}},n.settings||(n.settings=[]),n.settings.push(e)}]),t.directive("settingWidth",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"=",min:"@",max:"@"},template:t.get("widgets-settings/width.tmpl.html"),controller:"SettingWidthCtrl"}}])}.call(this),function(){"use strict";var t=this,e=t.Chart,n=function(t){this.canvas=t.canvas,this.ctx=t;var e=function(t,e){return t["offset"+e]?t["offset"+e]:document.defaultView.getComputedStyle(t).getPropertyValue(e)},n=this.width=e(t.canvas,"Width")||t.canvas.width,a=this.height=e(t.canvas,"Height")||t.canvas.height;return t.canvas.width=n,t.canvas.height=a,n=this.width=t.canvas.width,a=this.height=t.canvas.height,this.aspectRatio=this.width/this.height,i.retinaScale(this),this};n.defaults={global:{animation:!0,animationSteps:60,animationEasing:"easeOutQuart",showScale:!0,scaleOverride:!1,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:!0,scaleLabel:"<%=value%>",scaleIntegersOnly:!0,scaleBeginAtZero:!1,scaleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",responsive:!1,maintainAspectRatio:!0,showTooltips:!0,customTooltips:!1,tooltipEvents:["mousemove","touchstart","touchmove","mouseout"],tooltipFillColor:"rgba(0,0,0,0.8)",tooltipFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipFontSize:14,tooltipFontStyle:"normal",tooltipFontColor:"#fff",tooltipTitleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipTitleFontSize:14,tooltipTitleFontStyle:"bold",tooltipTitleFontColor:"#fff",tooltipYPadding:6,tooltipXPadding:6,tooltipCaretSize:8,tooltipCornerRadius:6,tooltipXOffset:10,tooltipTemplate:"<%if (label){%><%=label%>: <%}%><%= value %>",tooltipFixed:!1,multiTooltipTemplate:"<%= value %>",multiTooltipKeyBackground:"#fff",onAnimationProgress:function(){},onAnimationComplete:function(){}}},n.types={};var i=n.helpers={},a=i.each=function(t,e,n){var i=Array.prototype.slice.call(arguments,3);if(t)if(t.length===+t.length){var a;for(a=0;a<t.length;a++)e.apply(n,[t[a],a].concat(i))}else for(var s in t)e.apply(n,[t[s],s].concat(i))},s=i.clone=function(t){var e={};return a(t,function(n,i){t.hasOwnProperty(i)&&(e[i]=n)}),e},o=i.extend=function(t){return a(Array.prototype.slice.call(arguments,1),function(e){a(e,function(n,i){e.hasOwnProperty(i)&&(t[i]=n)})}),t},l=i.merge=function(){var t=Array.prototype.slice.call(arguments,0);return t.unshift({}),o.apply(null,t)},r=i.indexOf=function(t,e){if(Array.prototype.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1},d=(i.where=function(t,e){var n=[];return i.each(t,function(t){e(t)&&n.push(t)}),n},i.findNextWhere=function(t,e,n){n||(n=-1);for(var i=n+1;i<t.length;i++){var a=t[i];if(e(a))return a}},i.findPreviousWhere=function(t,e,n){n||(n=t.length);for(var i=n-1;i>=0;i--){var a=t[i];if(e(a))return a}},i.inherits=function(t){var e=this,n=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)},i=function(){this.constructor=n};return i.prototype=e.prototype,n.prototype=new i,n.extend=d,t&&o(n.prototype,t),n.__super__=e.prototype,n}),c=i.noop=function(){},u=i.uid=function(){var t=0;return function(){return"chart-"+t++}}(),g=i.warn=function(t){window.console&&"function"==typeof window.console.warn&&console.warn(t)},h=i.amd="function"==typeof define&&define.amd,p=i.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},m=i.max=function(t){return Math.max.apply(Math,t)},v=i.min=function(t){return Math.min.apply(Math,t)},f=(i.cap=function(t,e,n){if(p(e)){if(t>e)return e}else if(p(n)&&n>t)return n;return t},i.getDecimalPlaces=function(t){if(t%1!==0&&p(t)){var e=t.toString();if(e.indexOf("e-")<0)return e.split(".")[1].length;if(e.indexOf(".")<0)return parseInt(e.split("e-")[1]);var n=e.split(".")[1].split("e-");return n[0].length+parseInt(n[1])}return 0}),w=i.radians=function(t){return t*(Math.PI/180)},b=(i.getAngleFromPoint=function(t,e){var n=e.x-t.x,i=e.y-t.y,a=Math.sqrt(n*n+i*i),s=2*Math.PI+Math.atan2(i,n);return 0>n&&0>i&&(s+=2*Math.PI),{angle:s,distance:a}},i.aliasPixel=function(t){return t%2===0?0:.5}),y=(i.splineCurve=function(t,e,n,i){var a=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),s=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2)),o=i*a/(a+s),l=i*s/(a+s);return{inner:{x:e.x-o*(n.x-t.x),y:e.y-o*(n.y-t.y)},outer:{x:e.x+l*(n.x-t.x),y:e.y+l*(n.y-t.y)}}},i.calculateOrderOfMagnitude=function(t){return Math.floor(Math.log(t)/Math.LN10)}),C=(i.calculateScaleRange=function(t,e,n,i,a){var s=2,o=Math.floor(e/(1.5*n)),l=s>=o,r=m(t),d=v(t);r===d&&(r+=.5,d>=.5&&!i?d-=.5:r+=.5);for(var c=Math.abs(r-d),u=y(c),g=Math.ceil(r/(1*Math.pow(10,u)))*Math.pow(10,u),h=i?0:Math.floor(d/(1*Math.pow(10,u)))*Math.pow(10,u),p=g-h,f=Math.pow(10,u),w=Math.round(p/f);(w>o||o>2*w)&&!l;)if(w>o)f*=2,w=Math.round(p/f),w%1!==0&&(l=!0);else if(a&&u>=0){if(f/2%1!==0)break;f/=2,w=Math.round(p/f)}else f/=2,w=Math.round(p/f);return l&&(w=s,f=p/w),{steps:w,stepValue:f,min:h,max:h+w*f}},i.template=function(t,e){function n(t,e){var n=/\W/.test(t)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+t.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):i[t]=i[t];return e?n(e):n}if(t instanceof Function)return t(e);var i={};return n(t,e)}),S=(i.generateLabels=function(t,e,n,i){var s=new Array(e);return t&&a(s,function(e,a){s[a]=C(t,{value:n+i*(a+1)})}),s},i.easingEffects={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-1*t*(t-2)},easeInOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return 1*((t=t/1-1)*t*t+1)},easeInOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-1*((t=t/1-1)*t*t*t-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},easeInQuint:function(t){return 1*(t/=1)*t*t*t*t},easeOutQuint:function(t){return 1*((t=t/1-1)*t*t*t*t+1)},easeInOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return-1*Math.cos(t/1*(Math.PI/2))+1},easeOutSine:function(t){return 1*Math.sin(t/1*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t/1)-1)},easeInExpo:function(t){return 0===t?1:1*Math.pow(2,10*(t/1-1))},easeOutExpo:function(t){return 1===t?1:1*(-Math.pow(2,-10*t/1)+1)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},easeInCirc:function(t){return t>=1?t:-1*(Math.sqrt(1-(t/=1)*t)-1)},easeOutCirc:function(t){return 1*Math.sqrt(1-(t=t/1-1)*t)},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var e=1.70158,n=0,i=1;return 0===t?0:1==(t/=1)?1:(n||(n=.3),i<Math.abs(1)?(i=1,e=n/4):e=n/(2*Math.PI)*Math.asin(1/i),-(i*Math.pow(2,10*(t-=1))*Math.sin(2*(1*t-e)*Math.PI/n)))},easeOutElastic:function(t){var e=1.70158,n=0,i=1;return 0===t?0:1==(t/=1)?1:(n||(n=.3),i<Math.abs(1)?(i=1,e=n/4):e=n/(2*Math.PI)*Math.asin(1/i),i*Math.pow(2,-10*t)*Math.sin(2*(1*t-e)*Math.PI/n)+1)},easeInOutElastic:function(t){var e=1.70158,n=0,i=1;return 0===t?0:2==(t/=.5)?1:(n||(n=.3*1.5),i<Math.abs(1)?(i=1,e=n/4):e=n/(2*Math.PI)*Math.asin(1/i),1>t?-.5*i*Math.pow(2,10*(t-=1))*Math.sin(2*(1*t-e)*Math.PI/n):i*Math.pow(2,-10*(t-=1))*Math.sin(2*(1*t-e)*Math.PI/n)*.5+1)},easeInBack:function(t){var e=1.70158;return 1*(t/=1)*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return 1*((t=t/1-1)*t*((e+1)*t+e)+1)},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?.5*t*t*(((e*=1.525)+1)*t-e):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:function(t){return 1-S.easeOutBounce(1-t)},easeOutBounce:function(t){return(t/=1)<1/2.75?7.5625*t*t:2/2.75>t?1*(7.5625*(t-=1.5/2.75)*t+.75):2.5/2.75>t?1*(7.5625*(t-=2.25/2.75)*t+.9375):1*(7.5625*(t-=2.625/2.75)*t+.984375)},easeInOutBounce:function(t){return.5>t?.5*S.easeInBounce(2*t):.5*S.easeOutBounce(2*t-1)+.5}}),x=i.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}(),_=i.cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return window.clearTimeout(t,1e3/60)}}(),E=(i.animationLoop=function(t,e,n,i,a,s){var o=0,l=S[n]||S.linear,r=function(){o++;var n=o/e,d=l(n);t.call(s,d,n,o),i.call(s,d,n),e>o?s.animationFrame=x(r):a.apply(s)};x(r)},i.getRelativePosition=function(t){var e,n,i=t.originalEvent||t,a=t.currentTarget||t.srcElement,s=a.getBoundingClientRect();return i.touches?(e=i.touches[0].clientX-s.left,n=i.touches[0].clientY-s.top):(e=i.clientX-s.left,n=i.clientY-s.top),{x:e,y:n}},i.addEvent=function(t,e,n){t.addEventListener?t.addEventListener(e,n):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n}),D=i.removeEvent=function(t,e,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent?t.detachEvent("on"+e,n):t["on"+e]=c},A=(i.bindEvents=function(t,e,n){t.events||(t.events={}),a(e,function(e){t.events[e]=function(){n.apply(t,arguments)},E(t.chart.canvas,e,t.events[e])})},i.unbindEvents=function(t,e){a(e,function(e,n){D(t.chart.canvas,n,e)})}),M=i.getMaximumWidth=function(t){var e=t.parentNode;return e.clientWidth},k=i.getMaximumHeight=function(t){var e=t.parentNode;return e.clientHeight},F=(i.getMaximumSize=i.getMaximumWidth,i.retinaScale=function(t){var e=t.ctx,n=t.canvas.width,i=t.canvas.height;window.devicePixelRatio&&(e.canvas.style.width=n+"px",e.canvas.style.height=i+"px",e.canvas.height=i*window.devicePixelRatio,e.canvas.width=n*window.devicePixelRatio,e.scale(window.devicePixelRatio,window.devicePixelRatio))}),L=i.clear=function(t){t.ctx.clearRect(0,0,t.width,t.height)},W=i.fontString=function(t,e,n){return e+" "+t+"px "+n},z=i.longestText=function(t,e,n){t.font=e;var i=0;return a(n,function(e){var n=t.measureText(e).width;i=n>i?n:i}),i},P=i.drawRoundedRectangle=function(t,e,n,i,a,s){t.beginPath(),t.moveTo(e+s,n),t.lineTo(e+i-s,n),t.quadraticCurveTo(e+i,n,e+i,n+s),t.lineTo(e+i,n+a-s),t.quadraticCurveTo(e+i,n+a,e+i-s,n+a),t.lineTo(e+s,n+a),t.quadraticCurveTo(e,n+a,e,n+a-s),t.lineTo(e,n+s),t.quadraticCurveTo(e,n,e+s,n),t.closePath()};n.instances={},n.Type=function(t,e,i){this.options=e,this.chart=i,this.id=u(),n.instances[this.id]=this,e.responsive&&this.resize(),this.initialize.call(this,t)},o(n.Type.prototype,{initialize:function(){return this},clear:function(){return L(this.chart),this},stop:function(){return _(this.animationFrame),this},resize:function(t){this.stop();var e=this.chart.canvas,n=M(this.chart.canvas),i=this.options.maintainAspectRatio?n/this.chart.aspectRatio:k(this.chart.canvas);return e.width=this.chart.width=n,e.height=this.chart.height=i,F(this.chart),"function"==typeof t&&t.apply(this,Array.prototype.slice.call(arguments,1)),this},reflow:c,render:function(t){return t&&this.reflow(),this.options.animation&&!t?i.animationLoop(this.draw,this.options.animationSteps,this.options.animationEasing,this.options.onAnimationProgress,this.options.onAnimationComplete,this):(this.draw(),this.options.onAnimationComplete.call(this)),this},generateLegend:function(){return C(this.options.legendTemplate,this)},destroy:function(){this.clear(),A(this,this.events);var t=this.chart.canvas;t.width=this.chart.width,t.height=this.chart.height,t.style.removeProperty?(t.style.removeProperty("width"),t.style.removeProperty("height")):(t.style.removeAttribute("width"),t.style.removeAttribute("height")),delete n.instances[this.id]},showTooltip:function(t,e){"undefined"==typeof this.activeElements&&(this.activeElements=[]);var s=function(t){var e=!1;return t.length!==this.activeElements.length?e=!0:(a(t,function(t,n){t!==this.activeElements[n]&&(e=!0)},this),e)}.call(this,t);if(s||e){if(this.activeElements=t,this.draw(),this.options.customTooltips&&this.options.customTooltips(!1),t.length>0)if(this.datasets&&this.datasets.length>1){for(var o,l,d=this.datasets.length-1;d>=0&&(o=this.datasets[d].points||this.datasets[d].bars||this.datasets[d].segments,l=r(o,t[0]),-1===l);d--);var c=[],u=[],g=function(){var t,e,n,a,s,o=[],r=[],d=[];return i.each(this.datasets,function(e){t=e.points||e.bars||e.segments,t[l]&&t[l].hasValue()&&o.push(t[l])}),i.each(o,function(t){r.push(t.x),d.push(t.y),c.push(i.template(this.options.multiTooltipTemplate,t)),u.push({fill:t._saved.fillColor||t.fillColor,stroke:t._saved.strokeColor||t.strokeColor})},this),s=v(d),n=m(d),a=v(r),e=m(r),{x:a>this.chart.width/2?a:e,y:(s+n)/2}}.call(this,l);new n.MultiTooltip({x:g.x,y:g.y,xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,xOffset:this.options.tooltipXOffset,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,titleTextColor:this.options.tooltipTitleFontColor,titleFontFamily:this.options.tooltipTitleFontFamily,titleFontStyle:this.options.tooltipTitleFontStyle,titleFontSize:this.options.tooltipTitleFontSize,cornerRadius:this.options.tooltipCornerRadius,labels:c,legendColors:u,legendColorBackground:this.options.multiTooltipKeyBackground,title:t[0].label,chart:this.chart,ctx:this.chart.ctx,custom:this.options.customTooltips}).draw()}else a(t,function(t){var e=t.tooltipPosition();new n.Tooltip({x:Math.round(e.x),y:Math.round(e.y),xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,caretHeight:this.options.tooltipCaretSize,cornerRadius:this.options.tooltipCornerRadius,text:C(this.options.tooltipTemplate,t),chart:this.chart,custom:this.options.customTooltips,tooltipFixed:this.options.tooltipFixed}).draw()},this);return this}},toBase64Image:function(){return this.chart.canvas.toDataURL.apply(this.chart.canvas,arguments)}}),n.Type.extend=function(t){var e=this,i=function(){return e.apply(this,arguments)};if(i.prototype=s(e.prototype),o(i.prototype,t),i.extend=n.Type.extend,t.name||e.prototype.name){var a=t.name||e.prototype.name,r=n.defaults[e.prototype.name]?s(n.defaults[e.prototype.name]):{};n.defaults[a]=o(r,t.defaults),n.types[a]=i,n.prototype[a]=function(t,e){var s=l(n.defaults.global,n.defaults[a],e||{});return new i(t,s,this)}}else g("Name not provided for this chart, so it hasn't been registered");return e},n.Element=function(t){o(this,t),this.initialize.apply(this,arguments),this.save()},o(n.Element.prototype,{initialize:function(){},restore:function(t){return t?a(t,function(t){this[t]=this._saved[t]},this):o(this,this._saved),this},save:function(){return this._saved=s(this),delete this._saved._saved,this},update:function(t){return a(t,function(t,e){this._saved[e]=this[e],this[e]=t},this),this},transition:function(t,e){return a(t,function(t,n){this[n]=(t-this._saved[n])*e+this._saved[n]},this),this},tooltipPosition:function(){return{x:this.x,y:this.y}},hasValue:function(){return p(this.value)}}),n.Element.extend=d,n.Point=n.Element.extend({display:!0,inRange:function(t,e){var n=this.hitDetectionRadius+this.radius;return Math.pow(t-this.x,2)+Math.pow(e-this.y,2)<Math.pow(n,2)},draw:function(){if(this.display){var t=this.ctx;t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.closePath(),t.strokeStyle=this.strokeColor,t.lineWidth=this.strokeWidth,t.fillStyle=this.fillColor,t.fill(),t.stroke()}}}),n.Arc=n.Element.extend({inRange:function(t,e){var n=i.getAngleFromPoint(this,{x:t,y:e}),a=n.angle>=this.startAngle&&n.angle<=this.endAngle,s=n.distance>=this.innerRadius&&n.distance<=this.outerRadius;return a&&s},tooltipPosition:function(){var t=this.startAngle+(this.endAngle-this.startAngle)/2,e=(this.outerRadius-this.innerRadius)/2+this.innerRadius;return{x:this.x+Math.cos(t)*e,y:this.y+Math.sin(t)*e}},draw:function(){var t=this.ctx;t.beginPath(),t.arc(this.x,this.y,this.outerRadius,this.startAngle,this.endAngle),t.arc(this.x,this.y,this.innerRadius,this.endAngle,this.startAngle,!0),t.closePath(),t.strokeStyle=this.strokeColor,t.lineWidth=this.strokeWidth,t.fillStyle=this.fillColor,t.fill(),t.lineJoin="bevel",this.showStroke&&t.stroke()}}),n.Rectangle=n.Element.extend({draw:function(){var t=this.ctx,e=this.width/2,n=this.x-e,i=this.x+e,a=this.base-(this.base-this.y),s=this.strokeWidth/2;this.showStroke&&(n+=s,i-=s,a+=s),t.beginPath(),t.fillStyle=this.fillColor,t.strokeStyle=this.strokeColor,t.lineWidth=this.strokeWidth,t.moveTo(n,this.base),t.lineTo(n,a),t.lineTo(i,a),t.lineTo(i,this.base),t.fill(),this.showStroke&&t.stroke()},height:function(){return this.base-this.y},inRange:function(t,e){return t>=this.x-this.width/2&&t<=this.x+this.width/2&&e>=this.y&&e<=this.base}}),n.Tooltip=n.Element.extend({draw:function(){var t=this.chart.ctx;t.font=W(this.fontSize,this.fontStyle,this.fontFamily),this.xAlign="center",this.yAlign="above";var e=this.caretPadding=2,n=t.measureText(this.text).width+2*this.xPadding,i=this.fontSize+2*this.yPadding,a=i+this.caretHeight+e;this.tooltipFixed&&(n=this.chart.width,i=2*this.fontSize+4*this.yPadding),this.x+n/2>this.chart.width?this.xAlign="left":this.x-n/2<0&&(this.xAlign="right"),this.y-a<0&&(this.yAlign="below");var s=this.x-n/2,o=this.y-a;if(t.fillStyle=this.fillColor,this.custom)this.custom(this);else{if(this.tooltipFixed)switch(s=0,this.yAlign){case"above":o=0;break;case"below":o=this.chart.height/2-i/2}else{switch(this.yAlign){case"above":t.beginPath(),t.moveTo(this.x,this.y-e),t.lineTo(this.x+this.caretHeight,this.y-(e+this.caretHeight)),t.lineTo(this.x-this.caretHeight,this.y-(e+this.caretHeight)),t.closePath(),t.fill();break;case"below":o=this.y+e+this.caretHeight,t.beginPath(),t.moveTo(this.x,this.y+e),t.lineTo(this.x+this.caretHeight,this.y+e+this.caretHeight),t.lineTo(this.x-this.caretHeight,this.y+e+this.caretHeight),t.closePath(),t.fill()}switch(this.xAlign){case"left":s=this.x-n+(this.cornerRadius+this.caretHeight);break;case"right":s=this.x-(this.cornerRadius+this.caretHeight)}}P(t,s,o,n,i,this.cornerRadius),t.fill(),t.fillStyle=this.textColor,t.textAlign="center",t.textBaseline="middle",this.tooltipFixed&&this.text.split(":").length>=2?(t.fillText(this.text.split(":")[0],s+n/2,o+this.yPadding+this.fontSize),t.fillText(this.text.split(":")[1],s+n/2,o+2*(this.yPadding+this.fontSize))):t.fillText(this.text,s+n/2,o+i/2)}}}),n.MultiTooltip=n.Element.extend({initialize:function(){this.font=W(this.fontSize,this.fontStyle,this.fontFamily),this.titleFont=W(this.titleFontSize,this.titleFontStyle,this.titleFontFamily),this.height=this.labels.length*this.fontSize+(this.labels.length-1)*(this.fontSize/2)+2*this.yPadding+1.5*this.titleFontSize,this.ctx.font=this.titleFont;var t=this.ctx.measureText(this.title).width,e=z(this.ctx,this.font,this.labels)+this.fontSize+3,n=m([e,t]);
this.width=n+2*this.xPadding;var i=this.height/2;this.y-i<0?this.y=i:this.y+i>this.chart.height&&(this.y=this.chart.height-i),this.x>this.chart.width/2?this.x-=this.xOffset+this.width:this.x+=this.xOffset},getLineHeight:function(t){var e=this.y-this.height/2+this.yPadding,n=t-1;return 0===t?e+this.titleFontSize/2:e+(1.5*this.fontSize*n+this.fontSize/2)+1.5*this.titleFontSize},draw:function(){if(this.custom)this.custom(this);else{P(this.ctx,this.x,this.y-this.height/2,this.width,this.height,this.cornerRadius);var t=this.ctx;t.fillStyle=this.fillColor,t.fill(),t.closePath(),t.textAlign="left",t.textBaseline="middle",t.fillStyle=this.titleTextColor,t.font=this.titleFont,t.fillText(this.title,this.x+this.xPadding,this.getLineHeight(0)),t.font=this.font,i.each(this.labels,function(e,n){t.fillStyle=this.textColor,t.fillText(e,this.x+this.xPadding+this.fontSize+3,this.getLineHeight(n+1)),t.fillStyle=this.legendColorBackground,t.fillRect(this.x+this.xPadding,this.getLineHeight(n+1)-this.fontSize/2,this.fontSize,this.fontSize),t.fillStyle=this.legendColors[n].fill,t.fillRect(this.x+this.xPadding,this.getLineHeight(n+1)-this.fontSize/2,this.fontSize,this.fontSize)},this)}}}),n.Scale=n.Element.extend({initialize:function(){this.fit()},buildYLabels:function(){this.yLabels=[];for(var t=f(this.stepValue),e=0;e<=this.steps;e++)this.yLabels.push(C(this.templateString,{value:(this.min+e*this.stepValue).toFixed(t)}));this.yLabelWidth=this.display&&this.showLabels?z(this.ctx,this.font,this.yLabels)+10:0},addXLabel:function(t){this.xLabels.push(t),this.valuesCount++,this.fit()},removeXLabel:function(){this.xLabels.shift(),this.valuesCount--,this.fit()},fit:function(){this.startPoint=this.display?this.fontSize:0,this.endPoint=this.display?this.height-1.5*this.fontSize-5:this.height,this.startPoint+=this.padding,this.endPoint-=this.padding;var t,e=this.endPoint-this.startPoint;for(this.calculateYRange(e),this.buildYLabels(),this.calculateXLabelRotation();e>this.endPoint-this.startPoint;)e=this.endPoint-this.startPoint,t=this.yLabelWidth,this.calculateYRange(e),this.buildYLabels(),t<this.yLabelWidth&&this.calculateXLabelRotation()},calculateXLabelRotation:function(){this.ctx.font=this.font;var t,e,n=this.ctx.measureText(this.xLabels[0]).width,i=this.ctx.measureText(this.xLabels[this.xLabels.length-1]).width;if(this.xScalePaddingRight=i/2+3,this.xScalePaddingLeft=n/2>this.yLabelWidth?n/2:this.yLabelWidth,this.xLabelRotation=0,this.display){var a,s=z(this.ctx,this.font,this.xLabels);this.xLabelWidth=s;for(var o=Math.floor(this.calculateX(1)-this.calculateX(0))-6;this.xLabelWidth>o&&0===this.xLabelRotation||this.xLabelWidth>o&&this.xLabelRotation<=90&&this.xLabelRotation>0;)a=Math.cos(w(this.xLabelRotation)),t=a*n,e=a*i,t+this.fontSize/2>this.yLabelWidth&&(this.xScalePaddingLeft=t+this.fontSize/2),this.xScalePaddingRight=this.fontSize/2,this.xLabelRotation++,this.xLabelWidth=a*s;this.xLabelRotation>0&&(this.endPoint-=Math.sin(w(this.xLabelRotation))*s+3)}else this.xLabelWidth=0,this.xScalePaddingRight=this.padding,this.xScalePaddingLeft=this.padding},calculateYRange:c,drawingArea:function(){return this.startPoint-this.endPoint},calculateY:function(t){var e=this.drawingArea()/(this.min-this.max);return this.endPoint-e*(t-this.min)},calculateX:function(t){var e=(this.xLabelRotation>0,this.width-(this.xScalePaddingLeft+this.xScalePaddingRight)),n=e/Math.max(this.valuesCount-(this.offsetGridLines?0:1),1),i=n*t+this.xScalePaddingLeft;return this.offsetGridLines&&(i+=n/2),Math.round(i)},update:function(t){i.extend(this,t),this.fit()},draw:function(){var t=this.ctx,e=(this.endPoint-this.startPoint)/this.steps,n=Math.round(this.xScalePaddingLeft);this.display&&(t.fillStyle=this.textColor,t.font=this.font,a(this.yLabels,function(a,s){var o=this.endPoint-e*s,l=Math.round(o),r=this.showHorizontalLines;t.textAlign="right",t.textBaseline="middle",this.showLabels&&t.fillText(a,n-10,o),0!==s||r||(r=!0),r&&t.beginPath(),s>0?(t.lineWidth=this.gridLineWidth,t.strokeStyle=this.gridLineColor):(t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor),l+=i.aliasPixel(t.lineWidth),r&&(t.moveTo(n,l),t.lineTo(this.width,l),t.stroke(),t.closePath()),t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor,t.beginPath(),t.moveTo(n-5,l),t.lineTo(n,l),t.stroke(),t.closePath()},this),a(this.xLabels,function(e,n){var i=this.calculateX(n)+b(this.lineWidth),a=this.calculateX(n-(this.offsetGridLines?.5:0))+b(this.lineWidth),s=this.xLabelRotation>0,o=this.showVerticalLines;0!==n||o||(o=!0),o&&t.beginPath(),n>0?(t.lineWidth=this.gridLineWidth,t.strokeStyle=this.gridLineColor):(t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor),o&&(t.moveTo(a,this.endPoint),t.lineTo(a,this.startPoint-3),t.stroke(),t.closePath()),t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor,t.beginPath(),t.moveTo(a,this.endPoint),t.lineTo(a,this.endPoint+5),t.stroke(),t.closePath(),t.save(),t.translate(i,s?this.endPoint+12:this.endPoint+8),t.rotate(-1*w(this.xLabelRotation)),t.font=this.font,t.textAlign=s?"right":"center",t.textBaseline=s?"middle":"top",t.fillText(e,0,0),t.restore()},this))}}),n.RadialScale=n.Element.extend({initialize:function(){this.size=v([this.height,this.width]),this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2},calculateCenterOffset:function(t){var e=this.drawingArea/(this.max-this.min);return(t-this.min)*e},update:function(){this.lineArc?this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2:this.setScaleSize(),this.buildYLabels()},buildYLabels:function(){this.yLabels=[];for(var t=f(this.stepValue),e=0;e<=this.steps;e++)this.yLabels.push(C(this.templateString,{value:(this.min+e*this.stepValue).toFixed(t)}))},getCircumference:function(){return 2*Math.PI/this.valuesCount},setScaleSize:function(){var t,e,n,i,a,s,o,l,r,d,c,u,g=v([this.height/2-this.pointLabelFontSize-5,this.width/2]),h=this.width,m=0;for(this.ctx.font=W(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily),e=0;e<this.valuesCount;e++)t=this.getPointPosition(e,g),n=this.ctx.measureText(C(this.templateString,{value:this.labels[e]})).width+5,0===e||e===this.valuesCount/2?(i=n/2,t.x+i>h&&(h=t.x+i,a=e),t.x-i<m&&(m=t.x-i,o=e)):e<this.valuesCount/2?t.x+n>h&&(h=t.x+n,a=e):e>this.valuesCount/2&&t.x-n<m&&(m=t.x-n,o=e);r=m,d=Math.ceil(h-this.width),s=this.getIndexAngle(a),l=this.getIndexAngle(o),c=d/Math.sin(s+Math.PI/2),u=r/Math.sin(l+Math.PI/2),c=p(c)?c:0,u=p(u)?u:0,this.drawingArea=g-(u+c)/2,this.setCenterPoint(u,c)},setCenterPoint:function(t,e){var n=this.width-e-this.drawingArea,i=t+this.drawingArea;this.xCenter=(i+n)/2,this.yCenter=this.height/2},getIndexAngle:function(t){var e=2*Math.PI/this.valuesCount;return t*e-Math.PI/2},getPointPosition:function(t,e){var n=this.getIndexAngle(t);return{x:Math.cos(n)*e+this.xCenter,y:Math.sin(n)*e+this.yCenter}},draw:function(){if(this.display){var t=this.ctx;if(a(this.yLabels,function(e,n){if(n>0){var i,a=n*(this.drawingArea/this.steps),s=this.yCenter-a;if(this.lineWidth>0)if(t.strokeStyle=this.lineColor,t.lineWidth=this.lineWidth,this.lineArc)t.beginPath(),t.arc(this.xCenter,this.yCenter,a,0,2*Math.PI),t.closePath(),t.stroke();else{t.beginPath();for(var o=0;o<this.valuesCount;o++)i=this.getPointPosition(o,this.calculateCenterOffset(this.min+n*this.stepValue)),0===o?t.moveTo(i.x,i.y):t.lineTo(i.x,i.y);t.closePath(),t.stroke()}if(this.showLabels){if(t.font=W(this.fontSize,this.fontStyle,this.fontFamily),this.showLabelBackdrop){var l=t.measureText(e).width;t.fillStyle=this.backdropColor,t.fillRect(this.xCenter-l/2-this.backdropPaddingX,s-this.fontSize/2-this.backdropPaddingY,l+2*this.backdropPaddingX,this.fontSize+2*this.backdropPaddingY)}t.textAlign="center",t.textBaseline="middle",t.fillStyle=this.fontColor,t.fillText(e,this.xCenter,s)}}},this),!this.lineArc){t.lineWidth=this.angleLineWidth,t.strokeStyle=this.angleLineColor;for(var e=this.valuesCount-1;e>=0;e--){if(this.angleLineWidth>0){var n=this.getPointPosition(e,this.calculateCenterOffset(this.max));t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(n.x,n.y),t.stroke(),t.closePath()}var i=this.getPointPosition(e,this.calculateCenterOffset(this.max)+5);t.font=W(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily),t.fillStyle=this.pointLabelFontColor;var s=this.labels.length,o=this.labels.length/2,l=o/2,r=l>e||e>s-l,d=e===l||e===s-l;t.textAlign=0===e?"center":e===o?"center":o>e?"left":"right",t.textBaseline=d?"middle":r?"bottom":"top",t.fillText(this.labels[e],i.x,i.y)}}}}}),i.addEvent(window,"resize",function(){var t;return function(){clearTimeout(t),t=setTimeout(function(){a(n.instances,function(t){t.options.responsive&&t.resize(t.render,!0)})},50)}}()),h?define(function(){return n}):"object"==typeof module&&module.exports&&(module.exports=n),t.Chart=n,n.noConflict=function(){return t.Chart=e,n}}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers,i={scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>',showXLabels:!0};e.Type.extend({name:"Bar",defaults:i,initialize:function(t){var i=this.options;this.ScaleClass=e.Scale.extend({offsetGridLines:!0,calculateBarX:function(t,e,n){var a=this.calculateBaseWidth(),s=this.calculateX(n)-a/2,o=this.calculateBarWidth(t);return s+o*e+e*i.barDatasetSpacing+o/2},calculateBaseWidth:function(){return this.calculateX(1)-this.calculateX(0)-2*i.barValueSpacing},calculateBarWidth:function(t){var e=this.calculateBaseWidth()-(t-1)*i.barDatasetSpacing;return e/t}}),this.datasets=[],this.options.showTooltips&&n.bindEvents(this,this.options.tooltipEvents,function(t){var e="mouseout"!==t.type?this.getBarsAtEvent(t):[];this.eachBars(function(t){t.restore(["fillColor","strokeColor"])}),n.each(e,function(t){t.fillColor=t.highlightFill,t.strokeColor=t.highlightStroke}),this.showTooltip(e)}),this.BarClass=e.Rectangle.extend({strokeWidth:this.options.barStrokeWidth,showStroke:this.options.barShowStroke,ctx:this.chart.ctx}),n.each(t.datasets,function(e){var i={label:e.label||null,fillColor:e.fillColor,strokeColor:e.strokeColor,bars:[]};this.datasets.push(i),n.each(e.data,function(n,a){i.bars.push(new this.BarClass({value:n,label:t.labels[a],datasetLabel:e.label,strokeColor:e.strokeColor,fillColor:e.fillColor,highlightFill:e.highlightFill||e.fillColor,highlightStroke:e.highlightStroke||e.strokeColor}))},this)},this),this.buildScale(t.labels),this.BarClass.prototype.base=this.scale.endPoint,this.eachBars(function(t,e,i){n.extend(t,{width:this.scale.calculateBarWidth(this.datasets.length),x:this.scale.calculateBarX(this.datasets.length,i,e),y:this.scale.endPoint}),t.save()},this),this.render()},update:function(){this.scale.update(),n.each(this.activeElements,function(t){t.restore(["fillColor","strokeColor"])}),this.eachBars(function(t){t.save()}),this.render()},eachBars:function(t){n.each(this.datasets,function(e,i){n.each(e.bars,t,this,i)},this)},getBarsAtEvent:function(t){for(var e,i=[],a=n.getRelativePosition(t),s=function(t){i.push(t.bars[e])},o=0;o<this.datasets.length;o++)for(e=0;e<this.datasets[o].bars.length;e++)if(this.datasets[o].bars[e].inRange(a.x,a.y))return n.each(this.datasets,s),i;return i},buildScale:function(t){var e=this,i=function(){var t=[];return e.eachBars(function(e){t.push(e.value)}),t},a={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:t.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,calculateYRange:function(t){var e=n.calculateScaleRange(i(),t,this.fontSize,this.beginAtZero,this.integersOnly);n.extend(this,e)},xLabels:this.options.showXLabels?t:[],font:n.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,showHorizontalLines:this.options.scaleShowHorizontalLines,showVerticalLines:this.options.scaleShowVerticalLines,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.barShowStroke?this.options.barStrokeWidth:0,showLabels:this.options.scaleShowLabels,display:this.options.showScale};this.options.scaleOverride&&n.extend(a,{calculateYRange:n.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}),this.scale=new this.ScaleClass(a)},addData:function(t,e){n.each(t,function(t,n){this.datasets[n].bars.push(new this.BarClass({value:t,label:e,x:this.scale.calculateBarX(this.datasets.length,n,this.scale.valuesCount+1),y:this.scale.endPoint,width:this.scale.calculateBarWidth(this.datasets.length),base:this.scale.endPoint,strokeColor:this.datasets[n].strokeColor,fillColor:this.datasets[n].fillColor}))},this),this.scale.addXLabel(e),this.update()},removeData:function(){this.scale.removeXLabel(),n.each(this.datasets,function(t){t.bars.shift()},this),this.update()},reflow:function(){n.extend(this.BarClass.prototype,{y:this.scale.endPoint,base:this.scale.endPoint});var t=n.extend({height:this.chart.height,width:this.chart.width});this.scale.update(t)},draw:function(t){var e=t||1;this.clear(),this.chart.ctx,this.scale.draw(e),n.each(this.datasets,function(t,i){n.each(t.bars,function(t,n){t.hasValue()&&(t.base=this.scale.endPoint,t.transition({x:this.scale.calculateBarX(this.datasets.length,i,n),y:this.scale.calculateY(t.value),width:this.scale.calculateBarWidth(this.datasets.length)},e).draw())},this)},this)}})}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers,i={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:50,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>'};e.Type.extend({name:"Doughnut",defaults:i,initialize:function(t){this.segments=[],this.outerRadius=(n.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2,this.SegmentArc=e.Arc.extend({ctx:this.chart.ctx,x:this.chart.width/2,y:this.chart.height/2}),this.options.showTooltips&&n.bindEvents(this,this.options.tooltipEvents,function(t){var e="mouseout"!==t.type?this.getSegmentsAtEvent(t):[];n.each(this.segments,function(t){t.restore(["fillColor"])}),n.each(e,function(t){t.fillColor=t.highlightColor}),this.showTooltip(e)}),this.calculateTotal(t),n.each(t,function(e,n){e.color||(e.color="hsl("+360*n/t.length+", 100%, 50%)"),this.addData(e,n,!0)},this),this.render()},getSegmentsAtEvent:function(t){var e=[],i=n.getRelativePosition(t);return n.each(this.segments,function(t){t.inRange(i.x,i.y)&&e.push(t)},this),e},addData:function(t,e,n){var i=e||this.segments.length;this.segments.splice(i,0,new this.SegmentArc({value:t.value,outerRadius:this.options.animateScale?0:this.outerRadius,innerRadius:this.options.animateScale?0:this.outerRadius/100*this.options.percentageInnerCutout,fillColor:t.color,highlightColor:t.highlight||t.color,showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,startAngle:1.5*Math.PI,circumference:this.options.animateRotate?0:this.calculateCircumference(t.value),label:t.label})),n||(this.reflow(),this.update())},calculateCircumference:function(t){return 2*Math.PI*(Math.abs(t)/this.total)},calculateTotal:function(t){this.total=0,n.each(t,function(t){this.total+=Math.abs(t.value)},this)},update:function(){this.calculateTotal(this.segments),n.each(this.activeElements,function(t){t.restore(["fillColor"])}),n.each(this.segments,function(t){t.save()}),this.render()},removeData:function(t){var e=n.isNumber(t)?t:this.segments.length-1;this.segments.splice(e,1),this.reflow(),this.update()},reflow:function(){n.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2}),this.outerRadius=(n.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2,n.each(this.segments,function(t){t.update({outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout})},this)},draw:function(t){var e=t?t:1;this.clear(),n.each(this.segments,function(t,n){t.transition({circumference:this.calculateCircumference(t.value),outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout},e),t.endAngle=t.startAngle+t.circumference,t.draw(),0===n&&(t.startAngle=1.5*Math.PI),n<this.segments.length-1&&(this.segments[n+1].startAngle=t.endAngle)},this)}}),e.types.Doughnut.extend({name:"Pie",defaults:n.merge(i,{percentageInnerCutout:0})})}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers,i={scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,bezierCurve:!0,bezierCurveTension:.4,pointDot:!0,pointDotRadius:4,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>',showXLabels:!0};e.Type.extend({name:"Line",defaults:i,initialize:function(t){this.PointClass=e.Point.extend({strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx,inRange:function(t){return Math.pow(t-this.x,2)<Math.pow(this.radius+this.hitDetectionRadius,2)}}),this.datasets=[],this.options.showTooltips&&n.bindEvents(this,this.options.tooltipEvents,function(t){var e="mouseout"!==t.type?this.getPointsAtEvent(t):[];this.eachPoints(function(t){t.restore(["fillColor","strokeColor"])}),n.each(e,function(t){t.fillColor=t.highlightFill,t.strokeColor=t.highlightStroke}),this.showTooltip(e)}),n.each(t.datasets,function(e){var i={label:e.label||null,fillColor:e.fillColor,strokeColor:e.strokeColor,pointColor:e.pointColor,pointStrokeColor:e.pointStrokeColor,points:[]};this.datasets.push(i),n.each(e.data,function(n,a){i.points.push(new this.PointClass({value:n,label:t.labels[a],datasetLabel:e.label,strokeColor:e.pointStrokeColor,fillColor:e.pointColor,highlightFill:e.pointHighlightFill||e.pointColor,highlightStroke:e.pointHighlightStroke||e.pointStrokeColor}))},this),this.buildScale(t.labels),this.eachPoints(function(t,e){n.extend(t,{x:this.scale.calculateX(e),y:this.scale.endPoint}),t.save()},this)},this),this.render()},update:function(){this.scale.update(),n.each(this.activeElements,function(t){t.restore(["fillColor","strokeColor"])}),this.eachPoints(function(t){t.save()}),this.render()},eachPoints:function(t){n.each(this.datasets,function(e){n.each(e.points,t,this)},this)},getPointsAtEvent:function(t){var e=[],i=n.getRelativePosition(t);return n.each(this.datasets,function(t){n.each(t.points,function(t){t.inRange(i.x,i.y)&&e.push(t)})},this),e},buildScale:function(t){var i=this,a=function(){var t=[];return i.eachPoints(function(e){t.push(e.value)}),t},s={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:t.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,calculateYRange:function(t){var e=n.calculateScaleRange(a(),t,this.fontSize,this.beginAtZero,this.integersOnly);n.extend(this,e)},xLabels:this.options.showXLabels?t:[],font:n.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,showHorizontalLines:this.options.scaleShowHorizontalLines,showVerticalLines:this.options.scaleShowVerticalLines,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.pointDotRadius+this.options.pointDotStrokeWidth,showLabels:this.options.scaleShowLabels,display:this.options.showScale};this.options.scaleOverride&&n.extend(s,{calculateYRange:n.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}),this.scale=new e.Scale(s)},addData:function(t,e){n.each(t,function(t,n){this.datasets[n].points.push(new this.PointClass({value:t,label:e,x:this.scale.calculateX(this.scale.valuesCount+1),y:this.scale.endPoint,strokeColor:this.datasets[n].pointStrokeColor,fillColor:this.datasets[n].pointColor}))},this),this.scale.addXLabel(e),this.update()},removeData:function(){this.scale.removeXLabel(),n.each(this.datasets,function(t){t.points.shift()},this),this.update()},reflow:function(){var t=n.extend({height:this.chart.height,width:this.chart.width});this.scale.update(t)},draw:function(t){var e=t||1;this.clear();var i=this.chart.ctx,a=function(t){return null!==t.value},s=function(t,e,i){return n.findNextWhere(e,a,i)||t},o=function(t,e,i){return n.findPreviousWhere(e,a,i)||t};this.scale.draw(e),n.each(this.datasets,function(t){var l=n.where(t.points,a);n.each(t.points,function(t,n){t.hasValue()&&t.transition({y:this.scale.calculateY(t.value),x:this.scale.calculateX(n)},e)},this),this.options.bezierCurve&&n.each(l,function(t,e){var i=e>0&&e<l.length-1?this.options.bezierCurveTension:0;t.controlPoints=n.splineCurve(o(t,l,e),t,s(t,l,e),i),t.controlPoints.outer.y>this.scale.endPoint?t.controlPoints.outer.y=this.scale.endPoint:t.controlPoints.outer.y<this.scale.startPoint&&(t.controlPoints.outer.y=this.scale.startPoint),t.controlPoints.inner.y>this.scale.endPoint?t.controlPoints.inner.y=this.scale.endPoint:t.controlPoints.inner.y<this.scale.startPoint&&(t.controlPoints.inner.y=this.scale.startPoint)},this),i.lineWidth=this.options.datasetStrokeWidth,i.strokeStyle=t.strokeColor,i.beginPath(),n.each(l,function(t,e){if(0===e)i.moveTo(t.x,t.y);else if(this.options.bezierCurve){var n=o(t,l,e);i.bezierCurveTo(n.controlPoints.outer.x,n.controlPoints.outer.y,t.controlPoints.inner.x,t.controlPoints.inner.y,t.x,t.y)}else i.lineTo(t.x,t.y)},this),i.stroke(),this.options.datasetFill&&l.length>0&&(i.lineTo(l[l.length-1].x,this.scale.endPoint),i.lineTo(l[0].x,this.scale.endPoint),i.fillStyle=t.fillColor,i.closePath(),i.fill()),n.each(l,function(t){t.draw()})},this)}})}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers,i={scaleShowLabelBackdrop:!0,scaleBackdropColor:"rgba(255,255,255,0.75)",scaleBeginAtZero:!0,scaleBackdropPaddingY:2,scaleBackdropPaddingX:2,scaleShowLine:!0,segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>'};e.Type.extend({name:"PolarArea",defaults:i,initialize:function(t){this.segments=[],this.SegmentArc=e.Arc.extend({showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,ctx:this.chart.ctx,innerRadius:0,x:this.chart.width/2,y:this.chart.height/2}),this.scale=new e.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:this.options.scaleShowLine?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,lineArc:!0,width:this.chart.width,height:this.chart.height,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,valuesCount:t.length}),this.updateScaleRange(t),this.scale.update(),n.each(t,function(t,e){this.addData(t,e,!0)},this),this.options.showTooltips&&n.bindEvents(this,this.options.tooltipEvents,function(t){var e="mouseout"!==t.type?this.getSegmentsAtEvent(t):[];n.each(this.segments,function(t){t.restore(["fillColor"])}),n.each(e,function(t){t.fillColor=t.highlightColor}),this.showTooltip(e)}),this.render()},getSegmentsAtEvent:function(t){var e=[],i=n.getRelativePosition(t);return n.each(this.segments,function(t){t.inRange(i.x,i.y)&&e.push(t)},this),e},addData:function(t,e,n){var i=e||this.segments.length;this.segments.splice(i,0,new this.SegmentArc({fillColor:t.color,highlightColor:t.highlight||t.color,label:t.label,value:t.value,outerRadius:this.options.animateScale?0:this.scale.calculateCenterOffset(t.value),circumference:this.options.animateRotate?0:this.scale.getCircumference(),startAngle:1.5*Math.PI})),n||(this.reflow(),this.update())},removeData:function(t){var e=n.isNumber(t)?t:this.segments.length-1;this.segments.splice(e,1),this.reflow(),this.update()},calculateTotal:function(t){this.total=0,n.each(t,function(t){this.total+=t.value},this),this.scale.valuesCount=this.segments.length},updateScaleRange:function(t){var e=[];n.each(t,function(t){e.push(t.value)});var i=this.options.scaleOverride?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}:n.calculateScaleRange(e,n.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);n.extend(this.scale,i,{size:n.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2})},update:function(){this.calculateTotal(this.segments),n.each(this.segments,function(t){t.save()}),this.reflow(),this.render()},reflow:function(){n.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2}),this.updateScaleRange(this.segments),this.scale.update(),n.extend(this.scale,{xCenter:this.chart.width/2,yCenter:this.chart.height/2}),n.each(this.segments,function(t){t.update({outerRadius:this.scale.calculateCenterOffset(t.value)})},this)},draw:function(t){var e=t||1;this.clear(),n.each(this.segments,function(t,n){t.transition({circumference:this.scale.getCircumference(),outerRadius:this.scale.calculateCenterOffset(t.value)},e),t.endAngle=t.startAngle+t.circumference,0===n&&(t.startAngle=1.5*Math.PI),n<this.segments.length-1&&(this.segments[n+1].startAngle=t.endAngle),t.draw()},this),this.scale.draw()}})}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers;e.Type.extend({name:"Radar",defaults:{scaleShowLine:!0,angleShowLineOut:!0,scaleShowLabels:!1,scaleBeginAtZero:!0,angleLineColor:"rgba(0,0,0,.1)",angleLineWidth:1,pointLabelFontFamily:"'Arial'",pointLabelFontStyle:"normal",pointLabelFontSize:10,pointLabelFontColor:"#666",pointDot:!0,pointDotRadius:3,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'},initialize:function(t){this.PointClass=e.Point.extend({strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx}),this.datasets=[],this.buildScale(t),this.options.showTooltips&&n.bindEvents(this,this.options.tooltipEvents,function(t){var e="mouseout"!==t.type?this.getPointsAtEvent(t):[];this.eachPoints(function(t){t.restore(["fillColor","strokeColor"])}),n.each(e,function(t){t.fillColor=t.highlightFill,t.strokeColor=t.highlightStroke}),this.showTooltip(e)}),n.each(t.datasets,function(e){var i={label:e.label||null,fillColor:e.fillColor,strokeColor:e.strokeColor,pointColor:e.pointColor,pointStrokeColor:e.pointStrokeColor,points:[]};this.datasets.push(i),n.each(e.data,function(n,a){var s;this.scale.animation||(s=this.scale.getPointPosition(a,this.scale.calculateCenterOffset(n))),i.points.push(new this.PointClass({value:n,label:t.labels[a],datasetLabel:e.label,x:this.options.animation?this.scale.xCenter:s.x,y:this.options.animation?this.scale.yCenter:s.y,strokeColor:e.pointStrokeColor,fillColor:e.pointColor,highlightFill:e.pointHighlightFill||e.pointColor,highlightStroke:e.pointHighlightStroke||e.pointStrokeColor}))},this)},this),this.render()},eachPoints:function(t){n.each(this.datasets,function(e){n.each(e.points,t,this)},this)},getPointsAtEvent:function(t){var e=n.getRelativePosition(t),i=n.getAngleFromPoint({x:this.scale.xCenter,y:this.scale.yCenter},e),a=2*Math.PI/this.scale.valuesCount,s=Math.round((i.angle-1.5*Math.PI)/a),o=[];return(s>=this.scale.valuesCount||0>s)&&(s=0),i.distance<=this.scale.drawingArea&&n.each(this.datasets,function(t){o.push(t.points[s])}),o},buildScale:function(t){this.scale=new e.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:this.options.scaleShowLine?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,angleLineColor:this.options.angleLineColor,angleLineWidth:this.options.angleShowLineOut?this.options.angleLineWidth:0,pointLabelFontColor:this.options.pointLabelFontColor,pointLabelFontSize:this.options.pointLabelFontSize,pointLabelFontFamily:this.options.pointLabelFontFamily,pointLabelFontStyle:this.options.pointLabelFontStyle,height:this.chart.height,width:this.chart.width,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,labels:t.labels,valuesCount:t.datasets[0].data.length}),this.scale.setScaleSize(),this.updateScaleRange(t.datasets),this.scale.buildYLabels()},updateScaleRange:function(t){var e=function(){var e=[];return n.each(t,function(t){t.data?e=e.concat(t.data):n.each(t.points,function(t){e.push(t.value)})}),e}(),i=this.options.scaleOverride?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}:n.calculateScaleRange(e,n.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);
n.extend(this.scale,i)},addData:function(t,e){this.scale.valuesCount++,n.each(t,function(t,n){var i=this.scale.getPointPosition(this.scale.valuesCount,this.scale.calculateCenterOffset(t));this.datasets[n].points.push(new this.PointClass({value:t,label:e,x:i.x,y:i.y,strokeColor:this.datasets[n].pointStrokeColor,fillColor:this.datasets[n].pointColor}))},this),this.scale.labels.push(e),this.reflow(),this.update()},removeData:function(){this.scale.valuesCount--,this.scale.labels.shift(),n.each(this.datasets,function(t){t.points.shift()},this),this.reflow(),this.update()},update:function(){this.eachPoints(function(t){t.save()}),this.reflow(),this.render()},reflow:function(){n.extend(this.scale,{width:this.chart.width,height:this.chart.height,size:n.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2}),this.updateScaleRange(this.datasets),this.scale.setScaleSize(),this.scale.buildYLabels()},draw:function(t){var e=t||1,i=this.chart.ctx;this.clear(),this.scale.draw(),n.each(this.datasets,function(t){n.each(t.points,function(t,n){t.hasValue()&&t.transition(this.scale.getPointPosition(n,this.scale.calculateCenterOffset(t.value)),e)},this),i.lineWidth=this.options.datasetStrokeWidth,i.strokeStyle=t.strokeColor,i.beginPath(),n.each(t.points,function(t,e){0===e?i.moveTo(t.x,t.y):i.lineTo(t.x,t.y)},this),i.closePath(),i.stroke(),i.fillStyle=t.fillColor,i.fill(),n.each(t.points,function(t){t.hasValue()&&t.draw()})},this)}})}.call(this);