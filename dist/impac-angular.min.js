!function(){"use strict";angular.module("maestrano.impac",["impac.config","impac.services","impac.filters","impac.components","ui.sortable","ui.bootstrap"]),angular.module("impac.components",["impac.components.dashboard","impac.components.chart","impac.components.widget","impac.components.widgets","impac.components.widgets-settings","impac.components.widgets-common","impac.components.templates"]),angular.module("impac.components.widgets",["impac.components.widgets.catalogue","impac.components.widgets.template-admin","impac.components.widgets.accounts-accounting-values","impac.components.widgets.accounts-assets-summary","impac.components.widgets.accounts-balance-sheet","impac.components.widgets.accounts-balance","impac.components.widgets.accounts-cash-summary","impac.components.widgets.accounts-comparison","impac.components.widgets.accounts-custom-calculation","impac.components.widgets.accounts-expenses-revenue","impac.components.widgets.accounts-payable-receivable","impac.components.widgets.accounts-profit-and-loss","impac.components.widgets.hr-employee-details","impac.components.widgets.hr-employees-list","impac.components.widgets.hr-leaves-balance","impac.components.widgets.hr-leaves-schedule","impac.components.widgets.hr-payroll-summary","impac.components.widgets.hr-payroll-taxes","impac.components.widgets.hr-salaries-summary","impac.components.widgets.hr-superannuation-accruals","impac.components.widgets.hr-timesheets","impac.components.widgets.hr-workforce-summary","impac.components.widgets.invoices-aged-payables-receivables","impac.components.widgets.invoices-list","impac.components.widgets.invoices-summary","impac.components.widgets.sales-aged","impac.components.widgets.sales-break-even","impac.components.widgets.sales-comparison","impac.components.widgets.sales-customer-details","impac.components.widgets.sales-cycle","impac.components.widgets.sales-forecast","impac.components.widgets.sales-growth","impac.components.widgets.sales-leads-funnel","impac.components.widgets.sales-leads-list","impac.components.widgets.sales-list","impac.components.widgets.sales-margin","impac.components.widgets.sales-number-of-leads","impac.components.widgets.sales-opportunities-funnel","impac.components.widgets.sales-performance","impac.components.widgets.sales-segmented-turnover","impac.components.widgets.sales-summary","impac.components.widgets.sales-top-opportunities"]),angular.module("impac.components.widgets-settings",["impac.components.widgets-settings.account","impac.components.widgets-settings.accounts-list","impac.components.widgets-settings.chart-filters","impac.components.widgets-settings.formula","impac.components.widgets-settings.hist-mode","impac.components.widgets-settings.organizations","impac.components.widgets-settings.param-selector","impac.components.widgets-settings.params-picker","impac.components.widgets-settings.time-range","impac.components.widgets-settings.width"]),angular.module("impac.components.widgets-common",["impac.components.widgets-common.top-buttons","impac.components.widgets-common.data-not-found","impac.components.widgets-common.editable-title"]),angular.module("impac.filters",[]),angular.module("impac.services",["impac.services.routes","impac.services.linking","impac.services.theming","impac.services.assets","impac.services.analytics","impac.services.chart-formatter","impac.services.message-bus","impac.services.utilities","impac.services.widget-templates"]),angular.module("impac.config",[]).config(["$httpProvider",function(e){e.defaults.headers.common.Accept="application/json",e.defaults.headers.common["Content-Type"]="application/json"}]),angular.module("impac.components.templates",[]).run(["$templateCache",function(e){e.put("chart/chart.tmpl.html",'<canvas ng-hide="isExternalTemplate()" id="myChart"></canvas>'),e.put("dashboard/create.modal.html",'<div class="modal-header">\n  <div class="close" type="button" ng-click="close()" >×</div>\n  <h3>Create New Dashboard</h3>\n</div>\n\n<div class="modal-body">\n  <div class="row">\n    <div class="col-sm-12">\n      <div class="alert alert-error" ng-show="errors">\n        <button class="close" ng-click="errors=\'\'">×</button>\n        <ul>\n          <li ng-repeat="error in errors">{{error}}</li>\n        </ul>\n      </div>\n    </div>\n  </div>\n  \n  <!-- Create a new dashboard -->\n  <div class="row dashboard-form">\n    <div class="col-sm-10 col-sm-offset-1">\n      <form class="form-horizontal" role="form">\n        <div class="form-group">\n          <label class="col-sm-2 control-label">Name</label>\n          <div class="col-sm-10">\n            <input type=\'text\' class="form-control" ng-model="model.name" placeholder="E.g: Cash Accounts Monitoring" required>\n          </div>\n        </div>\n    \n        <div class="form-group" ng-show="isMultiCompanyAvailable()">\n          <label class="col-sm-2 control-label">Type</label>\n          <div class="col-sm-10">\n            <div class="btn-group" role="group">\n              <button type="button" ng-click="selectMode(\'single\')" ng-class="btnBlassFor(\'single\')">Current Company</button>\n              <button type="button" ng-click="selectMode(\'multi\')" ng-class="btnBlassFor(\'multi\')">Multi Company</button>\n            </div>\n          </div>\n        </div>\n        \n        <!-- Single Company mode -->\n        <div class="form-group" ng-show="isCurrentOrganizationShown()">\n          <div ng-show="!canAccessAnalyticsForCurrentOrganization()" class="text-center text-purple">\n            <div class="spacer1"></div>\n            <p>\n              Oops! Only Admins and Super Admins can create dashboards for company {{currentOrganization.name}}.\n              <span ng-show="isMultiCompanyAvailable()">Please select a "Multi Company" dashboard to select data from other companies.</span>\n            </p>\n          </div>\n        </div>\n        \n        <!-- Multi Company mode -->\n        <div class="form-group" ng-show="isSelectOrganizationShown()">\n          <label class="col-sm-2 control-label">Companies</label>\n          <div class="col-sm-10">\n            <ul class="list-unstyled">\n              <li ng-repeat="organization in organizations" >\n                <input type="checkbox" ng-model="organization.$selected" ng-disabled="!canAccessAnalyticsData(organization)"> \n                {{organization.name}} \n                <span ng-show="organization.is_customer_account">(customer)</span>\n                <span ng-show="!canAccessAnalyticsData(organization)">\n                  <em><small>\n                    &nbsp;\n                    &nbsp;\n                    <i class="fa fa-exclamation-circle text-danger" tooltip="Only Admins and Super Admins can access analytics data for this company"></i>\n                  </small></em>\n                </span>\n              </li>\n            </ul>\n          </div>\n        </div>\n      </form>\n      \n      <!-- End row col -->\n    </div>\n    \n    <!-- End Dashboard form -->\n  </div>\n  \n  \n  \n</div>\n\n<div class="modal-footer">\n  <div class="row">\n    <div class="col-sm-12">\n      <button class="btn btn-shaded" ng-click="close()" ng-hide="isLoading" ng-disabled="isLoading">Cancel</button>\n      <button class="btn btn-info" ng-click="proceed()" ng-hide="isLoading" ng-disabled="proceedDisabled()">Add</button>\n      <img ng-src="{{loadingGif}}" ng-show="isLoading" alt="Loading">\n    </div>\n  </div>\n</div>'),e.put("dashboard/dashboard.tmpl.html",'<!-- DASHBOARD -->\n<div class="analytics">\n  <div mno-star-wizard=true modal-open=\'starWizardModal.value\'></div>\n\n  <div class=\'row head-title\'>\n\n    <!-- Title and Dashboard selection -->\n    <div class="col-md-6 col-sm-12">\n\n      <h2>\n        <img ng-src="{{impacTitleLogo}}" style="float: left; margin-right: 15px;" />\n        <!-- <div class="text-info" style="padding-top:12px; height: 48px;">Beta</div> -->\n        <div class="text-info" style="padding-top:12px; height: 48px;"></div>\n      </h2>\n\n      <h4 ng-hide=\'showChooseDhbMsg\' class=\'dashboard-title\' ng-click="toogleShowDashboardsList()">\n        {{currentDhb.full_name}}\n        <i class="fa fa-chevron-down" style="font-size: 18px;"></i>\n        <i ng-hide="showChangeDhbName" class="fa fa-pencil" tooltip="Change name" tooltip-animation="false" ng-click="toogleShowChangeDhbName(currentDhb)"/>\n      </h4>\n\n      <div collapse="!showDashboardsList" class=\'dashboard-select\'>\n        <div ng-hide="dhb.id == currentDhbId" class=\'option\' ng-repeat="dhb in dashboardsList">\n          <span class="name" ng-click="selectDashboard(dhb.id)">{{dhb.full_name}}</span>\n          <i ng-hide="showChangeDhbName" class="fa fa-pencil" tooltip="Change name" tooltip-animation="false" ng-click="toogleShowChangeDhbName(dhb)"/>\n        </div>\n\n        <div ng-show="showCreateDhb" class="option create" ng-click="modal.createDashboard.open() ; showChangeDhbName = false"><i class="fa fa-plus" /> Create Dashboard</div>\n      </div>\n\n      <div ng-show="showChangeDhbName" class="change-name">\n        <p>Change dashboard name:</p>\n        <input type="text" class="form-control" id="changeDhbNameInput" ng-model="dashboardToChange.name" ng-keyup="checkChangeDhbNameAndConfirm($event)"/>\n        <button class="btn btn-sm btn-default" ng-click="showChangeDhbName=false">Cancel</button>\n        <button class="btn btn-sm btn-success" style="margin-left: 10px" ng-click="updateDhbName()">Confirm</button>\n      </div>\n\n\n      <p ng-hide=\'showChooseDhbMsg\' class="data-source-label">\n        <small><b>Source:</b> {{currentDhb.organizationsNames}}</small>\n      </p>\n\n    </div>\n\n    <!-- Buttons -->\n    <div class=\'col-md-6 buttons-bar col-sm-12\'>\n      <div class=\'actions-panel\'>\n        <button ng-click="showWidgetSelector = true" class=\'btn btn-warning\' ng-show="showCreateWidget" ng-disabled="showWidgetSelector"><span class=\'fa fa-plus\'></span> Add Widget</button>\n        <!-- <button ng-click="modal.createDashboard.open()" class=\'btn btn-warning\' ng-show="showCreateDhb"><span class=\'fa fa-pencil-square-o\'></span> Create Dashboard</button>\n        <button id=\'data-upload-wizard\' ng-click=\'openStarWizard()\' class=\'btn btn-success hidden-xs\' ><span class=\'fa fa-upload\'></span> Data Upload</button>\n        <button ng-click="modal.deleteDashboard.open()" class=\'btn btn-danger hidden-xs\' ng-show="showDeleteDhb" tooltip="Delete Dashboard"><span class=\'fa fa-trash-o\'></span> </button> -->\n      </div>\n    </div>\n\n  </div>\n\n\n  <!-- Widgets selection container -->\n  <div id="widget-selector" collapse="!showWidgetSelector">\n    <div class="title">\n      <i class="fa fa-times-circle" ng-click="showWidgetSelector = false"/>\n      <span class="badge confirmation">Widget added!</span>\n      Select the widgets you want to add to your dashboard.\n    </div>\n\n    <div class="row top-container">\n      <div class="col-md-3 categories">\n        <div class="row header">\n          All categories\n        </div>\n        <div class="row lines">\n          <div class="col-md-12" style="padding: 3px 12px;">\n            <p ng-click="selectedCategory=\'accounts\'" ng-class="isCategorySelected(\'accounts\') ? \'selected\' : none">Accounting</p>\n            <p ng-click="selectedCategory=\'invoices\'" ng-class="isCategorySelected(\'invoices\') ? \'selected\' : none">Invoicing</p>\n            <p ng-click="selectedCategory=\'hr\'" ng-class="isCategorySelected(\'hr\') ? \'selected\' : none">HR / Payroll</p>\n            <p ng-click="selectedCategory=\'sales\'" ng-class="isCategorySelected(\'sales\') ? \'selected\' : none">Sales</p>\n          </div>\n        </div>\n\n        <div class="arrow" ng-style="getSelectedCategoryTop()">\n          <div class="square" />\n          <i class="fa fa-caret-right" />\n        </div>\n\n      </div>\n\n      <div class="col-md-9 widgets">\n        <div class="row header">\n          {{getSelectedCategoryName() | titleize}}\n        </div>\n        <div class="row lines">\n          <div class="col-md-4" ng-repeat="widgetPattern in getWidgetsForSelectedCategory()" style="padding: 0px 8px;">\n            <p ng-click="addWidget(widgetPattern.path, widgetPattern.metadata)" tooltip="{{widgetPattern.desc}}" tooltip-placement="{{$index < 9 ? \'bottom\' : \'top\'}}" tooltip-animation="false"><i class="fa fa-{{widgetPattern.icon}}" /> {{widgetPattern.name}} <i class="fa fa-plus-circle" /></p>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class="bottom">\n      <span class="suggestion">\n        Can\'t find the widget you\'re looking for? <a ng-click="modal.widgetSuggestion.open()">Give us your suggestions here!</a>\n      </span>\n    </div>\n  </div>\n\n\n  <!-- Errors -->\n  <div class="alert alert-error" ng-show="errors">\n    <button class="close" ng-click="errors=\'\'">×</button>\n    <ul>\n      <li ng-repeat="error in errors">{{error}}</li>\n    </ul>\n  </div>\n\n  <div class=\'spacer1\'></div>\n\n  <div class="text-center impac-background ng-hide" ng-show=\'(showChooseDhbMsg || showNoWidgetsMsg) && !isLoading\'>\n\n    <img ng-src="{{impacDashboardBackground}}" class="bg">\n\n    <div class="impac-info-message">\n      <!-- First Time Dashboard Creation -->\n      <div class="ng-hide" ng-show=\'showChooseDhbMsg && !isLoading\'>\n        <div class=\'hidden-xs\'>\n          <div class=\'spacer4\'></div>\n          <div class="row">\n            <div class="col-md-8 col-md-offset-2">\n              <div class="testimonial promo-dark">\n                <p><b>It\'s time to add a reporting dashboard!</b></p><p>In 2 clicks, you\'ll be able to visualize how your business is performing.</p>\n              </div>\n            </div>\n          </div>\n          <div class=\'spacer2\'></div>\n        </div>\n        <div class="align-center">\n          <button ng-click="modal.createDashboard.open()" class=\'btn btn-lg btn-warning\'><span class=\'fa fa-plus\'></span> Create a Dashboard!</button>\n        </div>\n      </div>\n\n      <!-- Empty Dashboard -->\n      <div class="ng-hide" ng-show=\'showNoWidgetsMsg && !isLoading\'>\n        <div class=\'hidden-xs\'>\n          <div class=\'spacer4\'></div>\n          <div class="row">\n            <div class="col-md-8 col-md-offset-2">\n              <div class="testimonial promo-dark">\n                <p><b>Now it\'s time to select the metrics you want to see!</b></p><p>Add widgets to your dashboard to help make an Impac!™ to your business.</p>\n              </div>\n            </div>\n          </div>\n          <div class="spacer2"></div>\n        </div>\n        <div class="align-center">\n          <button ng-disabled="showWidgetSelector" ng-click="showWidgetSelector=true" class=\'btn btn-lg btn-warning\'><span class=\'fa fa-plus\'></span> Add a new Widget</button>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- First Time Dashboard Creation -->\n  <div class="row text-center" ng-show=\'showChooseDhbMsg && !isLoading\'>\n    <div class="spacer2 hidden-xs"></div>\n    <div class=\'col-md-8 col-md-offset-2\'>\n      <p class="text-muted"><small><em>Note: dashboards you create will only be accessible by you. Dashboard sharing across users will be added soon.</em></small></p>\n    </div>\n  </div>\n\n  <!-- Widgets -->\n  <div class=\'row\'>\n    <div ui:sortable="sortableOptions" ng-model="currentDhb.widgets" class="widgets-container">\n      <div impac-widget widget="widget" parent-dashboard="currentDhb" ng-repeat="widget in currentDhb.widgets" class="widget-item" ng-class="widget.getColClass()" />\n    </div>\n  </div>\n</div>\n\n<div class=\'clearfix\'></div>\n<div class=\'spacer2\'></div>\n'),e.put("dashboard/delete.modal.html",'<div class="modal-header">\n  <div class="close" type="button" ng-click="close()" >×</div>\n  <h3>Delete Dashboard</h3>\n</div>\n\n<div class="modal-body">\n  <div class="row">\n    <div class="col-sm-12">\n      <div class="alert alert-error" ng-show="errors">\n        <button class="close" ng-click="errors=\'\'">×</button>\n        <ul>\n          <li ng-repeat="error in errors">{{error}}</li>\n        </ul>\n      </div>\n    </div>\n  </div>\n\n  <!-- Create a new widget -->\n  <p>Are you sure you want to delete this analytics dashboard?</p>\n  \n</div>\n\n<div class="modal-footer">\n  <div class="row">\n    <div class="col-sm-12">\n      <button class="btn btn-shaded" ng-click="close()" ng-hide="isLoading" ng-disabled="isLoading">Cancel</button>\n      <button class="btn btn-danger" ng-click="proceed()" ng-hide="isLoading" ng-disabled="isLoading">Delete</button>\n      <img ng-src="{{loadingGif}}" ng-show="isLoading" alt="Loading">\n    </div>\n    \n  </div>\n</div>'),e.put("dashboard/widget-suggestion.modal.html",'<div class="modal-header">\n  <div class="close" type="button" ng-click="close()" >×</div>\n  <h3>Suggest a widget</h3>\n</div>\n\n<div class="modal-body">\n  \n  <div class="row">\n    <div class="col-md-6">\n      <label>What would you name your widget?</label><br />\n      <input type="text" ng-model="widgetDetails.name" ng-disabled="isLoading" />\n    </div>\n    <div class="col-md-6">\n      <label>In which category?</label><br />\n      <input type="text" ng-model="widgetDetails.category" ng-disabled="isLoading" />\n    </div>\n  </div>\n\n  <div class="spacer1" />\n\n  <div class="row">\n    <div class="col-md-12">\n      <label>What kind of information would your widget display?</label><br />\n      <textarea ng-model="widgetDetails.description" ng-disabled="isLoading" />\n    </div>\n  </div>\n\n  <div class="spacer1" ng-show="isLoading" />\n\n  <div class="row" ng-show="isLoading">\n    <div class="col-md-12 text-center">\n      <h3 class="thanks-message">{{userName | titleize}}, thanks a lot for helping us improve Impac!&trade;</h3>\n    </div>\n  </div>\n  \n</div>\n\n<div class="modal-footer">\n  <div class="row">\n    <div class="col-sm-12" ng-class="isLoading ? \'text-center\' : null">\n      <button class="btn btn-shaded" ng-click="close()" ng-hide="isLoading">Cancel</button>\n      <button class="btn btn-info" ng-click="proceed()" ng-hide="isLoading" ng-disabled="!(widgetDetails.name && widgetDetails.category && widgetDetails.description)">Send your suggestion</button>\n      <img ng-src="{{loadingGif}}" ng-show="isLoading" alt="Loading">\n    </div>\n  </div>\n</div>'),e.put("widgets/accounts-accounting-values-ebitda.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-accounts-accounting-value class="content">\n\n  <div ng-hide="widget.isLoading">\n    <div ng-show="widget.isEditMode" class="edit">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n      <div ng-show="isDataFound">\n        <div setting-hist-mode parent-widget= "widget" />\n\n        <div ng-hide="widget.isHistoryMode" class="current">\n          <div class="price">\n             {{ getCurrentPrice() | mnoCurrency : getCurrency() : false }}\n          </div>\n          <div class="currency">{{getCurrency()}}</div>\n          <div class="legend">{{getLegend()}}</div>\n        </div>\n\n        <!-- the display condition must be an "if" and its value must change for the chart to be drawn again -->\n        <div ng-if="widget.isHistoryMode" class="history">\n          <div dhb-chart data="widget.chart"></div>\n          <div class="legend">{{getLegend()}}</div>\n        </div>\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n  </div>\n\n  <div class="loader" align="center" ng-show="widget.isLoading">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n</div>\n'),e.put("widgets/accounts-cash-summary.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-accounts-cash-summary class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound" class="row" >\n        <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n          <div setting-width parent-widget="widget" min="6" max="12" class="settings width" />\n\n          <div class="widget-lines-container">\n            <div class="row widget-line header">\n              <div class="col-sm-1" />\n              <div class="col-sm-5"></div>\n              <div class="col-sm-3 text-right">{{getLastDate() | date : "d-MMM"}}</div>\n              <div class="col-sm-3 text-right">Variance</div>\n            </div>\n            <div class="row widget-line total" ng-repeat="statement in widget.content.summary" >\n              <div class="row widget-line" ng-class="isSelected(statement) ? \'selected\' : null" >\n                <div class="col-sm-1" ng-click="toogleCollapsed(statement)"><i class="fa" ng-class="isCollapsed(statement) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" /></div>\n                <div class="col-sm-5" ng-click="toogleSelectedElement(statement)"><strong>{{getName(statement) | titleize}}</strong></div>\n                <div class="col-sm-3 text-right" ng-click="toogleSelectedElement(statement)"><strong>{{getLastValue(statement) | mnoCurrency : statement.currency}}</strong></div>\n                <div class="col-sm-3 text-right" ng-click="toogleSelectedElement(statement)" ng-class="getVarianceClassColor(getLastVariance(statement))"><strong>{{getLastVariance(statement)}}</strong></div>\n              </div>\n              <div collapse="isCollapsed(statement)">\n                <div class="row widget-line" ng-click="toogleSelectedElement(account)" ng-repeat="account in statement.accounts" ng-class="isSelected(account) ? \'selected\' : null" >\n                  <div class="col-sm-1" />\n                  <div class="col-sm-5">{{account.name}}</div>\n                  <div class="col-sm-3 text-right">{{getLastValue(account) | mnoCurrency : account.currency }}</div>\n                  <div class="col-sm-3 text-right" ng-class="getVarianceClassColor(getLastVariance(account))">{{getLastVariance(account)}}</div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n          <h4>{{getName(selectedElement) | titleize}}</h4>\n          <div class="chart-container" ng-if="isDataFound && widget.isExpanded()">\n            <div dhb-chart data="widget.chart"></div>\n          </div>\n          <div class="legend">{{(widget.metadata.hist_parameters.period || "Monthly") | titleize}} Cash Flow</div>\n          <div class="widget-lines-container">\n            <div class="row widget-line">\n              <div class="col-sm-2 text-center" ng-repeat="date in dates" style="padding: 5px 0px;">\n                <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;">{{date | date : "d-MMM"}}</div></div>\n                <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;">{{selectedElement.cash_flows[$index] | mnoCurrency : selectedElement.currency }}</div></div>\n                <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;" ng-class="getVarianceClassColor(selectedElement.variances[$index])">{{formatVariance(selectedElement.variances[$index])}}</div></div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/accounts-balance.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-accounts-balance class="content">\n  <div ng-hide="widget.isLoading">\n    <div ng-show="widget.isEditMode" class="edit">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div ng-hide="!isDataFound" setting-account parent-widget="widget" class="part" />\n      <div ng-hide="!isDataFound" setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n      <div ng-show="isDataFound">\n        <div setting-hist-mode parent-widget="widget" />\n\n        <!-- the display condition must be an "if" and its value must change for the chart to be drawn again -->\n        <div ng-if="widget.isHistoryMode" class="history">\n          <div dhb-chart data="widget.chart"></div>\n          <div class="legend">{{getName()}}</div>\n        </div>\n\n        <div ng-hide="widget.isHistoryMode">\n          <h3>{{getName()}}</h3>\n          <div class="price">\n             {{ getCurrentBalance() | mnoCurrency : getCurrency() : false }}\n          </div>\n          <div class="currency">{{getCurrency()}}</div>\n        </div>\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found />\n    </div>\n  </div>\n\n  <div class="loader" align="center" ng-show="widget.isLoading">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n</div>'),e.put("widgets/accounts-assets-summary.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget"></div>\n  <div common-editable-title parent-widget="widget"></div>\n</div>\n\n<div widget-accounts-assets-summary class="content">\n  <div ng-hide="widget.isLoading">\n    <div ng-show="widget.isEditMode" class="edit">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n      <div ng-if="isDataFound" class="chart-container">\n        <div dhb-chart data="widget.chart"></div>\n        <div class="legend">\n          <span ng-repeat="valuePair in widget.content.summary">\n            <span style="font-weight: bold; color: {{getAccountColor(valuePair)}};">{{valuePair.label}}</span>: {{valuePair.total | mnoCurrency : getCurrency()}}\n            <br />\n          </span>\n        </div>\n      </div>\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n  </div>\n\n  <div ng-show="widget.isLoading" class="loader" align="center" >\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n</div>'),e.put("widgets/accounts-balance-sheet.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-accounts-balance-sheet class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound">\n\n        <div class="widget-lines-container">\n          <div class="row widget-line header">\n            <div class="col-sm-6 text-center">Compare with previous: <span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period"/></div>\n            <div class="col-sm-3 text-right">{{widget.content.dates[0] | date : "d-MMM"}}</div>\n            <div class="col-sm-3 text-right">{{widget.content.dates[1] | date : "d-MMM"}}</div>\n          </div>\n          <div class="row widget-line total" ng-repeat="category in categories" >\n            <div class="row widget-line" >\n              <div class="col-sm-1" ng-click="toogleCollapsed(category)" style="cursor: pointer;"><i class="fa" ng-class="isCollapsed(category) ? "fa-plus-square-o" : "fa-minus-square-o"" /></div>\n              <div class="col-sm-5"><strong>{{category | titleize}}</strong></div>\n              <div class="col-sm-3 text-right"><strong>{{widget.content.summary[category].totals[0] | mnoCurrency : widget.content.summary[category].currency}}</strong></div>\n              <div class="col-sm-3 text-right"><strong>{{widget.content.summary[category].totals[1] | mnoCurrency : widget.content.summary[category].currency}}</strong></div>\n            </div>\n            <div collapse="isCollapsed(category)">\n              <div class="row widget-line" ng-repeat="account in widget.content.summary[category].accounts" >\n                <div class="col-sm-1" />\n                <div class="col-sm-5">{{account.name | titleize}}</div>\n                <div class="col-sm-3 text-right">{{account.totals[0] | mnoCurrency : account.currency}}</div>\n                <div class="col-sm-3 text-right">{{account.totals[1] | mnoCurrency : account.currency}}</div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/accounts-comparison.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-accounts-comparison class="content">\n  <div setting-accounts-list parent-widget="widget" />\n\n  <div ng-hide="widget.isLoading">\n    <div ng-show="widget.isEditMode" class="edit">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound">\n        <div ng-hide="hasAccountsSelected()" class="row">\n          <h5>Select which accounts you wish to compare.</h5>\n          <div class="col-md-6">\n            <div class="input-group">\n              <select ng-model="movedAccount" ng-options="account.name + \' (\' + formatAmount(account) + \')\' for account in widget.remainingAccounts" class="form-control" ng-show="widget.hasEditAbility" ng-change="addAccount(movedAccount)"></select>\n            </div>\n          </div>\n        </div>\n\n        <div ng-if="hasAccountsSelected()">\n          <div class="row">\n            <div class="col-md-12 chart-container">\n              <div dhb-chart data="widget.chart" />\n            </div>\n          </div>\n\n          <div class="row">\n            <div class="col-md-12">\n              <div class="widget-lines-container">\n                <div class="widget-line" ng-repeat="account in widget.selectedAccounts">\n                  <button class="close" ng-click="removeAccount(account)" ng-show="widget.hasDeleteAbility">\n                    x\n                  </button>\n                  <i style="float: right; margin-right: 10px;">{{formatAmount(account)}}</i>\n                  <i class="fa fa-circle" style="margin: 0px 8px; color: {{getAccountColor(account)}}" />\n                  {{account.name}}\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div class="row">\n            <div class="border" />\n            <div class="add-account">\n              <div class="input-group">\n                <select ng-model="movedAccount" ng-options="account.name + \' (\' + formatAmount(account) + \')\' for account in widget.remainingAccounts track by account.uid" class="form-control" ng-show="widget.hasDeleteAbility" ng-change="addAccount(movedAccount)" ng-disabled="widget.selectedAccounts.length >= 15 || widget.remainingAccounts.length == 0">\n                  <option value="" disabled selected>+ ADD ACCOUNT</option>\n                </select>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n  </div>\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n</div>'),e.put("widgets/accounts-custom-calculation.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-accounts-custom-calculation class="content">\n  <div setting-organizations parent-widget="widget" ng-hide="true" />\n  <div setting-accounts-list parent-widget="widget" />\n  <div setting-formula parent-widget="widget" />\n\n  <div ng-hide="widget.isLoading">\n    <h3 ng-show="widget.hasEditAbility && !widget.isFormulaCorrect">\n      <a href="" ng-click="formulaModal.open()">Create a custom calculation</a>\n    </h3>\n\n    <div class="price" ng-show="widget.isFormulaCorrect">\n      {{widget.evaluatedFormula}}\n    </div>\n    <!-- Should be put in a tooltip/popover instead -->\n<!--     <div class="legend" ng-show="widget.isFormulaCorrect">\n      {{widget.legend}}\n    </div> -->\n  </div>\n\n  <div class="loader" align="center" ng-show="widget.isLoading">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n</div>'),e.put("widgets/accounts-custom-calculation/formula.modal.html",'<div class="modal-custom-calculation">\n  <div class="modal-header">\n    <div class="close" type="button" ng-click="formulaModal.cancel()" >×</div>\n    <h3>Custom Calculation</h3>\n  </div>\n\n  <div class="modal-body">\n    <div class="row">\n      <div class="col-sm-12">\n        <div class="alert alert-error" ng-show="formulaModal.errors">\n          <button class="close" ng-click="formulaModal.errors=\'\'">×</button>\n          <ul>\n            <li ng-repeat="error in formulaModal.errors">{{error}}</li>\n          </ul>\n        </div>\n      </div>\n    </div>\n\n    <!-- <div class=\'analytics\'>  -->\n      \n      <div class="edit">\n        <div setting-organizations parent-widget="widget" class="part" />\n      </div>\n\n      <p>Make a custom equation with your accounts, and save it as a widget. To create an equation, simply select your accounts in the list, and use the classical operators (example: ({1} + {2}) / {3})</p>\n\n      <div class=\'row\'>\n        <div ng-show="widget.isLoading" class=\'col-md-6 loader\' align="center">\n          Your data is being retrieved...\n          <img class="gif" ng-src="{{loaderImage}}"/>\n        </div>\n\n        <div ng-hide="widget.isLoading" class=\'col-md-6\'>\n          <div class=\'widget-line\' ng-repeat=\'account in widget.selectedAccounts\'>\n            <div class=\'row\'>\n              <div class=\'col-md-6\'>\n                {{$index+1}} - {{account.name}}\n              </div>\n              <div class=\'col-md-6\'>\n                {{account.current_balance | mnoCurrency : account.currency}}\n                <button class="close" ng-click="removeAccountFromFormula(account)" ng-show="widget.hasEditAbility"><span class=\'fa fa-times-circle\'></span></button>\n              </div>\n            </div>\n          </div>\n\n          <div class=\'input-group\' ng-show="widget.hasEditAbility">\n            <select ng-model="movedAccount" ng-options="account.name + \' (\' + widget.formatAmount(account) + \')\' for account in widget.remainingAccounts" class=\'form-control\' ng-change=\'addAccountToFormula(movedAccount)\'><select>\n          </div>\n        </div>\n        \n        <div class=\'col-md-6\'>\n          <p>Type your formula just below:</p>\n          <input class=\'form-control\' ng-model="widget.formula">\n\n          <p>Result: {{widget.evaluatedFormula}}</p>\n          <p>Legend: {{widget.legend}}</p>\n        </div>\n      </div>\n    <!-- </div> -->\n  </div>\n\n  <div class="modal-footer">\n    <div class="row">\n      <div class="col-sm-12">\n        <button class="btn btn-gray" ng-click="formulaModal.cancel()" ng-hide="widget.isLoading" ng-disabled="isLoading">Cancel</button>\n        <button class="btn btn-warning" ng-click="formulaModal.proceed()" ng-hide="widget.isLoading" ng-disabled=\'!widget.isFormulaCorrect || widget.isLoading\'>Save</button>\n        <img ng-src="{{loaderImage}}" ng-show="widget.isLoading" alt="Loading">\n      </div>\n      \n    </div>\n  </div>\n</div>'),e.put("widgets/accounts-expenses-revenue.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-accounts-expenses-revenue class="content">\n\n  <div ng-hide="widget.isLoading">\n    <div ng-show="widget.isEditMode" class="edit">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n      <div ng-show="isDataFound">\n        <div setting-hist-mode parent-widget="widget" />\n\n        <!-- the display condition must be an "if" and its value must change for the chart to be drawn again -->\n        <div ng-if="widget.isHistoryMode && !widget.isLoading">\n          <div dhb-chart data="widget.hist_chart"></div>\n          <div class="legend">\n            <span class="pink">Expenses</span> -\n            <span class="blue">Revenue</span>\n          </div>\n        </div>\n\n        <div ng-if="!widget.isHistoryMode && !widget.isLoading" class="chart-container">\n          <div dhb-chart data="widget.cur_chart"></div>\n          <div class="legend">\n            <span class="pink">Expenses: {{getCurrentExpenses() | mnoCurrency : getCurrency()}}</span>\n            </br>\n            <span class="blue">Revenue: {{getCurrentRevenue() | mnoCurrency : getCurrency()}}</span>\n          </div>\n        </div>\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n  </div>\n\n  <div class="loader" align="center" ng-show="widget.isLoading">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n</div>'),e.put("widgets/accounts-payable-receivable.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-accounts-payable-receivable class="content">\n\n  <div ng-hide="widget.isLoading">\n\n    <div ng-show="widget.isEditMode" class="edit">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n      <div ng-show="isDataFound">\n        <div setting-hist-mode parent-widget="widget" />\n\n        <!-- the display condition must be an "if" and its value must change for the chart to be drawn again -->\n        <div ng-if="widget.isHistoryMode">\n          <div dhb-chart data="widget.chart"></div>\n          <div class="legend">\n            <span class="pink">Payable</span> -\n            <span class="blue">Receivable</span>\n          </div>\n        </div>\n\n        <div ng-hide="widget.isHistoryMode">\n          <div class="receivable">\n            <h3>Accounts Receivable</h3>\n            <div class="price blue">\n               {{getCurrentReceivable() | mnoCurrency : getCurrency() : false}}\n            </div>\n            <div class="currency">{{getCurrency()}}</div>\n          </div>\n\n          <div class="payable">\n            <h3>Accounts Payable</h3>\n            <div class="price pink">\n              {{getCurrentPayable() | mnoCurrency : getCurrency() : false}}\n            </div>\n            <div class="currency">{{getCurrency()}}</div>\n          </div>\n        </div>\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n  </div>\n\n  <div class="loader" align="center" ng-show="widget.isLoading">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n</div>'),e.put("widgets/accounts-profit-and-loss.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-accounts-profit-and-loss class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound" class="row" >\n        <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n          <div setting-width parent-widget="widget" min="6" max="12" class="settings width" />\n\n          <div class="widget-lines-container">\n            <div class="row widget-line header">\n              <div class="col-sm-8">{{(widget.metadata.hist_parameters.period || "Monthly") | titleize}} Profit and Loss</div>\n              <div class="col-sm-4 text-right">{{getLastDate() | date : "d-MMM"}}</div>\n            </div>\n            <div class="row widget-line total" ng-repeat="statement in widget.content.summary" >\n              <div class="row widget-line" ng-class="isSelected(statement) ? \'selected\' : null" >\n                <div class="col-sm-1" ng-click="toogleCollapsed(statement)"><i ng-show="statement.accounts" class="fa" ng-class="isCollapsed(statement) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" /></div>\n                <div class="col-sm-7" ng-click="toogleSelectedElement(statement)"><strong>{{getName(statement) | titleize}}</strong></div>\n                <div class="col-sm-4 text-right" ng-class="getClassColor(getLastValue(statement))" ng-click="toogleSelectedElement(statement)"><strong>{{getLastValue(statement) | mnoCurrency : statement.currency}}</strong></div>\n              </div>\n              <div collapse="isCollapsed(statement)">\n                <div class="row widget-line" ng-click="toogleSelectedElement(account)" ng-repeat="account in statement.accounts" ng-class="isSelected(account) ? \'selected\' : null" >\n                  <div class="col-sm-1" />\n                  <div class="col-sm-7">{{account.name}}</div>\n                  <div class="col-sm-4 text-right" ng-class="getClassColor(getLastValue(account))">{{getLastValue(account) | mnoCurrency : account.currency}}</div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n          <h4>{{(widget.metadata.hist_parameters.period || "Monthly") | titleize}} Profit and Loss</h4>\n          <div ng-show="selectedElements.length < 2" class="legend">{{getName(selectedElements[0]) | titleize}}</div>\n\n          <div class="chart-container" ng-if="isDataFound && widget.isExpanded()">\n            <div dhb-chart data="widget.chart"></div>\n          </div>\n\n          <div ng-show="selectedElements.length < 2" class="widget-lines-container">\n            <div class="row widget-line">\n              <div class="col-sm-2 text-center" ng-repeat="date in dates" style="padding: 5px 0px;">\n                <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;">{{date | date : "d-MMM"}}</div></div>\n                <div class="row widget-line"><div class="col-sm-12" ng-class="getClassColor(selectedElements[0].totals[$index])" style="padding: 0px;">{{selectedElements[0].totals[$index] | mnoCurrency : selectedElements[0].currency}}</div></div>\n              </div>\n            </div>\n          </div>\n\n          <div ng-hide="selectedElements.length < 2" class="widget-lines-container">\n            <div class="widget-line" ng-repeat="element in selectedElements">\n              <i style="float: right; margin-right: 10px;" ng-class="getClassColor(getLastValue(element))">{{getLastValue(element) | mnoCurrency : element.currency}}</i>\n              <i class="fa fa-circle" style="margin: 0px 8px; color: {{getElementChartColor($index)}}" />\n              {{getName(element) | titleize}}\n            </div>\n          </div>\n\n        </div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/catalogue.tmpl.html",'<div class="row">\n  <div class="col-md-3 menu" ng-hide="menu.loading">\n    <div class="heading">\n      Impac!&trade; widgets catalogue\n    </div>\n    <accordion close-others="true">\n      <accordion-group ng-repeat="category in menu.categories" is-open="selected">\n        <accordion-heading ng-click="selected = !selected">\n          <div class="category" ng-class="selected ? \'selected\' : null">\n            {{category.name}}\n            <i ng-show="selected" class="fa fa-caret-down" style="float: right" />\n            <i ng-hide="selected" class="fa fa-caret-right" style="float: right" />\n          </div>\n        </accordion-heading>\n        <div class="widget-name" ng-repeat="widget in category.widgets" ng-click="show.get(widget.id)" ng-class="widget.id == show.widget.id ? \'selected\' : null">\n          {{widget.name}}\n          <i ng-show="widget.id == show.widget.id" class="fa fa-angle-double-right" style="float: right; margin-top: 3px;" />\n        </div>\n      </accordion-group>\n    </accordion>\n  </div>\n  <div class="col-md-3" ng-show="menu.loading"><img class="gif" ng-src="{{loaderImage}}"/></div>\n\n  <div class="col-md-9 content" ng-style="{\'border-color\' : show.color}">\n\n    <div class="row header" ng-show="show.widget && !show.loading">\n      <div class="col-xs-2 heading" ng-style="{\'background-color\' : show.color, \'border-color\' : show.color}">\n        {{show.widget.category}}\n      </div>\n      <div class="col-xs-1 triangle-topleft" ng-style="{\'border-top-color\' : show.color}"></div>\n      <span class="red" ng-hide="show.widget.active">Inactive (displayed only to admins)</span>\n    </div>\n\n    <div class="row title center" ng-show="show.widget && !show.loading">\n      <h2>{{show.widget.name}}</h2>\n    </div>\n\n    <div class="row fields-container" ng-show="show.widget && !show.loading">\n\n      <div class="col-md-6">\n        <div class="left-panel">\n          <div class="heading" ng-style="{\'background-color\' : show.color}">\n            Screenshot\n          </div>\n          <div class="field screenshot">\n            <img ng-src="{{show.widget.screenshot}}">\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel">\n\n        <div class="row">\n          <div class="heading" ng-style="{\'background-color\' : show.color}">\n            Description\n          </div>\n          <div class="field description">\n            <p ng-bind-html="show.widget.full_description" />\n          </div>\n        </div>\n\n        <div class="row">\n          <div class="heading" ng-style="{\'background-color\' : show.color}">\n            Settings\n          </div>\n          <div class="field settings">\n            <div class="setting" ng-class="show.widget.settings.length <= 3 ? \'col-md-12\' : \'col-md-6\'" ng-repeat="setting in show.widget.settings">\n              <i class="fa fa-cog" />\n              {{setting}}\n            </div>\n          </div>\n        </div>\n\n        <div class="row" ng-style="{\'border-color\' : show.color}">\n          <div class="heading" ng-style="{\'background-color\' : show.color}">\n            Compatible with...\n          </div>\n          <div class="field apps">\n            <div class="col-md-2 app" ng-repeat="app in show.widget.compatible_apps" style="padding: 0px;" >\n              <img ng-src="{{app.logo.logo.url}}" class="app-logo" tooltip="{{app.name}}" tooltip-placement="bottom" />\n            </div>\n          </div>\n        </div>\n\n      </div>\n    </div>\n\n    <div class="row no-widget center" ng-hide="show.widget || show.loading">\n      <h3>Please select a widget</h3>\n    </div>\n\n    <div class="row no-widget center" ng-show="show.loading || menu.loading">\n      <img class="gif" ng-src="{{loaderImage}}"/>\n    </div>\n\n    <div class="spacer1"></div>\n\n  </div>\n</div>\n\n<div class="spacer1" />\n\n<div class="row">\n  <a class="btn btn-primary" href="/impac_catalogue/" style="float: right;">\n    Download PDF Catalogue\n  </a>\n</div>'),e.put("widgets/hr-employee-details.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-hr-employee-details class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound" class="row" >\n\n        <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n          <div setting-width parent-widget="widget" min="3" max="6" class="settings width" />\n          <div setting-param-selector parent-widget="widget" param="employee_uid" options="employeesOptions" selected="selectedEmployee" class="row title" />\n\n          <div class="details-container">\n            <div class="row">\n              <div class="col-md-4"><label>Job Title</label></div>\n              <div class="col-md-8"><pre>{{getEmployee().job_title || "-" }}</pre></div>\n            </div>\n            <div class="row">\n              <div class="col-md-4"><label>Company</label></div>\n              <div class="col-md-8"><pre>{{getEmployee().company || getSingleCompanyName()}}</pre></div>\n            </div>\n            <div class="row">\n              <div class="col-md-4"><label>Phone</label></div>\n              <div class="col-md-8"><pre>{{getEmployee().phone || "-" }}</pre></div>\n            </div>\n            <div class="row">\n              <div class="col-md-4"><label>Email</label></div>\n              <div class="col-md-8"><pre>{{getEmployee().email || "-" }}</pre></div>\n            </div>\n            <div class="row">\n              <div class="col-md-4"><label>Date of birth</label></div>\n              <div class="col-md-8"><pre>{{getEmployee().dob || "-" }}</pre></div>\n            </div>\n            <div class="row">\n              <div class="col-md-4"><label>Gender</label></div>\n              <div class="col-md-8"><pre>{{getEmployee().gender || "-" }}</pre></div>\n            </div>\n          </div>\n        </div>\n\n        <div class="col-md-6 right-panel" ng-show="widget.isExpanded()">\n          <div class="legend">Salary calculation period: <span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period" /></div>\n          <div class="details-container">\n            <div class="row">\n              <div class="col-md-4"><label>Salary</label></div>\n              <div class="col-md-8"><pre>{{getEmployee().salary || "-" }}</pre></div>\n            </div>\n            <div class="row">\n              <div class="col-md-4"><label>Address</label></div>\n              <div class="col-md-8"><pre>{{formatAddress(getEmployee().address) || "-" }}</pre></div>\n            </div>\n            <div class="row">\n              <div class="col-md-4"><label>Job location</label></div>\n              <div class="col-md-8"><pre>{{getEmployee().location || "-" }}</pre></div>\n            </div>\n            <div class="row">\n              <div class="col-md-4"><label>Supervisor</label></div>\n              <div class="col-md-8"><pre>{{getEmployee().supervisor || "-" }}</pre></div>\n            </div>\n            <div class="row">\n              <div class="col-md-4"><label>Statuts</label></div>\n              <div class="col-md-8"><pre>{{getEmployee().employment_status || "-" }}</pre></div>\n            </div>\n            <div class="row">\n              <div class="col-md-4"><label>Note</label></div>\n              <div class="col-md-8"><pre>{{getEmployee().note || "-" }}</pre></div>\n            </div>\n          </div>\n        </div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/hr-employees-list.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-hr-employees-list class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound" >\n\n        <div class="legend">\n          <strong>{{widget.content.total.employees}}</strong> employee{{widget.content.total.employees > 1 ? "s" : null}} - Average salary rate (<span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period"/>): <strong>{{widget.content.total.average_rate | mnoCurrency : widget.content.total.currency}}</strong>\n        </div>\n\n        <div class="widget-lines-container">\n          <div class="row widget-line header">\n            <div class="col-sm-2">Company</div>\n            <div class="col-sm-3">Employee</div>\n            <div class="col-sm-2">Title</div>\n            <div class="col-sm-3">Phone</div>\n            <div class="col-sm-2">Salary</div>\n          </div>\n          <div class="row widget-line" ng-repeat="employee in widget.content.employees" >\n            <div class="col-sm-2">{{employee.company || getSingleCompanyName()}}</div>\n            <div class="col-sm-3">{{employee.lastname}} {{employee.firstname}}</div>\n            <div class="col-sm-2"><i>{{employee.job_title}}</i></div>\n            <div class="col-sm-3">{{employee.phone}}</div>\n            <div class="col-sm-2"><i>{{getEmployeeSalary(employee)}}</i></div>\n          </div>\n        </div>\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/hr-leaves-balance.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-hr-leaves-balance class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound" >\n\n        <div setting-param-selector parent-widget="widget" param="employee_id" options="employeesOptions" selected="selectedEmployee" class="currency" />\n\n        <div class="widget-lines-container">\n          <div class="widget-line">\n            <i style="float: right; margin-right: 10px;">{{getEmployee().total_leaves}} h</i>\n            Accrued\n          </div>\n          <div class="widget-line">\n            <i style="float: right; margin-right: 10px;">{{getEmployee().total_timeoff}} h</i>\n            Used\n          </div>\n        </div>\n\n        <h3>Leave Balance</h3>\n        <div class="price">{{(getEmployee().total_leaves - getEmployee().total_timeoff)}} hours</div>\n        <div class="legend">\n          <span>(from {{widget.content.dates[0] | date : "MMM-d"}} to {{widget.content.dates[widget.content.dates.length - 1] | date : "MMM-d"}})</span>\n        </div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/hr-leaves-schedule.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-hr-leaves-schedule class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound">\n\n        <div widget-component-calendar ng-model="eventSources"></div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/hr-payroll-summary.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-hr-payroll-summary class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound" class="row" >\n        <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n          <div setting-width parent-widget="widget" min="6" max="12" class="settings width" />\n\n          <div class="widget-lines-container">\n            <div class="row widget-line header">\n              <div class="col-sm-12">Payroll Summary - {{getPeriod()}}</div>\n            </div>\n            <div class="row widget-line total" ng-repeat="statement in widget.content.summary" >\n              <div class="row widget-line" ng-class="isSelected(statement) ? \'selected\' : null" >\n                <div class="col-sm-1" ng-click="toogleCollapsed(statement)"><i ng-show="statement.employees" class="fa" ng-class="isCollapsed(statement) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" /></div>\n                <div class="col-sm-7" ng-click="toogleSelectedElement(statement)"><strong>{{getName(statement) | titleize}}</strong></div>\n                <div class="col-sm-4 text-right" ng-click="toogleSelectedElement(statement)">\n                  <strong>{{getLastValue(statement) | mnoCurrency : statement.currency}}</strong>\n                </div>\n              </div>\n              <div collapse="isCollapsed(statement)">\n                <div class="row widget-line" ng-click="toogleSelectedElement(employee)" ng-repeat="employee in statement.employees" ng-class="isSelected(employee) ? \'selected\' : null" >\n                  <div class="col-sm-1" />\n                  <div class="col-sm-7">{{employee.name}}</div>\n                  <div class="col-sm-4 text-right">\n                    <span>{{getLastValue(employee) | mnoCurrency : employee.currency}}</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n          <h4>{{(widget.content.hist_parameters.period || "Monthly") | titleize}} Payroll Summary</h4>\n\n          <div setting-hist-mode parent-widget="widget" />\n\n          <div ng-show="selectedElements.length < 2" class="legend">{{getName(selectedElements[0]) | titleize}}</div>\n\n          <div class="chart-container" ng-if="isDataFound && widget.isExpanded()">\n            <div ng-if="widget.isHistoryMode" dhb-chart data="widget.hist_chart"></div>\n            <div ng-if="!widget.isHistoryMode" dhb-chart data="widget.cur_chart"></div>\n          </div>\n\n          <div ng-show="selectedElements.length < 2" class="widget-lines-container">\n            <div ng-show="getTrackedField()" class="legend">{{getTrackedField()}}</div>\n            <div class="row widget-line">\n              <div class="col-sm-2 text-center" ng-repeat="date in widget.content.dates" style="padding: 5px 0px;">\n                <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;">{{formatDate(date)}}</div></div>\n                <div class="row widget-line">\n                  <div class="col-sm-12" style="padding: 0px;">{{selectedElements[0].totals[$index] | mnoCurrency : selectedElements[0].currency }}</div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div ng-hide="selectedElements.length < 2" class="widget-lines-container">\n\n            <div ng-if="widget.isHistoryMode" class="widget-line header">\n              <span ng-show="getTrackedField()">{{getTrackedField()}} - </span>From {{widget.content.dates[0] | date : "MMM-d"}} to {{widget.content.dates[widget.content.dates.length - 1] | date : "MMM-d"}}\n            </div>\n            <div ng-if="!widget.isHistoryMode" class="widget-line header">\n              <span ng-show="getTrackedField()">{{getTrackedField()}} - </span>{{getPeriod()}}\n            </div>\n\n            <div class="widget-line" ng-repeat="element in selectedElements">\n              <i style="float: right; margin-right: 10px;">\n                <span ng-if="widget.isHistoryMode">{{getTotalSum(element) | mnoCurrency : element.currency}}</span>\n                <span ng-if="!widget.isHistoryMode">{{getLastValue(element) | mnoCurrency : element.currency}}</span>\n              </i>\n              <i class="fa fa-circle" style="margin: 0px 8px; color: {{getElementChartColor($index)}}" />\n              {{getName(element) | titleize}}\n            </div>\n\n          </div>\n\n        </div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/hr-payroll-taxes.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-hr-payroll-taxes class="content">\n\n  <div ng-hide="widget.isLoading">\n    <div ng-show="widget.isEditMode" class="edit">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n      <div ng-show="isDataFound">\n        <div setting-hist-mode parent-widget= "widget" />\n\n        <div ng-hide="widget.isHistoryMode" class="current">\n          <div class="price">{{getCurrentPrice() | mnoCurrency : getCurrency() : false}}</div>\n          <div class="currency">{{getCurrency()}}</div>\n          <div class="legend">Taxes upon workforce costs<br />{{getPeriod()}}</div>\n        </div>\n\n        <!-- the display condition must be an "if" and its value must change for the chart to be drawn again -->\n        <div ng-if="widget.isHistoryMode" class="history">\n          <div dhb-chart data="widget.chart"></div>\n          <div class="legend">Taxes upon workforce costs</div>\n        </div>\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n  </div>\n\n  <div class="loader" align="center" ng-show="widget.isLoading">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n</div>\n'),e.put("widgets/hr-salaries-summary.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-hr-salaries-summary class="content">\n\n  <div ng-hide="widget.isLoading">\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div align="center" ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound" class="row">\n        <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n          <div setting-width parent-widget="widget" min="3" max="6" class="settings width" />\n\n          <h3 class="left">Average Salary Rate</h3>\n          <div class="price">\n             {{widget.content.total.average_rate | mnoCurrency : widget.content.total.currency}}\n          </div>\n          <div class="currency" setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period"/>\n          <div class="legend">\n            <span>({{widget.content.total.employees}} employee{{widget.content.total.employees > 1 ? "s" : null}} with known salary)</span>\n          </div>\n        </div>\n\n        <div class="col-md-6 right-panel" ng-show="widget.isExpanded()">\n          <h3 class="right">Filter: <span setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter"/></h3>\n          <div class="chart-container" ng-if="isDataFound && widget.isExpanded()">\n            <div dhb-chart data="widget.chart"></div>\n          </div>\n          <div class="widget-lines-container">\n            <div class="widget-line" ng-repeat="data in widget.content.summary.data">\n              <i style="float: right; margin-right: 10px;"><b>{{data.value | mnoCurrency : widget.content.total.currency}} (av.)</b></i>\n              <i ng-hide="widget.content.summary.filter==\'age_range\'" class="fa fa-circle" style="margin: 0px 8px; color: {{getColorByIndex($index)}}" />\n              {{data.label}}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n\n  <div class="loader" align="center" ng-show="widget.isLoading">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n</div>'),e.put("widgets/hr-superannuation-accruals.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-hr-superannuation-accruals class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound" class="row" >\n\n        <div setting-param-selector parent-widget="widget" param="employee_id" options="employeesOptions" selected="selectedEmployee" class="currency" />\n\n        <h3>Superannuation Balance</h3>\n        <div class="price">{{getEmployee().total_super | mnoCurrency : getEmployee().currency}}</div>\n        <div class="legend">\n          <span>(from {{widget.content.dates[0] | date : \'MMM-d\'}} to {{widget.content.dates[widget.content.dates.length - 1] | date : \'MMM-d\'}})</span>\n        </div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/hr-timesheets.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-hr-timesheets class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound">\n\n        <div setting-param-selector parent-widget="widget" param="employee_id" options="employeesOptions" selected="selectedEmployee" class="currency" />\n\n        <div class="widget-lines-container">\n          <div class="row widget-line header">\n            <div class="col-sm-12">From {{widget.content.dates[0] | date : \'MMM-d\'}} to {{widget.content.dates[widget.content.dates.length - 1] | date : \'MMM-d\'}}</div>\n          </div>\n          <div class="row widget-line total" >\n            <div class="row widget-line" >\n              <div class="col-sm-1" ng-click="toogleCollapsed(\'total_time_worked\')" style="cursor: pointer;"><i class="fa" ng-class="isCollapsed(\'total_time_worked\') ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" /></div>\n              <div class="col-sm-7"><strong>Total Time Worked</strong></div>\n              <div class="col-sm-4 text-right"><strong>{{getEmployeeTimeWorked()}} h</strong></div>\n            </div>\n            <div collapse="isCollapsed(\'total_time_worked\')">\n              <div class="row widget-line">\n                <div class="col-sm-1" />\n                <div class="col-sm-11"><i>Activities detail not found</i></div>\n              </div>\n            </div>\n          </div>\n\n          <div class="row widget-line total" >\n            <div class="row widget-line" >\n              <div class="col-sm-1" ng-click="toogleCollapsed(\'total_time_of\')" style="cursor: pointer;"><i class="fa" ng-class="isCollapsed(\'total_time_of\') ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" /></div>\n              <div class="col-sm-7"><strong>Total Time Off</strong></div>\n              <div class="col-sm-4 text-right"><strong>{{getEmployeeTimeOff()}} h</strong></div>\n            </div>\n            <div collapse="isCollapsed(\'total_time_of\')">\n              <div class="row widget-line">\n                <div class="col-sm-1" />\n                <div class="col-sm-7">PTO</div>\n                <div class="col-sm-4 text-right">0 h</div>\n              </div>\n              <div class="row widget-line">\n                <div class="col-sm-1" />\n                <div class="col-sm-7">Vacation</div>\n                <div class="col-sm-4 text-right">0 h</div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/hr-workforce-summary.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-hr-workforce-summary class="content">\n\n  <div ng-hide="widget.isLoading">\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div align="center" ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound" class="row">\n        <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n          <div setting-width parent-widget="widget" min="3" max="6" class="settings width" />\n\n          <h3 class="left">Total Workforce</h3>\n          <div class="price">\n             {{getTotalWorkforce() | mnoCurrency : getCurrency()}}\n          </div>\n          <div class="currency" setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period"/>\n          <div class="legend">\n            <span>({{getNumberOfEmployees()}} employee{{getNumberOfEmployees() > 1 ? \'s\' : null}} with known salary)</span>\n          </div>\n        </div>\n\n        <div class="col-md-6 right-panel" ng-show="widget.isExpanded()">\n          <h3 class="right">Filter: <span setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter"/></h3>\n          <div class="chart-container" ng-if="isDataFound && widget.isExpanded()">\n            <div dhb-chart data="widget.chart"></div>\n          </div>\n          <div class="widget-lines-container">\n            <div class="widget-line" ng-repeat="data in widget.content.summary.data">\n              <i style="float: right; margin-right: 10px;"><b>{{((data.value / widget.content.total.amount)*100).toFixed()}}%</b></i>\n              <i class="fa fa-circle" style="margin: 0px 8px; color: {{getColorByIndex($index)}}" />\n              {{widget.content.summary.filter == "salary_range" ? formatSalaryRange(data) : data.label}}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n\n  <div class="loader" align="center" ng-show="widget.isLoading">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n</div>'),e.put("widgets/invoices-aged-payables-receivables.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-invoices-aged-payables-receivables class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound" class="row" >\n        <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n          <div setting-width parent-widget="widget" min="6" max="12" class="settings width" />\n\n          <div class="widget-lines-container">\n            <div class="row widget-line header">\n              <div class="col-sm-8">Aged Payables & Receivables</div>\n              <div class="col-sm-4 text-right">{{widget.content.dates[0] | date : \'MMM-d\'}} to {{widget.content.dates[widget.content.dates.length - 1] | date : \'MMM-d\'}}</div>\n            </div>\n\n            <!-- Payables -->\n            <div class="row widget-line total">\n              <div class="row widget-line" ng-class="isSelected(widget.content.payables) ? \'selected\' : null" >\n                <div class="col-sm-1" ng-click="toogleCollapsed(widget.content.payables)">\n                  <i ng-show="widget.content.payables.suppliers" class="fa" ng-class="isCollapsed(widget.content.payables) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" />\n                </div>\n                <div class="col-sm-7" ng-click="toogleSelectedElement(widget.content.payables)">\n                  <strong>Aged Payables</strong>\n                </div>\n                <div class="col-sm-4 text-right" ng-click="toogleSelectedElement(widget.content.payables)">\n                  <strong>{{getTotalSum(widget.content.payables) | mnoCurrency : widget.content.payables.currency}}</strong>\n                </div>\n              </div>\n              <div ng-hide="isCollapsed(widget.content.payables)">\n                <div class="row widget-line" ng-click="toogleSelectedElement(supplier)" ng-repeat="supplier in widget.content.payables.suppliers" ng-class="isSelected(supplier) ? \'selected\' : null" >\n                  <div class="col-sm-1" />\n                  <div class="col-sm-7">{{supplier.name}}</div>\n                  <div class="col-sm-4 text-right">\n                    <span>{{getTotalSum(supplier) | mnoCurrency : supplier.currency}}</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <!-- Receivables -->\n            <div class="row widget-line total">\n              <div class="row widget-line" ng-class="isSelected(widget.content.receivables) ? \'selected\' : null" >\n                <div class="col-sm-1" ng-click="toogleCollapsed(widget.content.receivables)">\n                  <i ng-show="widget.content.receivables.customers" class="fa" ng-class="isCollapsed(widget.content.receivables) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" />\n                </div>\n                <div class="col-sm-7" ng-click="toogleSelectedElement(widget.content.receivables)">\n                  <strong>Aged Receivables</strong>\n                </div>\n                <div class="col-sm-4 text-right" ng-click="toogleSelectedElement(widget.content.receivables)">\n                  <strong>{{getTotalSum(widget.content.receivables) | mnoCurrency : widget.content.receivables.currency}}</strong>\n                </div>\n              </div>\n              <div ng-hide="isCollapsed(widget.content.receivables)">\n                <div class="row widget-line" ng-click="toogleSelectedElement(customer)" ng-repeat="customer in widget.content.receivables.customers" ng-class="isSelected(customer) ? \'selected\' : null" >\n                  <div class="col-sm-1" />\n                  <div class="col-sm-7">{{customer.name}}</div>\n                  <div class="col-sm-4 text-right">\n                    <span>{{getTotalSum(customer) | mnoCurrency : customer.currency}}</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n          <h4>{{(widget.content.hist_parameters.period || "Monthly") | titleize}} Aged Payables and Receivables</h4>\n\n          <div ng-show="selectedElements.length < 2" class="legend">{{getName(selectedElements[0]) | titleize}}</div>\n\n          <div class="chart-container" ng-if="isDataFound && widget.isExpanded()">\n            <div dhb-chart data="widget.chart"></div>\n          </div>\n\n          <div ng-show="selectedElements.length < 2" class="widget-lines-container">\n            <div class="row widget-line">\n              <div class="col-sm-2 text-center" ng-repeat="date in widget.content.dates" style="padding: 5px 0px;">\n                <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;">{{date | date : \'MMM-d\'}}</div></div>\n                <div class="row widget-line">\n                  <div class="col-sm-12" style="padding: 0px;">{{selectedElements[0].totals[$index] | mnoCurrency : selectedElements[0].currency}}</div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div ng-hide="selectedElements.length < 2" class="widget-lines-container">\n\n            <div class="widget-line header">\n              Total from {{widget.content.dates[0] | date : \'MMM-d\'}} to {{widget.content.dates[widget.content.dates.length - 1] | date : \'MMM-d\'}}\n            </div>\n\n            <div class="widget-line" ng-repeat="element in selectedElements">\n              <i style="float: right; margin-right: 10px;">\n                <span>{{getTotalSum(element) | mnoCurrency : element.currency}}</span>\n              </i>\n              <i class="fa fa-circle" style="margin: 0px 8px; color: {{getElementChartColor($index)}}" />\n              {{getName(element) | titleize}}\n            </div>\n\n          </div>\n\n        </div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/invoices-list.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-invoices-list class="content">\n\n  <div ng-show="widget.isLoading">\n    <div class="loader" align="center">\n      Your data is being retrieved...\n      <img class="gif" ng-src="{{loaderImage}}"/>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n      <div class="widget-line">\n        <div class="row table-header" ng-show="widget.width > 3">\n          <div class="col-sm-4">{{entityTypeCap}}</div>\n          <div class="col-sm-8">\n            <div class="col-xs-4">Paid</div>\n            <div class="col-xs-4">Due</div>\n            <div class="col-xs-4">Invoiced</div>\n          </div>\n        </div>\n        <div class="row table-header" ng-hide="widget.width > 3">\n          <div class="col-xs-7">{{entityTypeCap}}</div>\n          <div class="col-xs-4" ng-show="orderBy == \'paid \'">Paid</div>\n          <div class="col-xs-4" ng-show="orderBy == \'due \'">Due</div>\n          <div class="col-xs-4" ng-hide="orderBy == \'paid \' || orderBy == \'due \'">Invoiced</div>\n        </div>\n      </div>\n      <div class="widget-lines-container">\n        <div class="widget-line" ng-hide="isDataFound">\n          <div>\n            <div class="row">\n              <div class="col-xs-11">No {{orderBy}}invoice found for your {{entityType}}</div>\n            </div>\n          </div>\n        </div>\n        <div class="widget-line" ng-show="isDataFound" ng-repeat="entity in widget.content.entities" tooltip-trigger="mouseenter" tooltip-placement="top" tooltip-html-unsafe="{{getInvoices(entity)}}" tooltip-animation="false">\n          <div class="row">\n            <div ng-show="widget.width > 3">\n              <div class="col-sm-4">{{entity.name}}</div>\n              <div class="col-sm-8">\n                <div class="col-xs-4"><i>{{entity.total_paid | mnoCurrency : entity.currency}}</i></div>\n                <div class="col-xs-4"><i>{{entity.total_due | mnoCurrency : entity.currency}}</i></div>\n                <div class="col-xs-4"><i>{{entity.total_invoiced | mnoCurrency : entity.currency}}</i></div>\n              </div>\n            </div>\n          <div ng-hide="widget.width > 3">\n            <div class="col-xs-7">{{entity.name}}</div>\n            <div class="col-xs-4" ng-show="orderBy == \'paid \'"><i>{{entity.total_paid | mnoCurrency : entity.currency}}</i></div>\n            <div class="col-xs-4" ng-show="orderBy == \'due \'"><i>{{entity.total_due | mnoCurrency : entity.currency}}</i></div>\n            <div class="col-xs-4" ng-hide="orderBy == \'paid\' || orderBy == \'due \'"><i>{{entity.total_invoiced | mnoCurrency : entity.currency}}</i></div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n  </div>\n</div>'),e.put("widgets/invoices-summary.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-invoices-summary class="content">\n\n  <div ng-hide="widget.isLoading">\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-chart-filters parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div align="center" ng-hide="widget.isEditMode">\n      <div class="chart-container" ng-if="isDataFound">\n        <div dhb-chart data="widget.chart"></div>\n        <div class="legend">\n          <span>{{widget.content.legend}}</span>\n        </div>\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n  </div>\n\n  <div class="loader" align="center" ng-show="widget.isLoading">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n</div>'),e.put("widgets/sales-aged.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-sales-aged class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound" class="center">\n\n        <div setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter" no-reload truncate-no="60" />\n\n        <div class="chart-container">\n          <div dhb-chart data="widget.chart"></div>\n        </div>\n        <div class="legend">From {{widget.content.dates[0]}} to {{getLastDate()}}</div>\n\n        <div class="widget-lines-container">\n          <!-- <div class="row widget-line"> -->\n            <div class="col-sm-2 text-center" ng-repeat="date in formattedDates track by $index" style="padding: 5px 0px;">\n              <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;">{{date}}</div></div>\n              <div class="row widget-line">\n              <div ng-hide="filter.value == \'quantity_sold\'" class="col-sm-12" ng-class="getClassColor(getTotal($index - 1),getTotal($index))" style="padding: 0px;">\n                {{getTotal($index) | mnoCurrency : widget.content.currency : false}}\n                <br />\n                {{widget.content.currency}}\n              </div>\n              <div ng-show="filter.value == \'quantity_sold\'" class="col-sm-12" ng-class="getClassColor(getTotal($index - 1),getTotal($index))" style="padding: 0px;">\n                {{getTotal($index)}}\n              </div>\n            </div>\n          <!-- </div> -->\n        </div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/sales-break-even.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-sales-break-even class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound" class="align-center">\n\n        <div class="legend">From {{widget.content.period.from | date : \'d MMM yyyy\'}} to {{widget.content.period.to | date : \'d MMM yyyy\'}}</div>\n\n        <div class="block to-date">\n          <div class="title">Sales to Date</div>\n          <div class="price">{{widget.content.sales.to_date | mnoCurrency : widget.content.currency : false}}</div>\n          Target: <span class="edit-target" style="float: right;" editable-text="threshold" buttons="no" onaftersave="widget.updateSettings()">\n            {{threshold | mnoCurrency : widget.content.currency : false}}\n          </span>\n        </div>\n\n        <div ng-show="widget.content.break_even" class="block to-breakeven">\n          <div class="title">Projection to Break-Even</div>\n          <span ng-show="isTargetMet()">Your sales already exceed your target by:</span>\n          <div class="price">{{getVariance() | mnoCurrency : widget.content.currency : false}}</div>\n          <span ng-hide="isTargetMet()">\n            Projected date: <span style="float: right;">{{getProjectedDate() | date : \'d-MM-yy\'}}</span>\n            <br />\n            Opportunities to close: <span style="float: right;">{{getOpportunitiesToClose()}}</span>\n          </span>\n        </div>\n        <div ng-show="widget.content.break_even" class="legend">{{widget.content.break_even.eligible_opportunities}} eligible opportunities</div>\n\n        <div ng-hide="widget.content.break_even" class="block to-breakeven">\n          <span class="edit-target" editable-text="threshold" buttons="no" onaftersave="widget.updateSettings()">\n            <div class="currency">Click to define your sales target</div>\n          </span>\n        </div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/sales-comparison.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-sales-comparison class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound" class="row" >\n        <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n          <div setting-width parent-widget="widget" min="6" max="12" class="settings width" />\n\n          <div class="row legend center">\n            Compare by: <div setting-param-selector parent-widget="widget" style="display: inline;" param="criteria" options="criteriaOptions" selected="criteria" truncate-no="30" />\n             ---\n            See: <div setting-param-selector parent-widget="widget" style="display: inline;" param="filter" options="filterOptions" selected="filter" truncate-no="30" no-reload />\n          </div>\n\n          <div class="widget-lines-container" style="max-height: 530px;">\n            <div class="row widget-line header">\n              <div class="col-sm-12">Total sales from {{widget.content.dates[0]}} to {{getLastDate()}}</div>\n            </div>\n            <div class="row widget-line total" ng-repeat="statement in widget.content.sales_comparison" >\n              <div class="row widget-line" ng-class="isSelected(statement) ? \'selected\' : null" >\n                <div class="col-sm-1" ng-click="toogleCollapsed(statement)"><i ng-show="statement.sales" class="fa" ng-class="isCollapsed(statement) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" /></div>\n                <div class="col-sm-7" ng-click="toogleSelectedElement(statement)"><strong>{{statement.name | titleize}}</strong></div>\n                <div ng-show="filter.value == \'quantity_sold\'" class="col-sm-4 text-right" ng-click="toogleSelectedElement(statement)"><strong>{{getTotalForPeriod(statement)}}</strong></div>\n                <div ng-hide="filter.value == \'quantity_sold\'" class="col-sm-4 text-right" ng-click="toogleSelectedElement(statement)"><strong>{{getTotalForPeriod(statement) | mnoCurrency : statement.currency}}</strong></div>\n              </div>\n              <div collapse="isCollapsed(statement)">\n                <div class="row widget-line" ng-click="toogleSelectedElement(sale)" ng-repeat="sale in statement.sales" ng-class="isSelected(sale) ? \'selected\' : null" >\n                  <div class="col-sm-1" />\n                  <div class="col-sm-7">{{sale.name}}</div>\n                  <div ng-show="filter.value == \'quantity_sold\'" class="col-sm-4 text-right">{{getTotalForPeriod(sale)}}</div>\n                  <div ng-hide="filter.value == \'quantity_sold\'" class="col-sm-4 text-right">{{getTotalForPeriod(sale) | mnoCurrency : sale.currency}}</div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n          <div class="chart-container" ng-if="selectedElements.length > 0 && widget.isExpanded()">\n            <div dhb-chart data="widget.chart"></div>\n          </div>\n\n          <div class="widget-lines-container">\n            <div class="row widget-line header">\n              <div class="col-sm-12">Total sales from {{widget.content.dates[0]}} to {{getLastDate()}}</div>\n            </div>\n            <div class="widget-line" ng-repeat="element in selectedElements">\n              <i ng-show="filter.value == \'quantity_sold\'" style="float: right; margin-right: 10px;">{{getTotalForPeriod(element)}}</i>\n              <i ng-hide="filter.value == \'quantity_sold\'" style="float: right; margin-right: 10px;">{{getTotalForPeriod(element) | mnoCurrency : element.currency}}</i>\n              <i class="fa fa-circle" style="margin: 0px 8px; color: {{getElementChartColor($index)}}" />\n              {{element.name | titleize}}\n            </div>\n          </div>\n\n        </div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/sales-customer-details.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-sales-customer-details class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound" class="row" >\n\n        <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n          <div setting-width parent-widget="widget" min="3" max="6" class="settings width" />\n          <div setting-param-selector parent-widget="widget" param="customer_uid" options="customersOptions" selected="selectedCustomer" class="row title" />\n\n          <div class="details-container">\n            <div class="row">\n              <div class="col-md-4"><label>Email</label></div>\n              <div class="col-md-8"><pre>{{getCustomer().email}}</pre></div>\n            </div>\n            <div class="row">\n              <div class="col-md-4"><label>Phone</label></div>\n              <div class="col-md-8"><pre>{{getCustomer().phone}}</pre></div>\n            </div>\n            <div class="row">\n              <div class="col-md-4"><label>Website</label></div>\n              <div class="col-md-8"><pre>{{getCustomer().website}}</pre></div>\n            </div>\n            <div class="row">\n              <div class="col-md-4"><label>Contact</label></div>\n              <div class="col-md-8"><pre>{{getCustomer().contact}}</pre></div>\n            </div>\n            <div class="row">\n              <div class="col-md-4"><label>City</label></div>\n              <div class="col-md-8"><pre>{{getCustomer().city}}</pre></div>\n            </div>\n            <div class="row">\n              <div class="col-md-4"><label>Country</label></div>\n              <div class="col-md-8"><pre>{{getCustomer().country}}</pre></div>\n            </div>\n          </div>\n        </div>\n\n        <div class="col-md-6 right-panel" ng-show="widget.isExpanded()">\n          <div class="details-container">\n            <div class="row" style="border-bottom: solid 1px #e6e6e6; margin-bottom: 10px; padding-bottom: 5px;">\n              <div class="col-md-3"><label>Address</label></div>\n              <div class="col-md-9"><pre>{{formatAddress(getCustomer().full_address)}}</pre></div>\n            </div>\n            <div class="row">\n              <div class="col-md-12 center legend">From {{getFromDate() | date : \'d MMM yyyy\'}} to {{getToDate() | date : \'d MMM yyyy\'}}:</div>\n            </div>\n            <div class="row">\n              <div class="col-md-5"><label>Total invoiced</label></div>\n              <div class="col-md-7"><pre>{{getCustomer().total_invoiced | mnoCurrency : getCustomer().currency}}</pre></div>\n            </div>\n            <div class="row">\n              <div class="col-md-5"><label>Total paid</label></div>\n              <div class="col-md-7"><pre>{{getCustomer().total_paid | mnoCurrency : getCustomer().currency}}</pre></div>\n            </div>\n            <div class="row">\n              <div class="col-md-5"><label>Total due</label></div>\n              <div class="col-md-7"><pre>{{getCustomer().total_due | mnoCurrency : getCustomer().currency}}</pre></div>\n            </div>\n          </div>\n        </div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/sales-cycle.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-sales-cycle class="content">\n\n  <div ng-hide="widget.isLoading">\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-params-picker options="statusOptions" param="status_selection" parent-widget="widget" class="part" />\n      <div setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div align="center" ng-hide="widget.isEditMode">\n      <div class="chart-container" ng-if="isDataFound">\n        <div dhb-chart data="widget.chart"></div>\n        <div class="legend">\n          <span>Your sales cycle represents how much time your leads stay set to each status</span>\n        </div>\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n  </div>\n\n  <div class="loader" align="center" ng-show="widget.isLoading">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n</div>'),e.put("widgets/sales-forecast.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-sales-forecast class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound" >\n\n        <div class="chart-container">\n          <div dhb-chart data="widget.chart"></div>\n        </div>\n\n        <div class="widget-lines-container" style="max-height: 340px;">\n          <div class="row widget-line header">\n            <div class="col-sm-12">Projection on the next 6 months</div>\n          </div>\n          <div class="row widget-line total" ng-repeat="date in widget.content.dates.slice(6) track by $index" ng-init="collapsed = true" >\n            <div class="row widget-line" >\n              <div class="col-sm-6" ng-click="collapsed = !collapsed">{{date | date : \'MMMM yyyy\'}}</div>\n              <div class="col-sm-6 text-right"><strong>{{widget.content.totals.slice(6)[$index] | mnoCurrency : widget.content.currency}}</strong></div>\n            </div>\n            <div collapse="collapsed">\n              <div class="row widget-line" ng-repeat="opp in widget.content.opportunities.slice(6)[$index]" >\n                <div class="col-sm-6">{{opp.name}}</div>\n                <div class="col-sm-6 text-right">{{getOpportunityAmount(opp) | mnoCurrency : getOpportunityCurrency(opp)}}</div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/sales-growth.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-sales-growth class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound">\n\n        <div class="selector">\n          <div setting-param-selector parent-widget="widget" param="product" options="productOptions" selected="product"/>\n          <div ng-show="product.value != -1" setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter"/>\n        </div>\n\n        <div class="chart-container" ng-if="isDataFound && product.value != -1">\n          <div dhb-chart data="widget.chart"></div>\n        </div>\n\n        <div ng-show="product.value != -1" class="legend text-center">{{getSelectedProduct().name}}</div>\n        <div class="price text-center" ng-hide="isDataQuantity || product.value == -1" tooltip="total for last period">{{getCurrentValue() | mnoCurrency : getSelectedProduct().currency}}</div>\n        <div class="price text-center" ng-show="isDataQuantity && product.value != -1" tooltip="total for last period">{{getCurrentValue()}}</div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/sales-leads-funnel.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-sales-leads-funnel class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-params-picker options="statusOptions" param="status_selection" parent-widget="widget" class="part" />\n      <div setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound" class="row" >\n\n        <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n          <div setting-width parent-widget="widget" min="6" max="12" class="settings width" />\n\n          <div class="legend">Your leads sales funnel from {{widget.content.from | date : \'d MMM yyyy\'}} to {{widget.content.to | date : \'d MMM yyyy\'}}</div>\n\n          <div class="funnel-container">\n            <div class="tile" ng-repeat="elem in funnel" ng-click="toogleSelectStatus(elem.status)">\n              <div class="colored-area" ng-style="elem.coloredWidth" ng-class="isSelected(elem.status) ? \'selected\' : \'\'">{{elem.number}}</div>\n              <div class="status" ng-style="elem.statusWidth">{{elem.status | titleize}}</div>\n            </div>\n          </div>\n        </div>\n\n        <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n\n          <div ng-hide="selectedStatus" class="currency">\n            Select a status to display a list of the corresponding leads\n          </div>\n\n          <div ng-show="selectedStatus" class="widget-lines-container">\n            <div class="row widget-line total" ng-repeat="lead in getSelectedLeads()" tooltip-trigger="mouseenter" tooltip-placement="top" tooltip-html-unsafe="{{getLeadDescription(lead)}}" tooltip-animation="false">\n              <div class="row widget-line" >\n                <div class="col-sm-7">\n                  {{lead.first_name | titleize}} {{lead.last_name | titleize}}\n                  <span ng-show="lead.organization">({{lead.organization}})</span>\n                </div>\n                <div class="col-sm-5 text-right"><strong>{{lead.lead_status | titleize}}</strong></div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/sales-leads-list.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-sales-leads-list class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound">\n\n        <div class="widget-lines-container" style="max-height: 235px;">\n          <div class="row widget-line total" style="cursor: pointer;" ng-repeat="lead in widget.content.leads" tooltip-trigger="mouseenter" tooltip-placement="top" tooltip-html-unsafe="{{getLeadDescription(lead)}}" tooltip-animation="false">\n            <div class="row widget-line" >\n              <div class="col-sm-7">\n                {{lead.first_name | titleize}} {{lead.last_name | titleize}}\n                <span ng-show="lead.organization">({{lead.organization}})</span>\n              </div>\n              <div class="col-sm-5 text-right"><strong>{{lead.lead_status | titleize}}</strong></div>\n            </div>\n          </div>\n        </div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/sales-list.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-sales-list class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound">\n\n        <div class="selector">\n          See: <span setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter"/> for this <span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period"/>\n          ({{widget.content.hist_parameters.from | date : "d MMM"}} to {{widget.content.hist_parameters.to | date : "d MMM"}})\n        </div>\n\n        <div class="widget-lines-container">\n          <div class="row widget-line total" ng-repeat="company in widget.content.summary" >\n            <div class="row widget-line" >\n              <div class="col-sm-1" ng-click="toogleCollapsed(company.name)" style="cursor: pointer;"><i class="fa" ng-class="isCollapsed(company.name) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" /></div>\n              <div class="col-sm-7"><strong>{{company.name | titleize}}</strong></div>\n              <div class="col-sm-4 text-right" ng-show="{{filter.value.match(\'quantity\')}}"><strong>{{company.total}}</strong></div>\n              <div class="col-sm-4 text-right" ng-hide="{{filter.value.match(\'quantity\')}}"><strong>{{company.total | mnoCurrency : company.currency}}</strong></div>\n            </div>\n            <div collapse="isCollapsed(company.name)">\n              <div class="row widget-line" ng-repeat="product in company.products" >\n                <div class="col-sm-1" />\n                <div class="col-sm-7">{{product.name | titleize}}</div>\n                <div class="col-sm-4 text-right" ng-show="{{filter.value.match(\'quantity\')}}"><strong>{{product.total}}</strong></div>\n                <div class="col-sm-4 text-right" ng-hide="{{filter.value.match(\'quantity\')}}"><strong>{{product.total | mnoCurrency : product.currency}}</strong></div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/sales-margin.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-sales-margin class="content">\n\n  <div ng-hide="widget.isLoading">\n    <div ng-show="widget.isEditMode" class="edit">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n      <div ng-show="isDataFound">\n        <div setting-hist-mode parent-widget= "widget" />\n\n        <div ng-hide="widget.isHistoryMode" class="current">\n          <div class="price">\n             {{ getTotalMargin() | mnoCurrency : getCurrency()}}\n          </div>\n          <div class="legend">\n            Total sold - Total purchased\n            </br>\n            {{getTimeSpan()}}\n            </br>\n            <div setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter" no-reload />\n          </div>\n        </div>\n\n        <!-- the display condition must be an "if" and its value must change for the chart to be drawn again -->\n        <div ng-if="widget.isHistoryMode" class="history">\n          <div dhb-chart data="widget.chart"></div>\n          <div class="legend">Total sold - Total purchased</div>\n        </div>\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n  </div>\n\n  <div class="loader" align="center" ng-show="widget.isLoading">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n</div>\n'),e.put("widgets/sales-number-of-leads.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-sales-number-of-leads class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound" class="align-center">\n        Leads for this <span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period"/>\n\n        <div class="stats">\n          <div class="stat row align-left" ng-repeat="carac in [\'new\', \'converted\', \'lost\']">\n            <div class="col-md-6 title" style="padding: 0px;">{{carac | titleize}}</div>\n            <div class="col-md-6" style="padding: 0px;">\n              <span class="variation" ng-class="formatNumberOfLeads(carac).color">{{formatNumberOfLeads(carac).variation}}</span>\n              <span class="nominal">{{formatNumberOfLeads(carac).nominal}}</span>\n            </div>\n          </div>\n        </div>\n\n        <div class="legend">\n        {{widget.content.number_of_leads.total[1]}} leads in total\n        </div>\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/sales-opportunities-funnel.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-sales-opportunities-funnel class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-params-picker options="statusOptions" param="sales_stage_selection" parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound" class="row" >\n\n        <div ng-class="widget.isExpanded() ? \'col-md-6\': \'col-md-12\'">\n          <div setting-width parent-widget="widget" min="6" max="12" class="settings width" />\n\n          <div class="legend">Your opportunities, sorted by sales stage</div>\n\n          <div class="funnel-container">\n            <div class="tile" ng-repeat="elem in funnel" ng-click="toogleSelectStatus(elem.status)">\n              <div class="colored-area" ng-style="elem.coloredWidth" ng-class="isSelected(elem.status) ? \'selected\' : \'\'">{{elem.number}}</div>\n              <div class="status" ng-style="elem.statusWidth">{{elem.status | titleize}}</div>\n            </div>\n          </div>\n        </div>\n\n        <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n\n          <div ng-hide="selectedStatus" class="currency">\n            Select a sales stage to display a list of the corresponding opportunities\n          </div>\n\n          <div ng-show="selectedStatus" class="widget-lines-container">\n            <div class="row widget-line total" ng-repeat="opp in getSelectedOpportunities()">\n              <div class="row widget-line" >\n                <div class="col-sm-6">\n                  {{opp.name | titleize}}\n                </div>\n                <div class="col-sm-6 text-right"><strong>{{getOppDetails(opp)}}</strong></div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/sales-performance.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-sales-performance class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound">\n\n        <div class="widget-lines-container" style="max-height: 235px;">\n          <div class="row widget-line header">\n            <div class="col-sm-4">Users/Teams</div>\n            <div class="col-sm-4 text-right">Win ratio</div>\n            <div class="col-sm-4 text-right">Total won</div>\n          </div>\n          <div class="row widget-line total" style="cursor: pointer;" ng-repeat="assignee in widget.content.assignees" ng-init="collapsed=true">\n            <div class="row widget-line" ng-click="collapsed=!collapsed">\n              <div class="col-sm-4"><strong>{{assignee.name | titleize}}</strong></div>\n              <div class="col-sm-4 text-right"><strong>{{assignee.win_ratio}} %</strong></div>\n              <div class="col-sm-4 text-right"><strong>{{assignee.total_won | mnoCurrency : \'AUD\'}}</strong></div>\n            </div>\n            <div collapse="collapsed">\n              <div class="row widget-line" ng-repeat="opp in assignee.opportunities" >\n                <div class="col-sm-4">{{opp.name}}</div>\n                <div class="col-sm-4 text-right">{{opp.sales_stage}}</div>\n                <div class="col-sm-4 text-right">{{getOpportunityAmount(opp)}}</div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/sales-segmented-turnover.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-sales-segmented-turnover class="content">\n\n  <div ng-hide="widget.isLoading">\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-time-range parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div align="center" ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound" class="row">\n        <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n          <div setting-width parent-widget="widget" min="3" max="6" class="settings width"></div>\n\n          <h3 class="left">Filter: <span setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter"/></h3>\n          <div class="chart-container" ng-if="isDataFound">\n            <div dhb-chart data="widget.chart"></div>\n          </div>\n          <div class="widget-lines-container">\n            <div class="widget-line">\n              Average price range\n            </div>\n            <div class="widget-line" ng-repeat="range in widget.content.ranges">\n              <i style="float: right; margin-right: 10px;">{{range.percentage}}%</i>\n              <i class="fa fa-circle" style="margin: 0px 8px; color: {{getColorByIndex($index)}}" />\n              {{getRangeLabel(range.label)}}\n            </div>\n          </div>\n        </div>\n\n        <div class="col-md-6 right-panel" ng-show="widget.isExpanded()">\n          <i class="fa fa-info-circle" style="float: left;" tooltip="This widget segments your revenue by products average price range and propose an analysis of its composition" />\n          <h3 style="margin: 25px 10px; text-align: center;">{{getMaxRange().percentage.toFixed()}}% of your revenue comes from products sold at an average price between {{getMaxRange().label.split(\'-\')[0] | mnoCurrency : widget.content.currency}} and {{getMaxRange().label.split(\'-\')[1] | mnoCurrency : widget.content.currency}}.</h3>\n          <div class=\'price hidden-md\' >{{getAnalysis()}}</div>\n        </div>\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n\n  <div class="loader" align="center" ng-show="widget.isLoading">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n</div>'),e.put("widgets/sales-summary.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-sales-summary class="content">\n\n  <div ng-hide="widget.isLoading">\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n      <div setting-chart-filters parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div align="center" ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound" class="selector">\n        See: <span setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter"/>\n        for this <span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period"/>\n        ({{widget.content.hist_parameters.from | date : \'d MMM\'}} to {{widget.content.hist_parameters.to | date : \'d MMM\'}})\n      </div>\n\n      <div class="chart-container" ng-if="isDataFound && !incorrectPeriod">\n        <div dhb-chart data="widget.chart"></div>\n      </div>\n\n      <div class="data-not-found" ng-if="incorrectPeriod">\n        <div class="message">No data found for this period<br/> Please select another one</div>\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n  </div>\n\n  <div class="loader" align="center" ng-show="widget.isLoading">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n</div>'),e.put("widgets/sales-top-opportunities.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div widget-sales-top-opportunities class="content">\n\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    Your data is being retrieved...\n    <img class="gif" ng-src="{{loaderImage}}"/>\n  </div>\n\n  <div ng-hide="widget.isLoading">\n\n    <div class="edit" ng-show="widget.isEditMode">\n      <h4>Widget settings</h4>\n\n      <div setting-organizations parent-widget="widget" class="part" />\n\n      <div align="right">\n        <button class="btn btn-default" ng-click="widget.initSettings()">Cancel</button>\n        <button class="btn btn-warning" ng-click="widget.updateSettings()">Save</button>\n      </div>\n    </div>\n\n    <div ng-hide="widget.isEditMode">\n\n      <div ng-show="isDataFound">\n\n        <div class="legend">\n          Total potential: <b>{{widget.content.total_potential | mnoCurrency : widget.content.currency || "AUD"}}</b> - <b>{{widget.content.eligible_opportunities}}</b> eligible opportunities\n        </div>\n\n        <div class="opps-container">\n          <div class="tile" ng-repeat="opp in widget.content.opportunities track by $index" ng-class="getOppClass($index)">\n            <div class="colored-area">{{$index +1 }}</div>\n            <div class="name">\n              {{opp.name | titleize}}\n              <br />\n              <i style="font-size: 13px;">{{getOppDetails(opp)}}</i>\n            </div>\n          </div>\n        </div>\n\n      </div>\n\n      <div ng-hide="isDataFound" common-data-not-found widget-engine="widget.category" />\n    </div>\n\n  </div>\n</div>'),e.put("widgets/template-admin.tmpl.html",'<div class="widget-template-admin">\n  <h1>Widget template <small>(last update: {{index.lastUpdate}})</small></h1>\n\n\n  <div class="panel-cat" ng-click="activateCat(\'create\')">\n    <h4>\n      <span ng-hide="cat[\'create\']">+</span>\n      <span class="ng-hide" ng-show="cat[\'create\']">-</span>\n      Create a widget template\n    </h4>\n  </div>\n  <div class="ng-hide" ng-show="cat[\'create\']">\n    <div class="alert alert-success ng-hide" ng-show="create.successMsg">Success! Well done!<button class="close" ng-click="create.successMsg=false">×</button></div>\n    <div class="alert alert-error ng-hide" ng-show="create.errorMsg">Error: {{create.errors}}<button class="close" ng-click="create.errorMsg=false">×</button></div>\n    <form name="create_form">\n      <div class="row">\n        <div class="col-md-2 align-right">\n          <label for="create_name">*Name:</label>\n        </div>\n        <div class="col-md-3">\n          <input type="text" required id="create_name" class="form-control" ng-model="create.model[\'name\']">\n        </div>\n        <div class="col-md-2 col-md-offset-1 align-right">\n          <label for="create_description">*Description (tooltip):</label>\n        </div>\n        <div class="col-md-3">\n          <input type="text" required id="create_description" class="form-control" ng-model="create.model[\'description\']">\n        </div>\n      </div>\n      <div class="spacer1"></div>\n      <div class="row">\n        <div class="col-md-2 align-right">\n          <label for="create_icon">*Icon (font-awesome):</label>\n        </div>\n        <div class="col-md-3">\n          <input type="text" required id="create_icon" class="form-control" ng-model="create.model[\'icon\']">\n        </div>\n        <div class="col-md-2 col-md-offset-1 align-right">\n          <label for="create_settings">Settings (separated by commas, no spaces):</label>\n        </div>\n        <div class="col-md-3">\n          <input type="text" id="create_settings" class="form-control" ng-model="create.model[\'settings\']">\n        </div>\n      </div>\n      <div class="spacer1"></div>\n      <div class="row">\n        <div class="col-md-2 align-right">\n          <label for="create_width">*Width:</label>\n        </div>\n        <div class="col-md-3">\n          <input type="number" required min="3" max="12" id="create_width" class="form-control" ng-model="create.model[\'width\']">\n        </div>\n        <div class="col-md-2 col-md-offset-1 align-right">\n          <label for="create_screenshot">\n            Screenshot: (prefer 400px*380px)\n            <br/>\n            <small>Preview on save only</small>\n          </label>\n        </div>\n        <div class="col-md-3">\n          <input type="file" id="create_screenshot" class="form-control" file-model="create.screenshot">\n        </div>\n      </div>\n      <div class="spacer1"></div>\n      <div class="row">\n        <div class="col-md-2 align-right">\n          <label for="create_full_description">\n            *Full description:\n            <br/>\n            <small>{{create.model[\'full_description\'].length}}/350 char</small>\n          </label>\n        </div>\n        <div class="col-md-3">\n          <textarea row="15" required id="create_full_description" class="form-control" ng-model="create.model[\'full_description\']"/>\n        </div>\n        <div class="col-md-2 col-md-offset-1 align-right">\n          <label for="create_active">Active:</label>\n        </div>\n        <div class="col-md-3">\n          <input type="checkbox" id="create_active" class="form-control" ng-model="create.model[\'active\']">\n        </div>\n      </div>\n      <div class="spacer1"></div>\n      <div class="row">\n        <div class="col-md-2 align-right">\n          <label for="category">*Category:</label>\n        </div>\n        <div class="col-md-3">\n          <select required id="category" class="form-control" ng-model="create.model[\'category\']" ng-options="cat.name for cat in index.categories"/>\n        </div>\n        <div class="col-md-2 col-md-offset-1 align-right">\n          <label for="create_engine">Engine:</label>\n        </div>\n        <div class="col-md-3">\n          <input type="text" id="create_engine" class="form-control" ng-model="create.model[\'engine\']">\n        </div>\n      </div>\n      <div class="spacer1"></div>\n      <div class="row">\n        <h4>Endpoints:</h4>\n      </div>\n      <div class="row">\n        <div ng-repeat="ep in create.endpoints">\n          <div class="col-md-2 align-right checkbox-label">\n            <label for="{{ep.name}}">{{ep.name}}</label>\n          </div>\n          <div class="col-md-1">\n            <input type="checkbox" id="{{ep.name}}" class="form-control" ng-model="ep.checked" ng-change="getCompatibleApps(create)"/>\n          </div>\n        </div>\n      </div>\n      <div class="spacer1"></div>\n      <div class="row">\n        <h4>Preview:</h4>\n      </div>\n      <div class="impac-catalogue">\n        <div class="col-md-2"></div>\n        <div class="col-md-9 content" id="preview_create" ng-style="{\'border-color\' : create.model.category.color}">\n\n          <div class="row header">\n            <div class="col-xs-2 heading" ng-style="{\'background-color\' : create.model.category.color, \'border-color\' : create.model.category.color}">\n              {{create.model.category.name}}\n            </div>\n            <div class="col-xs-1 triangle-topleft" ng-style="{\'border-top-color\' : create.model.category.color}"></div>\n            <span class="red" ng-hide="create.model.active">Inactive (displayed only to admins)</span>\n          </div>\n\n          <div class="row title center">\n            <h2>{{create.model.name}}</h2>\n          </div>\n\n          <div class="row fields-container">\n\n            <div class="col-md-6">\n              <div class="left-panel">\n                <div class="heading" ng-style="{\'background-color\' : create.model.category.color}" style="font-size: 17px; font-weight: 700;">\n                  Screenshot\n                </div>\n                <div class="field screenshot">\n                  <img ng-src="{{create.model.screenshot}}" ng-show="create.inProgress">\n                  <p ng-hide="create.inProgress">No preview available</p>\n                </div>\n              </div>\n            </div>\n\n            <div class="col-md-6 right-panel">\n              <div class="row">\n                <div class="heading" ng-style="{\'background-color\' : create.model.category.color}" style="font-size: 17px; font-weight: 700;">\n                  Description\n                </div>\n                <div class="field description">\n                  <p ng-bind-html="create.model.full_description"></p>\n                </div>\n              </div>\n\n              <div class="row">\n                <div class="heading" ng-style="{\'background-color\' : create.model.category.color}" style="font-size: 17px; font-weight: 700;">\n                  Settings\n                </div>\n                <div class="field settings">\n                  <div class="setting" ng-class="getSettings(create.model).length <= 3 ? \'col-md-12\' : \'col-md-6\'" ng-repeat="setting in getSettings(create.model) track by $index">\n                    <i ng-hide="getSettings(create.model).length == 0" class="fa fa-cog" />\n                    {{setting}}\n                  </div>\n                </div>\n              </div>\n\n              <div class="row" ng-style="{\'border-color\' : create.model.category.color}">\n                <div class="heading" ng-style="{\'background-color\' : create.model.category.color}" style="font-size: 17px; font-weight: 700;">\n                  Compatible with...\n                </div>\n                <div class="field apps">\n                  <div class="col-md-2 app" ng-repeat="app in create.model.compatible_apps.slice(0,6)" style="padding: 0px;" >\n                    <img ng-src="{{app.logo.logo.url}}" class="app-logo" tooltip="{{app.name}}" tooltip-placement="bottom" />\n                  </div>\n                </div>\n              </div>\n            </div>\n\n          </div>\n        </div>\n      </div>\n\n      <div class="spacer2"></div>\n      <div class="row center" ng-hide="create.inProgress">\n        <label>\n          Generate pdf:\n          <input type="checkbox" name="generate_pdf" ng-model="create.generatePdf"/>\n        </label>\n        <button class="btn btn-primary" ng-disabled="create.saveDisabled || create_form.$invalid" ng-click="create.save()">Save</button>\n        <button class="btn btn-warning" ng-click="create.reset()">Reset</button>\n      </div>\n    </form>\n  </div>\n\n  <div class="panel-cat" ng-click="activateCat(\'update\')">\n    <h4>\n      <span ng-hide="cat[\'update\']">+</span>\n      <span class="ng-hide" ng-show="cat[\'update\']">-</span>\n      Update a widget template\n    </h4>\n  </div>\n  <div class="ng-hide" ng-show="cat[\'update\']">\n    <div class="alert alert-success ng-hide" ng-show="update.successMsg">Success! Well done!<button class="close" ng-click="update.successMsg=false">×</button></div>\n    <div class="alert alert-error ng-hide" ng-show="update.errorMsg">Error: {{update.errors}}<button class="close" ng-click="update.errorMsg=false">×</button></div>\n    <div ng-show="index.inProgress" class="ng-hide"><img class="gif" ng-src="{{loaderImage}}"/></div>\n    <div ng-hide="index.inProgress" class="selector">\n      <select ng-model="update.selected" convert-to-number class="form-control" ng-options="wt.name for wt in index.model" />\n\n      <div ng-hide="update.selected">No widget template selected</div>\n        <div class="ng-hide" ng-show="update.selected">\n        <form name="update_form">\n          <div class="spacer1"></div>\n          <div class="row">\n            <h4>Template details:</h4>\n          </div>\n          <div class="row">\n            <div class="col-md-2 align-right">\n            <label for="update_name">*Name:</label>\n            </div>\n            <div class="col-md-3">\n              <input type="text" required id="update_name" class="form-control" ng-model="update.model[\'name\']">\n            </div>\n\n            <div class="col-md-2 col-md-offset-1 align-right">\n              <label for="update_description">*Description (tooltip):</label>\n            </div>\n            <div class="col-md-3">\n              <input type="text" required id="update_description" class="form-control" ng-model="update.model[\'description\']">\n            </div>\n          </div>\n          <div class="spacer1"></div>\n          <div class="row">\n            <div class="col-md-2 align-right">\n            <label for="update_icon">*Icon (font-awesome):</label>\n            </div>\n            <div class="col-md-3">\n              <input type="text" required id="update_icon" class="form-control" ng-model="update.model[\'icon\']">\n            </div>\n            <div class="col-md-2 col-md-offset-1 align-right">\n              <label for="update_settings">Settings (separated by commas, no spaces):</label>\n            </div>\n            <div class="col-md-3">\n              <input type="text" id="update_settings" class="form-control" ng-model="update.model[\'settings\']">\n            </div>\n          </div>\n          <div class="spacer1"></div>\n          <div class="row">\n            <div class="col-md-2 align-right">\n            <label for="update_width">*Width:</label>\n            </div>\n            <div class="col-md-3">\n              <input type="number" required min="3" max="12" id="update_width" class="form-control" ng-model="update.model[\'width\']">\n            </div>\n            <div class="col-md-2 col-md-offset-1 align-right">\n              <label for="update_screenshot">\n                Screenshot: (prefer 400px*380px)\n                <br/>\n                <small>Preview on save only</small>\n              </label>\n            </div>\n            <div class="col-md-3">\n              <input type="file" id="update_screenshot" class="form-control" file-model="update.screenshot">\n            </div>\n          </div>\n          <div class="spacer1"></div>\n          <div class="row">\n            <div class="col-md-2 align-right">\n              <label for="update_full_description">\n                *Full description:\n                <br/>\n                <small>{{update.model[\'full_description\'].length}}/350 char</small>\n              </label>\n            </div>\n            <div class="col-md-3">\n              <textarea row="15" required id="update_full_description" class="form-control" ng-model="update.model[\'full_description\']"/>\n            </div>\n            <div class="col-md-2 col-md-offset-1 align-right">\n              <label for="update_active">Active:</label>\n            </div>\n            <div class="col-md-3">\n              <input type="checkbox" id="update_active" class="form-control" ng-model="update.model[\'active\']">\n            </div>\n          </div>\n          <div class="spacer1"></div>\n          <div class="row">\n            <div class="col-md-2 align-right">\n              <label for="category">*Category:</label>\n            </div>\n            <div class="col-md-3">\n              <select required id="category_id" class="form-control" ng-model="update.model[\'category\']" ng-options="cat.name for cat in index.categories track by cat.id"/>\n            </div>\n            <div class="col-md-2 col-md-offset-1 align-right">\n              <label for="update_engine">Engine:</label>\n            </div>\n            <div class="col-md-3">\n              <input type="text" id="update_engine" class="form-control" ng-model="update.model[\'engine\']">\n            </div>\n          </div>\n          <div class="spacer1"></div>\n          <div class="row">\n            <h4>Endpoints:</h4>\n          </div>\n          <div class="row">\n            <div ng-repeat="ep in update.endpoints">\n              <div class="col-md-2 align-right checkbox-label">\n                <label for="{{ep.name}}">{{ep.name}}</label>\n              </div>\n              <div class="col-md-1">\n                <input type="checkbox" id="{{ep.name}}" class="form-control" ng-model="ep.checked" ng-change="getCompatibleApps(update)"/>\n              </div>\n            </div>\n          </div>\n          <div class="spacer1"></div>\n          <div class="row">\n            <h4>Preview:</h4>\n          </div>\n          <div class="impac-catalogue">\n            <div class="col-md-2"></div>\n            <div class="col-md-9 content" id="preview_update" ng-style="{\'border-color\' : update.model.category.color}">\n\n              <div class="row header">\n                <div class="col-xs-2 heading" ng-style="{\'background-color\' : update.model.category.color, \'border-color\' : update.model.category.color}">\n                  {{update.model.category.name}}\n                </div>\n                <div class="col-xs-1 triangle-topleft" ng-style="{\'border-top-color\' : update.model.category.color}"></div>\n                <span class="red" ng-hide="update.model.active">Inactive (displayed only to admins)</span>\n              </div>\n\n              <div class="row title center">\n                <h2>{{update.model.name}}</h2>\n              </div>\n\n              <div class="row fields-container">\n                <div class="col-md-6">\n                  <div class="left-panel">\n                    <div class="heading" ng-style="{\'background-color\' : update.model.category.color}" style="font-size: 17px; font-weight: 700;">\n                      Screenshot\n                    </div>\n                    <div class="field screenshot">\n                      <img ng-src="{{update.model.screenshot}}">\n                    </div>\n                  </div>\n                </div>\n\n                <div class="col-md-6 right-panel">\n                  <div class="row">\n                    <div class="heading" ng-style="{\'background-color\' : update.model.category.color}" style="font-size: 17px; font-weight: 700;">\n                      Description\n                    </div>\n                    <div class="field description">\n                      <p ng-bind-html="update.model.full_description"></p>\n                    </div>\n                  </div>\n\n                  <div class="row">\n                    <div class="heading" ng-style="{\'background-color\' : update.model.category.color}" style="font-size: 17px; font-weight: 700;">\n                      Settings\n                    </div>\n                    <div class="field settings">\n                      <div class="setting" ng-class="getSettings(update.model).length <= 3 ? \'col-md-12\' : \'col-md-6\'" ng-repeat="setting in getSettings(update.model) track by $index">\n                        <i class="fa fa-cog" />\n                        {{setting}}\n                      </div>\n                    </div>\n                  </div>\n\n                  <div class="row" ng-style="{\'border-color\' : update.model.category.color}">\n                    <div class="heading" ng-style="{\'background-color\' : update.model.category.color}" style="font-size: 17px; font-weight: 700;">\n                      Compatible with...\n                    </div>\n                    <div class="field apps">\n                      <div class="col-md-2 app" ng-repeat="app in update.model.compatible_apps.slice(0,6)" style="padding: 0px;" >\n                        <img ng-src="{{app.logo.logo.url}}" class="app-logo" tooltip="{{app.name}}" tooltip-placement="bottom" />\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n              </div>\n            </div>\n          </div>\n\n          <div class="spacer2"></div>\n          <div class="row center" ng-hide="update.inProgress">\n            <label>\n              Generate pdf:\n              <input type="checkbox" name="generate_pdf" ng-model="update.generatePdf"/>\n            </label>\n            <button class="btn btn-primary" ng-disabled="update.saveDisabled || update_form.$invalid" ng-click="update.save()">Save</button>\n          </div>\n        </form>\n      </div>\n    </div>\n  </div>\n\n  <div class="panel-cat" ng-click="activateCat(\'delete\')">\n    <h4>\n      <span ng-hide="cat[\'delete\']">+</span>\n      <span class="ng-hide" ng-show="cat[\'delete\']">-</span>\n      Delete a widget template\n    </h4>\n  </div>\n  <div class="ng-hide" ng-show="cat[\'delete\']">\n    <div ng-show="index.inProgress" class="ng-hide"><img class="gif" ng-src="{{loaderImage}}"/></div>\n    <div ng-hide="index.inProgress" class="selector">\n      <select ng-model="destroy.selected" convert-to-number class="form-control" ng-options="wt.name for wt in index.model">\n      </select>\n      <div ng-hide="destroy.selected">No widget template selected</div>\n      <div class="ng-hide" ng-show="destroy.selected">\n        Do you really wish to permanantly delete the widget template "{{destroy.selected.name}}" (you could also simply desactivate it)? If so type "<strong>I do</strong>" in the input below.\n        <br/>\n        <label>\n          Generate pdf:\n          <input type="checkbox" name="generate_pdf" ng-model="destroy.generatePdf"/>\n        </label>\n        <input type="text" ng-model="destroy.confirm">\n        <button class="btn btn-warning" ng-disabled="destroy.confirm != \'I do\'" ng-click="destroy.destroy()" ng-hide="destroy.inProgress">Delete</button>\n        <div class="ng-hide" ng-show="destroy.inProgress"><img class="gif" ng-src="{{loaderImage}}"/></div>\n      </div>\n    </div>\n  </div>\n\n  <div class="panel-cat" ng-click="activateCat(\'addCategory\')">\n    <h4>\n      <span ng-hide="cat[\'addCategory\']">+</span>\n      <span class="ng-hide" ng-show="cat[\'addCategory\']">-</span>\n      Add a category\n    </h4>\n  </div>\n  <div class="ng-hide" ng-show="cat[\'addCategory\']">\n    <div class="row">\n      <div class="col-md-2">\n        <input type="text" placeholder="Name" ng-model="addCategory.model.name"/>\n      </div>\n      <div class="col-md-2">\n        <div class="row">\n          <input type="text" placeholder="Color (ex: #1de9b6)" ng-model="addCategory.model.color"/>\n        </div>\n        <div class="row">\n        Impac! colors: "#1de9b6","#7c4dff","#ffc928","#3fc4ff","#ff8e01",\n        <br/>"#c6ff00","#d500fa","#ff6e41","#ffeb3c","#ff1844".\n        </div>\n      </div>\n      <div class="col-md-1" style="color: white; background-color:{{addCategory.model.color}}">\n        Test\n      </div>\n      <div class="col-md-1">\n        <a class="btn btn-warning btn-sm" ng-click="addCategory.save()">Save</a>\n      </div>\n    </div>\n  </div>\n\n  <div class="panel-cat" ng-click="activateCat(\'updateCategory\')">\n    <h4>\n      <span ng-hide="cat[\'updateCategory\']">+</span>\n      <span class="ng-hide" ng-show="cat[\'updateCategory\']">-</span>\n      Update a category\n    </h4>\n  </div>\n  <div class="ng-hide" ng-show="cat[\'updateCategory\']">\n  <div class="alert alert-success ng-hide" ng-show="updateCategory.successMsg">Success! Well done!<button class="close" ng-click="updateCategory.successMsg=false">×</button></div>\n  <div class="alert alert-error ng-hide" ng-show="updateCategory.errorMsg">Error: {{updateCategory.errors}}<button class="close" ng-click="updateCategory.errorMsg=false">×</button></div>\n    <div class="row">\n      <div ng-show="index.inProgress" class="ng-hide"><img class="gif" ng-src="{{loaderImage}}"/></div>\n      <div ng-hide="index.inProgress" class="selector">\n        <select ng-model="updateCategory.selected" convert-to-number class="form-control" ng-options="cat.name for cat in index.categories"></select>\n        <div class="spacer1"></div>\n      </div>\n      <div ng-hide="updateCategory.selected">No category selected</div>\n      <div class="ng-hide" ng-show="updateCategory.selected">\n        <div class="col-md-2">\n          <input type="text" placeholder="Name" ng-model="updateCategory.model.name"/>\n        </div>\n        <div class="col-md-2">\n          <div class="row">\n            <input type="text" placeholder="Color (ex: #1de9b6)" ng-model="updateCategory.model.color"/>\n          </div>\n          <div class="row">\n          Impac! colors: "#1de9b6","#7c4dff","#ffc928","#3fc4ff","#ff8e01",\n          <br/>"#c6ff00","#d500fa","#ff6e41","#ffeb3c","#ff1844".\n          </div>\n        </div>\n        <div class="col-md-1" style="color: white; background-color:{{updateCategory.model.color}}">\n          Test\n        </div>\n        <div class="col-md-1">\n          <a class="btn btn-warning btn-sm" ng-click="updateCategory.save()">Save</a>\n        </div>\n        <div class="col-md-6">\n          <strong>Warning: updating a category (name or color) won"t update the pdf catalogue. Each widget of that category will have to be updated.</strong>\n        </div>\n      </div>\n    </div>\n  </div>\n\n</div>\n'),e.put("widgets-common/data-not-found.tmpl.html",'<div class="data-not-found">\n	<img ng-src="{{bgImage}}" />\n	<div class="message">\n	  Data not found\n    <!-- TODO: provider for html hyperlinks? -->\n		<a ng-href="" target="_blank">\n			Are you missing an app ?\n		</a>\n	</div>\n</div>\n'),e.put("widgets-common/editable-title.tmpl.html",'<div class="visible-lg title-wrapper" ng-if="parentWidget.width >= 3 && parentWidget.width < 6">\n  <div ng-show="parentWidget.hasEditAbility" class="title" editable-text="parentWidget.name" buttons="no" onaftersave="updateName()">\n  	{{parentWidget.name | truncate:25:"."}}\n  </div>\n\n  <div ng-hide="parentWidget.hasEditAbility" class="title">\n  	{{parentWidget.name | truncate:25:"."}}\n  </div>\n</div>\n\n<div class="visible-lg title-wrapper" ng-if="parentWidget.width >= 6">\n  <div ng-show="parentWidget.hasEditAbility" class="title" editable-text="parentWidget.name" buttons="no" onaftersave="updateName()">\n  	{{parentWidget.name | truncate:60:"."}}\n  </div>\n\n  <div ng-hide="parentWidget.hasEditAbility" class="title">\n  	{{parentWidget.name | truncate:60:"."}}\n  </div>\n</div>\n\n<div class="visible-md visible-sm title-wrapper" ng-if="parentWidget.width == 3 && parentWidget.width < 6">\n  <div ng-show="parentWidget.hasEditAbility" class="title" editable-text="parentWidget.name" buttons="no" onaftersave="updateName()">\n  	{{parentWidget.name | truncate:18:"."}}\n  </div>\n\n  <div ng-hide="parentWidget.hasEditAbility" class="title">\n  	{{parentWidget.name | truncate:18:"."}}\n  </div>\n</div>\n\n<div class="visible-md visible-sm title-wrapper" ng-if="parentWidget.width >= 6">\n  <div ng-show="parentWidget.hasEditAbility" class="title" editable-text="parentWidget.name" buttons="no" onaftersave="updateName()">\n  	{{parentWidget.name | truncate:45:"."}}\n  </div>\n\n  <div ng-hide="parentWidget.hasEditAbility" class="title">\n  	{{parentWidget.name | truncate:45:"."}}\n  </div>\n</div>\n\n<div class="visible-xs title-wrapper">\n  <div ng-show="parentWidget.hasEditAbility" class="title" editable-text="parentWidget.name" buttons="no" onaftersave="updateName()">\n  	{{parentWidget.name | truncate:30:"."}}\n  </div>\n\n  <div ng-hide="parentWidget.hasEditAbility" class="title">\n  	{{parentWidget.name | truncate:30:"."}}\n  </div>\n</div>'),e.put("widgets-common/top-buttons.tmpl.html",'<div id="module__top-buttons">\n  <div ng-mouseenter="showCloseActive=true" ng-mouseleave="showCloseActive=false" class="delete-widget" ng-show="parentWidget.hasDeleteAbility">\n    <button class="btn btn-close top-button" ng-click="showConfirmDelete = !showConfirmDelete">\n      <i class="fa fa-times-circle-o fa-lg"></i>\n    </button>\n  </div>\n\n  <div ng-mouseenter="showEditActive=true" ng-mouseleave="showEditActive=false" class="edit-widget" ng-show="parentWidget.hasEditAbility">\n    <button class="btn top-button btn-edit" ng-click="toogleEditMode()">\n      <i class="fa fa-cog fa-lg"></i>\n    </button>\n  </div>\n\n  <div class="refresh-widget">\n    <button class="btn top-button btn-refresh" ng-click="parentWidget.loadContent(true)">\n      <i class="fa fa-refresh"></i>\n    </button>\n  </div>\n\n  <div class="confirm-delete-popover" ng-show="showConfirmDelete">\n  	<h4>Are you sure you want to delete this widget ?</h4>\n  	<p>(it will not erase your data)</p>\n  	<button ng-click="showConfirmDelete = false" class="btn btn-sm btn-default">Cancel</button>\n  	<button ng-click="deleteWidget()" class="btn btn-sm btn-danger" style="margin-left: 10px;">Delete</button>\n  </div>\n</div>\n'),e.put("widgets-settings/chart-filters.tmpl.html",'<h5>Chart filters</h5>\n<div class="row chart-filters">\n  <div class="col-md-6">\n    <input type="radio" ng-model="filterCriteria" value="number">\n    <label for="number" ng-click="filterCriteria = \'number\'">Top {{filterValueNumber}} {{entityType}}</label>\n  </div>\n  <div class="col-md-6">\n    <input type="range" ng-model="filterValueNumber" ng-change="filterCriteria = \'number\'" min="3" max="{{maxEntities}}" step="1">\n  </div>\n</div>\n<div class="row chart-filters">\n  <div class="col-md-6">\n    <input type="radio" ng-model="filterCriteria" value="percentage">\n    <label for="percentage" ng-click="filterCriteria = "percentage"">Top {{filterValuePercentage}}% {{filterLabel}}</label>\n  </div>\n  <div class="col-md-6">\n    <input type="range" ng-model="filterValuePercentage" ng-change="filterCriteria = \'percentage\'" min="20" max="100" step="5">\n  </div>\n</div>'),e.put("widgets-settings/account.tmpl.html",'<h5>Account to monitor</h5>\n<div class="input-group select-account">\n	<select ng-model="parentWidget.selectedAccount" ng-options="account.name + \' (\' + formatAmount(account) + \')\' for account in parentWidget.content.account_list track by account.uid" class="form-control" />\n</div>'),e.put("widgets-settings/hist-mode.tmpl.html",'<div align="center" class="histModeChoser">\n  <a ng-click="toogleHistMode(\'current\')" ng-class="!parentWidget.isHistoryMode ? \'active\' : \'inactive\'">current</a> |\n  <a ng-click="toogleHistMode(\'history\')" ng-class="parentWidget.isHistoryMode ? \'active\' : \'inactive\'">history</a>\n</div>\n<div class="{{parentWidget.isHistoryMode ? \'arrow-container right\' : \'arrow-container left\'}}">\n  <div class="arrow" />\n  <div class="arrow-border" />\n</div>'),e.put("widgets-settings/organizations.tmpl.html",'<h5>Select Companies</h5>\n\n<div class="widget-lines-container">\n  <div class="widget-line" ng-repeat="org in dashboardOrganizations">\n    {{org.label}}\n    <i ng-class="isOrganizationSelected(org.uid) ? \'fa fa-toggle-on\' : \'fa fa-toggle-off\'" ng-click="toogleSelectOrganization(org.uid)" tooltip="{{isOrganizationSelected(org.uid) ? \'disable\' : \'enable\'}}" />\n  </div>\n</div>'),e.put("widgets-settings/params-picker.tmpl.html",'<h5>{{formattedParam | titleize}}</h5>\n<div class="params-picker">\n  <div style="margin-bottom: 8px;">\n    The selected criteria will be displayed in this order (drag/drop to modify):\n  </div>\n  <div ui:sortable="sortableOptions" ng-model="options" class="input-group">\n    <span ng-repeat="parameter in options track by $index" class="parameter" ng-class="!parameter.selected ? \'unchecked\' : \'\'">\n      <span class="badge">{{$index + 1}}</span>\n      {{parameter.label | titleize}}\n      <input type="checkbox" ng-model="parameter.selected" />\n    </span>\n  </div>\n</div>'),e.put("widgets-settings/param-selector.tmpl.html",'<span class="settings param-selector">\n	<a ng-click="toogleShowOptions()">{{selected.label | titleize | truncate : getTruncateValue() : "..." : false}} <i class="fa fa-chevron-down" /></a>\n	<div class="options-container" collapse="!showOptions">\n		<div ng-repeat="option in options" ng-click="selectOption(option)">\n			{{option.label | titleize}}\n		</div>\n	</div>\n</span>'),e.put("widgets-settings/time-range.tmpl.html",'<h5>Time range</h5>\n<div class="time-range">\n	<div class="row">\n	  <div class="col-md-12">\n	    Show last {{numberOfPeriods}} {{periodToUnit()}}\n	  </div>\n	</div>\n	<div class="row input-group" align="center" style="margin: 0; margin-top: 3px;">\n	  <div class="col-xs-6" style="padding: 0; padding-right: 5px;">\n	    <select ng-model="selectedPeriod" ng-options="period.toLowerCase() for period in PERIODS track by period" class="form-control" style="height: 22px; margin-top: 0; padding: 0; padding-left: 1px; padding-bottom: 1px;"></select>\n	  </div>\n	  <div class="col-xs-6" style="padding: 0;">\n	    <input type="range" ng-model="numberOfPeriods" min="1" max="12" step="1">\n	  </div>\n	</div>\n</div>'),e.put("widgets-settings/width.tmpl.html",'<i class="fa fa-angle-double-left reduce" ng-show="expanded" ng-click="parentWidget.toogleExpanded()" tooltip="reduce"/>\n<i class="fa fa-angle-double-right expand" ng-hide="expanded" ng-click="parentWidget.toogleExpanded()" tooltip="expand"/>')
}])}(),function(){"use strict";angular.module("impac.services.analytics",[]).factory("DhbAnalyticsSvc",["$http","$q","$window","$timeout","$log","ImpacLinking","ImpacRoutes",function(e,t,n,i,a,s,o){var d,l;return d=l={},l.defaultConfig={delay:6e5},l.config={id:null,organizationId:null,timerId:null,$q:null},l.data=[],l.isLocked=!1,l.getId=function(){return!l.config.id&&l.data.length>0?l.config.id=l.data[0].id:l.config.id},l.getDashboards=function(){return l.data},l.getOrganizationId=function(){return l.config.organizationId},l.configure=function(e){return angular.copy(e,l.config),angular.extend(l.config,l.defaultConfig)},l.load=function(t){return null==t&&(t=!1),(null==d.config.$q||t)&&(d.config.$q=e.get(o.baseDhbPath()).then(function(e){return angular.copy(e.data,d.data),console.log("dashboards: ",d.data)})),d.config.$q},l.dashboards={},l.dashboards.create=function(t){var n,i;return i={dashboard:t},(n=i.dashboard).organization_id||(n.organization_id=d.config.organizationId),e.post(o.createDhbPath(),i).then(function(e){var t;return t=e.data,d.data.push(t),d.config.id=t.id,t})},l.dashboards["delete"]=function(t){return e["delete"](o.deleteDhbPath(t)).then(function(){var e;return d.config.id=null,e=d.data,d.data=_.reject(d.data,function(e){return e.id===t})})},l.dashboards.update=function(t,n,i){var s;return null==i&&(i=!0),s={dashboard:n},e.put(o.updateDhbPath(t),s).then(function(e){var n;return n=_.findWhere(d.data,{id:t}),i?angular.extend(n,e.data):void 0},function(e){return a.error(e)})},l.widgets={},l.widgets.create=function(t,n){var i;return i={widget:n},e.post(o.createWidgetPath(t),i).then(function(e){var n,i;return i=e.data,n=_.findWhere(d.data,{id:t}),n.widgets.push(i),i})},l.widgets.show=function(t,n){var i;return null==n&&(n=!1),i={owner:t.owner,sso_session:s.getSsoSession(),metadata:t.metadata,engine:t.category},n&&angular.extend(i,{refresh_cache:!0}),i.metadata.organization_ids=s.getOrganizations(),e.post(o.showWidgetPath(),i)},l.widgets["delete"]=function(t,n){return e["delete"](o.deleteWidgetPath(t)).then(function(){return n.widgets=_.reject(n.widgets,function(e){return e.id===t})})},l.widgets.update=function(t,n){var i;return i={widget:n},e.put(o.updateWidgetPath(t.id),i)},l}])}.call(this),function(){"use strict";angular.module("impac.services.assets",[]).provider("ImpacAssets",function(){var e,t,n;return n=this,t={dataNotFound:null,impacTitleLogo:null,impacDashboardBackground:null,noWarning:!1},n.configure=function(e){return angular.extend(t,e)},e=function(e){var n;return n=this,n.get=function(n){var i,a;return a="",i="impac-angular warning: There are missing assets, please refer to the including assets section in the docs.",null!=t[n]?a=t[n]:t.noWarning||e.warn(i),a},n},e.$inject=["$log"],n.$get=e,n})}.call(this),function(){"use strict";angular.module("impac.components.chart",[]).directive("dhbChart",["$templateCache","$compile","$timeout",function(e,t,n){return{restrict:"A",scope:{data:"="},template:e.get("chart/chart.tmpl.html"),link:function(e,t){var i,a;return a={bezierCurve:!0,pointDotRadius:3,responsive:!0,scaleShowLabels:!0,scaleShowLabelBackdrop:!0,scaleBeginAtZero:!0,scaleShowGridLines:!0},i=null,e.draw=function(){var n,s,o;switch(_.isEmpty(e.data.options)||angular.extend(a,e.data.options),null!==i&&i.destroy(),n=t.children().get(0),s=n.getContext("2d"),e.data.chartType){case"Bar":i=new Chart(s).Bar(e.data.data,a);break;case"Line":i=new Chart(s).Line(e.data.data,a);break;case"Pie":angular.extend(a,{tooltipFixed:!0}),i=new Chart(s).Pie(e.data.data,a)}return o=angular.element(n).parent().width()},e.$watch(function(){return e.data},function(t){return null!=t?n(function(){return e.draw()},100):void 0},!0)}}}])}.call(this),function(){"use strict";angular.module("impac.services.chart-formatter",[]).service("ChartFormatterSvc",["ImpacTheming",function(e){var t,n,i,a,s,o,d,l;n=this,t=e.getChartColors(),this.getPositiveColor=function(){return t.positive},this.getNegativeColor=function(){return t.negative},this.getOthersColor=function(){return t.others},this.getColor=function(e){return t.array[e%t.array.length]},i=function(e){return e.replace(/#/,"")},o=function(e){return parseInt(i(e).substring(0,2),16)},s=function(e){return parseInt(i(e).substring(2,4),16)},a=function(e){return parseInt(i(e).substring(4,6),16)},d=function(e){return[o(e),s(e),a(e)].join(",")},l=function(e,t){return"rgba("+d(e)+","+t+")"},this.lineChart=function(e,t,i){var a;return null==t&&(t={}),null==i&&(i=!1),a=0,{chartType:"Line",options:t,data:{labels:e[0].labels,datasets:_.map(e,function(e){var t;return t=i?0===a?n.getNegativeColor():n.getPositiveColor():n.getColor(a),a++,{label:e.title,data:e.values,fillColor:l(t,.3),strokeColor:t,pointColor:t,pointStrokeColor:t,pointHighlightFill:t,pointHighlightStroke:l(t,.3)}})}}},this.barChart=function(e,t,i){var a;return null==t&&(t={}),null==i&&(i=!0),a=0,{chartType:"Bar",options:t,data:{labels:[""],datasets:_.map(e.values,function(t){var s;return s=n.getColor(a),a++,null==t&&(t=0,s="rgba(0,0,0,0)"),i&&0>t&&(t=-t),{label:e.labels[a]||"",data:[t],fillColor:s,strokeColor:s,highlightFill:s,highlightStroke:s}})}}},this.pieChart=function(e,t,i){var a;return null==t&&(t={}),null==i&&(i=!1),a=0,{chartType:"Pie",options:t,data:_.map(e,function(e){var t;return t=i?0===a?n.getNegativeColor():n.getPositiveColor():n.getColor(a),a++,{value:e.value,label:e.label,color:t,highlight:l(t,.7)}})}}}])}.call(this),function(){"use strict";var e;e=angular.module("impac.components.dashboard",[]),e.controller("ImpacDashboardCtrl",["$scope","$http","$q","$filter","$modal","$log","$timeout","$templateCache","DhbAnalyticsSvc","MsgBus","Utilities","ImpacAssets",function(e,t,n,i,a,s,o,d,l,r,c,g){var u,v,m,p,h;return e.impacTitleLogo=g.get("impacTitleLogo"),e.impacDashboardBackground=g.get("impacDashboardBackground"),e.widgetsList=[],e.isLoading=!0,e.starWizardModal={value:!1},r.publish("starWizardModal",e.starWizardModal),e.openStarWizard=function(){return e.starWizardModal.value=!0},l.load().then(function(){return e.currentDhbId=l.getId(),e.refreshDashboards(),e.isLoading=!1}),e.refreshDashboards=function(){return e.dashboardsList=l.getDashboards(),e.dashboardsList.length&&null!=e.dashboardsList[0].widgets_templates&&(e.widgetsList=e.dashboardsList[0].widgets_templates),e.currentDhb=_.where(e.dashboardsList,{id:e.currentDhbId})[0],null==e.currentDhb&&(e.currentDhb=e.dashboardsList[0],e.currentDhbId=null!=e.currentDhb&&e.currentDhb.id||null),angular.isDefined(e.currentDhb)&&(e.currentDhb.organizationsNames=_.map(e.currentDhb.data_sources,function(e){return e.label}).join(", ")),e.setDisplay()},e.getCurrentDhbWidgetsNumber=function(){return e.currentDhb&&e.currentDhb.widgets?e.currentDhb.widgets.length:0},e.$watch(e.getCurrentDhbWidgetsNumber,function(){return e.setDisplay()}),e.setDisplay=function(){var t,n,i;return t=null!=e.currentDhbId,i=t&&e.dashboardsList.length>1,n=t?e.currentDhb.widgets.length>0:!1,t&&!n?o(function(){return e.showWidgetSelector=!0},300):t||(e.showWidgetSelector=!1),e.showDashboardsList=!1,e.showChangeDhbName=!1,e.showCreateDhb=!0,e.showDeleteDhb=t,e.showCreateWidget=t,e.showChooseDhbMsg=!t,e.showNoWidgetsMsg=t&&!n,e.canManageWidgets=!0},e.selectDashboard=function(t){return e.currentDhbId=t,e.refreshDashboards()},e.toogleShowDashboardsList=function(){return e.showChangeDhbName?void 0:e.showDashboardsList=e.dashboardsList.length>1||e.showCreateDhb?!e.showDashboardsList:!1},e.toogleShowChangeDhbName=function(t){var n;return n=angular.copy(t),e.dashboardToChange={},e.dashboardToChange.id=n.id,e.dashboardToChange.name=n.full_name,e.showChangeDhbName=!e.showChangeDhbName,o(function(){var e;return e=$("#changeDhbNameInput"),e.select(),e.focus()},100)},e.checkChangeDhbNameAndConfirm=function(t){return 13===t.keyCode&&e.updateDhbName(),27===t.keyCode?e.showChangeDhbName=!1:void 0},e.updateDhbName=function(){return null==e.dashboardToChange||_.isEmpty(e.dashboardToChange.name)?void 0:(l.dashboards.update(e.dashboardToChange.id,{name:e.dashboardToChange.name}),_.find(e.dashboardsList,function(t){return t.id===e.dashboardToChange.id}).full_name=e.dashboardToChange.name,e.showChangeDhbName=!1)},e.selectedCategory="accounts",e.isCategorySelected=function(t){return null!=e.selectedCategory&&null!=t?e.selectedCategory===t:!1},e.getSelectedCategoryName=function(){if(null==e.selectedCategory)return!1;switch(e.selectedCategory){case"accounts":return"Accounting";case"invoices":return"Invoicing";case"hr":return"HR / Payroll";case"sales":return"Sales";default:return!1}},e.getSelectedCategoryTop=function(){if(null==e.selectedCategory)return!1;switch(e.selectedCategory){case"accounts":return{top:"33px"};case"invoices":return{top:"64px"};case"hr":return{top:"95px"};case"sales":return{top:"126px"};default:return{top:"9999999px"}}},e.getWidgetsForSelectedCategory=function(){return null!=e.selectedCategory&&null!=e.widgetsList?_.select(e.widgetsList,function(t){return t.path.split("/")[0]===e.selectedCategory}):[]},e.addWidget=function(t,n){var i;return null==n&&(n=null),i={widget_category:t},null!=n&&angular.extend(i,{metadata:n}),angular.element("#widget-selector").css("cursor","progress"),angular.element("#widget-selector .top-container .row.lines p").css("cursor","progress"),l.widgets.create(e.currentDhbId,i).then(function(){return e.errors="",angular.element("#widget-selector").css("cursor","auto"),angular.element("#widget-selector .top-container .row.lines p").css("cursor","pointer"),angular.element("#widget-selector .badge.confirmation").fadeTo(250,1),o(function(){return angular.element("#widget-selector .badge.confirmation").fadeTo(700,0)},4e3)},function(t){return e.errors=c.processRailsError(t),angular.element("#widget-selector").css("cursor","auto"),angular.element("#widget-selector .top-container .row.lines p").css("cursor","pointer")})["finally"](function(){return e.setDisplay()})},e.modal={},e.modal.createDashboard=u=e.$new(!0),e.modal.deleteDashboard=v=e.$new(!0),e.modal.widgetSuggestion=m=e.$new(!0),u.config={action:"create",instance:{backdrop:"static",template:d.get("dashboard/create.modal.html"),size:"md",windowClass:"inverse connec-analytics-modal",scope:u}},u.open=function(){var t;return t=u,t.model={name:null},t.organizations=angular.copy(e.user.organizations),t.currentOrganization=_.findWhere(t.organizations,{id:DhbOrganizationSvc.getId()}),t.selectMode("single"),t.loadingGif=g.get("loader-darkblue-bg.gif"),t.$instance=a.open(t.config.instance),t.isLoading=!1,t.multiOrganizationReporting=e.user.multi_organization_reporting},u.close=function(){return u.$instance.close()},u.proceed=function(){var t,n,i;return i=u,i.isLoading=!0,t={name:i.model.name},n="multi"===i.mode?_.select(i.organizations,function(e){return e.$selected}):[{id:DhbOrganizationSvc.getId()}],n.length>0&&(t.organization_ids=_.pluck(n,"id")),l.dashboards.create(t).then(function(t){return i.errors="",e.currentDhbId=t.id,i.close()},function(e){return i.errors=c.processRailsError(e)})["finally"](function(){return e.refreshDashboards()})},u.proceedDisabled=function(){var e,t,n;return n=u,t=_.select(n.organizations,function(e){return e.$selected}),e=!n.model.name||""===n.model.name,e||(e=0===t.length),e||(e=0===_.select(t,function(e){return n.canAccessAnalyticsData(e)}).length),n.isLoading||e},u.btnBlassFor=function(e){var t;return t=u,e===t.mode?"btn btn-sm btn-warning active":"btn btn-sm btn-default"},u.selectMode=function(e){var t;return t=u,_.each(t.organizations,function(e){return e.$selected=!1}),t.currentOrganization.$selected="single"===e,t.mode=e},u.isSelectOrganizationShown=function(){return"multi"===u.mode},u.isCurrentOrganizationShown=function(){return"single"===u.mode},u.canAccessAnalyticsForCurrentOrganization=function(){var e;return e=u,e.canAccessAnalyticsData(e.currentOrganization)},u.isMultiCompanyAvailable=function(){return u.organizations.length>1&&u.multiOrganizationReporting},u.canAccessAnalyticsData=function(e){return e.current_user_role&&("Super Admin"===e.current_user_role||"Admin"===e.current_user_role)},v.config={action:"delete",instance:{backdrop:"static",template:d.get("dashboard/delete.modal.html"),size:"md",windowClass:"inverse",scope:v}},v.open=function(){var e;return e=v,e.loadingGif=g.get("loader-darkblue-bg.gif"),e.$instance=a.open(e.config.instance),e.isLoading=!1},v.close=function(){return v.$instance.close()},v.proceed=function(){var t;return t=v,t.isLoading=!0,l.dashboards["delete"](e.currentDhbId).then(function(){return t.errors="",e.currentDhbId=l.getId(),t.close()},function(e){return t.errors=c.processRailsError(e)})["finally"](function(){return e.refreshDashboards()})},m.widgetDetails={},m.config={instance:{backdrop:"static",template:d.get("dashboard/widget-suggestion.modal.html"),size:"md",windowClass:"inverse impac-widget-suggestion",scope:m}},m.open=function(){var e;return e=m,e.userName=UserSvc.document.user.name,e.loadingGif=g.get("loader-darkblue-bg.gif"),e.$instance=a.open(e.config.instance),e.isLoading=!1},m.close=function(){return m.$instance.close()},m.proceed=function(){var e,n;return n=m,n.isLoading=!0,e={widget_name:n.widgetDetails.name,widget_category:n.widgetDetails.category,widget_description:n.widgetDetails.description},t.post("/js_api/v1/mailers",{template:"widget_suggestion",opts:e}),o(function(){return n.close(),n.widgetDetails={},n.isLoading=!1},3e3)},e.sortableOptions={stop:p=function(){var t;return t={widgets_order:_.pluck(e.currentDhb.widgets,"id")},l.dashboards.update(e.currentDhbId,t,!1)},start:h=function(e,t){return t.placeholder.css("width",t.item.width()-1),t.placeholder.css("height",t.item.height())},cursorAt:{left:100,top:20},opacity:.5,delay:150,tolerance:"pointer",placeholder:"placeHolderBox",cursor:"move",revert:250}}]),e.directive("impacDashboard",["$templateCache",function(e){return{restrict:"EA",scope:{dashboards:"="},template:e.get("dashboard/dashboard.tmpl.html"),controller:"ImpacDashboardCtrl"}}])}.call(this),function(){"use strict";angular.module("impac.services.linking",[]).provider("ImpacLinking",function(){var e,t,n;return n=this,t={organizations:null,ssoSession:null},n.linkData=function(e){_.forIn(t,function(n,i){var a;if(a=e[i],null==a)throw"Missing core data to run impac-angular, please refer to impac.services.linking module or impac-angular README.md on required provider configurations.";return t[i]=a})},e=function(){var e;return e=this,e.getOrganizations=function(){return t.organizations()},e.getSsoSession=function(){return t.ssoSession()},e},e.$inject=[],n.$get=e,n})}.call(this),function(){"use strict";angular.module("impac.services.message-bus",[]).service("MsgBus",function(){var e;e={dashboardGrid:{},controlBarFilter:{},controlBarQuickFilter:{},orgaSharingModal:{},appConnectModal:{},page:{},pane:{},errors:[],autostopQueue:[],notificationQueue:[],params:{}},this.publish=function(t,n){return e[t]=n},this.subscribe=function(t){return function(){return e[t]}}})}.call(this),function(){"use strict";angular.module("impac.services.routes",[]).provider("ImpacRoutes",function(){var e,t,n;return n=this,t={dhbBasePath:"/mnoe/jpi/v1/impac/dashboards",widgetBasePath:"/mnoe/jpi/v1/impac/widgets",showWidgetPath:"http://localhost:4000/api/v1/get_widget"},n.configureRoutes=function(e){return angular.extend(t,e)},e=function(){var e;return e=this,e.baseDhbPath=function(){return t.dhbBasePath},e.showDhbPath=function(e){return t.dhbBasePath+"/"+e},e.createDhbPath=function(){return t.dhbBasePath},e.updateDhbPath=function(t){return e.showDhbPath(t)},e.deleteDhbPath=function(t){return e.showDhbPath(t)},e.showWidgetPath=function(){return t.showWidgetPath},e.widgetBasePath=function(e){return t.widgetBasePath+"/"+e},e.createWidgetPath=function(t){return e.showDhbPath(t)+"/widgets"},e.updateWidgetPath=function(t){return e.widgetBasePath(t)},e.deleteWidgetPath=function(t){return e.widgetBasePath(t)},e},e.$inject=[],n.$get=e,n})}.call(this),function(){"use strict";angular.module("impac.services.theming",[]).provider("ImpacTheming",function(){var e,t,n;return n=this,t={chartColors:{positive:"#3FC4FF",negative:"#1DE9B6",array:["#1de9b6","#7c4dff","#ffc928","#3fc4ff","#ff8e01","#c6ff00","#d500fa","#ff6e41","#ffeb3c","#ff1844"]}},n.configureChartTheme=function(e){return angular.extend(t.chartColors,e)},e=function(){var e;return e=this,e.getChartColors=function(){return t.chartColors},e},e.$inject=[],n.$get=e,n})}.call(this),function(){"use strict";angular.module("impac.services.utilities",[]).service("Utilities",function(){this.processRailsError=function(e){var t;return t=[],e.status&&401===e.status?t.push("Sorry! You are not authorized to perform this action"):e.data&&" "!==e.data?angular.isArray(e.data)?_.each(e.data,function(e){var n;return n=e.charAt(0).toUpperCase()+e.slice(1),t.push(""+n)}):angular.isObject(e.data)?_.each(e.data,function(e,n){var i;return i=n.charAt(0).toUpperCase()+n.slice(1),angular.isArray(e)?_.each(e,function(e){return i.match(/base/i)?t.push(e):t.push(i+" "+e)}):i.match(/base/i)?t.push(e):t.push(i+" "+e)}):angular.isString(e.data)?t.push(e.data):t.push("Potentially a system or communication error. Please retry later."):t.push("Potentially a system or communication error. Please retry later."),t},this.camelize=function(e){return e.replace(/(?:^|[-_])(\w)/g,function(e,t){return t?t.toUpperCase():""})},this.jsCamelize=function(e){var t;return t=this.camelize(e),t.charAt(0).toLowerCase()+t.slice(1)},this.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widget",[]),e.controller("ImpacWidgetCtrl",["$scope","$timeout","DhbAnalyticsSvc","Utilities",function(e,t,n,i){var a,s,o;return e.loaderImage="",a=function(e,t){return angular.forEach(t,function(t,n){return e[n]&&e[n].constructor&&e[n].constructor===Object?a(e[n],t):e[n]=t})},o=e.widget||{},o.parentDashboard||(o.parentDashboard=e.parentDashboard),o.settings=[],o.isLoading=!0,o.hasEditAbility=!0,o.hasDeleteAbility=!0,o.loadContent=function(e){return null==e&&(e=!1),o.isLoading=!0,n.widgets.show(o,e).then(function(e){var t;return console.log("widget loadContent SUCCESS: ",e),t=e.data,t.content||(t.content={}),t.originalName=t.name,angular.extend(o,t),o.initContext(),o.initSettings(),o.isLoading=!1,angular.isDefined(o.format)?o.format():void 0},function(e){return o.errors=i.processRailsError(e),o.isLoading=!1})},o.loadContent(),o.initSettings=function(){return angular.forEach(o.settings,function(e){return e.initialize()}),o.isEditMode=!1,!0},o.updateSettings=function(e){var t;return null==e&&(e=!0),t={},angular.forEach(o.settings,function(e){return a(t,e.toMetadata())}),_.isEmpty(t)||s(t,e),!0},s=function(e,t){var a;return null==t&&(t=!0),_.isEmpty(e)?void 0:(a={metadata:e},t&&(o.isLoading=!0),n.widgets.update(o,a).then(function(e){return angular.extend(o,e.data),t?o.loadContent():void 0},function(e){return o.errors=i.processRailsError(e),o.isLoading=!1}))},o.getColClass=function(){return"col-md-"+o.width}}]),e.directive("impacWidget",["$templateCache",function(e){return{restrict:"A",scope:{parentDashboard:"=",widget:"="},controller:"ImpacWidgetCtrl",link:function(t){var n,i;return n=angular.copy(t.widget.category).split("/"),i=n.join("-").replace(/_/g,"-"),t.templateUrl="widgets/"+i+".tmpl.html",t.isTemplateLoaded=function(){return!!e.get(t.templateUrl)}},template:'<div ng-show="isTemplateLoaded()" ng-include="templateUrl"></div><div ng-hide="isTemplateLoaded()"><div class="top-line"><div common-top-buttons parent-widget="widget" /> <div common-editable-title parent-widget="widget" /></div><div class="content"><div class="loader" align="center"><img class="gif" ng-src="{{loaderImage}}"/></div></div></div>'}}])}.call(this),function(){"use strict";angular.module("impac.services.widget-templates",[]).service("WidgetTemplateSvc",["$http","$filter","$timeout",function(e,t,n){var i;i=this,this.config={createPath:"/js_api/v1/impac/widget_templates/",indexPath:"/js_api/v1/impac/widget_templates/",categoriesPath:"/js_api/v1/impac/widget_templates/categories",newCategoryPath:"/js_api/v1/impac/widget_templates/category",lastUpdatePath:"/js_api/v1/impac/widget_templates/last_update",previewAppsPath:"/js_api/v1/impac/widget_templates/preview_apps",generatePdfPath:"/js_api/v1/impac/widget_templates/generate_pdf",deletePath:function(e){return"/js_api/v1/impac/widget_templates/"+e},updatePath:function(e){return"/js_api/v1/impac/widget_templates/"+e},showPath:function(e){return"/js_api/v1/impac/widget_templates/"+e},screenshotPath:function(e){return"/js_api/v1/impac/widget_templates/"+e+"/update_screenshot"},catalogueImgPath:function(e){return"/js_api/v1/impac/widget_templates/"+e+"/update_catalogue_img"},updateCategoryPath:function(e){return"/js_api/v1/impac/widget_templates/update_category/"+e}},this.create=function(t){return e.post(i.config.createPath,t.model).then(function(e){return t.model.id=e.data.id,i.updateImg(t,t.screenshot,!0)},function(e){return e})},this.index=function(){return e.get(i.config.indexPath).then(function(e){return e.data.widget_templates})},this.categories=function(){return e.get(i.config.categoriesPath).then(function(e){return t("orderBy")(e.data.categories,"id")})},this.updateCategory=function(t){return e.put(i.config.updateCategoryPath(t.id),t)},this.destroy=function(t){return e["delete"](i.config.deletePath(t)).then(function(e){return e})},this.update=function(t){return e.put(i.config.updatePath(t.model.id),t.model).then(function(){return i.updateImg(t,t.screenshot,!0)},function(e){return e})},this.updateImg=function(t,a,s){var o,d,l;return null==s&&(s=!0),null!=t?null!=a?(l=s?i.config.screenshotPath(t.model.id):i.config.catalogueImgPath(t.model.id),d={transformRequest:angular.identity,headers:{"Content-Type":void 0}},o=new FormData,o.append("file",a),e.put(l,o,d).then(function(e){return s?(t.model.screenshot=e.data,n(function(){return t.saveCatalogueImg()},300)):(t.model.catalogueImg=e.data,t.afterSave())})):t.saveCatalogueImg():void 0},this.show=function(t){return e.get(i.config.showPath(t)).then(function(e){return e.data.widget_template})},this.createCategory=function(t){return e.post(i.config.newCategoryPath,t)},this.lastUpdate=function(){return e.get(i.config.lastUpdatePath).then(function(e){return e.data.last_update.last_update})},this.previewApps=function(t){return null!=t.endpoints?e.post(i.config.previewAppsPath,{endpoints:t.endpoints}).then(function(e){return t.model.compatible_apps=e.data}):void 0},this.generatePdf=function(){return e.post(i.config.generatePdfPath)}}])}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.accounts-accounting-values",[]),e.controller("WidgetAccountsAccountingValuesCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(e,t,n){var i,a;return a=e.widget,a.initContext=function(){return e.isDataFound=null!=a.content&&null!=a.content.accounting},a.format=function(){var t,i,s,o;return e.isDataFound?(i=angular.copy(a.content.accounting),s={title:i.type,labels:i.dates,values:i.values},t=!0,angular.forEach(i.values,function(e){return t&&(t=e>=0)}),o={scaleBeginAtZero:t,showXLabels:!1},a.chart=n.lineChart([s],o)):void 0},e.getCurrentPrice=function(){return e.isDataFound?_.last(a.content.accounting.values):void 0},e.getCurrency=function(){return e.isDataFound?a.content.accounting.currency:void 0},e.getLegend=function(){return e.isDataFound?a.content.accounting.legend:void 0},i=function(){return null!=a.settings?a.settings.length:0},e.$watch(i,function(e){return 3===e?a.loadContent():void 0}),a}]),e.directive("widgetAccountsAccountingValue",function(){return{restrict:"A",link:function(e,t){return t.addClass("accounts"),t.addClass("accounting-value")},controller:"WidgetAccountsAccountingValuesCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.accounts-assets-summary",[]),e.controller("WidgetAccountsAssetsSummaryCtrl",["$scope","ChartFormatterSvc",function(e,t){var n,i;return i=e.widget,i.initContext=function(){return e.isDataFound=angular.isDefined(i.content)&&!_.isEmpty(i.content.summary)},i.format=function(){var n,a;return e.isDataFound?(n=_.map(i.content.summary,function(e){return{label:e.label,value:e.total}}),a={percentageInnerCutout:50,tooltipFontSize:12},i.chart=t.pieChart(n,a)):void 0},e.getCurrency=function(){return e.isDataFound?i.content.currency:void 0},e.getAccountColor=function(n){return e.isDataFound?t.getColor(_.indexOf(i.content.summary,n)):void 0},n=function(){return null!=i.settings?i.settings.length:0},e.$watch(n,function(e){return 1===e?i.loadContent():void 0}),i}]),e.directive("widgetAccountsAssetsSummary",function(){return{restrict:"A",link:function(e,t){return t.addClass("accounts"),t.addClass("assets-summary")},controller:"WidgetAccountsAssetsSummaryCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.accounts-balance",[]),e.controller("WidgetAccountsBalanceCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(e,t,n){var i,a;return a=e.widget,a.initContext=function(){return e.isDataFound=null!=a.content&&!_.isEmpty(a.content.account_list)},a.format=function(){var t,i,s,o;return e.isDataFound&&null!=a.selectedAccount?(i=angular.copy(a.selectedAccount),s={title:i.name,labels:a.content.dates,values:i.balances},t=!0,angular.forEach(i.balances,function(e){return t&&(t=e>=0)}),o={scaleBeginAtZero:t,showXLabels:!1},a.chart=n.lineChart([s],o)):void 0},e.getName=function(){return null!=a.selectedAccount?a.selectedAccount.name:void 0},e.getCurrentBalance=function(){return null!=a.selectedAccount?a.selectedAccount.current_balance:void 0},e.getCurrency=function(){return null!=a.selectedAccount?a.selectedAccount.currency:void 0},e.$watch(function(){return a.isEditMode},function(){return null==a.selectedAccount?a.isEditMode=!0:void 0}),i=function(){return null!=a.settings?a.settings.length:0},e.$watch(i,function(e){return 4===e?a.loadContent():void 0}),a}]),e.directive("widgetAccountsBalance",function(){return{restrict:"A",link:function(e,t){return t.addClass("accounts"),t.addClass("balance")},controller:"WidgetAccountsBalanceCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.accounts-balance-sheet",[]),e.controller("WidgetAccountsBalanceSheetCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(e){var t,n,i;return i=e.widget,i.initContext=function(){return(e.isDataFound=angular.isDefined(i.content)&&!_.isEmpty(i.content.summary)&&!_.isEmpty(i.content.dates))?(e.periodOptions=[{label:"Year",value:"YEARLY"},{label:"Quarter",value:"QUARTERLY"},{label:"Month",value:"MONTHLY"},{label:"Week",value:"WEEKLY"},{label:"Day",value:"DAILY"}],e.period=_.find(e.periodOptions,function(e){return e.value===i.content.period})||e.periodOptions[2],e.dates=i.content.dates,e.unCollapsed=i.metadata.unCollapsed||[],e.categories=Object.keys(i.content.summary)):void 0},e.toogleCollapsed=function(t){return null!=t?(_.find(e.unCollapsed,function(e){return t===e})?e.unCollapsed=_.reject(e.unCollapsed,function(e){return e===t}):e.unCollapsed.push(t),i.updateSettings(!1)):void 0},e.isCollapsed=function(t){return null!=t?_.find(e.unCollapsed,function(e){return t===e})?!1:!0:void 0},n={},n.initialized=!1,n.initialize=function(){return n.initialized=!0},n.toMetadata=function(){return{unCollapsed:e.unCollapsed}},i.settings.push(n),t=function(){return null!=i.settings?i.settings.length:0},e.$watch(t,function(e){return e>=3?i.loadContent():void 0}),i}]),e.directive("widgetAccountsBalanceSheet",function(){return{restrict:"A",link:function(e,t){return t.addClass("accounts"),t.addClass("balance-sheet")},controller:"WidgetAccountsBalanceSheetCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.accounts-cash-summary",[]),e.controller("WidgetAccountsCashSummaryCtrl",["$scope","ChartFormatterSvc","$filter",function(e,t,n){var i,a,s,o;return o=e.widget,o.initContext=function(){return(e.isDataFound=angular.isDefined(o.content)&&!_.isEmpty(o.content.summary)&&!_.isEmpty(o.content.dates))&&(e.dates=o.content.dates,e.unCollapsed=o.metadata.unCollapsed||[],o.metadata.selectedElement&&(e.selectedElement=_.find(o.content.summary,function(e){return e.name===o.metadata.selectedElement.name}),e.selectedElement||angular.forEach(o.content.summary,function(t){return null!=t.accounts?e.selectedElement||(e.selectedElement=_.find(t.accounts,function(e){return e.id===o.metadata.selectedElement.id})):void 0})),null==e.selectedElement)?o.width=6:void 0},o.format=function(){var i,a,s,d,l;return e.isDataFound&&null!=e.selectedElement?(a=angular.copy(e.selectedElement),d=_.map(o.content.dates,function(e){return null!=o.metadata.hist_parameters&&"YEARLY"===o.metadata.hist_parameters.period?n("date")(e,"yyyy"):null!=o.metadata.hist_parameters&&"QUARTERLY"===o.metadata.hist_parameters.period?n("date")(e,"MMM-yy"):null==o.metadata.hist_parameters||"WEEKLY"!==o.metadata.hist_parameters.period&&"DAILY"!==o.metadata.hist_parameters.period?n("date")(e,"MMM"):n("date")(e,"dd-MMM")}),s={title:a.name,labels:d,values:a.cash_flows},i=!0,angular.forEach(a.cash_flows,function(e){return i&&(i=e>=0)}),l={scaleBeginAtZero:i,showXLabels:!0},o.chart=t.lineChart([s],l)):void 0},e.getLastDate=function(){return null!=e.dates?_.last(e.dates):void 0},e.getLastValue=function(e){return null!=e.cash_flows?_.last(e.cash_flows):void 0},e.formatVariance=function(e){return null!=e?e>0?"+"+e+" %":e+" %":"n/a"},e.getLastVariance=function(t){return null!=t.variances&&null!=_.last(t.variances)?e.formatVariance(_.last(t.variances)):"n/a"},e.getVarianceClassColor=function(e){return parseInt(e)>0?"positive":parseInt(e)<0?"negative":null},e.getName=function(e){return null!=e&&null!=e.name?e.name.replace("_"," "):void 0},e.toogleSelectedElement=function(t){return e.isSelected(t)?(e.selectedElement=null,o.isExpanded()?o.toogleExpanded():o.updateSettings(!1)):(e.selectedElement=angular.copy(t),o.format(),o.isExpanded()?o.updateSettings(!1):o.toogleExpanded())},e.isSelected=function(t){return null!=t&&null!=e.selectedElement?null!=t.id&&e.selectedElement.id&&t.id===e.selectedElement.id||t.name===e.selectedElement.name?!0:!1:!1},e.toogleCollapsed=function(t){return null!=t&&null!=t.name?(_.find(e.unCollapsed,function(e){return t.name===e})?e.unCollapsed=_.reject(e.unCollapsed,function(e){return e===t.name}):e.unCollapsed.push(t.name),o.updateSettings(!1)):void 0},e.isCollapsed=function(t){return null!=t&&null!=t.name?_.find(e.unCollapsed,function(e){return t.name===e})?!1:!0:void 0},s={},s.initialized=!1,s.initialize=function(){return s.initialized=!0},s.toMetadata=function(){return{unCollapsed:e.unCollapsed}},o.settings.push(s),a={},a.initialized=!1,a.initialize=function(){return a.initialized=!0},a.toMetadata=function(){return{selectedElement:e.selectedElement}},o.settings.push(a),i=function(){return null!=o.settings?o.settings.length:0},e.$watch(i,function(e){return 5===e?o.loadContent():void 0}),o}]),e.directive("widgetAccountsCashSummary",function(){return{restrict:"A",link:function(e,t){return t.addClass("accounts"),t.addClass("cash-summary")},controller:"WidgetAccountsCashSummaryCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.accounts-comparison",[]),e.controller("WidgetAccountsComparisonCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(e,t,n,i){var a,s;return s=e.widget,s.initContext=function(){return e.isDataFound=null!=s.content&&!_.isEmpty(s.content.complete_list),e.movedAccount={}},s.format=function(){var e,t;for(e={labels:[],values:[]},_.map(s.selectedAccounts,function(t){return e.labels.push(t.name),e.values.push(t.current_balance)});e.values.length<15;)e.labels.push(""),e.values.push(null);return t={showTooltips:!1,showXLabels:!1,barDatasetSpacing:9},s.chart=n.barChart(e,t)},e.hasAccountsSelected=function(){return s.selectedAccounts&&s.selectedAccounts.length>0},e.getAccountColor=function(e){return n.getColor(_.indexOf(s.selectedAccounts,e))
},e.addAccount=function(e){return s.moveAccountToAnotherList(e,s.remainingAccounts,s.selectedAccounts),s.format()},e.removeAccount=function(e){return s.moveAccountToAnotherList(e,s.selectedAccounts,s.remainingAccounts),s.format()},e.formatAmount=function(e){return i("mnoCurrency")(e.current_balance,e.currency)},a=function(){return null!=s.settings?s.settings.length:0},e.$watch(a,function(e){return e>=2?s.loadContent():void 0}),s}]),e.directive("widgetAccountsComparison",function(){return{restrict:"A",link:function(e,t){return t.addClass("accounts"),t.addClass("comparison")},controller:"WidgetAccountsComparisonCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.accounts-custom-calculation",[]),e.controller("WidgetAccountsCustomCalculationCtrl",["$scope","$timeout","$modal","DhbAnalyticsSvc","$templateCache",function(e,t,n,i,a){var s,o;return o=e.widget,e.loaderImage="",o.initContext=function(){return e.movedAccount={},e.isDataFound=null!=o.content&&!_.isEmpty(o.content.complete_list)},e.addAccountToFormula=function(e){return o.selectedAccounts.length>0?o.formula+=" + {"+(o.selectedAccounts.length+1)+"}":o.formula="{1}",o.moveAccountToAnotherList(e,o.remainingAccounts,o.selectedAccounts,!1)},e.removeAccountFromFormula=function(e){var t,n,i,a,s,d,l,r;for(l=_.map(o.selectedAccounts,function(e){return e.uid}),d=_.reject(l,function(t){return t===e.uid}),n=_.first(_.difference(l,d)),t=_.indexOf(l,n)+1,r=1===t?"{"+t+"\\}\\s*(-|\\*|\\/|\\+)*\\s*":"\\s*(-|\\*|\\/|\\+)*\\s*\\{"+t+"\\}",s=angular.copy(o.formula).replace(new RegExp(r,"g"),""),i=t+1;i<=l.length;)a="\\{"+i+"\\}",s=s.replace(new RegExp(a,"g"),"{"+(i-1)+"}"),i++;return o.formula=angular.copy(s),o.moveAccountToAnotherList(e,o.selectedAccounts,o.remainingAccounts,!1)},e.formulaModal={},e.formulaModal.config={instance:{backdrop:"static",template:a.get("widgets/accounts-custom-calculation/formula.modal.html"),size:"lg",scope:e,keyboard:!1}},e.formulaModal.open=function(){var i;return o.settings=angular.copy(_.reject(o.settings,function(e){return"organizations"===e.key})),i=e.formulaModal,i.$instance=n.open(i.config.instance),t(function(){return o.initSettings()},200)},e.$watch(function(){return o.selectedOrganizations},function(e){return _.isEmpty(e)?void 0:o.updateSettings()},!0),e.formulaModal.cancel=function(){return o.initSettings(),e.formulaModal.close()},e.formulaModal.proceed=function(){return o.updateSettings(!1),e.formulaModal.close()},e.formulaModal.close=function(){return e.formulaModal.$instance.close()},e.$watch(function(){return o.isEditMode},function(t,n){return t&&!n?e.formulaModal.open():void 0}),s=function(){return null!=o.settings?o.settings.length:0},e.$watch(s,function(t){return 3!==t||e.blockLoadContent?void 0:(o.loadContent(),e.blockLoadContent=!0)}),o}]),e.directive("widgetAccountsCustomCalculation",function(){return{restrict:"A",link:function(e,t){return t.addClass("accounts"),t.addClass("custom-calculation")},controller:"WidgetAccountsCustomCalculationCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.accounts-expenses-revenue",[]),e.controller("WidgetAccountsExpensesRevenueCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(e,t,n){var i,a;return a=e.widget,a.initContext=function(){return e.isDataFound=null!=a.content&&null!=a.content.values},a.format=function(){var t,i,s,o,d;return e.isDataFound?(i=[{title:"Expenses ("+e.getCurrency()+")",labels:a.content.dates,values:a.content.values.expenses},{title:"Revenue ("+e.getCurrency()+")",labels:a.content.dates,values:a.content.values.revenue}],t=!0,angular.forEach(a.content.values.expenses,function(e){return t&&(t=e>=0)}),angular.forEach(a.content.values.revenue,function(e){return t&&(t=e>=0)}),s={scaleBeginAtZero:t,showXLabels:!1},a.hist_chart=n.lineChart(i,s,!0),o=[{label:"Expenses ("+e.getCurrency()+")",value:e.getCurrentExpenses()},{label:"Revenue ("+e.getCurrency()+")",value:e.getCurrentRevenue()}],d={tooltipFontSize:12,percentageInnerCutout:0},a.cur_chart=n.pieChart(o,d,!0)):void 0},e.getCurrentRevenue=function(){return e.isDataFound?_.last(a.content.values.revenue):void 0},e.getCurrentExpenses=function(){return e.isDataFound?_.last(a.content.values.expenses):void 0},e.getCurrency=function(){return e.isDataFound?a.content.currency:void 0},i=function(){return null!=a.settings?a.settings.length:0},e.$watch(i,function(e){return e>=3?a.loadContent():void 0}),a}]),e.directive("widgetAccountsExpensesRevenue",function(){return{restrict:"A",link:function(e,t){return t.addClass("accounts"),t.addClass("expenses-revenue")},controller:"WidgetAccountsExpensesRevenueCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.accounts-payable-receivable",[]),e.controller("WidgetAccountsPayableReceivableCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(e,t,n){var i,a;return a=e.widget,a.initContext=function(){return e.isDataFound=null!=a.content&&null!=a.content.values},a.format=function(){var t,i,s;return e.isDataFound?(i=[{title:"Payable",labels:a.content.dates,values:a.content.values.payables},{title:"Receivable",labels:a.content.dates,values:a.content.values.receivables}],t=!0,angular.forEach(a.content.values.payables,function(e){return t&&(t=e>=0)}),angular.forEach(a.content.values.receivables,function(e){return t&&(t=e>=0)}),s={scaleBeginAtZero:t,showXLabels:!1},a.chart=n.lineChart(i,s,!0)):void 0},e.getCurrentPayable=function(){return e.isDataFound?_.last(a.content.values.payables):void 0},e.getCurrentReceivable=function(){return e.isDataFound?_.last(a.content.values.receivables):void 0},e.getCurrency=function(){return e.isDataFound?a.content.currency:void 0},i=function(){return null!=a.settings?a.settings.length:0},e.$watch(i,function(e){return 3===e?a.loadContent():void 0}),a}]),e.directive("widgetAccountsPayableReceivable",function(){return{restrict:"A",link:function(e,t){return t.addClass("accounts"),t.addClass("payable-receivable")},controller:"WidgetAccountsPayableReceivableCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.accounts-profit-and-loss",[]),e.controller("WidgetAccountsProfitAndLossCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(e,t,n,i){var a,s,o,d;return d=e.widget,d.initContext=function(){return!(e.isDataFound=angular.isDefined(d.content)&&!_.isEmpty(d.content.summary)&&!_.isEmpty(d.content.dates))||(e.dates=d.content.dates,e.unCollapsed=d.metadata.unCollapsed||[],d.metadata.selectedElements&&(e.selectedElements=[],angular.forEach(d.metadata.selectedElements,function(t){var n;return n=_.find(d.content.summary,function(e){return e.name===t.name}),n||angular.forEach(d.content.summary,function(e){return null!=e.accounts?n||(n=_.find(e.accounts,function(e){return t.id===e.id})):void 0}),n?e.selectedElements.push(n):void 0})),null!=e.selectedElements&&e.selectedElements.length>0)?void 0:d.width=6},d.format=function(){var t,a,s;return e.isDataFound&&null!=e.selectedElements&&e.selectedElements.length>0?(t=!0,a=[],angular.forEach(e.selectedElements,function(e){var n,s;return n=angular.copy(e),s=_.map(d.content.dates,function(e){return d.metadata.hist_parameters&&"YEARLY"===d.metadata.hist_parameters.period?i("date")(e,"yyyy"):d.metadata.hist_parameters&&"QUARTERLY"===d.metadata.hist_parameters.period?i("date")(e,"MMM-yy"):!d.metadata.hist_parameters||"WEEKLY"!==d.metadata.hist_parameters.period&&"DAILY"!==d.metadata.hist_parameters.period?i("date")(e,"MMM"):i("date")(e,"dd-MMM")}),a.push({title:n.name,labels:s,values:n.totals}),angular.forEach(n.totals,function(e){return t&&(t=e>=0)})}),s={scaleBeginAtZero:t,showXLabels:!0,datasetFill:1===e.selectedElements.length,pointDot:1===e.selectedElements.length},d.chart=n.lineChart(a,s)):void 0},e.getElementChartColor=function(e){return n.getColor(e)},e.getLastDate=function(){return null!=e.dates?_.last(e.dates):void 0},e.getLastValue=function(e){return null!=e.totals?_.last(e.totals):void 0},e.getClassColor=function(e){return parseInt(e)>0?"positive":parseInt(e)<0?"negative":null},e.getName=function(e){return null!=e&&null!=e.name?e.name.replace(/_/g," "):void 0},e.toogleSelectedElement=function(t){return e.isSelected(t)?(e.selectedElements=_.reject(e.selectedElements,function(e){return t.id?e.id===t.id:e.name===t.name}),d.format(),d.isExpanded()&&0===e.selectedElements.length?d.toogleExpanded():d.updateSettings(!1)):(e.selectedElements||(e.selectedElements=[]),e.selectedElements.push(t),d.format(),d.isExpanded()?d.updateSettings(!1):d.toogleExpanded())},e.isSelected=function(t){return null!=t&&null!=e.selectedElements?_.find(e.selectedElements,function(e){return t.id?e.id===t.id:e.name===t.name})?!0:!1:!1},e.toogleCollapsed=function(t){return null!=t&&null!=t.name?(_.find(e.unCollapsed,function(e){return t.name===e})?e.unCollapsed=_.reject(e.unCollapsed,function(e){return e===t.name}):e.unCollapsed.push(t.name),d.updateSettings(!1)):void 0},e.isCollapsed=function(t){return null!=t&&null!=t.name?_.find(e.unCollapsed,function(e){return t.name===e})?!1:!0:void 0},o={},o.initialized=!1,o.initialize=function(){return o.initialized=!0},o.toMetadata=function(){return{unCollapsed:e.unCollapsed}},d.settings.push(o),s={},s.initialized=!1,s.initialize=function(){return s.initialized=!0},s.toMetadata=function(){return{selectedElements:e.selectedElements}},d.settings.push(s),a=function(){return null!=d.settings?d.settings.length:0},e.$watch(a,function(e){return e>=5?d.loadContent():void 0}),d}]),e.directive("widgetAccountsProfitAndLoss",function(){return{restrict:"A",link:function(e,t){return t.addClass("accounts"),t.addClass("profit-and-loss")},controller:"WidgetAccountsProfitAndLossCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.catalogue",[]),e.controller("ImpacWidgetCatalogueCtrl",["$scope","WidgetTemplateSvc","$http",function(e,t){var n,i;return e.loaderImage="",e.menu=n={},n.categories=[],n.loading=!0,n.init=function(){return n.loading=!0,t.categories().then(function(t){return n.categories=t,e.isAdmin||n.removeInactiveWidgets(),n.prepareCategories(),n.loading=!1})},n.removeInactiveWidgets=function(){return _.each(n.categories,function(e){return e.widgets=_(e.widgets).filter(function(e){return e.active})})},n.prepareCategories=function(){return n.categories=_(n.categories).filter(function(e){return _.isEmpty(e.widgets)===!1})},e.show=i={},i.widget=!1,i.loading=!1,i.get=function(e){return i.loading=!0,t.show(e).then(function(e){return i.widget=e,i.widget.settings=i.widget.settings.splice(0,6),i.widget.compatible_apps=i.widget.compatible_apps.splice(0,6),i.color=e.category_color||"#233845",i.loading=!1})},e.init=function(){return n.init()},e.init()}]),e.directive("impacWidgetCatalogue",["$templateCache",function(e){return{restrict:"A",scope:{isAdmin:"="},template:e.get("widgets/catalogue.tmpl.html"),controller:"ImpacWidgetCatalogueCtrl"}}])}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.hr-employee-details",[]),e.controller("WidgetHrEmployeeDetailsCtrl",["$scope","DhbAnalyticsSvc","Utilities","$filter",function(e,t,n,i){var a,s;return s=e.widget,s.initContext=function(){return(e.isDataFound=!_.isEmpty(s.content.employees))?(e.periodOptions=[{label:"Yearly",value:"yearly"},{label:"Monthly",value:"monthly"},{label:"Weekly",value:"weekly"},{label:"Hourly",value:"hourly"}],e.period=s.metadata&&s.metadata.period?_.find(e.periodOptions,function(e){return e.value===s.metadata.period.toLowerCase()})||e.periodOptions[0]:e.periodOptions[0],e.employeesOptions=_.map(s.content.employees,function(e){return{value:e.uid,label:e.lastname+" "+e.firstname}}),e.selectedEmployee={value:e.getEmployee().uid,label:e.getEmployee().lastname+" "+e.getEmployee().firstname}):void 0},e.getSingleCompanyName=function(){var e,t;return s.content&&s.content.organizations?(t=s.content.organizations[0],e=_.find(s.parentDashboard.data_sources,function(e){return e.uid===t}),e.label):void 0},e.getEmployee=function(){var t;return e.isDataFound?(t=s.metadata&&s.metadata.employee_uid?angular.copy(_.find(s.content.employees,function(e){return e.uid===s.metadata.employee_uid})||s.content.employees[0]):angular.copy(s.content.employees[0]),t.salary&&(t.salary=i("mnoCurrency")(t.salary.amount,t.salary.currency)),t):!1},e.formatAddress=function(e){return angular.isDefined(e)?e.replace(/, /g,",\n"):void 0},a=function(){return null!=s.settings?s.settings.length:0},e.$watch(a,function(e){return e>=4?s.loadContent():void 0}),s}]),e.directive("widgetHrEmployeeDetails",function(){return{restrict:"A",link:function(e,t){return t.addClass("hr"),t.addClass("employee-details")},controller:"WidgetHrEmployeeDetailsCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.hr-employees-list",[]),e.controller("WidgetHrEmployeesListCtrl",["$scope","DhbAnalyticsSvc","Utilities","$filter",function(e,t,n,i){var a,s;return s=e.widget,s.initContext=function(){return(e.isDataFound=!_.isEmpty(s.content.total)&&!_.isEmpty(s.content.employees))?(e.periodOptions=[{label:"Yearly",value:"yearly"},{label:"Monthly",value:"monthly"},{label:"Weekly",value:"weekly"},{label:"Hourly",value:"hourly"}],e.period=_.find(e.periodOptions,function(e){return e.value===s.content.total.period.toLowerCase()})||e.periodOptions[0]):void 0},e.getSingleCompanyName=function(){var e,t;return s.content&&s.content.organizations?(t=s.content.organizations[0],e=_.find(s.parentDashboard.data_sources,function(e){return e.uid===t}),e.label):void 0},e.getEmployeeSalary=function(e){return null!=e.salary?i("mnoCurrency")(e.salary.amount,s.content.total.currency):"-"},a=function(){return null!=s.settings?s.settings.length:0},e.$watch(a,function(e){return 2===e?s.loadContent():void 0}),s}]),e.directive("widgetHrEmployeesList",function(){return{restrict:"A",link:function(e,t){return t.addClass("hr"),t.addClass("employees-list")},controller:"WidgetHrEmployeesListCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.hr-leaves-balance",[]),e.controller("WidgetHrLeavesBalanceCtrl",["$scope","DhbAnalyticsSvc","Utilities",function(e){var t,n;return n=e.widget,n.initContext=function(){return(e.isDataFound=!_.isEmpty(n.content.employees)&&!_.isEmpty(n.content.dates))?(e.employeesOptions=_.map(n.content.employees,function(e){return{value:e.id,label:e.lastname+" "+e.firstname}}),e.selectedEmployee={value:e.getEmployee().id,label:e.getEmployee().lastname+" "+e.getEmployee().firstname}):void 0},e.getEmployee=function(){return e.isDataFound?n.metadata&&n.metadata.employee_id?_.find(n.content.employees,function(e){return e.id===n.metadata.employee_id})||n.content.employees[0]:n.content.employees[0]:!1},t=function(){return null!=n.settings?n.settings.length:0},e.$watch(t,function(e){return e>=3?n.loadContent():void 0}),n}]),e.directive("widgetHrLeavesBalance",function(){return{restrict:"A",link:function(e,t){return t.addClass("hr"),t.addClass("leaves-balance")},controller:"WidgetHrLeavesBalanceCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.hr-leaves-schedule",[]),e.controller("WidgetHrLeavesScheduleCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(e){var t,n;return n=e.widget,e.eventSources=[],n.initContext=function(){var t;return(e.isDataFound=angular.isDefined(n.content)&&!_.isEmpty(n.content.summary))?(t=[],angular.forEach(n.content.summary,function(e){return t.push({title:e.employee_name+" - "+e.title,start:e.start_date,end:e.end_date})}),e.eventSources=angular.copy(t)):void 0},t=function(){return null!=n.settings?n.settings.length:0},e.$watch(t,function(e){return e>=1?n.loadContent():void 0}),n}]),e.directive("widgetHrLeavesSchedule",function(){return{restrict:"A",link:function(e,t){return t.addClass("hr"),t.addClass("leaves-schedule")},controller:"WidgetHrLeavesScheduleCtrl"}}),e.directive("widgetComponentCalendar",function(){return{scope:{events:"=ngModel"},restrict:"A",link:function(e,t){var n,i;return n={header:{left:"prev",center:"title",right:"next"},contentHeight:204},i=function(){return e.events},e.$watch(i,function(i){return i.length>0?(t.fullCalendar("destroy"),angular.extend(n,{events:e.events}),t.fullCalendar(n)):void 0},!0)}}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.hr-payroll-summary",[]),e.controller("WidgetHrPayrollSummaryCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(e,t,n,i){var a,s,o,d;return d=e.widget,d.initContext=function(){return!(e.isDataFound=angular.isDefined(d.content)&&!_.isEmpty(d.content.summary)&&!_.isEmpty(d.content.dates))||(e.unCollapsed=d.metadata.unCollapsed||[],d.metadata.selectedElements&&(e.selectedElements=[],angular.forEach(d.metadata.selectedElements,function(t){var n;return n=_.find(d.content.summary,function(e){return e.name===t.name}),n||angular.forEach(d.content.summary,function(e){return null!=e.employees?n||(n=_.find(e.employees,function(e){return t.id===e.id})):void 0}),n?e.selectedElements.push(n):void 0})),null!=e.selectedElements&&e.selectedElements.length>0)?void 0:d.width=6},d.format=function(){var t,a,s,o,l,r;return e.isDataFound&&null!=e.selectedElements&&e.selectedElements.length>0?(t=!0,a=[],s=_.map(d.content.dates,function(e){return d.metadata.hist_parameters&&"YEARLY"===d.metadata.hist_parameters.period?i("date")(e,"yyyy"):d.metadata.hist_parameters&&"QUARTERLY"===d.metadata.hist_parameters.period?i("date")(e,"MMM-yy"):!d.metadata.hist_parameters||"WEEKLY"!==d.metadata.hist_parameters.period&&"DAILY"!==d.metadata.hist_parameters.period?i("date")(e,"MMM"):i("date")(e,"dd-MMM")}),angular.forEach(e.selectedElements,function(e){var n;return n=angular.copy(e),a.push({title:n.name,labels:s,values:n.totals}),angular.forEach(n.totals,function(e){return t&&(t=e>=0)})}),o={scaleBeginAtZero:t,showXLabels:!0,datasetFill:1===e.selectedElements.length,pointDot:1===e.selectedElements.length},d.hist_chart=n.lineChart(a,o),l=_.map(e.selectedElements,function(t){return{label:i("titleize")(e.getName({name:t.name})),value:e.getLastValue(t)}}),r={showTooltips:!0,percentageInnerCutout:50,tooltipFontSize:12},d.cur_chart=n.pieChart(l,r)):void 0},e.getElementChartColor=function(e){return n.getColor(e)},e.getLastValue=function(e){return null!=e.totals?e.totals[e.totals.length-2]:void 0},e.getTotalSum=function(e){return null!=e.totals?_.reduce(e.totals,function(e,t){return e+t},0):void 0},e.getName=function(e){return null!=e&&null!=e.name?"total_leaves"===e.name?"Total Leaves Accruals":"total_super"===e.name?"Total Superannuation Accruals":"total_reimbursement"===e.name?"Total Reimbursements":"total_tax"===e.name?"Total Taxes":"total_timeoff"===e.name?"Total Time Off":e.name.replace(/_/g," "):void 0},e.getTrackedField=function(){var t,n;return null==e.selectedElements||_.isEmpty(e.selectedElements)||null==e.selectedElements[0].id?void 0:(n=e.selectedElements[0].id.split("-")[0],t=!0,angular.forEach(e.selectedElements,function(e){return t&&(t=e.id&&n===e.id.split("-")[0])}),t?e.getName({name:n}):null)},e.formatDate=function(e){if(null==d.content.hist_parameters)return i("date")(e,"MMM");switch(d.content.hist_parameters.period){case"DAILY":return i("date")(e,"dd-MMM");case"WEEKLY":return i("date")(e,"dd-MMM");case"MONTHLY":return i("date")(e,"MMM");case"QUARTERLY":return i("date")(e,"MMM-yy");case"YEARLY":return i("date")(e,"yyyy");default:return i("date")(e,"MMM")}},e.toogleSelectedElement=function(t){return e.isSelected(t)?(e.selectedElements=_.reject(e.selectedElements,function(e){return t.id?e.id===t.id:e.name===t.name}),d.format(),d.isExpanded()&&0===e.selectedElements.length?d.toogleExpanded():d.updateSettings(!1)):(e.selectedElements||(e.selectedElements=[]),e.selectedElements.push(t),d.format(),d.isExpanded()?d.updateSettings(!1):d.toogleExpanded())},e.isSelected=function(t){return null!=t&&null!=e.selectedElements?_.find(e.selectedElements,function(e){return t.id?e.id===t.id:e.name===t.name})?!0:!1:!1},e.toogleCollapsed=function(t){return null!=t&&null!=t.name?(_.find(e.unCollapsed,function(e){return t.name===e})?e.unCollapsed=_.reject(e.unCollapsed,function(e){return e===t.name}):e.unCollapsed.push(t.name),d.updateSettings(!1)):void 0},e.getPeriod=function(){var t,n;return e.isDataFound&&d.content.hist_parameters?(n=d.content.hist_parameters.period||"MONTHLY",t="day","DAILY"!==n&&(t=n.substr(0,n.length-2).toLowerCase()),"last "+t):"last MONTH"},e.isCollapsed=function(t){return null!=t&&null!=t.name?_.find(e.unCollapsed,function(e){return t.name===e})?!1:!0:void 0},o={},o.initialized=!1,o.initialize=function(){return o.initialized=!0},o.toMetadata=function(){return{unCollapsed:e.unCollapsed}},d.settings.push(o),s={},s.initialized=!1,s.initialize=function(){return s.initialized=!0},s.toMetadata=function(){return{selectedElements:e.selectedElements}},d.settings.push(s),a=function(){return null!=d.settings?d.settings.length:0},e.$watch(a,function(e){return e>=6?d.loadContent():void 0}),d}]),e.directive("widgetHrPayrollSummary",function(){return{restrict:"A",link:function(e,t){return t.addClass("hr"),t.addClass("payroll-summary")},controller:"WidgetHrPayrollSummaryCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.hr-payroll-taxes",[]),e.controller("WidgetHrPayrollTaxesCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(e,t,n){var i,a;return a=e.widget,a.initContext=function(){return e.isDataFound=null!=a.content&&a.content.total_tax&&a.content.dates},a.format=function(){var t,i,s;return e.isDataFound?(i={title:"Payroll Taxes",labels:a.content.dates,values:a.content.total_tax},t=!0,angular.forEach(a.content.total_tax,function(e){return t&&(t=e>=0)}),s={scaleBeginAtZero:t,showXLabels:!1},a.chart=n.lineChart([i],s)):void 0},e.getCurrentPrice=function(){return e.isDataFound?_.last(a.content.total_tax):void 0},e.getCurrency=function(){return e.isDataFound?a.content.currency||"USD":void 0},e.getPeriod=function(){var t,n;return e.isDataFound&&a.content.hist_parameters?(n=a.content.hist_parameters.period||"MONTHLY",t="day","DAILY"!==n&&(t=n.substr(0,n.length-2).toLowerCase()),"(current "+t+")"):void 0},i=function(){return null!=a.settings?a.settings.length:0},e.$watch(i,function(e){return e>=3?a.loadContent():void 0}),a}]),e.directive("widgetHrPayrollTaxes",function(){return{restrict:"A",link:function(e,t){return t.addClass("hr"),t.addClass("payroll-taxes")},controller:"WidgetHrPayrollTaxesCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.hr-salaries-summary",[]),e.controller("WidgetHrSalariesSummaryCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(e,t,n){var i,a;return a=e.widget,a.initContext=function(){return(e.isDataFound=null!=a.content.summary&&!_.isEmpty(a.content.summary.data))?(e.periodOptions=[{label:"Yearly",value:"yearly"},{label:"Monthly",value:"monthly"},{label:"Weekly",value:"weekly"},{label:"Hourly",value:"hourly"}],e.period=_.find(e.periodOptions,function(e){return e.value===a.content.total.period.toLowerCase()})||e.periodOptions[0],e.filterOptions=[{label:"Gender",value:"gender"},{label:"Age Range",value:"age_range"},{label:"Job Title",value:"job_title"}],e.filter=_.find(e.filterOptions,function(e){return e.value===a.content.summary.filter})||e.filterOptions[0]):void 0},a.format=function(){var t,i,s,o;if(e.isDataFound){if(t={labels:_.map(a.content.summary.data,function(e){return e.label}),values:_.map(a.content.summary.data,function(e){return e.value})},"gender"===e.filter.value)return i={showTooltips:!1},a.chart=n.barChart(t,i);if("job_title"===e.filter.value)return i={showTooltips:!1,showXLabels:!1,barDatasetSpacing:15},a.chart=n.barChart(t,i);if("age_range"===e.filter.value)return"unknown"===_.last(t.labels)&&(t.labels.pop(),t.values.pop()),s=[{title:"Average salary",labels:t.labels,values:t.values}],o={scaleBeginAtZero:!0,showXLabels:!1},a.chart=n.lineChart(s,o)}},e.getColorByIndex=function(e){return n.getColor(e)},i=function(){return null!=a.settings?a.settings.length:0},e.$watch(i,function(e){return 4===e?a.loadContent():void 0}),a}]),e.directive("widgetHrSalariesSummary",function(){return{restrict:"A",link:function(e,t){return t.addClass("hr"),t.addClass("salaries-summary")},controller:"WidgetHrSalariesSummaryCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.hr-superannuation-accruals",[]),e.controller("WidgetHrSuperannuationAccrualsCtrl",["$scope","DhbAnalyticsSvc","Utilities",function(e){var t,n;return n=e.widget,n.initContext=function(){return(e.isDataFound=!_.isEmpty(n.content.employees)&&!_.isEmpty(n.content.dates))?(e.employeesOptions=_.map(n.content.employees,function(e){return{value:e.id,label:e.lastname+" "+e.firstname}}),e.selectedEmployee={value:e.getEmployee().id,label:e.getEmployee().lastname+" "+e.getEmployee().firstname}):void 0},e.getEmployee=function(){return e.isDataFound?n.metadata&&n.metadata.employee_id?_.find(n.content.employees,function(e){return e.id===n.metadata.employee_id})||n.content.employees[0]:n.content.employees[0]:!1},t=function(){return null!=n.settings?n.settings.length:0},e.$watch(t,function(e){return e>=3?n.loadContent():void 0}),n}]),e.directive("widgetHrSuperannuationAccruals",function(){return{restrict:"A",link:function(e,t){return t.addClass("hr"),t.addClass("superannuation-accruals")},controller:"WidgetHrSuperannuationAccrualsCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.hr-timesheets",[]),e.controller("WidgetHrTimesheetsCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(e){var t,n,i;return i=e.widget,i.initContext=function(){return(e.isDataFound=angular.isDefined(i.content)&&!_.isEmpty(i.content.employees)&&!_.isEmpty(i.content.dates))?(e.employeesOptions=_.map(i.content.employees,function(e){return{value:e.id,label:e.lastname+" "+e.firstname}}),e.selectedEmployee={value:e.getEmployee().id,label:e.getEmployee().lastname+" "+e.getEmployee().firstname},e.unCollapsed=i.metadata.unCollapsed||[]):void 0},e.toogleCollapsed=function(t){return null!=t?(_.find(e.unCollapsed,function(e){return t===e})?e.unCollapsed=_.reject(e.unCollapsed,function(e){return e===t}):e.unCollapsed.push(t),i.updateSettings(!1)):void 0},e.isCollapsed=function(t){return null!=t?_.find(e.unCollapsed,function(e){return t===e})?!1:!0:void 0},e.getEmployee=function(){return e.isDataFound?i.metadata&&i.metadata.employee_id?_.find(i.content.employees,function(e){return e.id===i.metadata.employee_id})||i.content.employees[0]:i.content.employees[0]:!1},e.getEmployeeTimeWorked=function(){var t;return(t=e.getEmployee())?_.find(i.content.employees,function(e){return e.id===t.id}).total_time_worked:void 0},e.getEmployeeTimeOff=function(){var t;return(t=e.getEmployee())?_.find(i.content.employees,function(e){return e.id===t.id}).total_time_off:void 0},n={},n.initialized=!1,n.initialize=function(){return n.initialized=!0},n.toMetadata=function(){return{unCollapsed:e.unCollapsed}},i.settings.push(n),t=function(){return null!=i.settings?i.settings.length:0},e.$watch(t,function(e){return e>=4?i.loadContent():void 0}),i}]),e.directive("widgetHrTimesheets",function(){return{restrict:"A",link:function(e,t){return t.addClass("hr"),t.addClass("timesheets")},controller:"WidgetHrTimesheetsCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.hr-workforce-summary",[]),e.controller("WidgetHrWorkforceSummaryCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(e,t,n,i){var a,s;return s=e.widget,s.initContext=function(){return(e.isDataFound=null!=s.content.summary&&!_.isEmpty(s.content.summary.data))?(e.periodOptions=[{label:"Yearly",value:"yearly"},{label:"Monthly",value:"monthly"},{label:"Weekly",value:"weekly"},{label:"Hourly",value:"hourly"}],e.period=_.find(e.periodOptions,function(e){return e.value===s.content.total.period.toLowerCase()})||e.periodOptions[0],e.filterOptions=[{label:"Gender",value:"gender"},{label:"Age Range",value:"age_range"},{label:"Salary Range",value:"salary_range"},{label:"Job Title",value:"job_title"}],e.filter=_.find(e.filterOptions,function(e){return e.value===s.content.summary.filter})||e.filterOptions[0]):void 0},s.format=function(){var t,i,a,o;return e.isDataFound?"salary_range"===e.filter.value?(t={labels:_.map(s.content.summary.data,function(t){return e.formatSalaryRange(t)}),values:_.map(s.content.summary.data,function(e){return e.value})},i={showTooltips:!1,showXLabels:!1,barDatasetSpacing:15},s.chart=n.barChart(t,i)):(a=_.map(s.content.summary.data,function(e){return{label:e.label,value:e.value}}),o={showTooltips:!0,percentageInnerCutout:50,tooltipFontSize:12},s.chart=n.pieChart(a,o)):void 0},e.getTotalWorkforce=function(){return e.isDataFound?s.content.total.amount:void 0},e.getNumberOfEmployees=function(){return e.isDataFound?s.content.total.employees:void 0},e.getCurrency=function(){return e.isDataFound?s.content.total.currency:void 0},e.formatSalaryRange=function(e){var t,n;return t=i("mnoCurrency")(e.label.split("-")[0],e.currency,!1),n=i("mnoCurrency")(e.label.split("-")[1],e.currency,!1),[t,n].join(" - ")},e.getColorByIndex=function(e){return n.getColor(e)},a=function(){return null!=s.settings?s.settings.length:0},e.$watch(a,function(e){return 4===e?s.loadContent():void 0}),s}]),e.directive("widgetHrWorkforceSummary",function(){return{restrict:"A",link:function(e,t){return t.addClass("hr"),t.addClass("workforce-summary")},controller:"WidgetHrWorkforceSummaryCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.invoices-aged-payables-receivables",[]),e.controller("WidgetInvoicesAgedPayablesReceivablesCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(e,t,n,i){var a,s,o,d;return d=e.widget,d.initContext=function(){return!(e.isDataFound=!(!angular.isDefined(d.content)||_.isEmpty(d.content.payables)&&_.isEmpty(d.content.receivables)||_.isEmpty(d.content.dates)))||(e.unCollapsed=d.metadata.unCollapsed||[],d.metadata.selectedElements&&(e.selectedElements=[],angular.forEach(d.metadata.selectedElements,function(t){var n;return"aged_payables"===t.name&&(n=d.content.payables),"aged_receivables"!==t.name||n||(n=d.content.receivables),n||(n=_.find(d.content.payables.suppliers,function(e){return e.id===t.id})),n||(n=_.find(d.content.receivables.customers,function(e){return e.id===t.id})),n?e.selectedElements.push(n):void 0})),null!=e.selectedElements&&e.selectedElements.length>0)?void 0:d.width=6},d.format=function(){var t,a,s,o;return e.isDataFound&&null!=e.selectedElements&&e.selectedElements.length>0?(t=!0,a=[],s=_.map(d.content.dates,function(e){return d.metadata.hist_parameters&&"YEARLY"===d.metadata.hist_parameters.period?i("date")(e,"yyyy"):d.metadata.hist_parameters&&"QUARTERLY"===d.metadata.hist_parameters.period?i("date")(e,"MMM-yy"):!d.metadata.hist_parameters||"WEEKLY"!==d.metadata.hist_parameters.period&&"DAILY"!==d.metadata.hist_parameters.period?i("date")(e,"MMM"):i("date")(e,"dd-MMM")}),angular.forEach(e.selectedElements,function(e){var n;return n=angular.copy(e),a.push({title:n.name,labels:s,values:n.totals}),angular.forEach(n.totals,function(e){return t&&(t=e>=0)})}),o={scaleBeginAtZero:t,showXLabels:!0,datasetFill:1===e.selectedElements.length,pointDot:1===e.selectedElements.length},d.chart=n.lineChart(a,o)):void 0},e.getElementChartColor=function(e){return null!=e?n.getColor(e):void 0},e.getLastValue=function(e){return null!=e&&null!=e.totals?_.last(e.totals):void 0},e.getTotalSum=function(e){return null!=e&&null!=e.totals?_.reduce(e.totals,function(e,t){return e+t},0):void 0},e.getName=function(e){return null!=e&&null!=e.name?e.name.replace(/_/g," "):void 0},e.getPeriod=function(){var t,n;return e.isDataFound&&d.content.hist_parameters?(n=d.content.hist_parameters.period||"MONTHLY",t="day","DAILY"!==n&&(t=n.substr(0,n.length-2).toLowerCase()),"current "+t):"current month"
},e.toogleSelectedElement=function(t){return e.isSelected(t)?(e.selectedElements=_.reject(e.selectedElements,function(e){return t.id?e.id===t.id:e.name===t.name}),d.format(),d.isExpanded()&&0===e.selectedElements.length?d.toogleExpanded():d.updateSettings(!1)):(e.selectedElements||(e.selectedElements=[]),e.selectedElements.push(t),d.format(),d.isExpanded()?d.updateSettings(!1):d.toogleExpanded())},e.isSelected=function(t){return null!=t&&null!=e.selectedElements?_.find(e.selectedElements,function(e){return t.id?e.id===t.id:e.name===t.name})?!0:!1:!1},e.toogleCollapsed=function(t){return null!=t&&null!=t.name?(_.find(e.unCollapsed,function(e){return t.name===e})?e.unCollapsed=_.reject(e.unCollapsed,function(e){return e===t.name}):e.unCollapsed.push(t.name),d.updateSettings(!1)):void 0},e.isCollapsed=function(t){return null!=t&&null!=t.name?_.find(e.unCollapsed,function(e){return t.name===e})?!1:!0:void 0},o={},o.initialized=!1,o.initialize=function(){return o.initialized=!0},o.toMetadata=function(){return{unCollapsed:e.unCollapsed}},d.settings.push(o),s={},s.initialized=!1,s.initialize=function(){return s.initialized=!0},s.toMetadata=function(){return{selectedElements:e.selectedElements}},d.settings.push(s),a=function(){return null!=d.settings?d.settings.length:0},e.$watch(a,function(e){return e>=5?d.loadContent():void 0}),d}]),e.directive("widgetInvoicesAgedPayablesReceivables",function(){return{restrict:"A",link:function(e,t){return t.addClass("invoices"),t.addClass("aged-payables-receivables")},controller:"WidgetInvoicesAgedPayablesReceivablesCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.invoices-list",[]),e.controller("WidgetInvoicesListCtrl",["$scope","DhbAnalyticsSvc","Utilities","$filter",function(e,t,n,i){var a,s;return s=e.widget,s.initContext=function(){return e.isDataFound=!_.isEmpty(s.content.entities)},e.entityType=s.metadata.entity,e.entityTypeCap=n.capitalize(s.metadata.entity),e.orderBy="name"===s.metadata.order_by||"total_invoiced"===s.metadata.order_by?"":_.last(s.metadata.order_by.split("_")).concat(" "),e.getInvoices=function(e){var t,n;return n=["<strong>"+e.name+"</strong>"],t=1,angular.forEach(e.invoices,function(e){var a,s;return s=""!==e.transaction_no?" ("+e.transaction_no+")":"",a="partially paid"===e.tooltip_status?" ("+i("mnoCurrency")(e.paid,e.currency,!1)+" over "+i("mnoCurrency")(e.invoiced,e.currency,!1)+")":" ("+i("mnoCurrency")(e.invoiced,e.currency,!1)+")",n.push("#"+t+s+" - "+e.tooltip_status+a),t++}),n.join("<br />")},a=function(){return null!=s.settings?s.settings.length:0},e.$watch(a,function(e){return 1===e?s.loadContent():void 0}),s}]),e.directive("widgetInvoicesList",function(){return{restrict:"A",link:function(e,t){return t.addClass("invoices"),t.addClass("list")},controller:"WidgetInvoicesListCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.invoices-summary",[]),e.controller("WidgetInvoicesSummaryCtrl",["$scope","DhbAnalyticsSvc","Utilities","ChartFormatterSvc",function(e,t,n,i){var a,s;return s=e.widget,s.initContext=function(){return e.isDataFound=!_.isEmpty(s.content.summary)},s.format=function(){var t,n;return e.isDataFound?(t=_.map(s.content.summary,function(e){return{label:e.name,value:e.total}}),n={percentageInnerCutout:50,tooltipFontSize:12},s.chart=i.pieChart(t,n)):void 0},a=function(){return null!=s.settings?s.settings.length:0},e.$watch(a,function(e){return 2===e?s.loadContent():void 0}),s}]),e.directive("widgetInvoicesSummary",function(){return{restrict:"A",link:function(e,t){return t.addClass("invoices"),t.addClass("summary")},controller:"WidgetInvoicesSummaryCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.sales-aged",[]),e.controller("WidgetSalesAgedCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(e,t,n,i){var a,s;return s=e.widget,s.initContext=function(){return(e.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.aged_sales)&&!_.isEmpty(s.content.dates))?(e.filterOptions=[{label:"value sold (incl. taxes)",value:"gross_value_sold"},{label:"value sold (excl. taxes)",value:"net_value_sold"},{label:"quantity sold",value:"quantity_sold"}],e.filter=_.find(e.filterOptions,function(e){return s.metadata&&s.metadata.filter===e.value})||e.filterOptions[0]):void 0},s.format=function(){var t,a,o,d;return e.isDataFound?(t=!0,a=[],d=s.content.aged_sales[e.filter.value],e.formattedDates=_.map(s.content.dates,function(e){return s.metadata&&s.metadata.hist_parameters&&"YEARLY"===s.metadata.hist_parameters.period?i("date")(e,"yyyy"):s.metadata&&s.metadata.hist_parameters&&"QUARTERLY"===s.metadata.hist_parameters.period?i("date")(e,"MMM-yy"):s.metadata&&s.metadata.hist_parameters&&("WEEKLY"===s.metadata.hist_parameters.period||"DAILY"===s.metadata.hist_parameters.period)?i("date")(e,"dd-MMM"):i("date")(e,"MMM")}),a.push({title:e.filter.label,labels:e.formattedDates,values:d}),angular.forEach(d,function(e){return t&&(t=e>=0)}),o={scaleBeginAtZero:t,showXLabels:!0,datasetFill:!0,pointDot:!0},s.chart=n.lineChart(a,o)):void 0},e.$watch(function(){return e.filter},function(){return s.format()},!0),e.getTotal=function(t){return e.isDataFound&&t>=0&&t<s.content.aged_sales[e.filter.value].length?s.content.aged_sales[e.filter.value][t]:void 0},e.getLastDate=function(){return e.isDataFound?_.last(s.content.dates):void 0},e.getClassColor=function(e,t){return e>t?"negative":t>e?"positive":null},a=function(){return null!=s.settings?s.settings.length:0},e.$watch(a,function(e){return e>=3?s.loadContent():void 0}),s}]),e.directive("widgetSalesAged",function(){return{restrict:"A",link:function(e,t){return t.addClass("sales"),t.addClass("aged")},controller:"WidgetSalesAgedCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.sales-break-even",[]),e.controller("WidgetSalesBreakEvenCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(e,t,n,i){var a,s,o;return o=e.widget,o.initContext=function(){return e.isDataFound=angular.isDefined(o.content)&&!_.isEmpty(o.content.sales),e.threshold=o.metadata.threshold},e.getProjectedDate=function(){var t;return e.isDataFound&&o.content.break_even?(""+o.content.break_even.projected_date).match("After")?(t=angular.copy(o.content.break_even.projected_date).replace("After ",""),"> "+i("date")(t,"d-MM-yy")):o.content.break_even.projected_date:void 0},e.getOpportunitiesToClose=function(){var t;return e.isDataFound&&o.content.break_even?(""+o.content.break_even.opportunities_to_close).match(">")?(t=angular.copy(o.content.break_even.opportunities_to_close).replace(">",""),"> "+t):o.content.break_even.opportunities_to_close:void 0},e.isTargetMet=function(){return e.isDataFound&&o.content.break_even?o.content.break_even.variance<0:void 0},e.getVariance=function(){return e.isDataFound&&o.content.break_even?Math.abs(o.content.break_even.variance):void 0},s={},s.initialized=!1,s.initialize=function(){return s.initialized=!0},s.toMetadata=function(){return{threshold:e.threshold}},o.settings.push(s),a=function(){return null!=o.settings?o.settings.length:0},e.$watch(a,function(e){return e>=3?o.loadContent():void 0}),o}]),e.directive("widgetSalesBreakEven",function(){return{restrict:"A",link:function(e,t){return t.addClass("sales"),t.addClass("break-even")},controller:"WidgetSalesBreakEvenCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.sales-comparison",[]),e.controller("WidgetSalesComparisonCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(e,t,n,i){var a,s,o,d;return d=e.widget,d.initContext=function(){return(e.isDataFound=angular.isDefined(d.content)&&!_.isEmpty(d.content.sales_comparison)&&!_.isEmpty(d.content.dates))&&(e.unCollapsed=d.metadata.unCollapsed||[],e.filterOptions=[{label:"value sold (incl. taxes)",value:"gross_value_sold"},{label:"value sold (excl. taxes)",value:"net_value_sold"},{label:"quantity sold",value:"quantity_sold"}],e.filter=_.find(e.filterOptions,function(e){return d.metadata&&d.metadata.filter===e.value})||e.filterOptions[0],e.criteriaOptions=[{label:"products",value:"default"},{label:"locations",value:"location"},{label:"industries",value:"industry"},{label:"customers",value:"customer"}],e.criteria=_.find(e.criteriaOptions,function(e){return d.metadata&&d.metadata.criteria===e.value})||e.criteriaOptions[0],d.metadata.selectedElements)?(e.selectedElements=[],angular.forEach(d.metadata.selectedElements,function(t){var n;return n=_.find(d.content.sales_comparison,function(e){return e.name===t.name}),n||angular.forEach(d.content.sales_comparison,function(e){return null!=e.sales?n||(n=_.find(e.sales,function(e){return t.id===e.id})):void 0}),n?e.selectedElements.push(n):void 0})):void 0},d.format=function(){var t,a,s;return e.isDataFound&&null!=e.selectedElements&&e.selectedElements.length>0?(t=!0,a=[],angular.forEach(e.selectedElements,function(n){var s,o;return s=angular.copy(n),o=_.map(d.content.dates,function(e){return d.metadata.hist_parameters&&"YEARLY"===d.metadata.hist_parameters.period?i("date")(e,"yyyy"):d.metadata.hist_parameters&&"QUARTERLY"===d.metadata.hist_parameters.period?i("date")(e,"MMM-yy"):!d.metadata.hist_parameters||"WEEKLY"!==d.metadata.hist_parameters.period&&"DAILY"!==d.metadata.hist_parameters.period?i("date")(e,"MMM"):i("date")(e,"dd-MMM")}),a.push({title:s.name,labels:o,values:s.totals[e.filter.value]}),angular.forEach(s.totals,function(e){return t&&(t=e>=0)})}),s={scaleBeginAtZero:t,showXLabels:!0,datasetFill:!1,pointDot:!1},d.chart=n.lineChart(a,s)):void 0},e.$watch(function(){return e.filter},function(){return d.format()},!0),e.getLastDate=function(){return e.isDataFound?_.last(d.content.dates):void 0},e.getTotalForPeriod=function(t){return null!=t.totals&&e.filter?_.reduce(t.totals[e.filter.value],function(e,t){return e+t},0):void 0},e.getElementChartColor=function(e){return n.getColor(e)},e.toogleSelectedElement=function(t){return e.isSelected(t)?(e.selectedElements=_.reject(e.selectedElements,function(e){return t.id?e.id===t.id:e.name===t.name}),d.format(),d.isExpanded()&&0===e.selectedElements.length?d.toogleExpanded():d.updateSettings(!1)):(e.selectedElements||(e.selectedElements=[]),e.selectedElements.push(t),d.format(),d.isExpanded()?d.updateSettings(!1):d.toogleExpanded())},e.isSelected=function(t){return null!=t&&null!=e.selectedElements?_.find(e.selectedElements,function(e){return t.id?e.id===t.id:e.name===t.name})?!0:!1:!1},e.toogleCollapsed=function(t){return null!=t&&null!=t.name?(_.find(e.unCollapsed,function(e){return t.name===e})?e.unCollapsed=_.reject(e.unCollapsed,function(e){return e===t.name}):e.unCollapsed.push(t.name),d.updateSettings(!1)):void 0},e.isCollapsed=function(t){return null!=t&&null!=t.name?_.find(e.unCollapsed,function(e){return t.name===e})?!1:!0:void 0},o={},o.initialized=!1,o.initialize=function(){return o.initialized=!0},o.toMetadata=function(){return{unCollapsed:e.unCollapsed}},d.settings.push(o),s={},s.initialized=!1,s.initialize=function(){return s.initialized=!0},s.toMetadata=function(){return{selectedElements:e.selectedElements}},d.settings.push(s),a=function(){return null!=d.settings?d.settings.length:0},e.$watch(a,function(e){return e>=7?d.loadContent():void 0}),d}]),e.directive("widgetSalesComparison",function(){return{restrict:"A",link:function(e,t){return t.addClass("accounts"),t.addClass("profit-and-loss")},controller:"WidgetSalesComparisonCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.sales-customer-details",[]),e.controller("WidgetSalesCustomerDetailsCtrl",["$scope","DhbAnalyticsSvc","Utilities","$filter",function(e){var t,n;return n=e.widget,n.initContext=function(){return(e.isDataFound=!_.isEmpty(n.content.customers))?(e.customersOptions=_.map(n.content.customers,function(e){return{value:e.uid,label:e.name}}),e.selectedCustomer={value:e.getCustomer().uid,label:e.getCustomer().name}):void 0},e.getCustomer=function(){var t;return e.isDataFound?t=n.metadata&&n.metadata.customer_uid?angular.copy(_.find(n.content.customers,function(e){return e.uid===n.metadata.customer_uid})||n.content.customers[0]):angular.copy(n.content.customers[0]):!1},e.formatAddress=function(e){return angular.isDefined(e)?e.replace(/, /g,",\n"):void 0},e.getFromDate=function(){return e.isDataFound?n.content.from:void 0},e.getToDate=function(){return e.isDataFound?n.content.to:void 0},t=function(){return null!=n.settings?n.settings.length:0},e.$watch(t,function(e){return e>=4?n.loadContent():void 0}),n}]),e.directive("widgetSalesCustomerDetails",function(){return{restrict:"A",link:function(e,t){return t.addClass("sales"),t.addClass("customer-details")},controller:"WidgetSalesCustomerDetailsCtrl"}})}.call(this),function(){"use strict";var e,t=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};e=angular.module("impac.components.widgets.sales-cycle",[]),e.controller("WidgetSalesCycleCtrl",["$scope","DhbAnalyticsSvc","Utilities","ChartFormatterSvc","$filter",function(e,n,i,a,s){var o,d;return d=e.widget,d.initContext=function(){return(e.isDataFound=angular.isDefined(d.content)&&!_.isEmpty(d.content.status_average_durations))?(e.unit=(d.metadata.unit||d.content.unit||"days").toLowerCase(),e.statusOptions=_.compact(_.map(d.metadata.status_selection,function(e){return angular.isDefined(d.content.status_average_durations[e])?{label:e,selected:!0}:void 0})),angular.forEach(d.content.status_average_durations,function(n,i){return!d.metadata.status_selection||t.call(d.metadata.status_selection,i)>=0?_.isEmpty(d.metadata.status_selection)?e.statusOptions.push({label:i,selected:!0}):void 0:e.statusOptions.push({label:i,selected:!1})})):void 0},d.format=function(){var t,n;return e.isDataFound?(t=_.compact(_.map(e.statusOptions,function(t){var n;return n=d.content.status_average_durations[t.label],t.selected&&angular.isDefined(n)?{label:s("titleize")(t.label)+": "+n+" "+e.unit,value:n}:void 0})),n={percentageInnerCutout:50,tooltipFontSize:12},d.chart=a.pieChart(t,n)):void 0},o=function(){return null!=d.settings?d.settings.length:0},e.$watch(o,function(e){return e>=3?d.loadContent():void 0}),d}]),e.directive("widgetSalesCycle",function(){return{restrict:"A",link:function(e,t){return t.addClass("invoices"),t.addClass("summary")},controller:"WidgetSalesCycleCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.sales-forecast",[]),e.controller("WidgetSalesForecastCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(e,t,n,i){var a,s;return s=e.widget,s.initContext=function(){return e.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.dates)&&!_.isEmpty(s.content.totals)},s.format=function(){var t,a,o,d;return e.isDataFound?(t=!0,a=_.map(s.content.dates,function(e){return i("date")(e,"MMM-yy")}),o=[{title:"Sales Performance",labels:a,values:s.content.totals}],angular.forEach(s.content.totals,function(e){return t&&(t=e>=0)}),d={scaleBeginAtZero:t,showXLabels:!0,datasetFill:!0,pointDot:!1},s.chart=n.lineChart(o,d)):void 0},e.getOpportunityAmount=function(t){return e.isDataFound&&!_.isEmpty(t)?t.amount&&t.amount.amount?t.amount.amount:"-":void 0},e.getOpportunityCurrency=function(t){return e.isDataFound&&!_.isEmpty(t)?t.amount&&t.amount.currency?t.amount.currency:s.content.currency?s.content.currency:"AUD":void 0},a=function(){return null!=s.settings?s.settings.length:0},e.$watch(a,function(e){return e>=1?s.loadContent():void 0}),s}]),e.directive("widgetSalesForecast",function(){return{restrict:"A",link:function(e,t){return t.addClass("accounts"),t.addClass("profit-and-loss")},controller:"WidgetSalesForecastCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.sales-growth",[]),e.controller("WidgetSalesGrowthCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(e,t,n){var i,a;return a=e.widget,e.isDataQuantity=!0,e.getSelectedProduct=function(){return e.isDataFound?_.find(a.content.summary,function(t){return t.id===e.product.value}):void 0},e.getCurrentValue=function(){return null!=e.getSelectedProduct()?_.last(e.getSelectedProduct().totals):void 0},e.getCurrentDate=function(){return e.isDataFound?_.last(a.content.dates):void 0},a.initContext=function(){return(e.isDataFound=angular.isDefined(a.content)&&!_.isEmpty(a.content.summary)&&!_.isEmpty(a.content.dates))?(e.productOptions=_.flatten(_.map(a.content.summary,function(e){return{label:e.code,value:e.id}})),e.product=_.find(e.productOptions,function(e){return e.value===a.content.product})||{label:"SELECT PRODUCT",value:-1},e.filterOptions=[{label:"value sold (incl. taxes)",value:"gross_value_sold"},{label:"value sold (excl. taxes)",value:"net_value_sold"},{label:"quantity sold",value:"quantity_sold"},{label:"value purchased (incl. taxes)",value:"gross_value_purchased"},{label:"value purchased (excl. taxes)",value:"net_value_purchased"},{label:"quantity purchased",value:"quantity_purchased"}],e.filter=_.find(e.filterOptions,function(e){return e.value===a.content.filter})||e.filterOptions[0],e.isDataQuantity=e.filter.value.match("quantity")):void 0},a.format=function(){var t,i,s,o;return e.isDataFound&&e.product&&(i=e.getSelectedProduct())?(s={title:i.name,labels:a.content.dates,values:i.totals},t=!0,angular.forEach(i.totals,function(e){return t&&(t=e>=0)}),o={scaleBeginAtZero:t,showXLabels:!1},a.chart=n.lineChart([s],o)):void 0},i=function(){return null!=a.settings?a.settings.length:0},e.$watch(i,function(e){return e>=4?a.loadContent():void 0}),a}]),e.directive("widgetSalesGrowth",function(){return{restrict:"A",link:function(e,t){return t.addClass("sales"),t.addClass("growth")},controller:"WidgetSalesGrowthCtrl"}})}.call(this),function(){"use strict";var e,t=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};e=angular.module("impac.components.widgets.sales-leads-funnel",[]),e.controller("WidgetSalesLeadsFunnelCtrl",["$scope","DhbAnalyticsSvc","Utilities","ChartFormatterSvc","$filter",function(e,n,i,a,s){var o,d,l;return l=e.widget,l.initContext=function(){return(e.isDataFound=angular.isDefined(l.content)&&!_.isEmpty(l.content.leads_per_status))?(e.statusOptions=_.compact(_.map(l.metadata.status_selection,function(e){return angular.isDefined(l.content.leads_per_status[e])?{label:e,selected:!0}:void 0})),angular.forEach(l.content.leads_per_status,function(n,i){return!l.metadata.status_selection||t.call(l.metadata.status_selection,i)>=0?_.isEmpty(l.metadata.status_selection)?e.statusOptions.push({label:i,selected:!0}):void 0:e.statusOptions.push({label:i,selected:!1})})):void 0},l.format=function(){var t;return e.isDataFound&&(t=0,angular.forEach(e.statusOptions,function(e){var n;return n=l.content.leads_per_status[e.label].total,e.selected&&angular.isDefined(n)&&n>t?t=n:void 0}),t>0)?e.funnel=_.compact(_.map(e.statusOptions,function(e){var n,i,a;return a=l.content.leads_per_status[e.label].total,n=(100*(a/t)-10).toFixed(),i=8>n?92:100-n,e.selected&&angular.isDefined(a)?{status:e.label,number:a,coloredWidth:{width:n+"%"},statusWidth:{width:i+"%"}}:void 0})):void 0},e.getImpacColor=function(e){return a.getColor(e)},e.toogleSelectStatus=function(t){return e.selectedStatus=e.selectedStatus&&e.selectedStatus===t?null:t,!l.isExpanded()&&e.selectedStatus?l.toogleExpanded():l.updateSettings(!1)},e.isSelected=function(t){return e.selectedStatus&&t===e.selectedStatus},e.getSelectedLeads=function(){return e.isDataFound&&e.selectedStatus?l.content.leads_per_status[e.selectedStatus].leads:void 0},e.getLeadDescription=function(e){var t,n;return n=[],t=["<strong>"],e.first_name&&t.push(s("titleize")(e.first_name)),e.last_name&&t.push(s("titleize")(e.last_name)),t.push("</strong>"),n.push(t.join(" ")),n.push("Status: "+s("titleize")(e.lead_status)),e.organization&&n.push("Organization: "+s("titleize")(e.organization)),e.opportunities&&(n.push("<strong>Opportunities:</strong>"),angular.forEach(e.opportunities,function(e){var t;return t=[],e.code&&t.push("#"+e.code),e.name&&t.push(""+e.name),e.amount&&t.push(s("mnoCurrency")(e.amount.total_amount,"USD",!1)),e.probability&&t.push(e.probability+"%"),e.sales_stage&&t.push(""+e.sales_stage),n.push(t.join(" - "))})),n.join("<br />")},d={},d.initialized=!1,d.initialize=function(){return angular.isDefined(l.content.leads_per_status[l.metadata.selected_status])&&(e.selectedStatus=l.metadata.selected_status),d.initialized=!0},d.toMetadata=function(){return{selected_status:e.selectedStatus}},l.settings.push(d),o=function(){return null!=l.settings?l.settings.length:0},e.$watch(o,function(e){return e>=5?l.loadContent():void 0}),l}]),e.directive("widgetSalesLeadsFunnel",function(){return{restrict:"A",link:function(e,t){return t.addClass("sales"),t.addClass("leads-funnel")},controller:"WidgetSalesLeadsFunnelCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.sales-leads-list",[]),e.controller("WidgetSalesLeadsListCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(e,t,n,i){var a,s;return s=e.widget,s.initContext=function(){return e.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.leads)},e.getLeadDescription=function(e){var t,n;return n=[],t=["<strong>"],e.first_name&&t.push(i("titleize")(e.first_name)),e.last_name&&t.push(i("titleize")(e.last_name)),t.push("</strong>"),n.push(t.join(" ")),n.push("Status: "+i("titleize")(e.lead_status)),e.organization&&n.push("Organization: "+i("titleize")(e.organization)),e.opportunities&&(n.push("<strong>Opportunities:</strong>"),angular.forEach(e.opportunities,function(e){var t;return t=[],e.code&&t.push("#"+e.code),e.name&&t.push(""+e.name),e.amount&&t.push(i("mnoCurrency")(e.amount.total_amount,"USD",!1)),e.probability&&t.push(e.probability+"%"),e.sales_stage&&t.push(""+e.sales_stage),n.push(t.join(" - "))})),n.join("<br />")},a=function(){return null!=s.settings?s.settings.length:0},e.$watch(a,function(e){return e>=1?s.loadContent():void 0}),s}]),e.directive("widgetSalesLeadsList",function(){return{restrict:"A",link:function(e,t){return t.addClass("sales"),t.addClass("list")},controller:"WidgetSalesLeadsListCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.sales-list",[]),e.controller("WidgetSalesListCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc",function(e){var t,n,i;return i=e.widget,i.initContext=function(){return(e.isDataFound=angular.isDefined(i.content)&&!_.isEmpty(i.content.summary))?(e.periodOptions=[{label:"year",value:"YEARLY"},{label:"quarter",value:"QUARTERLY"},{label:"month",value:"MONTHLY"},{label:"week",value:"WEEKLY"},{label:"day",value:"DAILY"}],e.period=_.find(e.periodOptions,function(e){return e.value===i.content.hist_parameters.period})||e.periodOptions[0],e.filterOptions=[{label:"value sold (incl. taxes)",value:"gross_value_sold"},{label:"value sold (excl. taxes)",value:"net_value_sold"},{label:"quantity sold",value:"quantity_sold"},{label:"value purchased (incl. taxes)",value:"gross_value_purchased"},{label:"value purchased (excl. taxes)",value:"net_value_purchased"},{label:"quantity purchased",value:"quantity_purchased"}],e.filter=_.find(e.filterOptions,function(e){return e.value===i.content.filter})||e.filterOptions[0],e.unCollapsed=i.metadata.unCollapsed||[]):void 0},e.toogleCollapsed=function(t){return null!=t?(_.find(e.unCollapsed,function(e){return t===e})?e.unCollapsed=_.reject(e.unCollapsed,function(e){return e===t}):e.unCollapsed.push(t),i.updateSettings(!1)):void 0},e.isCollapsed=function(t){return null!=t?_.find(e.unCollapsed,function(e){return t===e})?!1:!0:void 0},n={},n.initialized=!1,n.initialize=function(){return n.initialized=!0},n.toMetadata=function(){return{unCollapsed:e.unCollapsed}},i.settings.push(n),t=function(){return null!=i.settings?i.settings.length:0},e.$watch(t,function(e){return e>=3?i.loadContent():void 0}),i}]),e.directive("widgetSalesList",function(){return{restrict:"A",link:function(e,t){return t.addClass("sales"),t.addClass("list")},controller:"WidgetSalesListCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.sales-margin",[]),e.controller("WidgetSalesMarginCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(e,t,n,i){var a,s;return s=e.widget,s.initContext=function(){return e.isDataFound=null!=s.content&&null!=s.content.margins&&null!=s.content.dates,e.filterOptions=[{label:"Including taxes",value:"gross_margin"},{label:"Excluding taxes",value:"net_margin"}],e.filter=null!=s.metadata&&"net_margin"===s.metadata.filter?e.filterOptions[1]:e.filterOptions[0]},s.format=function(){var t,i,a,o;return e.isDataFound?(o=null!=s.metadata&&"net_margin"===s.metadata.filter?s.content.margins.net:s.content.margins.gross,i={title:"Gross margin",labels:s.content.dates,values:o},t=!0,angular.forEach(o,function(e){return t&&(t=e>=0)}),a={scaleBeginAtZero:t,showXLabels:!1},s.chart=n.lineChart([i],a)):void 0},e.getTotalMargin=function(){return e.isDataFound?null!=s.metadata&&"net_margin"===s.metadata.filter?_.reduce(s.content.margins.net,function(e,t){return e+t},0):_.reduce(s.content.margins.gross,function(e,t){return e+t},0):void 0},e.getCurrency=function(){return e.isDataFound?s.content.currency||"USD":void 0},e.getTimeSpan=function(){return e.isDataFound?"From "+i("date")(_.first(s.content.dates),"d MMM yy")+" to "+i("date")(_.last(s.content.dates),"d MMM yy"):void 0},a=function(){return null!=s.settings?s.settings.length:0},e.$watch(a,function(e){return e>=4?s.loadContent():void 0}),s}]),e.directive("widgetSalesMargin",function(){return{restrict:"A",link:function(e,t){return t.addClass("accounts"),t.addClass("accounting-value")},controller:"WidgetSalesMarginCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.sales-number-of-leads",[]),e.controller("WidgetSalesNumberOfLeadsCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(e){var t,n,i;return i=e.widget,i.initContext=function(){return(e.isDataFound=angular.isDefined(i.content)&&!_.isEmpty(i.content.number_of_leads))?(e.periodOptions=[{label:"year",value:"YEARLY"},{label:"quarter",value:"QUARTERLY"},{label:"month",value:"MONTHLY"},{label:"week",value:"WEEKLY"},{label:"day",value:"DAILY"}],e.period=_.find(e.periodOptions,function(e){return e.value===i.metadata.period})||e.periodOptions[3]):void 0},e.formatNumberOfLeads=function(t){var a,s,o,d,l,r;if(s=0,o="- %",!e.isDataFound)return{nominal:s,variation:o,color:""};if(d=angular.copy(i.content.number_of_leads),l=0,a="","new"===t&&d.total&&2===d.total.length)l=d.total[1]-d.total[0],r=n(d.total),r>0?a="green":0>r&&(a="red");else if("converted"===t&&d.converted&&2===d.converted.length)l=d.converted[1],r=n(d.converted),r>0?a="green":0>r&&(a="red");else{if("lost"!==t||!d.lost||2!==d.lost.length)return{nominal:s,variation:o,color:a};l=d.lost[1],r=n(d.lost),0>r?a="green":r>0&&(a="red")}return l>0?s="+"+l:0>l&&(s=l),r&&r>0?o="+"+r.toFixed(0)+"%":r&&0>r&&(o=r.toFixed(0)+"%"),{nominal:s,variation:o,color:a}},n=function(e){var t;return t=0!==e[0]?100*(e[1]/e[0]-1):"- "},t=function(){return null!=i.settings?i.settings.length:0},e.$watch(t,function(e){return e>=2?i.loadContent():void 0}),i}]),e.directive("widgetSalesNumberOfLeads",function(){return{restrict:"A",link:function(e,t){return t.addClass("sales"),t.addClass("number-of-leads")},controller:"WidgetSalesNumberOfLeadsCtrl"}})}.call(this),function(){"use strict";var e,t=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};e=angular.module("impac.components.widgets.sales-opportunities-funnel",[]),e.controller("WidgetSalesOpportunitiesFunnelCtrl",["$scope","DhbAnalyticsSvc","Utilities","ChartFormatterSvc","$filter",function(e,n,i,a,s){var o,d,l;return l=e.widget,l.initContext=function(){return(e.isDataFound=angular.isDefined(l.content)&&!_.isEmpty(l.content.opps_per_sales_stage))?(e.statusOptions=_.compact(_.map(l.metadata.sales_stage_selection,function(e){return angular.isDefined(l.content.opps_per_sales_stage[e])?{label:e,selected:!0}:void 0})),angular.forEach(l.content.opps_per_sales_stage,function(n,i){return!l.metadata.sales_stage_selection||t.call(l.metadata.sales_stage_selection,i)>=0?_.isEmpty(l.metadata.sales_stage_selection)?e.statusOptions.push({label:i,selected:!0}):void 0:e.statusOptions.push({label:i,selected:!1})})):void 0},l.format=function(){var t;return e.isDataFound&&(t=0,angular.forEach(e.statusOptions,function(e){var n;return n=l.content.opps_per_sales_stage[e.label].total,e.selected&&angular.isDefined(n)&&n>t?t=n:void 0}),t>0)?e.funnel=_.compact(_.map(e.statusOptions,function(e){var n,i,a;return a=l.content.opps_per_sales_stage[e.label].total,n=(100*(a/t)-10).toFixed(),i=8>n?92:100-n,e.selected&&angular.isDefined(a)?{status:e.label,number:a,coloredWidth:{width:n+"%"},statusWidth:{width:i+"%"}}:void 0})):void 0},e.getImpacColor=function(e){return a.getColor(e)},e.toogleSelectStatus=function(t){return e.selectedStatus=e.selectedStatus&&e.selectedStatus===t?null:t,!l.isExpanded()&&e.selectedStatus?l.toogleExpanded():l.updateSettings(!1)},e.isSelected=function(t){return e.selectedStatus&&t===e.selectedStatus},e.getSelectedOpportunities=function(){return e.isDataFound&&e.selectedStatus?l.content.opps_per_sales_stage[e.selectedStatus].opps:void 0},e.getOppDetails=function(e){var t;return t=[],e.amount&&t.push(s("mnoCurrency")(e.amount.amount,e.amount.currency||"AUD")),e.probability&&t.push("proba "+e.probability+"%"),t.join(" / ")},d={},d.initialized=!1,d.initialize=function(){return angular.isDefined(l.content.opps_per_sales_stage[l.metadata.selected_status])&&(e.selectedStatus=l.metadata.selected_status),d.initialized=!0},d.toMetadata=function(){return{selected_status:e.selectedStatus}},l.settings.push(d),o=function(){return null!=l.settings?l.settings.length:0},e.$watch(o,function(e){return e>=4?l.loadContent():void 0}),l}]),e.directive("widgetSalesOpportunitiesFunnel",function(){return{restrict:"A",link:function(e,t){return t.addClass("sales"),t.addClass("leads-funnel")},controller:"WidgetSalesOpportunitiesFunnelCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.sales-performance",[]),e.controller("WidgetSalesPerformanceCtrl",["$scope","DhbAnalyticsSvc","ChartFormatterSvc","$filter",function(e,t,n,i){var a,s;return s=e.widget,s.initContext=function(){return e.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.assignees)},e.getOpportunityAmount=function(t){var n;return e.isDataFound&&!_.isEmpty(t)?t.amount&&t.amount.amount?(n=t.amount.amount,i("mnoCurrency")(n,t.amount.currency||"AUD")):"-":void 0},a=function(){return null!=s.settings?s.settings.length:0},e.$watch(a,function(e){return e>=1?s.loadContent():void 0}),s}]),e.directive("widgetSalesPerformance",function(){return{restrict:"A",link:function(e,t){return t.addClass("sales"),t.addClass("list")},controller:"WidgetSalesPerformanceCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.sales-segmented-turnover",[]),e.controller("WidgetSalesSegmentedTurnoverCtrl",["$scope","$filter","ChartFormatterSvc",function(e,t,n){var i,a;return a=e.widget,a.initContext=function(){return(e.isDataFound=!_.isEmpty(a.content.dates)&&!_.isEmpty(a.content.ranges))?(e.filterOptions=[{label:"Gross revenue (incl. taxes)",value:"gross"},{label:"Net revenue (excl. taxes)",value:"net"}],e.filter=_.find(e.filterOptions,function(e){return e.value===a.content.filter})||e.filterOptions[0]):void 0},a.format=function(){var t,i;return e.isDataFound?(t={labels:_.map(a.content.ranges,function(e){return e.label}),values:_.map(a.content.ranges,function(e){return e.value})},i={showTooltips:!1,showXLabels:!1,barDatasetSpacing:15},a.chart=n.barChart(t,i)):void 0},e.getAnalysis=function(){return e.isDataFound?a.content.ranges[0].percentage+a.content.ranges[1].percentage>50?"Your less expensive products bring you most of your revenue.":a.content.ranges[3].percentage+a.content.ranges[4].percentage>50?"Your most expensive products bring you most of your revenue.":"Your revenue is balanced between your different products segments.":void 0
},e.getColorByIndex=function(e){return n.getColor(e)},e.getRangeLabel=function(e){var n;return n=e.split("-"),_.map(n,function(e){return t("mnoCurrency")(e,a.content.currency,!1)}).join(" - ")},e.getMaxRange=function(){var t,n;return e.isDataFound?(t=0,n=a.content.ranges[0],angular.forEach(a.content.ranges,function(e){return e.percentage>t&&(n=angular.copy(e)),t=Math.max(t,e.percentage)}),n):void 0},i=function(){return null!=a.settings?a.settings.length:0},e.$watch(i,function(e){return e>=4?a.loadContent():void 0}),a}]),e.directive("widgetSalesSegmentedTurnover",function(){return{restrict:"A",link:function(e,t){return t.addClass("sales"),t.addClass("segmented-turnover")},controller:"WidgetSalesSegmentedTurnoverCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.sales-summary",[]),e.controller("WidgetSalesSummaryCtrl",["$scope","DhbAnalyticsSvc","Utilities","ChartFormatterSvc",function(e,t,n,i){var a,s;return s=e.widget,s.initContext=function(){return(e.isDataFound=!_.isEmpty(s.content.hist_parameters))?(e.incorrectPeriod=_.isEmpty(s.content.summary),e.periodOptions=[{label:"year",value:"YEARLY"},{label:"quarter",value:"QUARTERLY"},{label:"month",value:"MONTHLY"},{label:"week",value:"WEEKLY"},{label:"day",value:"DAILY"}],e.period=_.find(e.periodOptions,function(e){return e.value===s.content.hist_parameters.period})||e.periodOptions[0],e.filterOptions=[{label:"value sold (incl. taxes)",value:"gross_value_sold"},{label:"value sold (excl. taxes)",value:"net_value_sold"},{label:"quantity sold",value:"quantity_sold"},{label:"value purchased (incl. taxes)",value:"gross_value_purchased"},{label:"value purchased (excl. taxes)",value:"net_value_purchased"},{label:"quantity purchased",value:"quantity_purchased"}],"customer"===s.metadata.criteria&&(e.filterOptions=[e.filterOptions[0],e.filterOptions[1],e.filterOptions[2]]),e.filter=_.find(e.filterOptions,function(e){return e.value===s.content.filter})||e.filterOptions[0]):void 0},s.format=function(){var t,n;return e.isDataFound?(t=_.map(s.content.summary,function(e){var t;return t=e.company?(e.code||e.location||e.industry||e.customer)+" ("+e.company+")":e.code||e.location||e.industry||e.customer,{label:t,value:e.total}}),n={percentageInnerCutout:50,tooltipFontSize:12},s.chart=i.pieChart(t,n)):void 0},a=function(){return null!=s.settings?s.settings.length:0},e.$watch(a,function(e){return e>=4?s.loadContent():void 0}),s}]),e.directive("widgetSalesSummary",function(){return{restrict:"A",link:function(e,t){return t.addClass("sales"),t.addClass("summary")},controller:"WidgetSalesSummaryCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.sales-top-opportunities",[]),e.controller("WidgetSalesTopOpportunitiesCtrl",["$scope","DhbAnalyticsSvc","Utilities","ChartFormatterSvc","$filter",function(e,t,n,i,a){var s,o;return o=e.widget,o.initContext=function(){return e.isDataFound=angular.isDefined(o.content)&&!_.isEmpty(o.content.opportunities)},e.getOppDetails=function(e){var t;return t=[],e.amount&&t.push(a("mnoCurrency")(e.amount.amount,e.amount.currency||"AUD")),e.probability&&t.push("proba "+e.probability+"%"),e.sales_stage&&t.push(e.sales_stage),t.join(" / ")},e.getOppClass=function(e){switch(e){case 0:return"first";case 1:return"second";case 2:return"second";default:return""}},s=function(){return null!=o.settings?o.settings.length:0},e.$watch(s,function(e){return e>=1?o.loadContent():void 0}),o}]),e.directive("widgetSalesTopOpportunities",function(){return{restrict:"A",link:function(e,t){return t.addClass("sales"),t.addClass("top-opportunities")},controller:"WidgetSalesTopOpportunitiesCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets.template-admin",[]),e.controller("ImpacWidgetTemplateAdminCtrl",["$scope","WidgetTemplateSvc","$http",function(e,t,n){var i,a,s,o,d,l,r;return e.activatedCat=!1,e.cat={},e.loaderImage="",e.activateCat=function(t){return t===e.activatedCat?(e.activatedCat=!1,e.cat[t]=!1):(e.cat[t]=!0,e.activatedCat&&(e.cat[e.activatedCat]=!1),e.activatedCat=t)},e.create=a={},a.successMsg=!1,a.errorMsg=!1,a.errors="",a.inProgress=!1,a.generatePdf=!0,a.screenshot={},a.model={},a.endpoints=[],a.resetEndpoints=function(){return _.each(a.endpoints,function(e){return e.checked=!1})},a.reset=function(){return a.model={},a.model.active=!0,a.model.screenshot="",a.screenshot={},a.resetEndpoints()},a.save=function(){return a.errors="",a.successMsg=!1,a.errorMsg=!1,a.inProgress=!0,a.model.endpoints=a.endpoints,t.create(a).then(function(e){return 400===e.status?(a.errorMsg=!0,a.errors=e.data,a.inProgress=!1):void 0})},a.saveCatalogueImg=function(){return e.renderTemplateImg(!1)},a.afterSave=function(){return a.successMsg=!0,a.reset(),d.get(),a.inProgress=!1,a.generatePdf?t.generatePdf():void 0},e.update=l={},l.selected=!1,l.inProgress=!1,l.successMsg=!1,l.errorMsg=!1,l.errors="",l.generatePdf=!0,l.model={},l.endpoints=[],l.save=function(){return l.successMsg=!1,l.errorMsg=!1,l.inProgress=!0,l.model.endpoints=l.endpoints,t.update(l).then(function(e){return 400===e.status?(l.errorMsg=!0,l.errors=e.data,l.inProgress=!1):void 0})},l.saveCatalogueImg=function(){return e.renderTemplateImg(!0)},l.afterSave=function(){return l.successMsg=!0,l.inProgress=!1,l.generatePdf?t.generatePdf():void 0},l.selectEndpoints=function(e){return _.each(l.endpoints,function(t){return t.checked=!1,_.each(e.endpoints,function(e){return e.shared_entity_id===t.id?t.checked=!0:void 0})})},e.$watch("update.selected",function(){return l.selected?_.each(d.model,function(e){e.id===l.selected.id&&(l.model=e,l.model.category_id=e.category_id,l.selectEndpoints(e))}):l.model={},e.$apply}),e.destroy=o={},o.selected=!1,o.inProgress=!1,o.generatePdf=!0,o.destroy=function(){return o.inProgress=!0,t.destroy(o.selected.id).then(o.inProgress=!1,o.selected=!1,o.confirm="",d.get(),o.generatePdf?t.generatePdf():void 0)},e.addCategory=i={},i.model={},i.save=function(){return t.createCategory(i.model).then(i.model={},d.getCategories())},e.updateCategory=r={},r.selected=!1,r.inProgress=!1,r.model={},r.successMsg=!1,r.errorMsg=!1,r.errors="",r.save=function(){return r.successMsg=!1,r.errorMsg=!1,r.inProgress=!0,t.updateCategory(r.model).then(function(){return r.successMsg=!0,d.getCategories()},function(e){return r.errorMsg=!0,r.errors=e.data},r.inProgress=!1)},e.$watch("updateCategory.selected",function(){return r.selected?_.each(d.categories,function(e){e.id===r.selected.id&&(r.model=e)}):r.model={},e.$apply}),e.index=d={},d.inProgress=!1,d.model={},d.categories={},d.sharedEntities={},d.lastUpdate="",d.initEndpoints=function(e){return _.each(d.sharedEntities,function(t){return e.push({id:t.id,name:t.name,checked:!1})})},d.get=function(){return d.inProgress=!0,t.index().then(function(e){return d.model=e,d.inProgress=!1})},d.getCategories=function(){return d.inProgress=!0,t.categories().then(function(e){return d.categories=e,d.inProgress=!1})},d.getSharedEntities=function(){return d.inProgress=!0,n.get("/js_api/v1/connec_entities").then(function(e){return d.sharedEntities=e.data.shared_entities,d.initEndpoints(a.endpoints),d.initEndpoints(l.endpoints),d.inProgress=!1})},d.getLastUpdate=function(){return d.inProgress=!0,t.lastUpdate().then(function(e){return d.lastUpdate=e,d.inProgress=!1})},e.saveCatalogueImg=function(e,n){return t.updateImg(e,n,!1)},e.getSettings=function(e){return null!=e.settings&&_.isArray(e.settings)?e.settings.slice(0,6):null!=e.settings&&_.isString(e.settings)?""===e.settings?[]:e.settings.split(",").slice(0,6):void 0},e.getCompatibleApps=function(e){return null!=e.endpoints?t.previewApps(e):void 0},s=function(e){var t,n,i,a,s,o,d,l;for(i=atob(e.split(",")[1]),d=e.split(",")[0].split(":")[1].split(";")[0],t=new ArrayBuffer(i.length),s=new Uint8Array(t),a=o=0,l=i.length;l>=0?l>=o:o>=l;a=l>=0?++o:--o)s[a]=i.charCodeAt(a);return n=new Blob([t])},e.renderTemplateImg=function(t){var n;return null==t&&(t=!0),n=t?angular.element("#preview_update"):angular.element("#preview_create"),html2canvas(n,{onrendered:function(n){var i,o;return o=n.toDataURL("image/png"),i=s(o),t?e.saveCatalogueImg(l,i):e.saveCatalogueImg(a,i)}})},e.init=function(){return _.each(e.catList,function(t){return e.cat[t]=!1}),a.reset(),d.get(),d.getCategories(),d.getSharedEntities(),d.getLastUpdate()},e.init()}]),e.directive("impacWidgetTemplateAdmin",["$templateCache",function(e){return{restrict:"A",scope:{},template:e.get("widgets/template-admin.tmpl.html"),controller:"ImpacWidgetTemplateAdminCtrl"}}])}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets-common.data-not-found",[]),e.directive("commonDataNotFound",["$templateCache","ImpacAssets",function(e,t){return{restrict:"A",scope:{widgetEngine:"="},template:e.get("widgets-common/data-not-found.tmpl.html"),link:function(e){var n,i;return e.bgImage="",n=t.get("dataNotFound"),e.widgetEngine&&n.length>0?(i=n.split(""),i="/"!==i[i.length-1]?i.concat("/").join(""):i.join(""),e.bgImage=i+e.widgetEngine+".png"):void 0}}}])}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets-common.editable-title",[]),e.controller("CommonEditableTitleCtrl",["$scope","DhbAnalyticsSvc",function(e,t){var n;return n=e.parentWidget,e.updateName=function(){var e;return 0===n.name.length?(n.name=n.originalName,"Incorrect name"):(e={name:n.name},t.widgets.update(n,e).then(function(e){return n.originalName=n.name,angular.extend(n,e.data)},function(){return n.name=n.originalName}))}}]),e.directive("commonEditableTitle",["$templateCache",function(e){return{restrict:"A",scope:{parentWidget:"="},template:e.get("widgets-common/editable-title.tmpl.html"),controller:"CommonEditableTitleCtrl"}}])}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets-common.top-buttons",[]),e.controller("CommonTopButtonsCtrl",["$scope","$rootScope","$log","DhbAnalyticsSvc","ImpacAssets",function(e,t,n,i){var a;return a=e.parentWidget,e.showCloseActive=!1,e.showEditActive=!1,e.showConfirmDelete=!1,a.isEditMode=!1,e.deleteWidget=function(){return i.widgets["delete"](a.id,a.parentDashboard).then(function(){return n.debug("Successfully removed widget!")},function(e){return a.errors=Utilities.processRailsError(e),n.error("Error deleting widget: ",e)})},e.toogleEditMode=function(){return a.isLoading?void 0:a.isEditMode?a.initSettings():a.isEditMode=!0}}]),e.directive("commonTopButtons",["$templateCache",function(e){return{restrict:"A",scope:{parentWidget:"="},template:e.get("widgets-common/top-buttons.tmpl.html"),controller:"CommonTopButtonsCtrl"}}])}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets-settings.account",[]),e.controller("SettingAccountCtrl",["$scope","$filter",function(e,t){var n,i;return i=e.parentWidget,n={},n.key="account",n.isInitialized=!1,n.initialize=function(){return i.selectedAccount=null,null!=i.content&&null!=i.content.account_list&&null!=i.metadata&&null!=i.metadata.account_uid?(i.selectedAccount=_.find(i.content.account_list,function(e){return e.uid===i.metadata.account_uid}),n.isInitialized=!0):void 0},n.toMetadata=function(){return null!=i.selectedAccount?{account_uid:i.selectedAccount.uid}:void 0},e.formatAmount=function(e){return t("mnoCurrency")(e.current_balance,e.currency)},i.settings||(i.settings=[]),i.settings.push(n)}]),e.directive("settingAccount",["$templateCache",function(e){return{restrict:"A",scope:{parentWidget:"="},template:e.get("widgets-settings/account.tmpl.html"),controller:"SettingAccountCtrl"}}])}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets-settings.accounts-list",[]),e.controller("SettingAccountsListCtrl",["$scope",function(e){var t,n,i,a;return a=e.parentWidget,a.moveAccountToAnotherList=function(e,i,s,o){return null==o&&(o=!0),n(e,i),t(e,s),o?a.updateSettings(!1):void 0},n=function(e,t){return _.isEmpty(t)?void 0:angular.copy(_.reject(t,function(t){return e.uid===t.uid}),t)},t=function(e,t){return null!=e?(t||(t=[]),t.push(e)):void 0},i={},i.key="accounts-list",i.initialize=function(){return i.isInitialized=!1,a.remainingAccounts=[],a.selectedAccounts=[],null==a.content||_.isEmpty(a.content.complete_list)?void 0:(a.remainingAccounts=angular.copy(a.content.complete_list),_.isEmpty(a.metadata.accounts_list)||angular.forEach(a.metadata.accounts_list,function(e){var t;return t=_.find(a.content.complete_list,function(t){return t.uid===e}),a.moveAccountToAnotherList(t,a.remainingAccounts,a.selectedAccounts,!1)}),i.isInitialized=!0)},i.toMetadata=function(){return i.isInitialized?{accounts_list:_.map(a.selectedAccounts,function(e){return e.uid})}:void 0},a.settings||(a.settings=[]),a.settings.push(i)}]),e.directive("settingAccountsList",function(){return{restrict:"A",scope:{parentWidget:"="},controller:"SettingAccountsListCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets-settings.chart-filters",[]),e.controller("SettingChartFiltersCtrl",["$scope",function(e){var t,n;return n=e.parentWidget,t={},t.key="chart-filters",t.isInitialized=!1,t.initialize=function(){return null!=n.content.chart_filter&&(e.filterCriteria=n.content.chart_filter.criteria)?(e.maxEntities=n.content.chart_filter.max,e.entityType=n.content.chart_filter.entity_type,e.filterLabel=n.content.chart_filter.filter_label.replace(/_/g," "),"number"===e.filterCriteria?(e.filterValuePercentage=80,e.filterValueNumber=n.content.chart_filter.value):(e.filterValuePercentage=n.content.chart_filter.value,e.filterValueNumber=Math.round(e.maxEntities/2)),t.isInitialized=!0):void 0},t.toMetadata=function(){var t;return null!=n.content.chart_filter?(t="percentage"===e.filterCriteria?e.filterValuePercentage:e.filterValueNumber,{chart_filter:{criteria:e.filterCriteria,value:t}}):{}},n.settings||(n.settings=[]),n.settings.push(t)}]),e.directive("settingChartFilters",["$templateCache",function(e){return{restrict:"A",scope:{parentWidget:"="},template:e.get("widgets-settings/chart-filters.tmpl.html"),controller:"SettingChartFiltersCtrl"}}])}.call(this),function(){"use strict";var module;module=angular.module("impac.components.widgets-settings.formula",[]),module.controller("SettingFormulaCtrl",["$scope","$filter",function($scope,$filter){var authorized_regex,evaluateFormula,formatFormula,getFormula,setting,w;return w=$scope.parentWidget,w.formula="",authorized_regex=new RegExp("^(\\{|\\d|\\}|\\/|\\+|-|\\*|\\(|\\)|\\s|\\.)*$"),setting={},setting.key="formula",setting.isInitialized=!1,setting.initialize=function(){return null!=w.metadata&&null!=w.metadata.formula?(w.formula=w.metadata.formula,setting.isInitialized=!0):w.formula=""},setting.toMetadata=function(){return evaluateFormula(),w.isFormulaCorrect?{formula:w.formula}:{formula:""}},getFormula=function(){return w.formula},w.formatAmount=function(e){return $filter("mnoCurrency")(e.current_balance,e.currency)},$scope.$watch(getFormula,function(){return evaluateFormula()}),evaluateFormula=function(){var e,i,legend,str;str=angular.copy(w.formula),legend=angular.copy(w.formula),i=1,angular.forEach(w.selectedAccounts,function(e){var t;return t="\\{"+i+"\\}",str=str.replace(new RegExp(t,"g"),e.current_balance_no_format),legend=legend.replace(new RegExp(t,"g"),e.name),i++}),str.match(authorized_regex)||(w.isFormulaCorrect=!1,w.evaluatedFormula="invalid expression");try{w.evaluatedFormula=eval(str).toFixed(2)}catch(_error){e=_error,w.evaluatedFormula="invalid expression"}return null==w.evaluatedFormula||"invalid expression"===w.evaluatedFormula||"Infinity"===w.evaluatedFormula||"-Infinity"===w.evaluatedFormula?w.isFormulaCorrect=!1:(formatFormula(),w.legend=legend,w.isFormulaCorrect=!0)},formatFormula=function(){var e,t;return!w.formula.match(/\//g)&&null!=w.selectedAccounts&&(t=w.selectedAccounts[0])&&(e=t.currency)?w.evaluatedFormula=$filter("mnoCurrency")(w.evaluatedFormula,e):void 0},w.settings||(w.settings=[]),w.settings.push(setting)}]),module.directive(function(){return{restrict:"A",scope:{parentWidget:"="},controller:"SettingFormulaCtrl"}})}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets-settings.hist-mode",[]),e.controller("SettingHistModeCtrl",["$scope","DhbAnalyticsSvc",function(e){var t,n;return n=e.parentWidget,n.isHistoryMode=!1,e.toogleHistMode=function(e){return n.isHistoryMode&&"history"===e||!n.isHistoryMode&&"current"===e?void 0:(n.isHistoryMode=!n.isHistoryMode,n.updateSettings(!1))},t={},t.key="hist-mode",t.isInitialized=!1,t.initialize=function(){var e;return null!=n.content&&null!=n.content.hist_parameters&&(e=n.content.hist_parameters.mode)?(n.isHistoryMode="history"===e?!0:!1,t.isInitialized=!0):void 0},t.toMetadata=function(){var e;return e=n.isHistoryMode?"history":"current",{hist_parameters:{mode:e}}},n.settings||(n.settings=[]),n.settings.push(t)}]),e.directive("settingHistMode",["$templateCache",function(e){return{restrict:"A",scope:{parentWidget:"="},template:e.get("widgets-settings/hist-mode.tmpl.html"),controller:"SettingHistModeCtrl"}}])}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets-settings.organizations",[]),e.controller("SettingOrganizationsCtrl",["$scope",function(e){var t,n;return n=e.parentWidget,e.dashboardOrganizations=n.parentDashboard.data_sources,n.selectedOrganizations={},e.isOrganizationSelected=function(e){return!!n.selectedOrganizations[e]},e.toogleSelectOrganization=function(e){return n.selectedOrganizations[e]=!n.selectedOrganizations[e]},t={},t.key="organizations",t.isInitialized=!1,t.initialize=function(){return null!=n.metadata&&null!=n.metadata.organization_ids?(angular.forEach(n.metadata.organization_ids,function(e){return n.selectedOrganizations[e]=!0}),t.isInitialized=!0):void 0},t.toMetadata=function(){var e;return e=_.compact(_.map(n.selectedOrganizations,function(e,t){return e?t:void 0})),{organization_ids:e}},n.settings||(n.settings=[]),n.settings.push(t)}]),e.directive("settingOrganizations",["$templateCache",function(e){return{restrict:"A",scope:{parentWidget:"="},template:e.get("widgets-settings/organizations.tmpl.html"),controller:"SettingOrganizationsCtrl"}}])}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets-settings.param-selector",[]),e.controller("SettingParamSelectorCtrl",["$scope",function(e){var t,n;return e.showOptions=!1,e.toogleShowOptions=function(){return e.showOptions=!e.showOptions},e.selectOption=function(t){return t!==e.selected&&(e.selected=t,n.updateSettings(!e.noReload)),e.toogleShowOptions()},e.getTruncateValue=function(){return parseInt(e.truncateNo)||20},n=e.parentWidget,t={},t.key="param-selector",t.isInitialized=!1,t.initialize=function(){return null!=n.content?t.isInitialized=!0:void 0},t.toMetadata=function(){var t;return t={},t[""+e.param]=e.selected.value,t},n.settings||(n.settings=[]),n.settings.push(t)}]),e.directive("settingParamSelector",["$templateCache",function(e){return{restrict:"A",scope:{parentWidget:"=",param:"@",options:"=",selected:"=",truncateNo:"@"},link:function(e,t,n){return e.noReload="undefined"!=typeof n.noReload,e.truncateNo=n.truncateNo||20},template:e.get("widgets-settings/param-selector.tmpl.html"),controller:"SettingParamSelectorCtrl"}}])}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets-settings.params-picker",[]),e.controller("SettingParamsPickerCtrl",["$scope","DhbAnalyticsSvc",function(e){var t,n;return n=e.parentWidget,t={},t.key="params-picker",t.isInitialized=!1,t.initialize=function(){return e.sortableOptions={"ui-floating":!0,tolerance:"pointer"},_.isEmpty(e.options)?t.isInitialized=!0:void 0},t.toMetadata=function(){var t;return t={},t[""+e.param]=_.compact(_.map(e.options,function(e){return e.selected?e.label:void 0})),t},n.settings||(n.settings=[]),n.settings.push(t)}]),e.directive("settingParamsPicker",["$templateCache",function(e){return{restrict:"A",scope:{parentWidget:"=",param:"@",options:"="},link:function(e){return e.formattedParam=e.param.replace("_"," ")},template:e.get("widgets-settings/params-picker.tmpl.html"),controller:"SettingParamsPickerCtrl"}}])}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets-settings.time-range",[]),e.controller("SettingTimeRangeCtrl",["$scope",function(e){var t,n;return n=e.parentWidget,e.numberOfPeriods=(new Date).getMonth()+1,e.selectedPeriod="MONTHLY",e.PERIODS=["DAILY","WEEKLY","MONTHLY","QUARTERLY","YEARLY"],e.periodToUnit=function(){var t,n,i;return t=e.numberOfPeriods,n=e.selectedPeriod,i="DAILY"!==n?n.substring(0,n.length-2).toLowerCase():"day",t>1&&(i=i.concat("s")),i},t={},t.key="time-range",t.isInitialized=!1,t.initialize=function(){var i;return null!=n.metadata&&(i=n.metadata.hist_parameters)?(null!=i.period&&(e.selectedPeriod=i.period),null!=i.number_of_periods&&(e.numberOfPeriods=i.number_of_periods),t.isInitialized=!0):void 0},t.toMetadata=function(){return{hist_parameters:{period:e.selectedPeriod,number_of_periods:e.numberOfPeriods}}},n.settings||(n.settings=[]),n.settings.push(t)}]),e.directive("settingTimeRange",["$templateCache",function(e){return{restrict:"A",scope:{parentWidget:"="},template:e.get("widgets-settings/time-range.tmpl.html"),controller:"SettingTimeRangeCtrl"}}])}.call(this),function(){"use strict";var e;e=angular.module("impac.components.widgets-settings.width",[]),e.controller("SettingWidthCtrl",["$scope",function(e){var t,n;return n=e.parentWidget,n.toogleExpanded=function(){return e.expanded=!e.expanded,n.updateSettings(!1),n.width=e.expanded?parseInt(e.max):parseInt(e.min)},t={},t.key="width",t.isInitialized=!1,n.isExpanded=function(){return e.expanded},t.initialize=function(){return null!=n.width?(e.expanded=n.width===parseInt(e.max),t.isInitialized=!0):void 0},t.toMetadata=function(){var t;return t=e.expanded?e.max:e.min,{width:parseInt(t)}},n.settings||(n.settings=[]),n.settings.push(t)}]),e.directive("settingWidth",["$templateCache",function(e){return{restrict:"A",scope:{parentWidget:"=",min:"@",max:"@"},template:e.get("widgets-settings/width.tmpl.html"),controller:"SettingWidthCtrl"}}])}.call(this);