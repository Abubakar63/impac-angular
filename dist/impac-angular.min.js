!function(){"use strict";angular.module("maestrano.impac",["impac.config","impac.services","impac.filters","impac.components","ui.sortable","ui.bootstrap","emguo.poller"]),angular.module("impac.components",["impac.components.dashboard","impac.components.dashboard-selector","impac.components.dashboard-settings","impac.components.kpis-bar","impac.components.kpi","impac.components.chart","impac.components.widget","impac.components.widgets","impac.components.widgets-settings","impac.components.widgets-common","impac.components.templates"]),angular.module("impac.components.widgets",["impac.components.widgets.accounts-accounting-values","impac.components.widgets.accounts-assets-summary","impac.components.widgets.accounts-assets-liability-summary","impac.components.widgets.accounts-balance-sheet","impac.components.widgets.accounts-balance","impac.components.widgets.accounts-cash-summary","impac.components.widgets.accounts-comparison","impac.components.widgets.accounts-custom-calculation","impac.components.widgets.accounts-expenses-revenue","impac.components.widgets.accounts-payable-receivable","impac.components.widgets.accounts-profit-and-loss","impac.components.widgets.accounts-class-comparison","impac.components.widgets.accounts-expense-weight","impac.components.widgets.accounts-assets-vs-liabilities","impac.components.widgets.accounts-detailed-classifications","impac.components.widgets.hr-employee-details","impac.components.widgets.hr-employees-list","impac.components.widgets.hr-leaves-balance","impac.components.widgets.hr-leaves-schedule","impac.components.widgets.hr-payroll-summary","impac.components.widgets.hr-payroll-taxes","impac.components.widgets.hr-salaries-summary","impac.components.widgets.hr-superannuation-accruals","impac.components.widgets.hr-timesheets","impac.components.widgets.hr-workforce-summary","impac.components.widgets.invoices-aged-payables-receivables","impac.components.widgets.invoices-list","impac.components.widgets.invoices-summary","impac.components.widgets.sales-aged","impac.components.widgets.sales-break-even","impac.components.widgets.sales-comparison","impac.components.widgets.sales-customer-details","impac.components.widgets.sales-cycle","impac.components.widgets.sales-forecast","impac.components.widgets.sales-growth","impac.components.widgets.sales-leads-funnel","impac.components.widgets.sales-leads-list","impac.components.widgets.sales-list","impac.components.widgets.sales-margin","impac.components.widgets.sales-number-of-leads","impac.components.widgets.sales-opportunities-funnel","impac.components.widgets.sales-performance","impac.components.widgets.sales-segmented-turnover","impac.components.widgets.sales-summary","impac.components.widgets.sales-top-opportunities"]),angular.module("impac.components.widgets-settings",["impac.components.widgets-settings.account","impac.components.widgets-settings.accounts-list","impac.components.widgets-settings.chart-filters","impac.components.widgets-settings.dates-picker","impac.components.widgets-settings.formula","impac.components.widgets-settings.hist-mode","impac.components.widgets-settings.limit-entries","impac.components.widgets-settings.organizations","impac.components.widgets-settings.param-selector","impac.components.widgets-settings.params-picker","impac.components.widgets-settings.params-checkboxes","impac.components.widgets-settings.time-range","impac.components.widgets-settings.width"]),angular.module("impac.components.dashboard-settings",["impac.components.dashboard-settings.currency","impac.components.dashboard-settings.sync-apps"]),angular.module("impac.components.widgets-common",["impac.components.widgets-common.top-buttons","impac.components.widgets-common.data-not-found","impac.components.widgets-common.editable-title"]),angular.module("impac.services",["impac.services.routes","impac.services.linking","impac.services.theming","impac.services.assets","impac.services.chart-formatter","impac.services.message-bus","impac.services.utilities","impac.services.main","impac.services.kpis","impac.services.dashboards","impac.services.widgets"]),angular.module("impac.filters",["impac.filters.titleize","impac.filters.truncate","impac.filters.mno-currency","impac.filters.mno-date"]),angular.module("impac.config",[]).config(["$httpProvider",function(t){t.defaults.headers.common.Accept="application/json",t.defaults.headers.common["Content-Type"]="application/json"}]),angular.module("impac.components.templates",[]).run(["$templateCache",function(t){t.put("dashboard/create.modal.html",'<div class="modal-header">\n  <div class="close" type="button" ng-click="instance.close()" >×</div>\n  <h3>Create New Dashboard</h3>\n</div>\n\n<div class="modal-body">\n  <div class="row">\n    <div class="col-sm-12">\n      <div class="alert alert-error" ng-show="errors">\n        <button class="close" ng-click="errors=\'\'">×</button>\n        <ul>\n          <li ng-repeat="error in errors">{{error}}</li>\n        </ul>\n      </div>\n    </div>\n  </div>\n\n  <!-- Create a new dashboard -->\n  <div class="row dashboard-form">\n    <div class="col-sm-10 col-sm-offset-1">\n      <form class="form-horizontal" role="form">\n        <div class="form-group">\n          <label class="col-sm-2 control-label">Name</label>\n          <div class="col-sm-10">\n            <input type=\'text\' class="form-control" ng-model="model.name" placeholder="E.g: Cash Accounts Monitoring" required>\n          </div>\n        </div>\n\n        <div class="form-group" ng-show="isMultiCompanyAvailable()">\n          <label class="col-sm-2 control-label">Type</label>\n          <div class="col-sm-10">\n            <div class="btn-group" role="group">\n              <button type="button" ng-click="selectMode(\'single\')" ng-class="btnBlassFor(\'single\')">Current Company</button>\n              <button type="button" ng-click="selectMode(\'multi\')" ng-class="btnBlassFor(\'multi\')">Multi Company</button>\n            </div>\n          </div>\n        </div>\n\n        <!-- Single Company mode -->\n        <div class="form-group" ng-show="isCurrentOrganizationShown()">\n          <div ng-show="!canAccessAnalyticsForCurrentOrganization()" class="text-center text-purple">\n            <div class="spacer1"></div>\n            <p>\n              Oops! Only Admins and Super Admins can create dashboards for company {{currentOrganization.name}}.\n              <span ng-show="isMultiCompanyAvailable()">Please select a "Multi Company" dashboard to select data from other companies.</span>\n            </p>\n          </div>\n        </div>\n\n        <!-- Multi Company mode -->\n        <div class="form-group" ng-show="isSelectOrganizationShown()">\n          <label class="col-sm-2 control-label">Companies</label>\n          <div class="col-sm-10">\n            <ul class="list-unstyled">\n              <li ng-repeat="organization in organizations" >\n                <input type="checkbox" ng-model="organization.$selected" ng-disabled="!canAccessAnalyticsData(organization)">\n                {{organization.name}}\n                <span ng-show="organization.is_customer_account">(customer)</span>\n                <span ng-show="!canAccessAnalyticsData(organization)">\n                  <em><small>\n                    &nbsp;\n                    &nbsp;\n                    <i class="fa fa-exclamation-circle text-danger" tooltip="Only Admins and Super Admins can access analytics data for this company"></i>\n                  </small></em>\n                </span>\n              </li>\n            </ul>\n          </div>\n        </div>\n      </form>\n\n      <!-- End row col -->\n    </div>\n\n    <!-- End Dashboard form -->\n  </div>\n\n\n\n</div>\n\n<div class="modal-footer">\n  <div class="row">\n    <div class="col-sm-12">\n      <button class="btn btn-shaded" ng-click="instance.dismiss()" ng-hide="isLoading">Cancel</button>\n      <button class="btn btn-primary" ng-click="proceed()" ng-disabled="isProceedDisabled()">\n        <i class="fa fa-spinner fa-pulse loader" ng-if="isLoading"></i>\n        Add\n      </button>\n    </div>\n  </div>\n</div>\n'),t.put("dashboard/dashboard.tmpl.html",'<!-- DASHBOARD -->\n<div class="analytics" ng-hide="(isLoading || forceLoad)" ng-class="{\'hide-dhb\': (isLoading || forceLoad), \'show-dhb\': !(isLoading || forceLoad)}">\n  <div mno-star-wizard=true modal-open=\'starWizardModal.value\'></div>\n\n  <!-- Title and Dashboard selection -->\n  <div id="head-title">\n    <div class="row" ng-if="showDhbHeading">\n      <div class="col-md-6 col-sm-12" id="dashboard-heading">\n        <img ng-src="{{impacTitleLogo}}" />\n        <h2>\n          {{dhbHeadingText}}\n        </h2>\n      </div>\n    </div>\n\n    <!-- Impac KPI\'s -->\n    <kpis-bar ng-if="showKpisBar" kpis="currentDhb.kpis"></kpis-bar>\n\n    <!-- Dashboards selection/creation/deletion -->\n    <dashboard-selector id="module__dashboard-selector" is-widget-selector-shown="showWidgetSelector()" on-create-dashboard="createDashboardModal.open()" on-display-widget-selector="displayWidgetSelector()" on-select-dashboard="activateTimer()"></dashboard-selector>\n  </div>\n\n  <div id="sub-menu" collapse="!showSubMenu">\n    <i class="fa fa-times" ng-click="hideSubMenu()" />\n\n    <!-- Displayed to MYOB Essentials Users -->\n    <div id="myob-message" ng-if="hasMyobEssentialsOnly && myobMessageConfig.show" class="alert alert-warning">\n      <h3>It looks like you are using MYOB Essentials...</h3>\n      <p>Unfortunately, all the information required by Impac! is not exposed by MYOB Essentials API <strong>yet</strong>.\n      Consequently, most of the accounting widgets provided by Impac! won\'t find a valid source of data to display their content.</p>\n      <p>Maybe you should consider switching to <a href="http://myob.com.au/products/small-business/accounting-software/myob-accountright-1422735752948" target="_blank">MYOB AccountRight</a>, the other MYOB accounting solution?</p>\n      <p align="right" ng-if="myobMessageConfig.appLink.show"><a ng-href="{{myobMessageConfig.appLink.url}}" target="_blank">{{myobMessageConfig.appLink.text}}</a></p>\n    </div>\n  </div>\n\n  <!-- Widgets selection container -->\n  <div id="widget-selector" collapse="!showWidgetSelector()" ng-if="!customWidgetSelector.path">\n    <div class="title">\n      <i class="fa fa-times-circle" ng-if="showCloseWidgetSelectorButton()" ng-click="displayWidgetSelector(false)"/>\n      <span class="badge confirmation">Widget added!</span>\n      Select the widgets you want to add to your dashboard.\n    </div>\n\n    <div class="row top-container">\n      <div class="col-md-3 categories">\n        <div class="row header">\n          All categories\n        </div>\n        <div class="row lines">\n          <div class="col-md-12" style="padding: 3px 12px;">\n            <p ng-click="selectCategory(\'accounts\')" ng-class="isCategorySelected(\'accounts\') ? \'selected\' : none">Accounting</p>\n            <p ng-click="selectCategory(\'invoices\')" ng-class="isCategorySelected(\'invoices\') ? \'selected\' : none">Invoicing</p>\n            <p ng-click="selectCategory(\'hr\')" ng-class="isCategorySelected(\'hr\') ? \'selected\' : none">HR / Payroll</p>\n            <p ng-click="selectCategory(\'sales\')" ng-class="isCategorySelected(\'sales\') ? \'selected\' : none">Sales</p>\n          </div>\n        </div>\n\n        <div class="arrow" ng-style="getSelectedCategoryTop()">\n          <div class="square"></div>\n          <i class="fa fa-caret-right"></i>\n        </div>\n\n      </div>\n\n      <div class="col-md-9 widgets">\n        <div class="row header">\n          {{getSelectedCategoryName() | titleize}}\n        </div>\n        <div class="row lines">\n          <div class="col-md-4" ng-repeat="widgetPattern in getWidgetsForSelectedCategory()" style="padding: 0px 8px;">\n            <p ng-click="addWidget(widgetPattern.path, widgetPattern.metadata)" tooltip="{{widgetPattern.desc}}" tooltip-placement="{{$index < 9 ? \'bottom\' : \'top\'}}" tooltip-animation="false"  tooltip-append-to-body="true" tooltip-class="impac-widget-selector-tooltip"><i class="fa fa-{{widgetPattern.icon}}" /> {{widgetPattern.name}} <i class="fa fa-plus-circle" /></p>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class="bottom" ng-if="widgetSuggestionModal.config.apiPath">\n      <span class="suggestion">\n        Can\'t find the widget you\'re looking for? <a ng-click="widgetSuggestionModal.open()">Give us your suggestions here!</a>\n      </span>\n    </div>\n  </div>\n\n  <!-- custom widget selector template configured from ImpacThemingProvider -->\n  <div id="custom-widget-selector" ng-if="customWidgetSelector.path" ng-include="customWidgetSelector.path" ng-hide="showChooseDhbMsg()"></div>\n\n  <!-- Dashboard Settings - DEFAULT POSITION -->\n  <div id="dashboard-settings-panel" ng-if="!dhbSettingsConfig.inWidgetsContainer && !showChooseDhbMsg()" class="row text-right">\n    <div dashboard-setting-sync-apps ng-if="dhbSettingsConfig.showSyncApps()"/>\n    <div dashboard-setting-currency currency="currentDhb.currency" />\n  </div>\n\n  <!-- Errors -->\n  <div class="alert alert-error" ng-show="errors">\n    <button class="close" ng-click="errors=\'\'">×</button>\n    <ul>\n      <li ng-repeat="error in errors">{{error}}</li>\n    </ul>\n  </div>\n\n  <div id="no-widgets-container" class="row text-center ng-hide" ng-show=\'(showChooseDhbMsg() || showNoWidgetsMsg())\'>\n\n    <img ng-src="{{impacDashboardBackground}}" class="bg">\n\n    <div class="impac-info-message">\n      <!-- First Time Dashboard Creation -->\n      <div class="ng-hide" ng-show=\'showChooseDhbMsg()\'>\n        <div class=\'hidden-xs\'>\n          <div class=\'spacer4\'></div>\n          <div class="row">\n            <div class="col-md-8 col-md-offset-2">\n              <div class="testimonial promo-dark">\n                <p><b>{{dhbErrorsConfig.firstTimeCreated.first}}</b></p>\n                <p>{{dhbErrorsConfig.firstTimeCreated.second}}</p>\n              </div>\n            </div>\n          </div>\n          <div class=\'spacer2\'></div>\n        </div>\n        <div class="align-center">\n          <button ng-click="createDashboardModal.open()" class=\'btn btn-lg btn-warning\'><span class=\'fa fa-plus\'></span> Create a Dashboard!</button>\n        </div>\n      </div>\n\n      <!-- Empty Dashboard -->\n      <div class="ng-hide" ng-show=\'showNoWidgetsMsg()\'>\n        <div class=\'hidden-xs\'>\n          <div class=\'spacer4\'></div>\n          <div class="row">\n            <div class="col-md-8 col-md-offset-2">\n              <div class="testimonial promo-dark">\n                <p><b>{{dhbErrorsConfig.empty.first}}</b></p>\n                <p>{{dhbErrorsConfig.empty.second}}</p>\n              </div>\n            </div>\n          </div>\n          <div class="spacer2"></div>\n        </div>\n        <div class="align-center">\n          <button ng-disabled="showWidgetSelector()" ng-click="displayWidgetSelector()" class=\'btn btn-lg btn-warning\'><span class=\'fa fa-plus\'></span> Add a new Widget</button>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- First Time Dashboard Creation -->\n  <div class="row text-center" ng-show=\'showChooseDhbMsg()\'>\n    <div class="spacer2 hidden-xs"></div>\n    <div class=\'col-md-8 col-md-offset-2\'>\n      <p class="text-muted"><small><em>{{dhbErrorsConfig.firstTimeCreated.note}}</em></small></p>\n    </div>\n  </div>\n\n  <!-- Widgets -->\n  <div class=\'row\' id="widgets-section" ng-hide="showNoWidgetsMsg() || showChooseDhbMsg()">\n    <!-- Dashboard Settings - CONFIGURED INSIDE WIDGETS-CONTAINER -->\n    <div id="dashboard-settings-panel" ng-if="dhbSettingsConfig.inWidgetsContainer && !showChooseDhbMsg()" class="text-right col-md-12 in-widgets-container">\n      <div dashboard-setting-sync-apps ng-if="dhbSettingsConfig.showSyncApps()"/>\n      <div dashboard-setting-currency currency="currentDhb.currency" />\n    </div>\n    <div class="col-md-12">\n      <div id="widgets-container" ui-sortable="sortableOptions" ng-model="currentDhb.widgets" class="row">\n        <!-- Widgets -->\n        <div impac-widget widget="widget" is-accessibility="accessibility" parent-dashboard="currentDhb" ng-repeat="widget in currentDhb.widgets" class="widget-item" ng-class="widget.getColClass()" on-display-alerts="displaySubMenu()" />\n        <!-- Add Widget Tile, enabled & customised in ImpacThemingProvider -->\n        <div ng-if="isAddChartEnabled" class="unsortable" ng-click="addChartTileOnClick()">\n          <div class="col-md-6 widget-item add-chart">\n            <div class="a-content">+ chart</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class="analytics" ng-show="(isLoading || forceLoad)">\n  <div class="row">\n    <div class="col-md-12 loader-container text-center" style="margin-top: 200px;">\n      <i class="fa fa-refresh fa-spin" style="font-size: 250px; opacity: 0.7;"/>\n    </div>\n  </div>\n</div>\n'),t.put("dashboard/widget-suggestion.modal.html",'<div class="modal-header">\n  <div class="close" type="button" ng-click="instance.close()" >×</div>\n  <h3>Suggest a widget</h3>\n</div>\n\n<div class="modal-body">\n\n  <div class="row">\n    <div class="col-md-6">\n      <label>What would you name your widget?</label><br />\n      <input type="text" ng-model="widgetDetails.name" ng-disabled="isLoading" />\n    </div>\n    <div class="col-md-6">\n      <label>In which category?</label><br />\n      <input type="text" ng-model="widgetDetails.category" ng-disabled="isLoading" />\n    </div>\n  </div>\n\n  <div class="spacer1" />\n\n  <div class="row">\n    <div class="col-md-12">\n      <label>What kind of information would your widget display?</label><br/>\n      <textarea ng-model="widgetDetails.description" ng-disabled="isLoading" />\n    </div>\n  </div>\n\n  <div class="spacer1" ng-show="isLoading" />\n\n  <div class="row" collapse="!onSuccess">\n    <div class="col-md-12 text-center">\n      <h3 class="thanks-message">{{userName | titleize}}, thanks a lot for helping us improve Impac!&trade;</h3>\n    </div>\n  </div>\n\n  <div class="row" ng-show="error">\n    <div class="col-md-12 text-center">\n      <h5 style="color: red;">\n        Unable to send suggestions request, please try again or contact technical support.\n      </h5>\n    </div>\n  </div>\n\n</div>\n\n<div class="modal-footer">\n  <div class="row">\n    <div class="col-sm-12">\n      <button class="btn btn-shaded" ng-click="instance.dismiss()" ng-hide="isLoading">Cancel</button>\n      <button class="btn btn-info" ng-click="proceed()" ng-disabled="!(widgetDetails.name && widgetDetails.category && widgetDetails.description) || isLoading">\n        <i class="fa fa-spinner fa-pulse loader" ng-show="isLoading"></i>\n        Send your suggestion\n      </button>\n    </div>\n  </div>\n</div>\n'),t.put("dashboard-selector/bootstrap-tabs.tmpl.html",'<div class="row buttons-bar-row">\n  <div class="buttons-bar col-sm-8" ng-show="isThereADashboard()">\n    <tabset type="{{selectorType}}">\n      <tab ng-repeat="dhb in dashboardsList" ng-click="selectDashboard(dhb.id)" active="dhb.active">\n        <tab-heading>\n          {{dhb.full_name}}\n          <a href="" class="close-link" ng-if="isDeleteDhbEnabled">\n            <i class="fa fa-times" ng-click="deleteDashboardModal.open()"></i>\n          </a>\n        </tab-heading>\n      </tab>\n      <tab ng-if=\'isAccessibilityEnabled\' ng-click="toggleAccessibilityMode()">\n        <tab-heading>\n          <a href=""><i class="fa fa-wheelchair"></i></a>\n        </tab-heading>\n      </tab>\n      <tab ng-if="isAddDhbEnabled" ng-click="onCreateDashboard()">\n        <tab-heading>\n          <a href="">+</a>\n        </tab-heading>\n      </tab>\n    </tabset>\n  </div>\n  <div class=\'buttons-bar col-sm-4\'>\n    <div class=\'actions-panel\'>\n      <button ng-if=\'isAccessibilityEnabled\' ng-click="toggleAccessibilityMode()" class=\'btn btn-info\' ng-disabled="isWidgetSelectorShown()"><span class=\'fa fa-wheelchair\'></span></button>\n      <button ng-if="isAddWidgetEnabled && isThereADashboard()" ng-click="onDisplayWidgetSelector()" class=\'btn btn-warning\' ng-disabled="isWidgetSelectorShown()"><span class=\'fa fa-plus\'></span> Add Widget</button>\n      <!-- <button id=\'data-upload-wizard\' ng-click=\'openStarWizard()\' class=\'btn btn-success hidden-xs\' ><span class=\'fa fa-upload\'></span> Data Upload</button> -->\n    </div>\n  </div>\n</div>\n'),t.put("dashboard-selector/delete.modal.html",'<div class="modal-header">\n  <div class="close" type="button" ng-click="instance.close()" >×</div>\n  <h3>Delete Dashboard</h3>\n</div>\n\n<div class="modal-body">\n  <div class="row">\n    <div class="col-sm-12">\n      <div class="alert alert-error" ng-show="errors">\n        <button class="close" ng-click="errors=\'\'">×</button>\n        <ul>\n          <li ng-repeat="error in errors">{{error}}</li>\n        </ul>\n      </div>\n    </div>\n  </div>\n\n  <!-- Create a new widget -->\n  <p>Are you sure you want to delete this analytics dashboard?</p>\n\n</div>\n\n<div class="modal-footer">\n  <div class="row">\n    <div class="col-sm-12">\n      <button class="btn btn-shaded" ng-click="instance.dismiss()" ng-hide="isLoading" ng-disabled="isLoading">Cancel</button>\n      <button class="btn btn-danger" ng-click="proceed()" ng-disabled="isLoading">\n        <i class="fa fa-spinner fa-pulse loader" ng-if="isLoading"></i>\n        Delete\n      </button>\n    </div>\n  </div>\n</div>\n'),t.put("dashboard-selector/dropdown.tmpl.html",'<div class="row buttons-bar-row buttons-bar">\n\n  <div class="col-md-6 dropdown-container" ng-hide="isLoading">\n    <div ng-if="isThereADashboard()">\n      <h4 class=\'dashboard-title\'>\n        <div style="display: inline-block;" ng-click="toggleShowDashboardsDropdown()">\n          {{currentDhb.full_name}}\n          <i class="fa fa-chevron-down" style="font-size: 18px;"></i>\n        </div>\n        <i ng-hide="showChangeDashboardNameBox" class="fa fa-pencil" tooltip="Change name" tooltip-animation="false" tooltip-append-to-body="true" ng-click="toggleChangeDashboardNameBox(currentDhb)"></i>\n      </h4>\n\n      <div ng-show="showDashboardsDropdown" class=\'dashboard-select\'>\n        <div ng-hide="dhb.id == currentDhb.id" class=\'option\' ng-repeat="dhb in dashboardsList">\n          <span class="name" ng-click="selectDashboard(dhb.id)">{{dhb.full_name}}</span>\n          <i ng-hide="showChangeDashboardNameBox" class="fa fa-pencil" tooltip="Change name" tooltip-animation="false" tooltip-append-to-body="true" ng-click="toggleChangeDashboardNameBox(dhb)"/>\n        </div>\n\n        <div ng-show="showCreateDashboardButton" class="option create" ng-click="onCreateDashboard()"><i class="fa fa-plus" /> Create Dashboard</div>\n      </div>\n\n      <div ng-if="showChangeDashboardNameBox" class="change-name">\n        <p>Change dashboard name:</p>\n        <input type="text" class="form-control" id="changeDhbNameInput" ng-model="dashboardToChange.name" ng-keyup="checkAndUpdateDashboardName($event)"/>\n        <button class="btn btn-sm btn-default" ng-click="hideChangeDashboardNameBox()">Cancel</button>\n        <button class="btn btn-sm btn-success" style="margin-left: 10px" ng-click="updateDashboardName()">Confirm</button>\n      </div>\n\n      <p class="data-source-label">\n        <small><b>Source:</b> {{organizationsNames()}}</small>\n      </p>\n    </div>\n  </div>\n\n  <div class="col-md-6 loader-container" ng-show="isLoading">\n    <i class="fa fa-spinner fa-pulse fa-4x loading-spinner"/>\n  </div>\n\n  <div class=\'col-md-6 actions-panel\'>\n\n    <button ng-if=\'isAccessibilityEnabled\' ng-click="toggleAccessibilityMode()" class=\'btn btn-info\' ng-disabled="showWidgetSelector"><span class=\'fa fa-wheelchair\'></span></button>\n\n    <button ng-if="isAddWidgetEnabled && isThereADashboard()" ng-click="onDisplayWidgetSelector()" class=\'btn btn-warning\' ng-disabled="isWidgetSelectorShown()"><span class=\'fa fa-plus\'></span> Add Widget</button>\n\n    <button ng-if="isAddDhbEnabled" ng-click="onCreateDashboard()" class=\'btn btn-warning\' ng-show="showCreateDashboardButton"><span class=\'fa fa-pencil-square-o\'></span> Create Dashboard</button>\n\n    <!-- <button id=\'data-upload-wizard\' ng-click=\'dhbCtrl.openStarWizard()\' class=\'btn btn-success hidden-xs\' ><span class=\'fa fa-upload\'></span> Data Upload</button> -->\n\n    <button ng-if="isDeleteDhbEnabled" ng-click="deleteDashboardModal.open()" class=\'btn btn-danger hidden-xs\' ng-show="isThereADashboard()" tooltip="Delete Dashboard"><span class=\'fa fa-trash-o\'></span> </button>\n\n  </div>\n\n</div>\n'),t.put("kpi/kpi.tmpl.html",'<div class="tile kpi" ng-class="{ \'static\': kpi.static }">\n\n  <div class="kpi-show" ng-hide="showEditSettings">\n    <small class="kpi-title" ng-if="::kpi.static">{{::kpi.name}}</small>\n    <small class="kpi-title" ng-if="::!kpi.static" editable-text="kpi.name" buttons="yes" onaftersave="updateName()">{{kpi.name}}</small>\n    <div class="kpi-watch" ng-if="::!kpi.static">({{::kpi.element_watched}})</div>\n    <span class="kpi-value">{{kpi.data.value | mnoCurrency : kpi.data.unit}}</span>\n\n    <!-- TODO: refactor design to handle multiple targets and ranges -->\n    <div class="kpi-alert" ng-repeat="target in kpi.targets track by $index" ng-hide="editMode || kpi.data.results[$index]">\n      <span ng-show="target.max">over {{target.max | mnoCurrency : kpi.data.unit}}</span>\n      <span ng-show="target.min">below {{target.min | mnoCurrency : kpi.data.unit}}</span>\n    </div>\n\n    <div class="kpi-alert" ng-show="editMode" ng-click="displayEditSettings()">Edit</div>\n    <div class="kpi-alert kpi-close" ng-show="editMode" ng-click="deleteKpi()">x</div>\n  </div>\n\n  <div class="kpi-edit" ng-show="showEditSettings">\n    <span class="param-name">KPI target:</span>\n\n    <!-- TODO: refactor design to handle multiple targets and ranges -->\n    <div class="clearfix edit-limit align">\n      <select class="pull-left select-limit-mode form-control input-sm" ng-model="kpi.limit.mode" ng-options="option.mode as option.label for option in possibleTargets" >\n      </select>\n\n      <div class="pull-right input-limit-value form-group has-feedback">\n        <input type="text" class="form-control input-sm" ng-model="kpi.limit.value">\n        <span class="form-control-feedback" aria-hidden="true">{{kpi.data.unit}}</span>\n      </div>\n    </div>\n\n    <div class="extra-params" ng-repeat="(param, paramValues) in kpi.possibleExtraParams track by $index">\n      <span class="param-name">Select {{param | titleize}}:</span>\n      <select class="form-control input-sm" ng-model="kpi.extra_params[param]" ng-options="value.id as value.label for value in paramValues">\n      </select>\n    </div>\n\n    <button class="btn btn-xs btn-default" ng-click="hideEditSettings()">Cancel</button>\n    <button class="btn btn-xs btn-success" ng-click="updateSettings()">Save</button>\n  </div>\n\n</div>\n'),t.put("kpis-bar/kpis-bar.tmpl.html",'<div class="row kpis">\n  <div class="title-actions col-xs-4 col-sm-2">\n    <div ng-click="toggleAvailableKpis()"><a href=""><i class="fa fa-plus"></i> Attach KPI</a></div>\n\n    <div class="available-kpis-container" collapse="hideAvailableKpis">\n      <div ng-repeat="kpi in availableKpis" class="available-kpi" ng-init="kpi.element_watched = kpi.watchables[0]">\n        <span class="kpi-name">{{formatKpiName(kpi.endpoint)}}</span>\n        <button class="btn btn-sm btn-info" ng-click="addKpi(kpi)">+ Attach</button>\n        <select class="form-control-static input-sm" ng-model="kpi.element_watched" ng-options="watchable for watchable in kpi.watchables"></select>\n      </div>\n    </div>\n\n    <div ng-click="toggleEditMode()"><a href=""><i class="fa fa-cog"></i> Edit KPI Settings</a></div>\n  </div>\n\n  <impac-kpi class="col-xs-4 col-sm-2" kpi="kpi" on-delete="removeKpi(kpi.id)" edit-mode="showEditMode" available-kpis="availableKpis" ng-repeat="kpi in kpis track by $index"></impac-kpi>\n\n  <div ng-show="isAddingKPI" class="col-xs-2 kpi-loader">\n    <i class="fa fa-2x fa-spin fa-refresh"></i>\n  </div>\n</div>\n'),t.put("widget/widget.tmpl.html",'<div class="top-line">\n  <div common-top-buttons parent-widget="widget" on-refresh="showWidget" />\n  <div common-editable-title parent-widget="widget" />\n</div>\n\n<div class="content" ng-class="templateName">\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    <div>\n      <i class="fa fa-spinner fa-pulse fa-3x"></i>\n      <p>Your data is being retrieved...</p>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isLoading" ng-include="widgetContentTemplate()" />\n</div>\n'),t.put("dashboard-settings/currency.tmpl.html",'<div class="dashboard-settings currency">\n  <select ng-options="cur for cur in currencies" ng-model="currency" ng-change="massAssignCurrency()" ng-disabled="locked">\n    <option ng-if="!currency" value="" disabled>Choose currency...</option>\n  </select>\n</div>\n'),t.put("dashboard-settings/sync-apps.tmpl.html",'<!-- Will be displayed only if specified in configuration and if first response has been processed (lastConnector not null) -->\n<div class="dashboard-settings sync-apps" ng-show="lastConnector">\n\n  <span ng-show="isSyncing">Syncing...</span>\n  <span ng-if="otherConnectors.length == 0" ng-hide="isSyncing">\n    {{ formatStatus(lastConnector) }}\n  </span>\n  <span ng-if="otherConnectors.length > 0" ng-hide="isSyncing" popover-template="\'connectors.tmpl.html\'" popover-trigger="mouseenter" popover-placement="bottom">\n    {{ formatStatus(lastConnector) }}\n  </span>\n\n  <button id="sync" class="btn btn-primary" ng-click="synchronize()" tooltip="Sync data and refresh dashboard" ng-disabled="isSyncing">\n    <i class="fa fa-refresh" ng-class="{ \'fa-spin\': isSyncing }"></i>\n  </button>\n\n</div>\n\n<!-- ui.bootstrap popover template -->\n<script type="text/ng-template" id="connectors.tmpl.html">\n  <div ng-repeat="connector in otherConnectors track by $index">\n    <span>{{ formatStatus(connector) }}</span>\n  </div>\n  <div style="border-bottom: 1px solid #ccc; width: 100%; height: 2px; margin: 5px 0;"></div>\n  <p>All other applications are synced in real-time.</p>\n</script>\n\n<!-- ui.bootstrap modal template -->\n<script type="text/ng-template" id="alerts.tmpl.html">\n  <div class="modal-header">\n    <h4 class="modal-title">Synchronization alerts</h4>\n  </div>\n  <div class="modal-body">\n    <div ng-repeat="connector in failedConnectors track by $index">\n      {{connector.name}} - Synchronization failed. Please retry later.\n    </div>\n    <div ng-repeat="connector in disconnectedConnectors track by $index">\n      {{connector.name}} is disconnected. Please reconnect to synchronize.\n    </div>\n  </div>\n  <div class="modal-footer">\n    <button class="btn btn-primary" type="button" ng-click="ok()">OK</button>\n  </div>\n</script>\n'),t.put("widgets-common/data-not-found.tmpl.html",'<div class="data-not-found">\n  <img id="not-found-bg" />\n  <div class="message">\n    {{content.mainMessage}}\n\n    <a ng-show="showAlertsTrigger" ng-click="onDisplayAlerts()">\n      <i class="fa fa-warning" /> Find out why\n    </a>\n    <a ng-if="hasCallbackUrl" ng-hide="showAlertsTrigger" ng-click="content.linkUrlCallback()">\n      {{content.linkMessage}}\n    </a>\n    <a ng-if="!hasCallbackUrl" ng-hide="showAlertsTrigger" ng-href="{{content.linkUrl}}" target="{{content.linkTarget}}">\n      {{content.linkMessage}}\n    </a>\n\n  </div>\n</div>\n'),t.put("widgets-common/editable-title.tmpl.html",'<div class="visible-lg title-wrapper" ng-if="parentWidget.width >= 3 && parentWidget.width < 6">\n  <div ng-show="parentWidget.hasEditAbility" class="title" editable-text="parentWidget.name" onaftersave="updateName()">\n  	{{parentWidget.name | truncate:19:"."}}\n  </div>\n\n  <div ng-hide="parentWidget.hasEditAbility" class="title">\n  	{{parentWidget.name | truncate:19:"."}}\n  </div>\n</div>\n\n<div class="visible-lg title-wrapper" ng-if="parentWidget.width >= 6">\n  <div ng-show="parentWidget.hasEditAbility" class="title" editable-text="parentWidget.name" onaftersave="updateName()">\n  	{{parentWidget.name | truncate:80:"."}}\n  </div>\n\n  <div ng-hide="parentWidget.hasEditAbility" class="title">\n  	{{parentWidget.name | truncate:80:"."}}\n  </div>\n</div>\n\n<div class="visible-md visible-sm title-wrapper" ng-if="parentWidget.width == 3 && parentWidget.width < 6">\n  <div ng-show="parentWidget.hasEditAbility" class="title" editable-text="parentWidget.name" onaftersave="updateName()">\n  	{{parentWidget.name | truncate:13:"."}}\n  </div>\n\n  <div ng-hide="parentWidget.hasEditAbility" class="title">\n  	{{parentWidget.name | truncate:13:"."}}\n  </div>\n</div>\n\n<div class="visible-md visible-sm title-wrapper" ng-if="parentWidget.width >= 6">\n  <div ng-show="parentWidget.hasEditAbility" class="title" editable-text="parentWidget.name" onaftersave="updateName()">\n  	{{parentWidget.name | truncate:60:"."}}\n  </div>\n\n  <div ng-hide="parentWidget.hasEditAbility" class="title">\n  	{{parentWidget.name | truncate:60:"."}}\n  </div>\n</div>\n\n<div class="visible-xs title-wrapper">\n  <!-- Title edition no designed for mobile -->\n  <div class="title">\n  	{{parentWidget.name | truncate:25:"."}}\n  </div>\n</div>\n'),t.put("widgets-common/top-buttons.tmpl.html",'<div id="module__top-buttons">\n\n  <div class="top-buttons-wrapper">\n    <button class="btn top-button btn-refresh" ng-click="onRefresh({refreshCache: true})">\n      <i class="fa fa-refresh"></i>\n      <span class="text-hide">Refresh widget</span>\n    </button>\n\n    <button class="btn top-button btn-edit" ng-click="toggleEditMode()" ng-show="parentWidget.hasEditAbility" ng-class="{\'edit-mode\': parentWidget.isEditMode}">\n      <i class="fa fa-cog fa-lg"></i>\n      <span class="text-hide">Edit widget</span>\n    </button>\n\n    <button class="btn top-button btn-close" ng-click="showConfirmDelete = !showConfirmDelete" ng-show="parentWidget.hasDeleteAbility">\n      <i class="fa fa-times-circle-o fa-lg"></i>\n      <span class="text-hide">Delete widget</span>\n    </button>\n  </div>\n\n  <div class="confirm-delete-popover" ng-show="showConfirmDelete">\n    <h4>Are you sure you want to delete this widget ?</h4>\n    <p>(it will not erase your data)</p>\n    <div ng-hide="isDeletePopoverLoading">\n      <button ng-click="showConfirmDelete = false" class="btn btn-sm btn-default">Cancel</button>\n      <button ng-click="deleteWidget()" class="btn btn-sm btn-danger" style="margin-left: 10px;">Delete</button>\n    </div>\n    <div ng-show="isDeletePopoverLoading" class="loader" align="center">\n      <div>\n        <i class="fa fa-spinner fa-pulse fa-4x"></i>\n      </div>\n    </div>\n  </div>\n</div>\n'),t.put("widgets/accounts-accounting-values.tmpl.html",'<div widget-accounts-accounting-values>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-range parent-widget="widget" class="part" deferred="::timeRangeDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div ng-show="(isDataFound==true)">\n      <div setting-hist-mode parent-widget="widget" deferred="::histModeDeferred" />\n\n      <div ng-hide="widget.isHistoryMode" class="current">\n        <div class="price">\n           {{ getCurrentPrice() | mnoCurrency : getCurrency() : false }}\n        </div>\n        <div class="currency">{{getCurrency()}}</div>\n        <div class="legend">{{getLegend()}}</div>\n      </div>\n\n      <div class="history chart-container" ng-class="{\'invisible\': !widget.isHistoryMode}">\n        <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n        <div class="legend">{{getLegend()}}</div>\n      </div>\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found on-display-alerts="onDisplayAlerts()" widget-engine="::widget.category" />\n  </div>\n  \n</div>'),t.put("widgets/accounts-assets-liability-summary.tmpl.html",'<div widget-accounts-assets-liability-summary>\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div ng-show="(isDataFound==true)" class="chart-container">\n      <!-- account classification selectors -->\n      <div setting-param-selector parent-widget="widget" param="classification" options="accountsOptions" selected="selectedAccountsOption" class="row param-selector" deferred="::paramSelectorDeferred"/>\n      <!---->\n      <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n      <div class="legend">\n        <div class="title" ng-show="widget.metadata.organization_ids.length==1">{{widget.content.summary[0].company}} {{classification}}</div>\n        <div class="title" ng-hide="widget.metadata.organization_ids.length==1">{{classification}} repartition</div>\n        <span ng-repeat="valuePair in dataSource">\n          <span style="font-weight: bold; color: {{getAccountColor(valuePair)}};">{{valuePair.label}}</span>: {{valuePair.total | mnoCurrency : getCurrency()}}\n          <br />\n        </span>\n      </div>\n    </div>\n    <div ng-show="(isDataFound==false)" common-data-not-found on-display-alerts="onDisplayAlerts()" widget-engine="::widget.category" />\n  </div>\n</div>\n'),t.put("widgets/accounts-assets-summary.tmpl.html",'<div widget-accounts-assets-summary>\n      \n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div ng-show="(isDataFound==true)" class="chart-container">\n      <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n      <div class="legend">\n        <div class="title" ng-show="widget.metadata.organization_ids.length==1">{{widget.content.summary[0].company}} {{classification}}</div>\n        <div class="title" ng-hide="widget.metadata.organization_ids.length==1">{{classification}} repartition</div>\n        <span ng-repeat="valuePair in dataSource">\n          <span style="font-weight: bold; color: {{getAccountColor(valuePair)}};">{{valuePair.label}}</span>: {{valuePair.total | mnoCurrency : getCurrency()}}\n          <br />\n        </span>\n      </div>\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found on-display-alerts="onDisplayAlerts()" widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/accounts-assets-vs-liabilities.tmpl.html",'<div widget-accounts-assets-vs-liabilities>\n      \n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div ng-show="(isDataFound==true)" class="chart-container">\n      <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n      <div class="legend" style="max-height: 115px;">\n        <div class="title">\n          <i class="fa fa-circle" style="color: {{assetsColor}};"> Assets</i> | \n          <i class="fa fa-circle" style="color: {{liabilitiesColor}};"> Liabilities</i>\n        </div>\n        <div class="row">\n          <div ng-repeat="data in companiesList" ng-class="{\'col-md-6\': (widget.content.companies.length > 1), \'col-md-12\': (widget.content.companies.length == 1)}">\n            <span>{{ data.company }}</span><br />\n            <span style="color: {{assetsColor}};"> {{ data.assets | mnoCurrency : data.currency }}</span> <br/>\n            <span style="color: {{liabilitiesColor}};"> {{ data.liabilities | mnoCurrency : data.currency }}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found on-display-alerts="onDisplayAlerts()" widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/accounts-balance.tmpl.html",'<div widget-accounts-balance>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-account parent-widget="widget" class="part" deferred="::accountBackDeferred" />\n    <div setting-time-range parent-widget="widget" class="part" deferred="::timeRangeDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div ng-show="(isDataFound==true)">\n      <!-- Will be hidden once an account is selected -->\n      <div setting-account ng-hide="widget.selectedAccount" parent-widget="widget" label=\'Select an account to monitor\' on-account-selected="displayAccount()" deferred="::accountFrontDeferred" />\n\n      <!-- All the below divs will remain hidden until an account is selected -->\n      <div ng-show="widget.selectedAccount">\n        <div setting-hist-mode parent-widget="widget" deferred="::histModeDeferred" />\n\n        <div ng-hide="widget.isHistoryMode">\n          <h3>{{getName()}}</h3>\n          <div class="price">\n             {{ getCurrentBalance() | mnoCurrency : getCurrency() : false }}\n          </div>\n          <div class="currency">{{getCurrency()}}</div>\n        </div>\n\n        <div class="chart-container" ng-class="{\'invisible\': !widget.isHistoryMode}">\n          <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n          <div class="legend">{{getName()}}</div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found on-display-alerts="onDisplayAlerts()" widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/accounts-balance-sheet.tmpl.html",'<div widget-accounts-balance-sheet>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div class="no-data-block" ng-show="(isDataFound==false)">\n      No balance sheet can be generated between this {{period.label.toLowerCase()}} and the previous {{period.label.toLowerCase()}}. <br />\n      Maybe try selecting a longer period? <br />\n      <span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period" deferred="::paramSelectorFrontDeferred" />\n    </div>\n\n    <div ng-show="(isDataFound==true)" class="widget-lines-container">\n      <div class="row widget-line header">\n        <div class="col-sm-6 text-left">Compare with previous: <span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period" deferred="::paramSelectorBackDeferred" /></div>\n        <div class="col-sm-3 text-right">{{widget.content.dates[0] | mnoDate : widget.metadata.period}}</div>\n        <div class="col-sm-3 text-right">{{widget.content.dates[1] | mnoDate : widget.metadata.period}}</div>\n      </div>\n     \n      <div class="row widget-line total" ng-repeat="category in categories" >\n        <div class="row widget-line" >\n          <div class="col-sm-1" ng-click="toggleCollapsed(category)" style="cursor: pointer;">\n            <i class="fa" ng-class="isCollapsed(category) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" />\n          </div>\n          <div class="col-sm-5 text-left"><strong>{{category | titleize}}</strong></div>\n          <div class="col-sm-3 text-right"><strong>{{widget.content.summary[category].totals[0] | mnoCurrency : widget.content.summary[category].currency}}</strong></div>\n          <div class="col-sm-3 text-right"><strong>{{widget.content.summary[category].totals[1] | mnoCurrency : widget.content.summary[category].currency}}</strong></div>\n        </div>\n        \n        <div collapse="isCollapsed(category)">\n          <div class="row widget-line" ng-repeat="account in widget.content.summary[category].accounts" >\n            <div class="col-sm-1" />\n            <div class="col-sm-5 text-left">{{account.name | titleize}}</div>\n            <div class="col-sm-3 text-right">{{account.totals[0] | mnoCurrency : account.currency}}</div>\n            <div class="col-sm-3 text-right">{{account.totals[1] | mnoCurrency : account.currency}}</div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n  </div>\n\n</div>'),t.put("widgets/accounts-cash-summary.tmpl.html",'<div widget-accounts-cash-summary>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-range parent-widget="widget" class="part" deferred="::timeRangeDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)" class="row" >\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" deferred="::widthDeferred" />\n\n        <div class="widget-lines-container">\n          <div class="row widget-line header">\n            <div class="col-sm-6">Cash flow</div>\n            <div class="col-sm-3 text-right">{{getLastDate() | mnoDate : widget.metadata.hist_parameters.period}}</div>\n            <div class="col-sm-3 text-right">vs {{getPrevDate() | mnoDate : widget.metadata.hist_parameters.period}}</div>\n          </div>\n          <div class="row widget-line total" ng-repeat="statement in widget.content.summary" ng-class="{cash: statement.name.indexOf(\'cash\')>0}" >\n            <div class="row widget-line" ng-class="isSelected(statement) ? \'selected\' : null" >\n              <div class="col-sm-1" ng-click="toggleCollapsed(statement)"><i class="fa" ng-class="isCollapsed(statement) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" ng-show="(statement.accounts && statement.accounts.length)"/></div>\n              <div class="col-sm-5" ng-click="toggleSelectedElement(statement)"><strong>{{getName(statement) | titleize}}</strong></div>\n              <div class="col-sm-3 text-right" ng-click="toggleSelectedElement(statement)"><strong>{{getLastValue(statement) | mnoCurrency : statement.currency : false}}</strong></div>\n              <div class="col-sm-3 text-right" ng-click="toggleSelectedElement(statement)" ng-class="getVarianceClassColor(getLastVariance(statement))"><strong>{{getLastVariance(statement)}}</strong></div>\n            </div>\n            <div collapse="isCollapsed(statement)">\n              <div class="row widget-line" ng-click="toggleSelectedElement(account)" ng-repeat="account in statement.accounts" ng-class="isSelected(account) ? \'selected\' : null" >\n                <div class="col-sm-1" />\n                <div class="col-sm-5">{{account.name}}</div>\n                <div class="col-sm-3 text-right">{{getLastValue(account) | mnoCurrency : account.currency : false }}</div>\n                <div class="col-sm-3 text-right" ng-class="getVarianceClassColor(getLastVariance(account))">{{getLastVariance(account)}}</div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="right-panel text-center" ng-class="{\'col-md-6\': widget.isExpanded(), \'col-md-12 invisible\': !widget.isExpanded()}">\n\n        <div ng-show="selectedElement">\n          <h4>{{getName(selectedElement) | titleize}}</h4>\n\n          <div class="chart-container">\n            <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n            <div class="legend">{{(widget.metadata.hist_parameters.period || "Monthly") | titleize}} Cash Flow</div>\n          </div>\n\n          <div class="widget-lines-container">\n            <div class="row widget-line">\n              <span class="text-center" ng-repeat="date in dates track by $index">\n                <div ng-if="$index % 6 == 0 && $index > 0" class="clearfix dashed hidden-xs"></div>\n\n                <div class="col-sm-2" style="padding: 5px 0px;">\n                  <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;">{{date | mnoDate : widget.metadata.hist_parameters.period}}</div></div>\n                  <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;">{{selectedElement.cash_flows[$index] | mnoCurrency : selectedElement.currency }}</div></div>\n                  <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;" ng-class="getVarianceClassColor(selectedElement.variances[$index])">{{formatVariance(selectedElement.variances[$index])}}</div></div>\n                </div>\n              </span>\n            </div>\n          </div>\n        </div>\n\n        <div ng-hide="selectedElement" class="no-element">\n          Select an account or an account type to display the corresponding cash evolution.\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found on-display-alerts="onDisplayAlerts()" widget-engine="::widget.category" />\n  </div>\n\n</div>\n'),t.put("widgets/accounts-class-comparison.tmpl.html",'<div widget-accounts-class-comparison>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div ng-show="(isDataFound==true)">\n      <!-- account classification selectors -->\n      <div setting-param-selector parent-widget="widget" param="classification" options="classifications" selected="selectedClassification" class="row param-selector" deferred="::paramSelectorDeferred" on-select="widget.format()" no-reload/>\n      <!---->\n      <div class="row">\n        <div class="col-md-12 chart-container">\n          <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n        </div>\n      </div>\n      <div class="row">\n        <div class="col-md-12 widget-lines-container">\n          <div ng-repeat="entity in widget.content.companies track by $index">\n            <i style="float: right; margin-right: 10px;">\n              {{getAmount($index)}}\n            </i>\n            <i class="fa fa-circle" style="margin: 0px 8px; color: {{getAccountColor(entity)}}" />\n            {{entity}}\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    <div ng-show="(isDataFound==false)" common-data-not-found on-display-alerts="onDisplayAlerts()" widget-engine="::widget.category" />\n  </div>\n\n</div>\n'),t.put("widgets/accounts-comparison.tmpl.html",'<div widget-accounts-comparison>\n  <div setting-accounts-list parent-widget="widget" deferred="::accountsListDeferred"/>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)">\n      <!-- multi-companies mode -->\n      <div ng-show="widget.metadata.organization_ids.length > 1 && canSelectComparisonMode || isComparisonMode()">\n        <div setting-params-checkboxes options="comparisonModeOptions" param="comparison_mode" parent-widget="widget" deferred="::paramsCheckboxesDeferred"/>\n      </div>\n      <!-- end -->\n      <div ng-hide="hasAccountsSelected() || noComparableAccounts" class="row">\n        <h5>Select the accounts you wish to compare.</h5>\n        <div class="col-md-6">\n          <div class="input-group">\n            <select ng-model="movedAccount" ng-options="account.name + \' (\' + formatAmount(account) + \')\' for account in widget.remainingAccounts" class="form-control" ng-show="widget.hasEditAbility" ng-change="addAccount(movedAccount)"></select>\n          </div>\n        </div>\n      </div>\n      <!-- error: when there are no comparable accounts matched -->\n      <div ng-show="isComparisonMode() && noComparableAccounts" class="row comparable-error">\n        <h5>No comparable accounts found.</h5>\n      </div>\n\n      <div ng-show="hasAccountsSelected()">\n        <div class="row">\n          <div class="col-md-12 chart-container">\n            <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n          </div>\n        </div>\n\n        <div class="row">\n          <div class="col-md-12">\n            <div class="widget-lines-container">\n              <div class="widget-line" ng-repeat="account in widget.selectedAccounts track by $index">\n                <div ng-if="isComparisonMode()" ng-repeat="groupedAccount in account.accounts track by $index">\n                  <button class="close" ng-click="removeAccount(account)" ng-show="widget.hasDeleteAbility">\n                    x\n                  </button>\n                  <i style="float: right; margin-right: 10px;">{{formatAmount(groupedAccount)}}</i>\n                  <i class="fa fa-circle" style="margin: 0px 8px; color: {{getAccountColor(groupedAccount)}}" />\n                  {{groupedAccount.name}}\n                </div>\n                <div ng-if="!isComparisonMode()">\n                  <button class="close" ng-click="removeAccount(account)" ng-show="widget.hasDeleteAbility">\n                    x\n                  </button>\n                  <i style="float: right; margin-right: 10px;">{{formatAmount(account)}}</i>\n                  <i class="fa fa-circle" style="margin: 0px 8px; color: {{getAccountColor(account)}}" />\n                  {{account.name}}\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class="row">\n          <div class="add-account">\n            <div class="input-group">\n              <select ng-model="movedAccount" ng-options="account.name + \' (\' + formatAmount(account) + \')\' for account in widget.remainingAccounts track by account.uid" class="form-control" ng-show="widget.hasDeleteAbility" ng-change="addAccount(movedAccount)" ng-disabled="widget.selectedAccounts.length >= 15 || widget.remainingAccounts.length == 0 || isComparisonMode()">\n                <option value="" disabled selected>+ ADD ACCOUNT</option>\n              </select>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found on-display-alerts="onDisplayAlerts()" widget-engine="::widget.category" />\n  </div>\n\n</div>\n'),t.put("widgets/accounts-custom-calculation.tmpl.html",'<div widget-accounts-custom-calculation>\n\n  <div setting-organizations parent-widget="widget" ng-hide="true" deferred="::orgDeferred" />\n  <div setting-accounts-list parent-widget="widget" deferred="::accountsListDeferred" />\n  <div setting-formula parent-widget="widget" deferred="::formulaDeferred" />\n\n  <h3 ng-show="widget.hasEditAbility && !widget.isFormulaCorrect">\n    <a href="" ng-click="formulaModal.open()">Create a custom calculation</a>\n  </h3>\n  \n  <div class="price" ng-show="widget.isFormulaCorrect">\n    {{widget.evaluatedFormula}}\n  </div>\n  <div class="legend" ng-show="widget.isFormulaCorrect">\n    {{widget.legend}}\n  </div>\n\n</div>'),t.put("widgets/accounts-custom-calculation/formula.modal.html",'<div class="analytics modal-custom-calculation">\n  <div class="modal-header">\n    <div class="close" type="button" ng-click="cancel()" >×</div>\n    <h3>Custom Calculation</h3>\n  </div>\n\n  <div class="modal-body">\n    <div class="row">\n      <div class="col-sm-12">\n        <div class="alert alert-error" ng-show="errors">\n          <button class="close" ng-click="errors=\'\'">×</button>\n          <ul>\n            <li ng-repeat="error in errors">{{error}}</li>\n          </ul>\n        </div>\n      </div>\n    </div>\n\n    <div class="edit">\n      <div setting-organizations parent-widget="widget" class="part" deferred="::modalOrgDeferred" />\n    </div>\n\n    <p>Make a custom equation with your accounts, and save it as a widget. To create an equation, simply select your accounts in the list, and use the classical operators (example: ({1} + {2}) / {3})</p>\n\n    <div class=\'row\'>\n      <div ng-show="widget.isLoading" class=\'col-md-6 loader\' align="center">\n        <div>\n          <i class="fa fa-spinner fa-pulse fa-3x"></i>\n          <p>Your data is being retrieved...</p>\n        </div>\n      </div>\n\n      <div ng-hide="widget.isLoading" class=\'col-md-6\'>\n        <div class=\'widget-line\' ng-repeat=\'account in widget.selectedAccounts track by $index\'>\n          <div class=\'row\'>\n            <div class=\'col-md-6\'>\n              {{$index+1}} - {{account.name}}\n            </div>\n            <div class=\'col-md-6\'>\n              {{account.current_balance | mnoCurrency : account.currency}}\n              <button class="close" ng-click="removeAccountFromFormula(account)" ng-show="widget.hasEditAbility"><span class=\'fa fa-times-circle\'></span></button>\n            </div>\n          </div>\n        </div>\n\n        <div class=\'input-group\' ng-show="widget.hasEditAbility">\n          <select ng-model="movedAccount" ng-options="account.name + \' (\' + widget.formatAmount(account) + \')\' for account in widget.remainingAccounts" class=\'form-control\' ng-change=\'addAccountToFormula(movedAccount)\'><select>\n        </div>\n      </div>\n      \n      <div ng-hide="widget.isLoading" class=\'col-md-6\'>\n        <p>Type your formula just below:</p>\n        <input class=\'form-control\' ng-model="widget.formula">\n\n        <p>Result: {{widget.evaluatedFormula}}</p>\n        <p>Legend: {{widget.legend}}</p>\n      </div>\n    </div>\n  </div>\n\n  <div class="modal-footer">\n    <div class="row">\n      <div class="col-sm-12">\n        <button class="btn btn-gray" ng-click="cancel()" ng-hide="widget.isLoading" ng-disabled="isLoading">Cancel</button>\n        <button class="btn btn-warning" ng-click="proceed()" ng-hide="widget.isLoading" ng-disabled=\'!widget.isFormulaCorrect || widget.isLoading\'>\n          <i class="fa fa-spinner fa-pulse loader" ng-show="isLoading"></i>\n          Save\n        </button>\n      </div>\n      \n    </div>\n  </div>\n</div>\n'),t.put("widgets/accounts-detailed-classifications.tmpl.html",'<div widget-accounts-detailed-classifications>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div ng-show="(isDataFound==true)" class="widget-lines-container">\n\n      <div ng-hide="multiEntity" class="row widget-line header">{{widget.content.companies[0].name}} - Accounts classifications</div>\n\n      <div class="row widget-line total" ng-repeat="source in dataSource track by source.label">\n        <div class="row widget-line">\n          <div class="col-sm-1" ng-click="toggleCollapsed(source.label)" style="cursor: pointer;">\n            <i class="fa" ng-class="isCollapsed(source.label) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" />\n          </div>\n          <div class="col-sm-5 text-left"><strong>{{source.label | titleize}}</strong></div>\n          <div class="col-sm-6 text-right"><strong>{{source.value | mnoCurrency : source.currency}}</strong></div>\n        </div>\n\n        <div collapse="isCollapsed(source.label)">\n          <div class="row widget-line" ng-repeat="entry in source.entries" >\n            <div class="col-sm-1" />\n            <div class="col-sm-5 text-left">{{entry.label | titleize}}</div>\n            <div class="col-sm-6 text-right">{{entry.value | mnoCurrency : entry.currency}}</div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found on-display-alerts="onDisplayAlerts()" widget-engine="::widget.category" />\n  </div>\n</div>\n\n'),t.put("widgets/accounts-expense-weight.tmpl.html",'<div widget-accounts-expense-weight>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-account parent-widget="widget" class="part" deferred="::accountBackDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div ng-show="(isDataFound==true)">\n      <!-- Will be hidden once an account is selected -->\n      <div setting-account ng-hide="widget.selectedAccount" parent-widget="widget" label=\'Select an expense account\' on-account-selected="updateSettings()" deferred="::accountFrontDeferred" />\n\n      <!-- The chart will remain hidden until an account is selected -->\n      <div class="chart-container" ng-show="widget.selectedAccount">\n        <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n        <div class="legend">\n          <div class="title">\n            {{getName()}} to {{getComparator() | titleize}}\n            <span ng-if="widget.metadata.organization_ids.length==1"><br /><strong>{{widget.content.summary[0].ratio | mnoCurrency : \'%\'}}</strong></span>\n          </div>\n          <span ng-repeat="sum in widget.content.summary" ng-if="widget.metadata.organization_ids.length>1">\n            <span style="font-weight: bold;">{{sum.company}}: {{sum.ratio | mnoCurrency : \'%\'}}</span>\n            <br />\n          </span>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found on-display-alerts="onDisplayAlerts()" widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/accounts-expenses-revenue.tmpl.html",'<div widget-accounts-expenses-revenue>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-range parent-widget="widget" class="part" deferred="::timeRangeDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div ng-show="(isDataFound==true)">\n      <div setting-hist-mode parent-widget="widget" deferred="::histModeDeferred" on-toggle="widget.format()" />\n\n      <div class="chart-container">\n        <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n        \n        <div class="legend" ng-if="widget.isHistoryMode">\n          <span ng-hide="isNetProfitDisplayed">\n            <span class="negative2">Expenses</span> -\n            <span class="positive2">Revenue</span>\n          </span>\n          <span ng-show="isNetProfitDisplayed">\n            <strong>Net Profit</strong>\n          </span>\n        </div>\n\n        <div ng-show="widget.isHistoryMode" setting-params-checkboxes options="displayOptions" param="display" parent-widget="widget" deferred="::paramsCheckboxesDeferred"/>\n\n        <div class="legend" ng-if="!widget.isHistoryMode">\n          <span class="negative2">Expenses: {{getCurrentExpenses() | mnoCurrency : getCurrency()}}</span>\n          </br>\n          <span class="positive2">Revenue: {{getCurrentRevenue() | mnoCurrency : getCurrency()}}</span>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found on-display-alerts="onDisplayAlerts()" widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/accounts-payable-receivable.tmpl.html",'<div widget-accounts-payable-receivable>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-range parent-widget="widget" class="part" deferred="::timeRangeDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div ng-show="(isDataFound==true)">\n      <div setting-hist-mode parent-widget="widget" deferred="::histModeDeferred" />\n\n      <div ng-hide="widget.isHistoryMode">\n        <div class="receivable">\n          <h3>Accounts Receivable</h3>\n          <div class="price positive2">\n             {{getCurrentReceivable() | mnoCurrency : getCurrency() : false}}\n          </div>\n          <div class="currency">{{getCurrency()}}</div>\n        </div>\n\n        <div class="payable">\n          <h3>Accounts Payable</h3>\n          <div class="price negative2">\n            {{getCurrentPayable() | mnoCurrency : getCurrency() : false}}\n          </div>\n          <div class="currency">{{getCurrency()}}</div>\n        </div>\n      </div>\n\n      <div class="chart-container" ng-class="{\'invisible\': !widget.isHistoryMode}">\n        <div impac-chart draw-trigger="drawTrigger.promise" deferred="chartDeferred"></div>\n        <div class="legend">\n          <span class="negative2">Payable</span> -\n          <span class="positive2">Receivable</span>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found on-display-alerts="onDisplayAlerts()" widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/accounts-profit-and-loss.tmpl.html",'<div widget-accounts-profit-and-loss>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-range parent-widget="widget" class="part" deferred="::timeRangeDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)" class="row" >\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" deferred="::widthDeferred" />\n\n        <div class="widget-lines-container">\n          <div class="row widget-line header">\n            <div class="col-sm-8" />\n            <div class="col-sm-4 text-right">{{getLastDate() | mnoDate : widget.metadata.hist_parameters.period}}</div>\n          </div>\n          <div class="row widget-line total" ng-repeat="statement in widget.content.summary" ng-class="{profit: statement.name.indexOf(\'profit\')>0}">\n            <div class="row widget-line" ng-class="isSelected(statement) ? \'selected\' : null" >\n              <div class="col-sm-1" ng-click="toggleCollapsed(statement)"><i ng-show="(statement.accounts && statement.accounts.length)" class="fa" ng-class="isCollapsed(statement) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" /></div>\n              <div class="col-sm-7" ng-click="toggleSelectedElement(statement)"><strong>{{getName(statement) | titleize}}</strong></div>\n              <div class="col-sm-4 text-right" ng-class="getClassColor(getLastValue(statement))" ng-click="toggleSelectedElement(statement)"><strong>{{getLastValue(statement) | mnoCurrency : statement.currency}}</strong></div>\n            </div>\n            <div collapse="isCollapsed(statement)">\n              <div class="row widget-line" ng-click="toggleSelectedElement(account)" ng-repeat="account in statement.accounts" ng-class="isSelected(account) ? \'selected\' : null" >\n                <div class="col-sm-1" />\n                <div class="col-sm-7">{{account.name}}</div>\n                <div class="col-sm-4 text-right" ng-class="getClassColor(getLastValue(account))">{{getLastValue(account) | mnoCurrency : account.currency}}</div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="right-panel text-center" ng-class="{\'col-md-6\': widget.isExpanded(), \'col-md-12 invisible\': !widget.isExpanded()}">\n\n        <div ng-show="hasElements()"\n          <h4>{{(widget.metadata.hist_parameters.period || "Monthly") | titleize}} Profit and Loss</h4>\n          <div ng-show="selectedElements.length < 2" class="legend">{{getName(selectedElements[0]) | titleize}}</div>\n\n          <div class="chart-container">\n            <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n          </div>\n\n          <div ng-show="selectedElements.length < 2" class="widget-lines-container">\n            <div class="row widget-line">\n              <span class="text-center" ng-repeat="date in dates track by $index">\n                <div ng-if="$index % 6 == 0 && $index > 0" class="clearfix dashed hidden-xs"></div>\n\n                <div class="col-sm-2" style="padding: 5px 0px;">\n                  <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;">{{date | mnoDate : widget.metadata.hist_parameters.period}}</div></div>\n                  <div class="row widget-line"><div class="col-sm-12" ng-class="getClassColor(selectedElements[0].totals[$index])" style="padding: 0px;">{{selectedElements[0].totals[$index] | mnoCurrency : selectedElements[0].currency}}</div></div>\n                </div>\n              </span>\n            </div>\n          </div>\n\n          <div ng-hide="selectedElements.length < 2" class="widget-lines-container">\n            <div class="widget-line" ng-repeat="element in selectedElements">\n              <i style="float: right; margin-right: 10px;" ng-class="getClassColor(getLastValue(element))">{{getLastValue(element) | mnoCurrency : element.currency}}</i>\n              <i class="fa fa-circle" style="margin: 0px 8px; color: {{getElementChartColor($index)}}" />\n              {{getName(element) | titleize}}\n            </div>\n          </div>\n        </div>\n\n        <div ng-hide="hasElements()" class="no-element">\n          Select one or several account(s) or account(s) type(s) to display the corresponding PnL.\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found on-display-alerts="onDisplayAlerts()" widget-engine="::widget.category" />\n  </div>\n\n</div>\n'),t.put("widgets/hr-employee-details.tmpl.html",'<div widget-hr-employee-details>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)" class="row" >\n\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="3" max="6" class="settings width" deferred="::widthDeferred" />\n        <div setting-param-selector parent-widget="widget" param="employee_uid" options="employeesOptions" selected="selectedEmployee" class="row title" deferred="::paramSelectorDeferred1" />\n\n        <div class="details-container">\n          <div class="row">\n            <div class="col-md-4"><label>Job Title</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().job_title || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Company</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().company || getSingleCompanyName()}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Phone</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().phone || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Email</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().email || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Date of birth</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().dob || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Gender</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().gender || "-" }}</pre></div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel" ng-show="widget.isExpanded()">\n        <div class="legend">Salary calculation period: <span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period" deferred="::paramSelectorDeferred2" /></div>\n        <div class="details-container">\n          <div class="row">\n            <div class="col-md-4"><label>Salary</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().salary || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Address</label></div>\n            <div class="col-md-8"><pre>{{formatAddress(getEmployee().address) || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Job location</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().location || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Supervisor</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().supervisor || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Status</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().employment_status || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Note</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().note || "-" }}</pre></div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/hr-employees-list.tmpl.html",'<div widget-hr-employees-list>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)" >\n\n      <div class="legend">\n        <strong>{{widget.content.total.employees}}</strong> employee{{widget.content.total.employees > 1 ? "s" : null}} - Average salary rate (<span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period" deferred="::paramSelectorDeferred"/>): <strong>{{widget.content.total.average_rate | mnoCurrency : widget.content.total.currency}}</strong>\n      </div>\n\n      <div class="widget-lines-container">\n        <div class="row widget-line header">\n          <div class="col-sm-2">Company</div>\n          <div class="col-sm-3">Employee</div>\n          <div class="col-sm-2">Title</div>\n          <div class="col-sm-3">Phone</div>\n          <div class="col-sm-2">Salary</div>\n        </div>\n        <div class="row widget-line" ng-repeat="employee in widget.content.employees" >\n          <div class="col-sm-2">{{employee.company || getSingleCompanyName()}}</div>\n          <div class="col-sm-3">{{employee.lastname}} {{employee.firstname}}</div>\n          <div class="col-sm-2"><i>{{employee.job_title}}</i></div>\n          <div class="col-sm-3">{{employee.phone}}</div>\n          <div class="col-sm-2"><i>{{getEmployeeSalary(employee)}}</i></div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/hr-leaves-balance.tmpl.html",'<div widget-hr-leaves-balance>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred"/>\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)" >\n\n      <div setting-param-selector parent-widget="widget" param="employee_id" options="employeesOptions" selected="selectedEmployee" class="employee-name" deferred="::paramSelectorDeferred" />\n\n      <h3>{{getEmployee().leaves[0].name || \'Vacation leaves\'}} balance</h3>\n      <div class="balance">{{(getEmployee().leaves[0].units || 0) | mnoCurrency : (getEmployee().leaves[0].type_of_units || \'h\')}}</div>\n\n      <h3>{{getEmployee().leaves[1].name || \'Sick leaves\'}} balance</h3>\n      <div class="balance">{{(getEmployee().leaves[1].units || 0) | mnoCurrency : (getEmployee().leaves[1].type_of_units || \'h\')}}</div>\n\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/hr-leaves-schedule.tmpl.html",'<div widget-hr-leaves-schedule>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)">\n\n      <div widget-component-calendar ng-model="eventSources"></div>\n\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/hr-payroll-summary.tmpl.html",'<div widget-hr-payroll-summary>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-range parent-widget="widget" class="part" deferred="::timeRangeDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)" class="row" >\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" deferred="::widthDeferred" />\n\n        <div class="widget-lines-container">\n          <div class="row widget-line header">\n            <div class="col-sm-12">Payroll Summary - {{getPeriod()}}</div>\n          </div>\n          <div class="row widget-line total" ng-repeat="statement in widget.content.summary" >\n            <div class="row widget-line" ng-class="isSelected(statement) ? \'selected\' : null" >\n              <div class="col-sm-1" ng-click="toggleCollapsed(statement)"><i ng-show="(statement.employees && statement.employees.length)" class="fa" ng-class="isCollapsed(statement) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" /></div>\n              <div class="col-sm-7" ng-click="toggleSelectedElement(statement)"><strong>{{getName(statement) | titleize}}</strong></div>\n              <div class="col-sm-4 text-right" ng-click="toggleSelectedElement(statement)">\n                <strong>{{getLastValue(statement) | mnoCurrency : statement.currency}}</strong>\n              </div>\n            </div>\n            <div collapse="isCollapsed(statement)">\n              <div class="row widget-line" ng-click="toggleSelectedElement(employee)" ng-repeat="employee in statement.employees" ng-class="isSelected(employee) ? \'selected\' : null" >\n                <div class="col-sm-1" />\n                <div class="col-sm-7">{{employee.name}}</div>\n                <div class="col-sm-4 text-right">\n                  <span>{{getLastValue(employee) | mnoCurrency : employee.currency}}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="right-panel text-center" ng-class="{\'col-md-6\': widget.isExpanded(), \'col-md-12 invisible\': !widget.isExpanded()}">\n\n        <div ng-show="hasElements()">\n\n          <h4>{{(widget.content.hist_parameters.period || "Monthly") | titleize}} Payroll Summary</h4>\n          <div setting-hist-mode parent-widget="widget" deferred="::histModeDeferred" on-toggle="widget.format()"/>\n\n          <div class="chart-container">\n            <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n            <div ng-show="selectedElements.length < 2" class="legend">{{getName(selectedElements[0]) | titleize}}</div>\n          </div>\n\n          <div ng-show="selectedElements.length < 2" class="widget-lines-container">\n            <div ng-show="getTrackedField()" class="legend">{{getTrackedField()}}</div>\n            <div class="row widget-line">\n              <span class="text-center" ng-repeat="date in widget.content.dates track by $index">\n                <div ng-if="$index % 6 == 0 && $index > 0" class="clearfix dashed hidden-xs"></div>\n\n                <div class="col-sm-2" style="padding: 5px 0px;">\n                  <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;">\n                    {{formatDate(date)}}\n                    </div></div>\n                  <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;">\n                    {{selectedElements[0].totals[$index] | mnoCurrency : selectedElements[0].currency }}\n                  </div></div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div ng-hide="selectedElements.length < 2" class="widget-lines-container">\n\n            <div ng-if="widget.isHistoryMode" class="widget-line header">\n              <span ng-show="getTrackedField()">{{getTrackedField()}} - </span>From {{widget.content.dates[0] | date : "MMM-d"}} to {{widget.content.dates[widget.content.dates.length - 1] | date : "MMM-d"}}\n            </div>\n            <div ng-if="!widget.isHistoryMode" class="widget-line header">\n              <span ng-show="getTrackedField()">{{getTrackedField()}} - </span>{{getPeriod()}}\n            </div>\n\n            <div class="widget-line" ng-repeat="element in selectedElements">\n              <i style="float: right; margin-right: 10px;">\n                <span ng-if="widget.isHistoryMode">{{getTotalSum(element) | mnoCurrency : element.currency}}</span>\n                <span ng-if="!widget.isHistoryMode">{{getLastValue(element) | mnoCurrency : element.currency}}</span>\n              </i>\n              <i class="fa fa-circle" style="margin: 0px 8px; color: {{getElementChartColor($index)}}" />\n              {{getName(element) | titleize}}\n            </div>\n\n          </div>\n\n        </div>\n\n        <div ng-hide="hasElements()" class="no-element">\n          <p>Select one or several employee(s) or category(ies) to display the corresponding summary</p>\n        </div>\n\n      </div>\n\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>\n'),t.put("widgets/hr-payroll-taxes.tmpl.html",'<div widget-hr-payroll-taxes>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-range parent-widget="widget" class="part" deferred="::timeRangeDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div ng-show="(isDataFound==true)">\n      <div setting-hist-mode parent-widget="widget" deferred="::histModeDeferred" />\n\n      <div ng-hide="widget.isHistoryMode" class="current">\n        <div class="price">{{getCurrentPrice() | mnoCurrency : getCurrency() : false}}</div>\n        <div class="currency">{{getCurrency()}}</div>\n        <div class="legend">Taxes upon workforce costs<br />{{getPeriod()}}</div>\n      </div>\n\n      <div class="history chart-container" ng-class="{\'invisible\': !widget.isHistoryMode}">\n        <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n        <div class="legend">Taxes upon workforce costs</div>\n      </div>\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>\n'),t.put("widgets/hr-salaries-summary.tmpl.html",'<div widget-hr-salaries-summary>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div align="center" ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)" class="row">\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="3" max="6" class="settings width" deferred="::widthDeferred" />\n\n        <h3 class="left">Average Salary Rate</h3>\n        <div class="price">\n           {{widget.content.total.average_rate | mnoCurrency : widget.content.total.currency}}\n        </div>\n        <div class="currency" setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period" deferred="::paramSelectorDeferred1"/>\n        <div class="legend">\n          <span>({{widget.content.total.employees}} employee{{widget.content.total.employees > 1 ? "s" : null}} with known salary)</span>\n        </div>\n      </div>\n\n      <div class="right-panel" ng-class="{\'col-md-12 invisible\': !widget.isExpanded(), \'col-md-6\': widget.isExpanded()}">\n        <h3 class="right">Filter: <span setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter" deferred="::paramSelectorDeferred2"/></h3>\n        <div class="chart-container">\n          <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n        </div>\n        <div class="widget-lines-container">\n          <div class="widget-line" ng-repeat="data in widget.content.summary.data">\n            <i style="float: right; margin-right: 10px;"><b>{{data.value | mnoCurrency : widget.content.total.currency}} (av.)</b></i>\n            <i ng-hide="widget.content.summary.filter==\'age_range\'" class="fa fa-circle" style="margin: 0px 8px; color: {{getColorByIndex($index)}}" />\n            {{data.label}}\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/hr-superannuation-accruals.tmpl.html",'<div widget-hr-superannuation-accruals>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)" class="row" >\n\n      <div setting-param-selector parent-widget="widget" param="employee_id" options="employeesOptions" selected="selectedEmployee" class="currency" deferred="::paramSelectorDeferred" />\n\n      <h3>Superannuation Balance</h3>\n      <div class="price">{{(getEmployee().total_super || 0) | mnoCurrency : getEmployee().currency}}</div>\n\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/hr-timesheets.tmpl.html",'<div widget-hr-timesheets>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-range parent-widget="widget" class="part" deferred="::timeRangeDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)">\n\n      <div setting-param-selector parent-widget="widget" param="employee_id" options="employeesOptions" selected="selectedEmployee" class="currency" deferred="::paramSelectorDeferred" />\n\n      <div class="widget-lines-container">\n        <div class="row widget-line header">\n          <div class="col-sm-12">From {{widget.content.dates[0] | date : \'MMM-d\'}} to {{widget.content.dates[widget.content.dates.length - 1] | date : \'MMM-d\'}}</div>\n        </div>\n        <div class="row widget-line total" >\n          <div class="row widget-line" >\n            <div class="col-sm-1" ng-click="toggleCollapsed(\'total_time_worked\')" style="cursor: pointer;"><i class="fa" ng-class="isCollapsed(\'total_time_worked\') ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" /></div>\n            <div class="col-sm-7"><strong>Total Time Worked</strong></div>\n            <div class="col-sm-4 text-right"><strong>{{getEmployeeTimeWorked()}} h</strong></div>\n          </div>\n          <div collapse="isCollapsed(\'total_time_worked\')">\n            <div class="row widget-line">\n              <div class="col-sm-1" />\n              <div class="col-sm-11"><i>Activities detail not found</i></div>\n            </div>\n          </div>\n        </div>\n\n        <div class="row widget-line total" >\n          <div class="row widget-line" >\n            <div class="col-sm-1" ng-click="toggleCollapsed(\'total_time_of\')" style="cursor: pointer;"><i class="fa" ng-class="isCollapsed(\'total_time_of\') ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" /></div>\n            <div class="col-sm-7"><strong>Total Time Off</strong></div>\n            <div class="col-sm-4 text-right"><strong>{{getEmployeeTimeOff()}} h</strong></div>\n          </div>\n          <div collapse="isCollapsed(\'total_time_of\')">\n            <div class="row widget-line">\n              <div class="col-sm-1" />\n              <div class="col-sm-7">PTO</div>\n              <div class="col-sm-4 text-right">0 h</div>\n            </div>\n            <div class="row widget-line">\n              <div class="col-sm-1" />\n              <div class="col-sm-7">Vacation</div>\n              <div class="col-sm-4 text-right">0 h</div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/hr-workforce-summary.tmpl.html",'<div widget-hr-workforce-summary>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div align="center" ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)" class="row">\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="3" max="6" class="settings width" deferred="::widthDeferred" />\n\n        <h3 class="left">Total Workforce</h3>\n        <div class="price">\n           {{getTotalWorkforce() | mnoCurrency : getCurrency()}}\n        </div>\n        <div class="currency" setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period" deferred="::paramSelectorDeferred1"/>\n        <div class="legend">\n          <span>({{getNumberOfEmployees()}} employee{{getNumberOfEmployees() > 1 ? \'s\' : null}} with known salary)</span>\n        </div>\n      </div>\n\n      <div class="right-panel" ng-class="{\'col-md-12 invisible\': !widget.isExpanded(), \'col-md-6\': widget.isExpanded()}">\n        <h3 class="right">Filter: <span setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter" deferred="::paramSelectorDeferred2"/></h3>\n        <div class="chart-container">\n          <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n        </div>\n        <div class="widget-lines-container">\n          <div class="widget-line" ng-repeat="data in widget.content.summary.data">\n            <i style="float: right; margin-right: 10px;"><b>{{((data.value / widget.content.total.amount)*100).toFixed()}}%</b></i>\n            <i class="fa fa-circle" style="margin: 0px 8px; color: {{getColorByIndex($index)}}" />\n            {{widget.content.summary.filter == "salary_range" ? formatSalaryRange(data) : data.label}}\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/invoices-list.accessible.tmpl.html",'<div widget-invoices-list>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <table class="table widget-lines-container" ng-hide="widget.isEditMode">\n\n    <!-- Header line -->\n    <tr class="widget-line header">\n      <td>{{entityTypeCap}}</td>\n      <td>Paid</td>\n      <td>Due</td>\n      <td>Invoiced</td>\n    </tr>\n\n    <!-- Data not found line -->\n    <tr class="widget-line" ng-show="(isDataFound==false)">\n      <td>No {{orderBy}}invoice found for your {{entityType}}</td>\n    </tr>\n    \n    <!-- Content lines -->\n    <tr class="widget-line" ng-show="(isDataFound==true)" ng-repeat="entity in widget.content.entities">\n      <td>{{entity.name}}</td>\n      <td><i>{{entity.total_paid | mnoCurrency : entity.currency}}</i></td>\n      <td><i>{{entity.total_due | mnoCurrency : entity.currency}}</i></td>\n      <td><i>{{entity.total_invoiced | mnoCurrency : entity.currency}}</i></td>\n    </tr>\n\n  </table>\n\n</div>\n'),t.put("widgets/invoices-list.tmpl.html",'<div widget-invoices-list>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-dates-picker parent-widget="widget" class="part" from="(widget.metadata.hist_parameters.from || defaultFrom)" to="(widget.metadata.hist_parameters.to || defaultTo)" keep-today="widget.metadata.hist_parameters.keep_today" deferred="::datesPickerDeferred"/>\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode" class="widget-lines-container">\n\n    <div ng-show="(isDataFound==true)" setting-limit-entries parent-widget="widget" deferred="::limitEntriesDeferred" selected="limitEntriesSelected" max="widget.content.entities.length" entries-label="limitEntriesLabel" />\n\n    <!-- Header line -->\n    <!-- when large widget -->\n    <div class="row widget-line header" ng-show="widget.width > 3">\n      <div class="col-sm-4">{{entityTypeCap}}</div>\n      <div class="col-sm-7">\n        <div class="row">\n          <div class="col-xs-4">Paid</div>\n          <div class="col-xs-4">Due</div>\n          <div class="col-xs-4">Invoiced</div>\n        </div>\n      </div>\n    </div>\n\n    <!-- when small widget -->\n    <div class="row small-row widget-line header" ng-hide="widget.width > 3">\n      <div class="col-xs-6">{{entityTypeCap}}</div>\n      <div class="col-xs-5" ng-show="orderBy == \'paid \'">Paid</div>\n      <div class="col-xs-5" ng-show="orderBy == \'due \'">Due</div>\n      <div class="col-xs-5" ng-hide="orderBy == \'paid \' || orderBy == \'due \'">Invoiced</div>\n    </div>\n\n    <!-- Data not found line -->\n    <div class="row widget-line" ng-show="(isDataFound==false)">\n      <div class="col-xs-11">No {{orderBy}}invoice found for your {{entityType}}</div>\n    </div>\n\n    <!-- Content lines -->\n    <!-- when large widget -->\n    <div ng-if="widget.width > 3" class="row widget-line" ng-show="(isDataFound==true)" ng-repeat="entity in widget.content.entities | limitTo:limitEntriesSelected" tooltip-placement="top" tooltip-html-unsafe="{{getInvoices(entity)}}" tooltip-animation="false" tooltip-append-to-body="true" tooltip-class="impac-widgets-tooltip">\n      <div class="col-sm-4">{{entity.name}}</div>\n      <div class="col-sm-7">\n        <div class="row">\n          <div class="col-xs-4"><i>{{entity.total_paid | mnoCurrency : entity.currency}}</i></div>\n          <div class="col-xs-4"><i>{{entity.total_due | mnoCurrency : entity.currency}}</i></div>\n          <div class="col-xs-4"><i>{{entity.total_invoiced | mnoCurrency : entity.currency}}</i></div>\n        </div>\n      </div>\n      <div class="col-sm-1 text-right"><i class="fa fa-info-circle" /></div>\n    </div>\n\n    <!-- when small widget -->\n    <div ng-if="widget.width <= 3" class="row small-row widget-line" ng-show="(isDataFound==true)" ng-repeat="entity in widget.content.entities | limitTo:limitEntriesSelected" tooltip-placement="top" tooltip-html-unsafe="{{getInvoices(entity)}}" tooltip-animation="false" tooltip-append-to-body="true" tooltip-class="impac-widgets-tooltip">\n      <div class="col-xs-6">{{entity.name}}</div>\n      <div class="col-xs-5" ng-show="orderBy == \'paid \'"><i>{{entity.total_paid | mnoCurrency : entity.currency}}</i></div>\n      <div class="col-xs-5" ng-show="orderBy == \'due \'"><i>{{entity.total_due | mnoCurrency : entity.currency}}</i></div>\n      <div class="col-xs-5" ng-hide="orderBy == \'paid \' || orderBy == \'due \'"><i>{{entity.total_invoiced | mnoCurrency : entity.currency}}</i></div>\n      <div class="col-sm-1 text-right"><i class="fa fa-info-circle" /></div>\n    </div>\n\n  </div>\n\n</div>\n'),t.put("widgets/invoices-aged-payables-receivables.tmpl.html",'<div widget-invoices-aged-payables-receivables>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-range parent-widget="widget" class="part" deferred="::timeRangeDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)" class="row" >\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" deferred="::widthDeferred" />\n\n        <div class="widget-lines-container">\n          <div class="row widget-line header">\n            <div class="col-sm-8">Aged Payables & Receivables</div>\n            <div class="col-sm-4 text-right">Total</div>\n          </div>\n\n          <!-- Payables -->\n          <div class="row widget-line total">\n            <div class="row widget-line" ng-class="isSelected(widget.content.payables) ? \'selected\' : null" >\n              <div class="col-sm-1" ng-click="toggleCollapsed(widget.content.payables)">\n                <i ng-show="(widget.content.payables.suppliers && widget.content.payables.suppliers.length)" class="fa" ng-class="isCollapsed(widget.content.payables) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" />\n              </div>\n              <div class="col-sm-7" ng-click="toggleSelectedElement(widget.content.payables)">\n                <strong>Aged Payables</strong>\n              </div>\n              <div class="col-sm-4 text-right" ng-click="toggleSelectedElement(widget.content.payables)">\n                <strong>{{getTotalSum(widget.content.payables) | mnoCurrency : widget.content.payables.currency}}</strong>\n              </div>\n            </div>\n            <div ng-hide="isCollapsed(widget.content.payables)">\n              <div class="row widget-line" ng-click="toggleSelectedElement(supplier)" ng-repeat="supplier in widget.content.payables.suppliers" ng-class="isSelected(supplier) ? \'selected\' : null" >\n                <div class="col-sm-1" />\n                <div class="col-sm-7">{{supplier.name}}</div>\n                <div class="col-sm-4 text-right">\n                  <span>{{getTotalSum(supplier) | mnoCurrency : supplier.currency}}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <!-- Receivables -->\n          <div class="row widget-line total">\n            <div class="row widget-line" ng-class="isSelected(widget.content.receivables) ? \'selected\' : null" >\n              <div class="col-sm-1" ng-click="toggleCollapsed(widget.content.receivables)">\n                <i ng-show="(widget.content.receivables.customers && widget.content.receivables.customers.length)" class="fa" ng-class="isCollapsed(widget.content.receivables) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" />\n              </div>\n              <div class="col-sm-7" ng-click="toggleSelectedElement(widget.content.receivables)">\n                <strong>Aged Receivables</strong>\n              </div>\n              <div class="col-sm-4 text-right" ng-click="toggleSelectedElement(widget.content.receivables)">\n                <strong>{{getTotalSum(widget.content.receivables) | mnoCurrency : widget.content.receivables.currency}}</strong>\n              </div>\n            </div>\n            <div ng-hide="isCollapsed(widget.content.receivables)">\n              <div class="row widget-line" ng-click="toggleSelectedElement(customer)" ng-repeat="customer in widget.content.receivables.customers" ng-class="isSelected(customer) ? \'selected\' : null" >\n                <div class="col-sm-1" />\n                <div class="col-sm-7">{{customer.name}}</div>\n                <div class="col-sm-4 text-right">\n                  <span>{{getTotalSum(customer) | mnoCurrency : customer.currency}}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="right-panel text-center" ng-class="{\'col-md-6\': widget.isExpanded(), \'col-md-12 invisible\': !widget.isExpanded()}">\n\n        <div ng-show="hasElements()">\n\n          <h4>{{(widget.content.hist_parameters.period || "Monthly") | titleize}} Aged Payables and Receivables</h4>\n\n          <div ng-show="selectedElements.length < 2" class="legend">{{getName(selectedElements[0]) | titleize}}</div>\n\n          <div class="chart-container">\n            <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n          </div>\n\n          <div ng-show="selectedElements.length < 2" class="widget-lines-container">\n            <div class="row widget-line">\n              <span class="text-center" ng-repeat="date in widget.content.dates track by $index">\n                <div ng-if="$index % 6 == 0 && $index > 0" class="clearfix dashed hidden-xs"></div>\n\n                <div class="col-sm-2" style="padding: 5px 0px;">\n                  <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;">\n                    {{date | mnoDate : widget.metadata.hist_parameters.period}}\n                  </div></div>\n                  <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;">\n                    {{selectedElements[0].totals[$index] | mnoCurrency : selectedElements[0].currency}}\n                  </div></div>\n                </div>\n              </span>\n            </div>\n            <div class="astericks-info">\n              <p><i>* Your opening-balance of receivables and/or payables for this period.</i></p>\n            </div>\n          </div>\n\n          <div ng-hide="selectedElements.length < 2" class="widget-lines-container">\n\n            <div class="widget-line header">\n              Totals\n            </div>\n\n            <div class="widget-line" ng-repeat="element in selectedElements">\n              <i style="float: right; margin-right: 10px;">\n                <span>{{getTotalSum(element) | mnoCurrency : element.currency}}</span>\n              </i>\n              <i class="fa fa-circle" style="margin: 0px 8px; color: {{getElementChartColor($index)}}" />\n              {{getName(element) | titleize}}\n            </div>\n\n            <div class="astericks-info">\n              <p><i>* Your opening-balance of receivables and/or payables for this period.</i></p>\n            </div>\n\n          </div>\n\n        </div>\n\n        <div ng-hide="hasElements()" class="no-element">\n          Select one or several account(s) or category(ies) to display the payables/receivables evolution(s).\n        </div>\n\n      </div>\n\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>\n'),t.put("widgets/invoices-summary.tmpl.html",'<div widget-invoices-summary>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-dates-picker parent-widget="widget" class="part" from="(widget.metadata.hist_parameters.from || defaultFrom)" to="widget.metadata.hist_parameters.to" keep-today="widget.metadata.hist_parameters.keep_today" deferred="::datesPickerDeferred"/>\n    <div setting-chart-filters parent-widget="widget" class="part" deferred="::chartFiltersDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div align="center" ng-hide="widget.isEditMode">\n    <div ng-show="(isDataFound==true)" class="chart-container">\n      <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n      <div class="legend">\n        <span>{{widget.content.legend}}</span>\n      </div>\n    </div>\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-aged.tmpl.html",'<div widget-sales-aged>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-range parent-widget="widget" class="part" deferred="::timeRangeDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)" class="center">\n\n      <div setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter" no-reload truncate-no="60" on-select="widget.format()" style="text-align: center;" deferred="::paramSelectorDeferred"/>\n\n      <div class="chart-container">\n        <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n      </div>\n      <div class="legend">From {{widget.content.dates[0] | mnoDate : widget.metadata.hist_parameters.period}} to {{getLastDate() | mnoDate : widget.metadata.hist_parameters.period}}</div>\n\n      <div class="widget-lines-container">\n        <div class="row widget-line">\n          <span class="text-center" ng-repeat="date in formattedDates track by $index">\n            <div ng-if="$index % 6 == 0 && $index > 0" class="clearfix dashed hidden-xs"></div>\n\n            <div class="col-sm-2" style="padding: 5px 0px;">\n              <div class="row widget-line"><div class="col-sm-12" style="padding: 0px;">{{date}}</div></div>\n            \n              <div class="row widget-line">\n                <div ng-hide="filter.value == \'quantity_sold\'" class="col-sm-12" ng-class="getClassColor(getTotal($index - 1),getTotal($index))" style="padding: 0px;">\n                  {{getTotal($index) | mnoCurrency : widget.content.currency : false}}\n                  <br />\n                  {{widget.content.currency}}\n                </div>\n                <div ng-show="filter.value == \'quantity_sold\'" class="col-sm-12" ng-class="getClassColor(getTotal($index - 1),getTotal($index))" style="padding: 0px;">\n                  {{getTotal($index)}}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n    </div>\n  </div>\n  <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n</div>\n'),t.put("widgets/sales-break-even.tmpl.html",'<div widget-sales-break-even>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-range parent-widget="widget" class="part" deferred="::timeRangeDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)" class="align-center">\n\n      <div class="legend">From {{widget.content.period.from | date : \'d MMM yyyy\'}} to {{widget.content.period.to | date : \'d MMM yyyy\'}}</div>\n\n      <div class="block to-date">\n        <div class="title">Sales to Date</div>\n        <div class="price">{{widget.content.sales.to_date | mnoCurrency : widget.content.currency : false}}</div>\n        Target: <span class="edit-target" style="float: right;" editable-text="threshold" buttons="no" onaftersave="updateSettings()">\n          {{threshold | mnoCurrency : widget.content.currency : false}}\n        </span>\n      </div>\n\n      <div ng-show="widget.content.break_even" class="block to-breakeven">\n        <div class="title">Projection to Break-Even</div>\n        <span ng-show="isTargetMet()">Your sales already exceed your target by:</span>\n        <div class="price">{{getVariance() | mnoCurrency : widget.content.currency : false}}</div>\n        <span ng-hide="isTargetMet()">\n          Projected date: <span style="float: right;">{{getProjectedDate() | date : \'d-MM-yy\'}}</span>\n          <br />\n          Opportunities to close: <span style="float: right;">{{getOpportunitiesToClose()}}</span>\n        </span>\n      </div>\n      <div ng-show="widget.content.break_even" class="legend">{{widget.content.break_even.eligible_opportunities}} eligible opportunities</div>\n\n      <div ng-hide="widget.content.break_even" class="block to-breakeven">\n        <span class="edit-target" editable-text="threshold" buttons="no" onaftersave="updateSettings()">\n          <div class="define-text">Click to define your sales target</div>\n        </span>\n      </div>\n\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-customer-details.tmpl.html",'<div widget-sales-customer-details>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-range parent-widget="widget" class="part" deferred="::timeRangeDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)" class="row" >\n\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="3" max="6" class="settings width" deferred="::widthDeferred" />\n        <div setting-param-selector parent-widget="widget" param="customer_uid" options="customersOptions" selected="selectedCustomer" class="row title" deferred="::paramSelectorDeferred" />\n\n        <div class="details-container">\n          <div class="row">\n            <div class="col-md-4"><label>Email</label></div>\n            <div class="col-md-8"><pre>{{getCustomer().email}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Phone</label></div>\n            <div class="col-md-8"><pre>{{getCustomer().phone}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Website</label></div>\n            <div class="col-md-8"><pre>{{getCustomer().website}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Contact</label></div>\n            <div class="col-md-8"><pre>{{getCustomer().contact}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>City</label></div>\n            <div class="col-md-8"><pre>{{getCustomer().city}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label>Country</label></div>\n            <div class="col-md-8"><pre>{{getCustomer().country}}</pre></div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel" ng-show="widget.isExpanded()">\n        <div class="details-container">\n          <div class="row" style="border-bottom: solid 1px #e6e6e6; margin-bottom: 10px; padding-bottom: 5px;">\n            <div class="col-md-3"><label>Address</label></div>\n            <div class="col-md-9"><pre>{{formatAddress(getCustomer().full_address)}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-12 center legend">From {{getFromDate() | date : \'d MMM yyyy\'}} to {{getToDate() | date : \'d MMM yyyy\'}}:</div>\n          </div>\n          <div class="row">\n            <div class="col-md-5"><label>Total invoiced</label></div>\n            <div class="col-md-7"><pre>{{getCustomer().total_invoiced | mnoCurrency : getCustomer().currency}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-5"><label>Total paid</label></div>\n            <div class="col-md-7"><pre>{{getCustomer().total_paid | mnoCurrency : getCustomer().currency}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-5"><label>Total due</label></div>\n            <div class="col-md-7"><pre>{{getCustomer().total_due | mnoCurrency : getCustomer().currency}}</pre></div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-comparison.tmpl.html",'<div widget-sales-comparison>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-range parent-widget="widget" class="part" deferred="::timeRangeDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)" class="row" >\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" deferred="::widthDeferred" />\n\n        <div class="row legend center">\n          Compare by: <div setting-param-selector parent-widget="widget" style="display: inline;" param="criteria" options="criteriaOptions" selected="criteria" truncate-no="30" deferred="::paramSelectorDeferred1" />\n           |\n          See: <div setting-param-selector parent-widget="widget" style="display: inline;" param="filter" options="filterOptions" selected="filter" truncate-no="30" on-select="widget.format()" no-reload deferred="::paramSelectorDeferred2" />\n        </div>\n\n        <div class="widget-lines-container" style="max-height: 530px;">\n          <div class="row widget-line header">\n            <div class="col-sm-12">Total sales from {{widget.content.dates[0] | mnoDate : widget.metadata.hist_parameters.period}} to {{getLastDate() | mnoDate : widget.metadata.hist_parameters.period}}</div>\n          </div>\n          <div class="row widget-line total" ng-repeat="statement in widget.content.sales_comparison" >\n            <div class="row widget-line" ng-class="isSelected(statement) ? \'selected\' : null" >\n              <div class="col-sm-1" ng-click="toggleCollapsed(statement)"><i ng-show="(statement.sales && statement.sales.length)" class="fa" ng-class="isCollapsed(statement) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" /></div>\n              <div class="col-sm-7" ng-click="toggleSelectedElement(statement)"><strong>{{statement.name | titleize}}</strong></div>\n              <div ng-show="filter.value == \'quantity_sold\'" class="col-sm-4 text-right" ng-click="toggleSelectedElement(statement)"><strong>{{getTotalForPeriod(statement)}}</strong></div>\n              <div ng-hide="filter.value == \'quantity_sold\'" class="col-sm-4 text-right" ng-click="toggleSelectedElement(statement)"><strong>{{getTotalForPeriod(statement) | mnoCurrency : statement.currency}}</strong></div>\n            </div>\n            <div collapse="isCollapsed(statement)">\n              <div class="row widget-line" ng-click="toggleSelectedElement(sale)" ng-repeat="sale in statement.sales" ng-class="isSelected(sale) ? \'selected\' : null" >\n                <div class="col-sm-1" />\n                <div class="col-sm-7">{{sale.name}}</div>\n                <div ng-show="filter.value == \'quantity_sold\'" class="col-sm-4 text-right">{{getTotalForPeriod(sale)}}</div>\n                <div ng-hide="filter.value == \'quantity_sold\'" class="col-sm-4 text-right">{{getTotalForPeriod(sale) | mnoCurrency : sale.currency}}</div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="right-panel text-center" ng-class="{\'col-md-6\': widget.isExpanded(), \'col-md-12 invisible\': !widget.isExpanded()}">\n\n        <div ng-show="hasElements()">\n          <div class="chart-container">\n            <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n          </div>\n\n          <div class="widget-lines-container">\n            <div class="row widget-line header">\n              <div class="col-sm-12">Total sales from {{widget.content.dates[0] | mnoDate : widget.metadata.hist_parameters.period}} to {{getLastDate() | mnoDate : widget.metadata.hist_parameters.period}}</div>\n            </div>\n            <div class="widget-line" ng-repeat="element in selectedElements">\n              <i ng-show="filter.value == \'quantity_sold\'" style="float: right; margin-right: 10px;">{{getTotalForPeriod(element)}}</i>\n              <i ng-hide="filter.value == \'quantity_sold\'" style="float: right; margin-right: 10px;">{{getTotalForPeriod(element) | mnoCurrency : element.currency}}</i>\n              <i class="fa fa-circle" style="margin: 0px 8px; color: {{getElementChartColor($index)}}" />\n              {{element.name | titleize}}\n            </div>\n          </div>\n        </div>\n\n        <div ng-hide="hasElements()" class="no-element">\n          Select one or several sales category(ies) to display the corresponding comparison.\n        </div>\n\n      </div>\n\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>\n'),t.put("widgets/sales-cycle.tmpl.html",'<div widget-sales-cycle>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-params-picker options="statusOptions" param="status_selection" parent-widget="widget" class="part" deferred="::paramsPickerDeferred" />\n    <div setting-time-range parent-widget="widget" class="part" deferred="::timeRangeDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div align="center" ng-hide="widget.isEditMode">\n    <div ng-show="(isDataFound==true)" class="chart-container">\n      <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n      <div class="legend">\n        <span>Your sales cycle represents how much time your leads stay set to each status</span>\n      </div>\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-forecast.tmpl.html",'<div widget-sales-forecast>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)" >\n\n      <div class="chart-container">\n        <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n      </div>\n\n      <div class="widget-lines-container" style="max-height: 340px;">\n        <div class="row widget-line header">\n          <div class="col-sm-12">Projection on the next 6 months</div>\n        </div>\n        <div class="row widget-line total" ng-repeat="date in widget.content.dates.slice(6) track by $index" ng-init="collapsed = true" >\n          <div class="row widget-line" ng-class="{main: widget.content.opportunities.slice(6)[$index].length > 0}" ng-click="collapsed = !collapsed" >\n            <div class="col-sm-6">{{date | mnoDate : widget.metadata.hist_parameters.period}}</div>\n            <div class="col-sm-6 text-right"><strong>{{widget.content.totals.slice(6)[$index] | mnoCurrency : widget.content.currency}}</strong></div>\n          </div>\n          <div collapse="collapsed">\n            <div class="row widget-line" ng-repeat="opp in widget.content.opportunities.slice(6)[$index]" >\n              <div class="col-sm-6">{{opp.name}}</div>\n              <div class="col-sm-6 text-right">{{getOpportunityAmount(opp) | mnoCurrency : getOpportunityCurrency(opp)}}</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-growth.tmpl.html",'<div widget-sales-growth>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-range parent-widget="widget" class="part" deferred="::timeRangeDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)">\n\n      <div class="selector">\n        <div setting-param-selector parent-widget="widget" param="product" options="productOptions" selected="product" no-reload on-select="widget.format()" deferred="::paramSelectorDeferred1"/>\n        <div ng-show="product.value != -1" setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter" deferred="::paramSelectorDeferred2"/>\n      </div>\n\n      <div class="chart-container" ng-class="{\'invisible\': product.value==-1}">\n        <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n      </div>\n\n      <div ng-show="product.value != -1" class="legend text-center">{{getSelectedProduct().name}}</div>\n      <div class="price text-center" ng-hide="isDataQuantity || product.value == -1" tooltip="total for last period">{{getCurrentValue() | mnoCurrency : getSelectedProduct().currency}}</div>\n      <div class="price text-center" ng-show="isDataQuantity && product.value != -1" tooltip="total for last period">{{getCurrentValue()}}</div>\n\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-leads-list.tmpl.html",'<div widget-sales-leads-list>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)">\n\n      <div class="widget-lines-container">\n        <div class="row widget-line total" ng-repeat="lead in widget.content.leads" tooltip-trigger="mouseenter" tooltip-placement="top" tooltip-html-unsafe="{{getLeadDescription(lead)}}" tooltip-animation="false" tooltip-append-to-body="true" tooltip-class="impac-widgets-tooltip">\n          <div class="row widget-line" >\n            <div class="col-sm-7">\n              {{lead.first_name | titleize}} {{lead.last_name | titleize}}\n              <span ng-show="lead.organization">({{lead.organization}})</span>\n            </div>\n            <div class="col-sm-5 text-right"><strong>{{lead.lead_status | titleize}}</strong></div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-leads-funnel.tmpl.html",'<div widget-sales-leads-funnel>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-params-picker options="statusOptions" param="status_selection" parent-widget="widget" class="part" deferred="::paramsPickerDeferred" />\n    <div setting-time-range parent-widget="widget" class="part" deferred="::timeRangeDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)" class="row" >\n\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" deferred="::widthDeferred" />\n\n        <div class="legend">Your leads sales funnel from {{widget.content.from | date : \'d MMM yyyy\'}} to {{widget.content.to | date : \'d MMM yyyy\'}}</div>\n\n        <div class="funnel-container">\n          <div class="tile" ng-repeat="elem in funnel" ng-click="toggleSelectStatus(elem.status)">\n            <div class="colored-area" ng-style="elem.coloredWidth" ng-class="isSelected(elem.status) ? \'selected\' : \'\'">{{elem.number}}</div>\n            <div class="main-text" ng-style="elem.statusWidth">{{elem.status | titleize}}</div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n\n        <div ng-hide="selectedStatus" class="currency">\n          Select a status to display a list of the corresponding leads\n        </div>\n\n        <div ng-show="selectedStatus" class="widget-lines-container">\n          <div class="row widget-line total" ng-repeat="lead in getSelectedLeads()" tooltip-trigger="mouseenter" tooltip-placement="top" tooltip-html-unsafe="{{getLeadDescription(lead)}}" tooltip-animation="false"  tooltip-append-to-body="true" tooltip-class="impac-widgets-tooltip">\n            <div class="row widget-line" >\n              <div class="col-sm-7">\n                {{lead.first_name | titleize}} {{lead.last_name | titleize}}\n                <span ng-show="lead.organization">({{lead.organization}})</span>\n              </div>\n              <div class="col-sm-5 text-right"><strong>{{lead.lead_status | titleize}}</strong></div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-list.tmpl.html",'<div widget-sales-list>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div class="selector">\n      <span setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter" deferred="::paramSelectorDeferred" />\n      <span setting-dates-picker parent-widget="widget" from="widget.metadata.hist_parameters.from" to="widget.metadata.hist_parameters.to" keep-today="widget.metadata.hist_parameters.keep_today" deferred="::datesPickerDeferred"/>\n    </div>\n\n    <div class="widget-lines-container" ng-show="(isDataFound==true)">\n      <div class="row widget-line total" ng-repeat="company in widget.content.summary" >\n        <div class="row widget-line" >\n          <div class="col-sm-1" ng-click="toggleCollapsed(company.name)" style="cursor: pointer;"><i class="fa" ng-class="isCollapsed(company.name) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" /></div>\n          <div class="col-sm-7"><strong>{{company.name | titleize}}</strong></div>\n          <div class="col-sm-4 text-right" ng-show="{{filter.value.match(\'quantity\')}}"><strong>{{company.total}}</strong></div>\n          <div class="col-sm-4 text-right" ng-hide="{{filter.value.match(\'quantity\')}}"><strong>{{company.total | mnoCurrency : company.currency}}</strong></div>\n        </div>\n        <div collapse="isCollapsed(company.name)">\n          <div class="row widget-line" ng-repeat="product in company.products" >\n            <div class="col-sm-1" />\n            <div class="col-sm-7">{{product.name | titleize}}</div>\n            <div class="col-sm-4 text-right" ng-show="{{filter.value.match(\'quantity\')}}"><strong>{{product.total}}</strong></div>\n            <div class="col-sm-4 text-right" ng-hide="{{filter.value.match(\'quantity\')}}"><strong>{{product.total | mnoCurrency : product.currency}}</strong></div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class="data-not-found" ng-show="(isDataFound==false)">\n      <div class="message">No data found for this time range<br/> Please select another one</div>\n    </div>\n    <!-- <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" /> -->\n  </div>\n\n</div>'),t.put("widgets/sales-margin.tmpl.html",'<div widget-sales-margin>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-range parent-widget="widget" class="part" deferred="::timeRangeDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div ng-show="(isDataFound==true)">\n      <div setting-hist-mode parent-widget= "widget" deferred="::histModeDeferred" />\n\n      <div ng-hide="widget.isHistoryMode" class="current">\n        <div class="price">\n           {{ getTotalMargin() | mnoCurrency : getCurrency()}}\n        </div>\n        <div class="legend">\n          Total sold - Total purchased\n          </br>\n          {{getTimeSpan()}}\n          </br>\n          <div setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter" no-reload on-select="widget.format()" deferred="::paramSelectorDeferred" />\n        </div>\n      </div>\n\n      <div class="history chart-container" ng-class="{\'invisible\': !widget.isHistoryMode}">\n        <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n        <div class="legend">Total sold - Total purchased</div>\n      </div>\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>\n'),t.put("widgets/sales-number-of-leads.tmpl.html",'<div widget-sales-number-of-leads>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)" class="align-center">\n      <div class="selector">\n        Leads for this <span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period" deferred="::paramSelectorDeferred" />\n      </div>\n\n      <div class="stats">\n        <div class="stat row align-left" ng-repeat="carac in [\'new\', \'converted\', \'lost\']">\n          <div class="col-md-6 title" style="padding: 0px;">{{carac | titleize}}</div>\n          <div class="col-md-6" style="padding: 0px;">\n            <span class="variation" ng-class="formatNumberOfLeads(carac).color">{{formatNumberOfLeads(carac).variation}}</span>\n            <span class="nominal">{{formatNumberOfLeads(carac).nominal}}</span>\n          </div>\n        </div>\n      </div>\n\n      <div class="legend">\n      {{widget.content.number_of_leads.total[1]}} leads in total\n      </div>\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-opportunities-funnel.tmpl.html",'<div widget-sales-opportunities-funnel>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-params-picker options="statusOptions" param="sales_stage_selection" parent-widget="widget" class="part" deferred="::paramsPickerDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)" class="row" >\n\n      <div ng-class="widget.isExpanded() ? \'col-md-6\': \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" deferred="::widthDeferred" />\n\n        <div class="legend">Your opportunities, sorted by sales stage</div>\n\n        <div class="funnel-container">\n          <div class="tile" ng-repeat="elem in funnel" ng-click="toggleSelectStatus(elem.status)">\n            <div class="colored-area" ng-style="elem.coloredWidth" ng-class="isSelected(elem.status) ? \'selected\' : \'\'">{{elem.number}}</div>\n            <div class="main-text" ng-style="elem.statusWidth">{{elem.status | titleize}}</div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n\n        <div ng-hide="selectedStatus" class="currency">\n          Select a sales stage to display a list of the corresponding opportunities\n        </div>\n\n        <div ng-show="selectedStatus" class="widget-lines-container">\n          <div class="row widget-line total" ng-repeat="opp in getSelectedOpportunities()">\n            <div class="row widget-line" >\n              <div class="col-sm-6">\n                {{opp.name | titleize}}\n              </div>\n              <div class="col-sm-6 text-right"><strong>{{getOppDetails(opp)}}</strong></div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-performance.tmpl.html",'<div widget-sales-performance>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n\n    <div ng-show="(isDataFound==true)" class="row" >\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" deferred="::widthDeferred" />\n\n        <div class="widget-lines-container">\n          <div class="row widget-line header">\n            <div class="col-sm-5">from {{widget.content.dates[0] | mnoDate : widget.metadata.hist_parameters.period}} to {{widget.content.dates[widget.content.dates.length - 1] | mnoDate : widget.metadata.hist_parameters.period}}</div>\n            <div class="col-sm-3 text-right">Win ratio</div>\n            <div class="col-sm-4 text-right">Total won</div>\n          </div>\n          <div class="row widget-line total" ng-repeat="assignee in widget.content.assignees" >\n            <div class="row widget-line" ng-class="{\'selected\': isSelected(assignee)}" ng-click="toggleSelectedElement(assignee)" >\n              <div class="col-sm-5"><strong>{{assignee.name | titleize}}</strong></div>\n              <div class="col-sm-3 text-right"><strong>{{assignee.win_ratio | mnoCurrency : \'%\'}}</strong></div>\n              <div class="col-sm-4 text-right"><strong>{{assignee.total_won | mnoCurrency}}</strong></div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="right-panel text-center" ng-class="{\'col-md-6\': widget.isExpanded(), \'col-md-12 invisible\': !widget.isExpanded()}">\n\n        <div ng-show="selectedElement">\n          <h4>{{selectedElement.name | titleize}}</h4>\n\n          <div class="chart-container">\n            <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n            <div class="legend">Total won (last 12 months): {{selectedElement.total_won | mnoCurrency}}</div>\n          </div>\n          \n          <div class="widget-lines-container">\n            <div class="row widget-line total" ng-init="collapsedWon=false">\n              <div class="row widget-line" style="cursor: pointer;" ng-click="collapsedWon=!collapsedWon">\n                <div class="col-sm-10"><strong>Closed Won</strong></div>\n                <div class="col-sm-2 text-right"><strong>{{getWonOpportunities(selectedElement).length}}</strong></div>\n              </div>\n              <div collapse="collapsedWon">\n                <div class="row widget-line" ng-repeat="opp in getWonOpportunities(selectedElement)">\n                  <div class="col-sm-6">{{opp.name}}</div>\n                  <div class="col-sm-3 text-right">{{getCloseDate(opp)}}</div>\n                  <div class="col-sm-3 text-right">{{opp.amount.amount | mnoCurrency}}</div>\n                </div>\n              </div>\n            </div>\n\n            <div class="row widget-line total" ng-init="collapsedLost=false">\n              <div class="row widget-line" style="cursor: pointer;" ng-click="collapsedLost=!collapsedLost">\n                <div class="col-sm-10"><strong>Closed Lost</strong></div>\n                <div class="col-sm-2 text-right"><strong>{{getLostOpportunities(selectedElement).length}}</strong></div>\n              </div>\n              <div collapse="collapsedLost">\n                <div class="row widget-line" ng-repeat="opp in getLostOpportunities(selectedElement)" >\n                  <div class="col-sm-6">{{opp.name}}</div>\n                  <div class="col-sm-3 text-right">{{getCloseDate(opp)}}</div>\n                  <div class="col-sm-3 text-right">{{opp.amount.amount | mnoCurrency}}</div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div ng-hide="selectedElement" class="no-element">\n          Select an employee or team to display the corresponding opportunities won/lost.\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-segmented-turnover.tmpl.html",'<div widget-sales-segmented-turnover>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-range parent-widget="widget" class="part" deferred="::timeRangeDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div align="center" ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)" class="row">\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="3" max="6" class="settings width" deferred="::widthDeferred"></div>\n\n        <div class="selector">Filter: <span setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter" deferred="::paramSelectorDeferred"/></div>\n        <div class="chart-container">\n          <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n        </div>\n        <div class="widget-lines-container">\n          <div class="widget-line">\n            Average price range\n          </div>\n          <div class="widget-line" ng-repeat="range in widget.content.ranges">\n            <i style="float: right; margin-right: 10px;">{{range.percentage}}%</i>\n            <i class="fa fa-circle" style="margin: 0px 8px; color: {{getColorByIndex($index)}}" />\n            {{getRangeLabel(range.label)}}\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel" ng-show="widget.isExpanded()">\n        <i class="fa fa-info-circle" style="float: left;" tooltip="This widget segments your revenue by products average price range and propose an analysis of its composition" />\n        <h3 style="margin: 25px 10px; text-align: center;">{{getMaxRange().percentage.toFixed()}}% of your revenue comes from products sold at an average price between {{getMaxRange().label.split(\'-\')[0] | mnoCurrency : widget.content.currency}} and {{getMaxRange().label.split(\'-\')[1] | mnoCurrency : widget.content.currency}}.</h3>\n        <div class=\'analysis hidden-md\' >{{getAnalysis()}}</div>\n      </div>\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n\n</div>'),t.put("widgets/sales-summary.tmpl.html",'<div widget-sales-summary>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-chart-filters parent-widget="widget" class="part" deferred="::chartFiltersDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div align="center" ng-hide="widget.isEditMode">\n\n    <div class="selector">\n      <span setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter" deferred="::paramSelectorDeferred" />\n      <span setting-dates-picker parent-widget="widget" from="widget.metadata.hist_parameters.from" to="widget.metadata.hist_parameters.to" keep-today="widget.metadata.hist_parameters.keep_today" deferred="::datesPickerDeferred"/>\n    </div>\n\n    <div class="chart-container" ng-show="(isDataFound==true)">\n      <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n    </div>\n\n    <div class="data-not-found" ng-show="(isDataFound==false)">\n      <div class="message">No data found for this time range<br/> Please select another one</div>\n    </div>\n\n  </div>\n\n</div>'),t.put("widgets/sales-top-opportunities.tmpl.html",'<div widget-sales-top-opportunities>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div ng-show="(isDataFound==true)">\n\n      <div class="legend">\n        Total potential: <b>{{widget.content.total_potential | mnoCurrency : widget.content.currency || "AUD"}}</b> - <b>{{widget.content.eligible_opportunities}}</b> eligible opportunities\n      </div>\n\n      <div class="opps-container">\n        <div class="tile" ng-repeat="opp in widget.content.opportunities track by $index" ng-class="getOppClass($index)">\n          <div class="colored-area">{{$index +1 }}</div>\n          <div class="main-text">\n            {{opp.name | titleize}}\n            <br />\n            <i style="font-size: 13px;">{{getOppDetails(opp)}}</i>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-show="(isDataFound==false)" common-data-not-found widget-engine="::widget.category" />\n  </div>\n    \n</div>'),t.put("widgets-settings/account.tmpl.html",'<h5 ng-if="showLabel">{{label}}</h5>\n<div class="input-group settings select-account">\n	<select ng-model="parentWidget.selectedAccount" ng-change="onAccountSelected()" ng-options="formatLabel(account) for account in parentWidget.content.account_list track by account.uid" class="form-control" />\n</div>\n'),t.put("widgets-settings/chart-filters.tmpl.html",'<div class="settings chart-filters">\n  <h5>Chart filters</h5>\n  <div class="row">\n    <div class="col-md-6">\n      <input type="radio" ng-model="filterCriteria" value="number">\n      <label for="number" ng-click="filterCriteria = \'number\'">Top {{filterValueNumber}} {{entityType}}</label>\n    </div>\n    <div class="col-md-6">\n      <input type="range" ng-model="filterValueNumber" ng-change="filterCriteria = \'number\'" min="3" max="{{maxEntities}}" step="1">\n    </div>\n  </div>\n  <div class="row">\n    <div class="col-md-6">\n      <input type="radio" ng-model="filterCriteria" value="percentage">\n      <label for="percentage" ng-click="filterCriteria = \'percentage\'">Top {{filterValuePercentage}}% {{filterLabel}}</label>\n    </div>\n    <div class="col-md-6">\n      <input type="range" ng-model="filterValuePercentage" ng-change="filterCriteria = \'percentage\'" min="20" max="100" step="5">\n    </div>\n  </div>\n</div>\n'),t.put("widgets-settings/dates-picker.tmpl.html",'<span class="settings dates-picker">\n  <h5>Time range</h5>\n\n  <span class="buttons">\n    <button class="btn btn-sm btn-default" ng-click="calendarFrom.toggle()" datepicker-popup ng-model="calendarFrom.value" is-open="calendarFrom.opened" ng-change="showApplyButton()" max-date="calendarTo.value" >\n      {{ calendarFrom.value | date : \'yyyy-MM-dd\' }}\n    </button>\n    to \n    <button class="btn btn-sm btn-default" ng-click="calendarTo.toggle()" datepicker-popup ng-model="calendarTo.value" is-open="calendarTo.opened" ng-change="showApplyButton()" min-date="calendarFrom.value" on-open-focus="false" >\n      {{ calendarTo.value | date : \'yyyy-MM-dd\' }}\n    </button>\n    <button class="btn btn-sm btn-success" tooltip="Apply changes" ng-show="changed && !parentWidget.isEditMode" ng-click="applyChanges()" >\n      <i class="fa fa-check" />\n    </button>\n  </span>\n</span>'),t.put("widgets-settings/hist-mode.tmpl.html",'<div class="settings hist-mode-choser">\n  <div align="center" class="options">\n    <a ng-click="toggleHistMode(\'current\')" ng-class="!parentWidget.isHistoryMode ? \'active\' : \'inactive\'">current</a> |\n    <a ng-click="toggleHistMode(\'history\')" ng-class="parentWidget.isHistoryMode ? \'active\' : \'inactive\'">history</a>\n  </div>\n  <div class="{{parentWidget.isHistoryMode ? \'arrow-container right\' : \'arrow-container left\'}}">\n    <div class="arrow" />\n    <div class="arrow-border" />\n  </div>\n</div>'),t.put("widgets-settings/limit-entries.tmpl.html",'<div class="settings limit-entries">\n  {{ entriesLabel ? \'Top\' : \'Display\' }}\n\n  <span ng-repeat="option in options | filter:isOptionValid:option track by $index">\n    {{ $index!=0 ? \' |\' : \'\' }} \n    <a target=\'#\' ng-click="selectOption(option)" class="option" ng-class="{badge: option==selected}">{{ option }}</a>\n  </span>\n\n  <span ng-if="max">\n    | \n    <a target=\'#\' ng-click="selectOption(max)" class="option" ng-class="{badge: (!selected || selected==max)}">{{ max }}</a>\n  </span>\n\n   {{entriesLabel || \'entries\'}}\n</div>'),t.put("widgets-settings/organizations.tmpl.html",'<div class="settings organizations">\n  <h5>Select Companies</h5>\n\n  <div class="widget-lines-container">\n    <div class="widget-line" ng-repeat="org in dashboardOrganizations">\n      {{org.label}}\n      <i ng-class="isOrganizationSelected(org.uid) ? \'fa fa-toggle-on\' : \'fa fa-toggle-off\'" ng-click="toggleSelectOrganization(org.uid)" tooltip="{{isOrganizationSelected(org.uid) ? \'disable\' : \'enable\'}}" tooltip-append-to-body="true" />\n    </div>\n  </div>\n</div>'),t.put("widgets-settings/param-selector.tmpl.html",'<span class="settings param-selector">\n	<a ng-click="toggleShowOptions()">{{selected.label | titleize | truncate : getTruncateValue() : "..." : false}} <i class="fa fa-chevron-down" /></a>\n	<div class="options-container" collapse="!showOptions">\n		<div ng-repeat="option in options" ng-click="selectOption(option)">\n			{{option.label | titleize}}\n		</div>\n	</div>\n</span>'),t.put("widgets-settings/params-checkboxes.tmpl.html",'<div ng-repeat="parameter in options track by $index" class="settings params-checkboxes">\n  <label>\n    <input type="checkbox" ng-model="parameter.value" ng-change="parameter.onChangeCallback()">\n    <span>{{parameter.label}}</span>\n  </label>\n</div>\n'),t.put("widgets-settings/params-picker.tmpl.html",'<h5>{{formattedParam | titleize}}</h5>\n<div class="settings params-picker">\n  <div style="margin-bottom: 8px;">\n    The selected criteria will be displayed in this order (drag/drop to modify):\n  </div>\n  <div ui:sortable="sortableOptions" ng-model="options" class="input-group">\n    <span ng-repeat="parameter in options track by $index" class="parameter" ng-class="!parameter.selected ? \'unchecked\' : \'\'">\n      <span class="badge">{{$index + 1}}</span>\n      {{parameter.label | titleize}}\n      <input type="checkbox" ng-model="parameter.selected" />\n    </span>\n  </div>\n</div>'),t.put("widgets-settings/time-range.tmpl.html",'<h5>Time range</h5>\n<div class="settings time-range">\n	<div class="row">\n	  <div class="col-md-12">\n	    Show last {{numberOfPeriods}} {{periodToUnit()}}\n	  </div>\n	</div>\n	<div class="row input-group" align="center" style="margin: 0; margin-top: 3px;">\n	  <div class="col-xs-6" style="padding: 0; padding-right: 5px;">\n	    <select ng-model="selectedPeriod" ng-options="period.toLowerCase() for period in PERIODS track by period" class="form-control" style="height: 22px; margin-top: 0; padding: 0; padding-left: 1px; padding-bottom: 1px;"></select>\n	  </div>\n	  <div class="col-xs-6" style="padding: 0;">\n	    <input type="range" ng-model="numberOfPeriods" min="1" max="12" step="1">\n	  </div>\n	</div>\n</div>'),t.put("widgets-settings/width.tmpl.html",'<i class="fa fa-angle-double-left reduce" ng-show="expanded" ng-click="parentWidget.toggleExpanded()" tooltip="reduce"/>\n<i class="fa fa-angle-double-right expand" ng-hide="expanded" ng-click="parentWidget.toggleExpanded()" tooltip="expand"/>')
}])}(),function(){"use strict";angular.module("impac.filters.mno-currency",[]).filter("mnoCurrency",["$filter",function(t){return function(e,n,i){var a;if(null==i&&(i=!0),null!=e){if(a=t("currency")(e),a=a.replace("(","-"),a=a.replace(")",""),null!=n){if("EUR"===n)return a=a.replace("$",""),a=a.replace(","," "),a=a.replace(".",","),a+" €";"AUD"!==n&&"USD"!==n&&(a=a.replace("$",""),n.match(/[A-Z]{3}/)||"%"===n||"(ratio)"===n||(a=parseInt(a)))}return i&&null!=n?a+" "+n:a}return""}}])}.call(this),function(){"use strict";angular.module("impac.filters.mno-date",[]).filter("mnoDate",["$filter",function(t){return function(e,n){var i;if(i=["DAILY","WEEKLY","MONTHLY","QUARTERLY","YEARLY"],null==e)return"";switch(null!=n&&_.includes(i,n.toUpperCase())||(n="MONTHLY"),n.toUpperCase()){case"DAILY":return t("date")(e,"dd MMM");case"WEEKLY":return t("date")(e,"dd MMM");case"MONTHLY":return t("date")(e,"MMM yyyy");case"QUARTERLY":return t("date")(e,"MMM yyyy");case"YEARLY":return t("date")(e,"yyyy")}}}])}.call(this),function(){"use strict";angular.module("impac.filters.titleize",[]).filter("titleize",function(){return function(t){return t=void 0===t||null===t?"":t,t.toString().toLowerCase().replace(/\b([a-z])/g,function(t){return t.toUpperCase()})}})}.call(this),function(){"use strict";angular.module("impac.filters.truncate",[]).filter("truncate",function(){return function(t,e,n,i){var a;return t?(e=parseInt(e,10))?t.length<=e?t:(t=t.substr(0,e),i&&(a=t.lastIndexOf(" "),-1!==a&&(t=t.substr(0,a))),t+(n||"…")):t:""}})}.call(this),function(){"use strict";angular.module("impac.services.assets",[]).provider("ImpacAssets",function(){var t,e,n;return n=this,e={dataNotFound:null,impacTitleLogo:null,impacDashboardBackground:null,noWarning:!1},n.configure=function(t){return angular.extend(e,t)},t=function(t){var n;return n=this,n.get=function(n){var i,a;return a="",i="impac-angular warning: There are missing assets ("+n+"), please refer to the including assets section in the docs.",null!=e[n]?a=e[n]:e.noWarning||t.warn(i),a},n},t.$inject=["$log"],n.$get=t,n})}.call(this),function(){"use strict";angular.module("impac.components.chart",[]).directive("impacChart",["$log","$window",function(t,e){return{restrict:"A",scope:{drawTrigger:"=",deferred:"="},link:function(n,i){return n.draw=function(t){var e,n;return null==t.options.showXLabels||t.options.showXLabels||angular.merge(t.options,{scales:{xAxes:[{display:!1}]}}),i.children().length>0&&i.children().remove(0),i.append("<canvas></canvas>"),e=i.children()[0],n=e.getContext("2d"),new Chart(n,t)},n.drawTrigger.then(function(){return t.warn("chart promise has been resolved: use notify instead")},function(e){return t.error(e)},function(t){var a,s,r;return r=e.navigator.userAgent,a=-1!==r.indexOf("Safari")&&!(-1!==r.indexOf("Chrome")),a?(s=function(){var e;return e=$(i).is(":visible"),e?n.draw(t):setTimeout(function(){return s()},100)},s()):n.draw(t)}),n.deferred.resolve("chart ready")}}}])}.call(this),function(){"use strict";angular.module("impac.services.chart-formatter",[]).service("ChartFormatterSvc",["ImpacTheming","$filter","$window","$document","ImpacDashboardsSvc",function(t,e,n,i,a){var s,r,o,l,d,c,u,g;r=this,s=t.get().chartColors,n.onblur=function(){return angular.element(i[0].getElementById("chartjs-tooltip")).remove()},this.getPositiveColor=function(){return s.positive},this.getNegativeColor=function(){return s.negative},this.getOthersColor=function(){return s.others},this.getColor=function(t){return s.array[t%s.array.length]},o=function(t){return t.replace(/#/,"")},c=function(t){return parseInt(o(t).substring(0,2),16)},d=function(t){return parseInt(o(t).substring(2,4),16)},l=function(t){return parseInt(o(t).substring(4,6),16)},u=function(t){return[c(t),d(t),l(t)].join(",")},g=function(t,e){return"rgba("+u(t)+","+e+")"},this.customTooltip=function(t){var e,n,i,a,s,r;return r=angular.element("#chartjs-tooltip"),r[0]||(angular.element("body").append('<div id="chartjs-tooltip"></div>'),r=angular.element("#chartjs-tooltip")),t.opacity?(r.removeClass("above below no-transform"),t.yAlign?r.addClass(t.yAlign):r.addClass("no-transform"),t.body&&(n=_.compact([(t.beforeTitle||[]).join("<br/>"),(t.title||[]).join("<br/>"),(t.afterTitle||[]).join("<br/>"),(t.beforeBody||[]).join("<br/>"),(t.body||[]).join("<br/>"),(t.afterBody||[]).join("<br/>"),(t.beforeFooter||[]).join("<br/>"),(t.footer||[]).join("<br/>"),(t.afterFooter||[]).join("<br/>")]),r.html(n.join("<br/>"))),e=angular.element(this._chart.canvas),a=e.offset(),e.bind("mouseleave",function(t){return"chartjs-tooltip"!==t.relatedTarget.id?r.remove():void 0}),r.bind("mouseleave",function(t){return"CANVAS"!==t.relatedTarget.tagName?r.remove():void 0}),r.css({"background-color":"#17262d",color:"white",opacity:1,transition:"opacity 0.5s, top 0.5s, left 0.5s",position:"absolute",width:null!=(s=t.width)?s:(i={},i[t.width+"px"]="auto",i),left:a.left+t.x+10+"px",top:a.top+t.y+10+"px",fontFamily:t._fontFamily,fontSize:t.fontSize,fontStyle:t._fontStyle,padding:t.yPadding+"px "+t.xPadding+"px","border-radius":"2px"})):(r.css({opacity:.5}),void 0)},angular.merge(Chart.defaults.global,{defaultColor:r.getColor(0),tooltips:{titleFontFamily:"Lato, 'Helvetica Neue', Helvetica, Arial, sans-serif",bodyFontFamily:"Lato, 'Helvetica Neue', Helvetica, Arial, sans-serif",footerFontFamily:"Lato, 'Helvetica Neue', Helvetica, Arial, sans-serif",enabled:!1,custom:r.customTooltip},elements:{point:{hitRadius:8,hoverRadius:8},line:{tension:0,borderWidth:2}}}),angular.merge(Chart.defaults.scale,{ticks:{beginAtZero:!0,minRotation:0,fontFamily:"Lato, 'Helvetica Neue', Helvetica, Arial, sans-serif"},scaleLabel:{fontFamily:"Lato, 'Helvetica Neue', Helvetica, Arial, sans-serif"}}),this.setTooltipsTextLayout=function(t,n){return null==n&&(n=!1),angular.merge(t,{tooltips:{callbacks:{title:function(t,e){var i;return n?(i=[e.labels[t[0].index]],e.datasets[t[0].datasetIndex].label&&i.push(e.datasets[t[0].datasetIndex].label),i.join(" | ")):e.labels[t[0].index]},label:function(n,i){var s;return s=t.currency||a.getCurrentDashboard().currency,"hide"!==s?e("mnoCurrency")(i.datasets[n.datasetIndex].data[n.index],s):i.datasets[n.datasetIndex].data[n.index]}}}})},this.lineChart=function(t,e,n){var i,a,s;return null==e&&(e={}),null==n&&(n=!1),r.setTooltipsTextLayout(e,!0),i=0,a=1===t.length,s=!1,t[0].labels.length<2&&(s=!0,t[0].labels.push(t[0].labels[0])),(t.length>1||null!=e.pointDot&&!e.pointDot||s)&&angular.merge(e,{elements:{point:{radius:1e-4},line:{tension:.3}}}),{type:"line",options:e,data:{labels:t[0].labels,datasets:_.map(t,function(t){var e;return s&&t.values.push(t.values[0]),e=n?0===i?r.getNegativeColor():r.getPositiveColor():r.getColor(i),i++,{label:t.title,data:t.values,fill:a,backgroundColor:g(e,.3),borderColor:e,pointBorderColor:e,pointBackgroundColor:e,pointHoverBackgroundColor:"rgb(255,255,255)"}})}}},this.barChart=function(t,e,n){var i,a,s,o,l,d;for(null==e&&(e={}),null==n&&(n=!0),r.setTooltipsTextLayout(e),s=0,i=[],l=t.values,a=0,o=l.length;o>a;a++)d=l[a],n&&(t.values[s]=Math.abs(d)),i.push(r.getColor(s)),s++;return{type:"bar",options:e,data:{labels:t.labels,datasets:[{backgroundColor:i,data:t.values}]}}},this.combinedBarChart=function(t,e,n){var i,a;return null==e&&(e={}),null==n&&(n=!0),r.setTooltipsTextLayout(e,!0),i=0,a={type:"bar",options:e,data:{labels:t.labels,datasets:_.map(t.datasets,function(t){var e,a,s,o,l;if(e=r.getColor(i),i++,n)for(o=t.values,a=0,s=o.length;s>a;a++)l=o[a],l=Math.abs(l);return{label:t.title,data:t.values,backgroundColor:e}})}}},this.pieChart=function(t,e,n){var i,a,s,o,l,d,c;if(null==e&&(e={}),null==n&&(n=!1),r.setTooltipsTextLayout(e),o=0,i=[],n)for(i.push(r.getNegativeColor()),s=0,d=t.length;d>s;s++)a=t[s],0!==o&&i.push(r.getPositiveColor()),o++;else for(l=0,c=t.length;c>l;l++)a=t[l],i.push(r.getColor(o)),o++;return{type:"doughnut",options:e,data:{datasets:[{data:_.map(t,function(t){return Math.abs(t.value)}),backgroundColor:i}],labels:_.map(t,function(t){return t.label})}}}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.dashboard",[]),t.controller("ImpacDashboardCtrl",["$scope","$http","$q","$filter","$modal","$log","$timeout","$templateCache","MsgBus","ImpacUtilities","ImpacAssets","ImpacTheming","ImpacRoutes","ImpacMainSvc","ImpacDashboardsSvc","ImpacWidgetsSvc",function(t,e,n,i,a,s,r,o,l,d,c,u,g,h,p,m){var f,v;return t.currentDhb=p.getCurrentDashboard(),t.widgetsList=p.getWidgetsTemplates(),t.impacTitleLogo=c.get("impacTitleLogo"),t.impacDashboardBackground=c.get("impacDashboardBackground"),t.showDhbHeading=u.get().dhbConfig.showDhbHeading,t.dhbHeadingText=u.get().dhbConfig.dhbHeadingText,t.dhbErrorsConfig=u.get().dhbErrorsConfig,t.dhbSettingsConfig=u.get().dhbSettings,t.showKpisBar=u.get().dhbKpisConfig.enableKpis,t.showChooseDhbMsg=function(){return!p.isThereADashboard()},t.showNoWidgetsMsg=function(){return p.isCurrentDashboardEmpty()&&u.get().showNoWidgetMsg},t.starWizardModal={value:!1},l.publish("starWizardModal",t.starWizardModal),t.openStarWizard=function(){return t.starWizardModal.value=!0},t.marketplaceMyobLink=u.get().dhbSubMenuConfig.marketplaceMyobLink,t.showSubMenu=!1,t.displaySubMenu=function(){return t.showSubMenu=!0},t.hideSubMenu=function(){return t.showSubMenu=!1},t.myobMessageConfig=u.get().dhbSubMenuConfig.myobMessage,t.isLoading=!0,p.load(!0).then(function(){return t.activateTimer(),t.hasMyobEssentialsOnly=h.config.currentOrganization.has_myob_essentials_only},function(){return t.isLoading=!1}),t.activateTimer=function(){var e,n;return t.isLoading||(t.isLoading=!0),n=t.currentDhb.widgets,e=null!=n?Math.max(100*n.length,500):500,r(function(){return t.isLoading=!1},e)},t.createDashboardModal=t.$new(),t.createDashboardModal.config={backdrop:"static",template:o.get("dashboard/create.modal.html"),size:"md",windowClass:"inverse",scope:t.createDashboardModal},t.createDashboardModal.open=function(){var e;return e=t.createDashboardModal,e.locked?void 0:(e.model={name:""},e.errors="",e.isLoading=!1,e.instance=a.open(e.config),e.instance.rendered.then(function(){return e.locked=!0}),e.instance.result.then(function(){return e.locked=!1},function(){return e.locked=!1}),h.loadOrganizations().then(function(t){return e.organizations=t.organizations,e.currentOrganization=t.currentOrganization,e.selectMode("single")}))},t.createDashboardModal.proceed=function(){var e,n,i;return i=t.createDashboardModal,i.isLoading=!0,e={name:i.model.name},n=[],n="multi"===i.mode?_.select(i.organizations,function(t){return t.$selected}):[{id:h.config.currentOrganization.id}],n.length>0&&(e.organization_ids=_.pluck(n,"id")),p.create(e).then(function(){return i.errors="",i.instance.close()},function(t){return i.isLoading=!1,i.errors=d.processRailsError(t)})},t.createDashboardModal.isProceedDisabled=function(){var e,n,i;return i=t.createDashboardModal,n=_.select(i.organizations,function(t){return t.$selected}),e=_.isEmpty(i.model.name),e||(e=0===n.length),e||(e=0===_.select(n,function(t){return i.canAccessAnalyticsData(t)}).length),i.isLoading||e},t.createDashboardModal.btnBlassFor=function(e){var n;return n=t.createDashboardModal,e===n.mode?"btn btn-sm btn-warning active":"btn btn-sm btn-default"},t.createDashboardModal.selectMode=function(e){var n;return n=t.createDashboardModal,_.each(n.organizations,function(t){return t.$selected=!1}),n.currentOrganization.$selected="single"===e,n.mode=e},t.createDashboardModal.isSelectOrganizationShown=function(){return"multi"===t.createDashboardModal.mode},t.createDashboardModal.isCurrentOrganizationShown=function(){return"single"===t.createDashboardModal.mode},t.createDashboardModal.canAccessAnalyticsForCurrentOrganization=function(){var e;return e=t.createDashboardModal,e.canAccessAnalyticsData(e.currentOrganization)},t.createDashboardModal.isMultiCompanyAvailable=function(){return t.createDashboardModal.organizations.length>1&&t.createDashboardModal.multiOrganizationReporting},t.createDashboardModal.canAccessAnalyticsData=function(t){return t.current_user_role&&("Super Admin"===t.current_user_role||"Admin"===t.current_user_role)},t.customWidgetSelector=u.get().widgetSelectorConfig,t.forceShowWidgetSelector=!1,t.showCloseWidgetSelectorButton=function(){return!p.isCurrentDashboardEmpty()},t.displayWidgetSelector=function(e){return null==e&&(e=!0),t.forceShowWidgetSelector=e},t.showWidgetSelector=function(){return t.forceShowWidgetSelector||p.isCurrentDashboardEmpty()&&!t.customWidgetSelector.path},t.isAddChartEnabled=u.get().addChartTile.show,t.addChartTileOnClick=function(){var e;return e=u.get().addChartTile.onClickOptions.triggers,_.forEach(e,function(e){switch(e.type){case"objectProperty":return t[e.target][e.property]=e.value}})},t.selectedCategory="accounts",t.isCategorySelected=function(e){return null!=t.selectedCategory&&null!=e?t.selectedCategory===e:!1},t.selectCategory=function(e){return t.selectedCategory=e},t.getSelectedCategoryName=function(){if(null==t.selectedCategory)return!1;switch(t.selectedCategory){case"accounts":return"Accounting";case"invoices":return"Invoicing";case"hr":return"HR / Payroll";case"sales":return"Sales";default:return!1}},t.getSelectedCategoryTop=function(){if(null==t.selectedCategory)return!1;switch(t.selectedCategory){case"accounts":return{top:"33px"};case"invoices":return{top:"64px"};case"hr":return{top:"95px"};case"sales":return{top:"126px"};default:return{top:"9999999px"}}},t.getWidgetsForSelectedCategory=function(){return null!=t.selectedCategory&&null!=t.widgetsList?_.select(t.widgetsList,function(e){return e.path.split("/")[0]===t.selectedCategory}):[]},t.addWidget=function(e,n){var i;return null==n&&(n=null),i={widget_category:e},null!=n&&angular.extend(i,{metadata:n}),angular.element("#widget-selector").css("cursor","progress"),angular.element("#widget-selector .top-container .row.lines p").css("cursor","progress"),m.create(i).then(function(){return t.errors="",angular.element("#widget-selector").css("cursor","auto"),angular.element("#widget-selector .top-container .row.lines p").css("cursor","pointer"),angular.element("#widget-selector .badge.confirmation").fadeTo(250,1),r(function(){return angular.element("#widget-selector .badge.confirmation").fadeTo(700,0)},4e3)},function(e){return t.errors=d.processRailsError(e),angular.element("#widget-selector").css("cursor","auto"),angular.element("#widget-selector .top-container .row.lines p").css("cursor","pointer")})},t.widgetSuggestionModal=t.$new(),t.widgetSuggestionModal.widgetDetails={},t.widgetSuggestionModal.error=!1,t.widgetSuggestionModal.onSuccess=!1,t.widgetSuggestionModal.config={backdrop:"static",template:o.get("dashboard/widget-suggestion.modal.html"),size:"md",windowClass:"inverse impac-widget-suggestion",scope:t.widgetSuggestionModal,apiPath:g.widgets.suggest()},t.widgetSuggestionModal.open=function(){var e;return e=t.widgetSuggestionModal,e.locked?void 0:(h.loadUserData().then(function(t){return e.userName=t.name}),e.instance=a.open(e.config),e.instance.rendered.then(function(){return e.locked=!0}),e.instance.result.then(function(){return e.locked=!1},function(){return e.locked=!1}),e.isLoading=!1)},t.widgetSuggestionModal.proceed=function(){var n,i;return i=t.widgetSuggestionModal,i.isLoading=!0,n={widget_name:i.widgetDetails.name,widget_category:i.widgetDetails.category,widget_description:i.widgetDetails.description},null!=i.config.apiPath?e.post(i.config.apiPath,{template:"widget_suggestion",opts:n}).then(function(){return i.onSuccess=!0,r(function(){return i.instance.close(),i.widgetDetails={},i.isLoading=!1,i.onSuccess=!1},3e3)},function(t){return i.isLoading=!1,i.error=!0,s.error("impac-angular ERROR: Unable to POST widget_suggestion mailer: ",t)}):void 0},t.sortableOptions={stop:f=function(){var e;return e={widgets_order:_.pluck(t.currentDhb.widgets,"id")},p.update(t.currentDhb.id,e)},start:v=function(t,e){return e.placeholder.css("width",e.item.width()-1),e.placeholder.css("height",e.item.height())},cursorAt:{left:100,top:20},opacity:.5,delay:150,tolerance:"pointer",placeholder:"placeHolderBox",cursor:"move",revert:250,cancel:".unsortable",handle:".top-line"}}]),t.directive("impacDashboard",["$templateCache",function(t){return{restrict:"EA",scope:{forceLoad:"=load"},template:t.get("dashboard/dashboard.tmpl.html"),controller:"ImpacDashboardCtrl"}}])}.call(this),function(){"use strict";angular.module("impac.components.dashboard-selector",[]).directive("dashboardSelector",["$log","$compile","$templateCache","$http","$timeout","$modal","ImpacTheming","ImpacDashboardsSvc","ImpacMainSvc","ImpacUtilities",function(t,e,n,i,a,s,r,o,l,d){return{restrict:"E",scope:{onCreateDashboard:"&",isWidgetSelectorShown:"&",onDisplayWidgetSelector:"&",onSelectDashboard:"&"},controller:["$scope",function(t){return t.organizationsNames=function(){return _.pluck(t.currentDhb.data_sources,"label").join(", ")},t.toggleShowDashboardsDropdown=function(){return t.showChangeDashboardNameBox?void 0:t.showDashboardsDropdown=o.areThereSeveralDashboards()||t.showCreateDashboardButton?!t.showDashboardsDropdown:!1},t.selectDashboard=function(e){return t.currentDhb.id!==e?(t.isLoading=!0,t.showDashboardsDropdown=!1,a(function(){return t.$apply(function(){return o.setCurrentDashboard(e),t.onSelectDashboard(),t.isLoading=!1})},50)):void 0},t.toggleChangeDashboardNameBox=function(e){var n;return n=angular.copy(e),t.dashboardToChange={},t.dashboardToChange.id=n.id,t.dashboardToChange.name=n.full_name,t.showChangeDashboardNameBox=!t.showChangeDashboardNameBox,a(function(){var t;return t=$("#changeDhbNameInput"),t.select(),t.focus()},100)},t.hideChangeDashboardNameBox=function(){return t.showChangeDashboardNameBox=!1},t.checkAndUpdateDashboardName=function(e){return 13===e.keyCode&&t.updateDashboardName(),27===e.keyCode?t.showChangeDashboardNameBox=!1:void 0},t.updateDashboardName=function(){return null==t.dashboardToChange||_.isEmpty(t.dashboardToChange.name)?void 0:o.update(t.dashboardToChange.id,{name:t.dashboardToChange.name}).then(function(){return t.showChangeDashboardNameBox=!1})},t.toggleAccessibilityMode=function(){return t.accessibilityMode=!t.accessibilityMode,angular.forEach(t.currentDhb.widgets,function(t){return t.loadContent()})},t.deleteDashboardModal=t.$new(),t.deleteDashboardModal.config={backdrop:"static",template:n.get("dashboard-selector/delete.modal.html"),size:"md",windowClass:"inverse",scope:t.deleteDashboardModal},t.deleteDashboardModal.open=function(){var e;return e=t.deleteDashboardModal,e.locked?void 0:(e.errors="",e.isLoading=!1,e.instance=s.open(e.config),e.instance.rendered.then(function(){return e.locked=!0}),e.instance.result.then(function(){return e.locked=!1},function(){return e.locked=!1}))},t.deleteDashboardModal.proceed=function(){var e;return e=t.deleteDashboardModal,e.isLoading=!0,o["delete"](t.currentDhb.id).then(function(){return e.errors="",e.instance.close()},function(t){return e.errors=d.processRailsError(t),e.isLoading=!1})},t}],link:function(a,s){var l,d,c,u,g,h,p;switch(a.currentDhb=o.getCurrentDashboard(),a.dashboardsList=o.getDashboards(),a.isThereADashboard=function(){return o.isThereADashboard()},g=r.get().dhbSelectorConfig,a.isAccessibilityEnabled=g.accessibilityEnabled,a.isAddWidgetEnabled=g.addWidgetEnabled,a.isAddDhbEnabled=g.addDhbEnabled,a.isDeleteDhbEnabled=g.deleteDhbEnabled,a.showCreateDashboardButton=!0,a.showDashboardsDropdown=!1,a.showChangeDashboardNameBox=!1,a.accessibilityMode=!1,g.customTmplPath?d=g.customTmplPath:a.selectorType=g.selectorType,h=null,p=function(t){return h=t},a.selectorType){case"dropdown":p("dashboard-selector/dropdown.tmpl.html");break;case"tabs":p("dashboard-selector/bootstrap-tabs.tmpl.html");break;case"pills":p("dashboard-selector/bootstrap-tabs.tmpl.html");break;default:p(d)}return c=function(){return i.get(h,{cache:n}).then(function(e){return e&&e.data&&e.data.length||t.warn("dashboardSelector custom template: no content found"),l(e.data)},function(e){return t.error("Error retrieving custom template: ",e)})},u=function(){return l(n.get(h))},l=function(t){return s.html(t).show(),e(s.contents())(a)},d?c():u()}}}])}.call(this),function(){"use strict";angular.module("impac.services.dashboards",[]).service("ImpacDashboardsSvc",["$q","$http","$log","$timeout","ImpacMainSvc","ImpacRoutes","ImpacKpisSvc","ImpacTheming",function(t,e,n,i,a,s,r,o){var l,d,c,u;return l=this,this.config={},this.config.dashboards=[],this.getDashboards=function(){return l.config.dashboards},this.config.currentDashboard={},this.getCurrentDashboard=function(){return l.config.currentDashboard},this.config.widgetsTemplates=[],this.getWidgetsTemplates=function(){return l.config.widgetsTemplates},this.callbacks={},this.callbacks.dashboardChanged=t.defer(),this.dashboardChanged=function(){return l.callbacks.dashboardChanged.promise},this.callbacks.widgetAdded=t.defer(),this.widgetAdded=function(){return l.callbacks.widgetAdded.promise},c=function(){return _.isEmpty(l.config.dashboards)||_.isEmpty(l.config.currentDashboard)},this.isThereADashboard=function(){return!_.isEmpty(l.config.currentDashboard)},this.areThereSeveralDashboards=function(){return l.config.dashboards.length>1},this.isCurrentDashboardEmpty=function(){return l.isThereADashboard()&&_.isEmpty(l.config.currentDashboard.widgets)},this.areKpisEnabled=function(){return o.get().dhbKpisConfig.enableKpis},this.loadLocked=!1,this.load=function(r){var o;return null==r&&(r=!1),l.loadLocked?(n.warn("ImpacDashboardsSvc.load locked. Trying again in 1s"),i(function(){return l.load(r)},1e3)):(l.loadLocked=!0,o=t.defer(),c()||r?a.loadOrganizations(r).then(function(t){var i;return i=t.currentOrganization.id,e.get(s.dashboards.index()).then(function(t){return l.setDashboards(t.data).then(function(){return l.setCurrentDashboard(),l.loadLocked=!1,o.resolve(l.config)}),function(t){return l.loadLocked=!1,o.reject(t)}},function(t){return n.error("Impac - DashboardSvc: cannot retrieve dashboards list for org: "+i),l.loadLocked=!1,o.reject(t)})},function(t){return n.error("Impac - DashboardSvc: cannot retrieve current organization"),l.loadLocked=!1,o.reject(t)}):(l.loadLocked=!1,o.resolve(l.config)),o.promise)},u=function(){return null!=l.config.dashboards&&l.config.dashboards.length>0?(n.info("Impac - DashboardSvc: first dashboard set as current by default"),a.override(l.config.currentDashboard,l.config.dashboards[0]),l.setWidgetsTemplates(l.config.currentDashboard.widgets_templates),l.areKpisEnabled()&&r.initialize(l.config.currentDashboard),l.initializeActiveTabs(),l.callbacks.dashboardChanged.notify(l.config.currentDashboard),!0):(n.warn("Impac - DashboardSvc: cannot set default current dashboard"),a.override(l.config.currentDashboard,{}),l.callbacks.dashboardChanged.notify(!1),!1)},this.setCurrentDashboard=function(t){var e;return null==t&&(t=null),null!=t?(e=_.find(l.config.dashboards,function(e){return t===e.id}),_.isEmpty(e)?(n.error("Impac - DashboardSvc: dashboard: "+t+" not found in dashboards list"),u()):(a.override(l.config.currentDashboard,e),l.setWidgetsTemplates(e.widgets_templates),l.areKpisEnabled()&&r.initialize(l.config.currentDashboard),l.initializeActiveTabs(),l.callbacks.dashboardChanged.notify(l.config.currentDashboard),!0)):u()},d=function(t,e){return _.includes(_.pluck(t.data_sources,"id"),e.id)},this.setDashboards=function(t){return null==t&&(t=[]),a.loadOrganizations().then(function(e){var n,i,a,s,r;for(n=e.currentOrganization,_.remove(l.config.dashboards,function(){return!0}),r=[],a=0,s=t.length;s>a;a++)i=t[a],d(i,n)?r.push(l.config.dashboards.push(i)):r.push(void 0);return r},function(){return n.error("Impac - DashboardSvc: Cannot load user's organizations")})},this.setWidgetsTemplates=function(t){var e,n,i;if(_.isEmpty(t)||!_.isEmpty(l.config.widgetsTemplates))return!1;for(e=0,n=t.length;n>e;e++)i=t[e],l.config.widgetsTemplates.push(i);return!0},this.initializeActiveTabs=function(){var t,e,n,i,a;for(i=l.config.dashboards,a=[],e=0,n=i.length;n>e;e++)t=i[e],a.push(_.merge(t,{active:l.config.currentDashboard.id===t.id}));return a},this.create=function(i){return l.load().then(function(){var r,o;return o=t.defer(),null==i.currency&&(i.currency=a.config.currentOrganization.currency||"USD"),r={dashboard:i},e.post(s.dashboards.create(),r).then(function(t){return l.config.dashboards.push(t.data),l.setCurrentDashboard(t.data.id),o.resolve(t.data)},function(t){return n.error("Impac - DashboardSvc: cannot create dashboard with parameters: "+angular.toJson(i),t),o.reject(t)}),o.promise})},this["delete"]=function(i){var a;return a=t.defer(),e["delete"](s.dashboards["delete"](i)).then(function(t){return _.remove(l.config.dashboards,function(t){return i===t.id}),l.setCurrentDashboard(),a.resolve(t)},function(t){return n.error("Impac - DashboardSvc: cannot delete dashboard: "+i),a.reject(t)}),a.promise},this.update=function(i,a){var r,o;return o=t.defer(),r={dashboard:a},e.put(s.dashboards.update(i),r).then(function(t){return angular.merge(_.find(l.config.dashboards,function(t){return i===t.id}),t.data),i===l.config.currentDashboard.id&&angular.merge(l.config.currentDashboard,t.data),o.resolve(t.data)},function(t){return n.error("Impac - DashboardSvc: cannot update dashboard: "+i+" with parameters: "+a),o.reject(t)}),o.promise},l}])}.call(this),function(){"use strict";angular.module("impac.components.kpi",[]).directive("impacKpi",["$log","ImpacKpisSvc",function(t,e){return{restrict:"EA",scope:{onDelete:"&",kpi:"=",editMode:"="},templateUrl:"kpi/kpi.tmpl.html",controller:["$scope",function(t){return t.showEditSettings=!1,t.kpiTemplates=e.getKpisTemplates(),t.possibleExtraParams=[],t.limit={},t.possibleTargets=[{label:"over",mode:"min"},{label:"below",mode:"max"}],t.kpi["static"]||e.show(t.kpi).then(function(){var e,n;return n=_.find(t.kpiTemplates,function(e){return e.endpoint===t.kpi.endpoint}),null!=n&&null!=n.extra_params&&(t.kpi.possibleExtraParams=n.extra_params),(e=t.kpi).targets||(e.targets=[]),_.isEmpty(t.kpi.targets[0])?void 0:(null==t.kpi.limit&&(t.kpi.limit={}),t.kpi.limit.mode=_.keys(t.kpi.targets[0])[0],t.kpi.limit.value=_.values(t.kpi.targets[0])[0])}),t.displayEditSettings=function(){return t.showEditSettings=!0},t.hideEditSettings=function(){return t.showEditSettings=!1},t.updateName=function(){return _.isEmpty(t.kpi.name)?void 0:e.update(t.kpi,{name:t.kpi.name})},t.updateSettings=function(){var n,i;return n={},_.isEmpty(t.kpi.limit.value||_.isEmpty(t.kpi.limit.mode))||(i={},i[t.kpi.limit.mode]=t.kpi.limit.value,n.targets=[i]),_.isEmpty(t.kpi.extra_params)||(n.extra_params=t.kpi.extra_params),_.isEmpty(n)||e.update(t.kpi,n),t.hideEditSettings()},t.deleteKpi=function(){return t.kpi["static"]?void 0:e["delete"](t.kpi).then(function(){return t.onDelete()})}}]}}])}.call(this),function(){"use strict";angular.module("impac.services.kpis",[]).service("ImpacKpisSvc",["$log","$http","$filter","$q","ImpacRoutes","ImpacMainSvc",function(t,e,n,i,a,s){var r,o,l,d,c;return r=this,this.config={},this.config.ssoSessionId="",this.getSsoSessionId=function(){return r.config.ssoSessionId},this.config.kpisTemplates=[],this.getKpisTemplates=function(){return r.config.kpisTemplates},this.config.currentDashboardId="",this.getCurrentDashboardId=function(){return r.config.currentDashboardId},o=function(t,e,n,i){var a,s;return a=[t,e,n].join("/"),s=[a,decodeURIComponent($.param(i))].join("?")},c=function(){return!_.isEmpty(r.config.ssoSessionId||_.isEmpty(r.config.kpisTemplates||_.isEmpty(r.config.currentDashboardId)))},d=function(){var t;return t=e.defaults.headers.common.Authorization,t&&"string"==typeof t&&t.length},this.load=function(t){var e;return null==t&&(t=!1),e=i.defer(),_.isEmpty(r.config.ssoSessionId)||t?s.loadUserData(t).then(function(t){return r.config.ssoSessionId=t.sso_session,e.resolve(r.config)},function(t){return e.reject(t)}):e.resolve(r.config),e.promise},this.initialize=function(n){return r.load().then(function(){var s,o,d;return r.config.currentDashboardId=n.id,s=_.pluck(n.data_sources,"uid"),o={},o.metadata={organization_ids:s},r.config.ssoSessionId&&(o.metadata.sso_session=r.config.ssoSessionId),d={impac:l(o)},a.kpis.local()&&(d.local=e.get(a.kpis.local())),i.all(d).then(function(t){var e,n,i,a,s,o,l,d;for(_.remove(r.config.kpisTemplates,function(){return!0}),s=t.impac.data.kpis,e=0,i=s.length;i>e;e++)d=s[e],d.source||(d.source="impac"),r.config.kpisTemplates.push(d);if(t.local){for(o=t.local.data.kpis,l=[],n=0,a=o.length;a>n;n++)d=o[n],d.source="local",l.push(r.config.kpisTemplates.push(d));return l}},function(e){return t.error("ImpacKpisSvc - cannot retrieve kpis templates list",e)})})},l=function(t){var n,i;return n=a.kpis.index(),i=[n,decodeURIComponent($.param(t))].join("?"),e.get(i)},this.show=function(n){var s,l,u,g;if(s=i.defer(),c()||d()){switch(u={},r.config.ssoSessionId&&(u.sso_session=r.config.ssoSessionId),null!=n.targets&&(u.targets=n.targets),null!=n.settings&&(u.metadata=n.settings),null!=n.extra_params&&(u.extra_params=n.extra_params),n.source){case"impac":l=a.kpis.show(r.config.currentDashboardId,n.id);break;case"local":l=a.kpis.local()}g=o(l,n.endpoint,n.element_watched,u),e.get(g).then(function(t){var e,i;return n.data||(n.data={}),angular.extend(n.data,_.pick(t.data.kpi,["value","unit","results"])),i=t.data.kpi.configuration||{},e=_.select(["targets","extra_params"],function(t){return null==n[t]&&null!=i[t]}),angular.extend(n,_.pick(i,e)),s.resolve(n)},function(e){return t.error("impac-angular ERROR: Could not retrieve KPI at: "+n.endpoint,e),s.reject(e)})}else t.error("ImpacKpisSvc - Service not initialized"),s.reject({error:{message:"ImpacKpisSvc is not initialized"}});return s.promise},this.create=function(t,n,s){var o,l,u;return o=i.defer(),c()||d()?(l={source:t,endpoint:n,element_watched:s},u=a.kpis.create(r.config.currentDashboardId),e.post(u,{kpi:l}).then(function(t){return o.resolve(t.data)},function(t){return o.reject(t)})):o.reject({error:{message:"ImpacKpisSvc is not initialized"}}),o.promise},this.update=function(n,s){var o,l,d;return o=i.defer(),l={},null!=s.name&&(l.name=s.name),null!=s.metadata&&(l.settings=s.metadata),null!=s.targets&&(l.targets=s.targets),null!=s.extra_params&&(l.extra_params=s.extra_params),d=a.kpis.update(r.config.currentDashboardId,n.id),_.isEmpty(l)||e.put(d,{kpi:s}).then(function(t){return angular.extend(n,t.data),r.show(n),o.resolve(n)},function(e){return t.error("impac-angular ERROR: Unable to update KPI ",e),o.reject(e)}),o.promise},this["delete"]=function(t){var n,s;return n=i.defer(),s=a.kpis["delete"](r.config.currentDashboardId,t.id),e["delete"](s).then(function(t){return n.resolve(t)},function(t){return n.reject(t)}),n.promise},this}])}.call(this),function(){"use strict";angular.module("impac.components.kpis-bar",[]).directive("kpisBar",["$templateCache","ImpacKpisSvc",function(t,e){return{restrict:"E",scope:{kpis:"="},template:t.get("kpis-bar/kpis-bar.tmpl.html"),controller:["$scope","$timeout","$log",function(t,n,i){return t.hideAvailableKpis=!0,t.showKpisExpanded=!1,t.showEditMode=!1,t.isAddingKPI=!1,t.availableKpis=e.getKpisTemplates(),t.toggleAvailableKpis=function(){return t.hideAvailableKpis=!t.hideAvailableKpis},t.formatKpiName=function(t){var e,n;return e=t.split("/"),n=e[0]+" | "+e.slice(1,e.length).join(" "),n=n.replace("_"," ")},t.addKpi=function(n){return t.isAddingKPI=!0,e.create(n.source||"impac",n.endpoint,n.element_watched).then(function(e){return t.kpis.push(e)},function(t){return i.error("Impac Kpis bar can't add a kpi",t)})["finally"](function(){return t.isAddingKPI=!1})},t.removeKpi=function(e){return t.kpis=_.remove(t.kpis,function(t){return t.id!==e})},t.toggleEditMode=function(){return t.showEditMode=!t.showEditMode}}]}}])}.call(this),function(){"use strict";angular.module("impac.services.linking",[]).provider("ImpacLinking",function(){var t,e,n;return n=this,e={user:null,organizations:null},n.linkData=function(t){return _.forIn(e,function(n,i){var a;if(a=t[i],null==a)throw new Error("impac-angular linking.svc: Missing core data ("+i+") to run impac-angular.");if("function"!=typeof a)throw new TypeError("impac-angular linking.svc: "+i+" should be a Function.");
return e[i]=a})},t=function(t){var n;return n=this,n.getUserData=function(){return e.user().then(function(t){return t},function(e){return t.reject(e)})},n.getOrganizations=function(){return e.organizations().then(function(t){return t},function(e){return t.reject(e)})},n},t.$inject=["$q"],n.$get=t,n})}.call(this),function(){"use strict";angular.module("impac.services.main",[]).service("ImpacMainSvc",["$q","$log","ImpacLinking",function(t,e,n){var i,a,s;return i=this,this.config={},this.config.organizations=[],this.config.currentOrganization={},this.config.userData={},this.config.currencies=["USD","AUD","CAD","CNY","EUR","GBP","HKD","INR","JPY","NZD","SGD","PHP","AED","IDR"],a=function(){return!(_.isEmpty(i.config.organizations)||_.isEmpty(i.config.currentOrganization||_.isEmpty(i.config.userData)))},this.load=function(n){var s;return null==n&&(n=!1),s=t.defer(),!a()||n?t.all([i.loadOrganizations(n),i.loadUserData(n)]).then(function(){return s.resolve(i.config)},function(t){return e.error("ImpacMainSvc: failed to load configuration"),s.reject(t)}):s.resolve(i.config),s.promise},this.loadOrganizations=function(a){var s;return null==a&&(a=!1),s=t.defer(),_.isEmpty(i.config.organizations)||_.isEmpty(i.config.currentOrganization)||a?n.getOrganizations().then(function(t){return null!=t.organizations&&t.organizations.length>0?(i.config.organizations=t.organizations,i.setCurrentOrganization(t.currentOrgId)):(i.config.organizations=[],i.config.currentOrganization={},e.info("ImpacMainSvc: retrieved empty organizations list")),s.resolve(i.config)},function(t){return e.error("ImpacMainSvc: cannot set organization: "+id+" as currentOrganization"),s.reject(t)}):s.resolve(i.config),s.promise},s=function(){return null!=i.config.organizations&&i.config.organizations.length>0?(i.config.currentOrganization=i.config.organizations[0],e.info("ImpacMainSvc: first organization set as current by default"),!0):(i.config.currentOrganization={},e.error("ImpacMainSvc: cannot set default current organization"),{error:{code:400,message:"cannot set default current organization"}})},this.setCurrentOrganization=function(t){var n;return null==t&&(t=null),null!=t?(n=_.find(i.config.organizations,function(e){return t===e.id}),_.isEmpty(n)?(e.error("ImpacMainSvc: organization: "+t+" not found in organizations list"),s()):(i.config.currentOrganization=n,!0)):s()},this.loadUserData=function(a){var s;return null==a&&(a=!1),s=t.defer(),_.isEmpty(i.config.userData)||a?n.getUserData().then(function(t){return angular.extend(i.config.userData,t),s.resolve(i.config.userData)},function(t){return e.error("ImpacMainSvc: cannot retrieve user data"),s.reject(t)}):s.resolve(i.config.userData),s.promise},this.override=function(t,e){var n,i;for(n in t)i=t[n],delete t[n];for(n in e)i=e[n],t[n]=i;return t},i}])}.call(this),function(){"use strict";angular.module("impac.services.message-bus",[]).service("MsgBus",function(){var t;t={dashboardGrid:{},controlBarFilter:{},controlBarQuickFilter:{},orgaSharingModal:{},appConnectModal:{},page:{},pane:{},errors:[],autostopQueue:[],notificationQueue:[],params:{}},this.publish=function(e,n){return t[e]=n},this.subscribe=function(e){return function(){return t[e]}}})}.call(this),function(){"use strict";angular.module("impac.services.routes",[]).provider("ImpacRoutes",function(){var t,e,n;return n=this,e={mnoHub:"/api/v2",impacPrefix:"/impac",impacApi:"http://localhost:4000/api",dashboards:{index:null,show:null,create:null,update:null,del:null},widgets:{index:null,show:null,create:null,update:null,del:null,suggest:null},kpis:{index:null,show:null,create:null,update:null,del:null,local:null},organizations:{appInstancesSync:null}},n.configureRoutes=function(t){return angular.extend(e,t)},t=function(){var t;return t=this,t.dashboards={index:function(){return e.dashboards.index||""+e.mnoHub+e.impacPrefix+"/dashboards"},show:function(n){return e.dashboards.show?e.dashboards.show.replace(":id",n):t.dashboards.index()+"/"+n},create:function(){return e.dashboards.create||t.dashboards.index()},update:function(n){return e.dashboards.update?e.dashboards.update.replace(":id",n):t.dashboards.index()+"/"+n},"delete":function(n){return e.dashboards.del?e.dashboards.del.replace(":id",n):t.dashboards.index()+"/"+n}},t.widgets={index:function(n){return e.widgets.index?e.widgets.index.replace(":dashboard_id",n):t.dashboards.show(n)+"/widgets"},show:function(t,n){return e.widgets.show?e.widgets.show.replace(":dashboard_id",t).replace(":id",n):e.impacApi+"/v1/get_widget"},create:function(n){return e.widgets.create?e.widgets.create.replace(":dashboard_id",n):t.widgets.index(n)},update:function(n,i){return e.widgets.update?e.widgets.update.replace(":dashboard_id",n).replace(":id",i):t.widgets.index(n)+"/"+i},"delete":function(n,i){return e.widgets.del?e.widgets.del.replace(":dashboard_id",n).replace(":id",i):t.widgets.index(n)+"/"+i},suggest:function(){return e.widgets.suggest}},t.kpis={index:function(t){return e.kpis.index?e.kpis.index.replace(":dashboard_id",t):e.impacApi+"/v2/kpis"},show:function(t,n){return e.kpis.show?e.kpis.show.replace(":dashboard_id",t).replace(":id",n):e.impacApi+"/v2/kpis"},create:function(n){return e.kpis.create?e.kpis.create.replace(":dashboard_id",n):t.dashboards.show(n)+"/kpis"},update:function(n,i){return e.kpis.update?e.kpis.update.replace(":dashboard_id",n).replace(":id",i):t.kpis.create(n)+"/"+i},"delete":function(n,i){return e.kpis.del?e.kpis.del.replace(":dashboard_id",n).replace(":id",i):t.kpis.create(n)+"/"+i},local:function(){return e.kpis.local}},t.organizations={appInstancesSync:function(t){return e.organizations.appInstancesSync?e.organizations.appInstancesSync.replace(":uid",t):e.mnoHub+"/organizations/"+t+"/app_instances_sync"}},t},t.$inject=[],n.$get=t,n})}.call(this),function(){"use strict";angular.module("impac.services.theming",[]).provider("ImpacTheming",function(){var t,e,n;return n=this,e={chartColors:{positive:"#3FC4FF",negative:"#1DE9B6",array:["#1de9b6","#7c4dff","#ffc928","#3fc4ff","#ff8e01","#c6ff00","#d500fa","#ff6e41","#ffeb3c","#ff1844"]},dhbConfig:{showDhbHeading:!1,dhbHeadingText:"Impac!"},dhbSelectorConfig:{selectorType:"dropdown",customTmplPath:null,accessibilityEnabled:!1,addWidgetEnabled:!0,addDhbEnabled:!0,deleteDhbEnabled:!0},dhbKpisConfig:{enableKpis:!1,parentElementId:""},dataNotFoundConfig:{mainMessage:"Data not found",linkMessage:"Are you missing an app?",linkUrl:"/apps",linkTarget:"_blank",linkUrlCallback:null},dhbErrorsConfig:{firstTimeCreated:{first:"It's time to add a reporting dashboard!",second:"In 2 clicks, you'll be able to visualize how your business is performing.",note:"Note: dashboards you create will only be accessible by you. Dashboard sharing across users will be added soon."},empty:{first:"Now it's time to select the metrics you want to see!",second:"Add widgets to your dashboard to help make an Impac!™ to your business."}},dhbSubMenuConfig:{myobMessage:{show:!0,appLink:{show:!0,url:"#/marketplace",text:">> Check this app on our marketplace"}}},widgetSelectorConfig:{path:null},addChartTile:{show:!1,onClickOptions:{triggers:[]}},showNoWidgetMsg:{show:!0},dhbSettings:{inWidgetsContainer:!1,showSyncApps:function(){return!0},currency:{locked:!1}}},n.configure=function(t){return angular.merge(e,t)},t=function(){var t;return t=this,t.get=function(){return e},t},t.$inject=[],n.$get=t,n})}.call(this),function(){"use strict";angular.module("impac.filters.url-helper",[]).filter("urlHelper",function(){return function(t,e){var n,i;if(t&&t.length)return n=function(){return t=[t,e.shift()].join("?"),t=[].concat.apply([],[t,e]).join("&")},i=function(){var t,i,a;for(i=0,t=[],a=Object.keys(e);i<a.length;)t.push(a[i]+"="+e[a[i]]),i++;return e=t,n()},Array.isArray(e)&&n(),"object"!=typeof e||Array.isArray(e)||i(),t}})}.call(this),function(){"use strict";angular.module("impac.services.utilities",[]).service("ImpacUtilities",function(){this.processRailsError=function(t){var e;return e=[],t.status&&401===t.status?e.push("Sorry! You are not authorized to perform this action"):t.data&&" "!==t.data?angular.isArray(t.data)?_.each(t.data,function(t){var n;return n=t.charAt(0).toUpperCase()+t.slice(1),e.push(""+n)}):angular.isObject(t.data)?_.each(t.data,function(t,n){var i;return i=(n.charAt(0).toUpperCase()+n.slice(1)).replace("_"," "),angular.isArray(t)?_.each(t,function(t){return i.match(/base/i)?e.push(t):e.push(i+" "+t)}):i.match(/base/i)?e.push(t):e.push(i+" "+t)}):angular.isString(t.data)?e.push(t.data):e.push("Potentially a system or communication error. Please retry later."):e.push("Potentially a system or communication error. Please retry later."),e}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widget",[]),t.controller("ImpacWidgetCtrl",["$scope","$log","$q","$timeout","ImpacWidgetsSvc",function(t,e,n,i,a){var s;return s=t.widget||{},t.widgetDeferred=n.defer(),t.widgetDeferred.promise.then(function(i){return n.all(i).then(function(){return t.showWidget()},function(t){return s.isLoading=!1,e.error("widget "+s.id+" failed to render"),e.error(t)})}),t.showWidget=function(e){return null==e&&(e=!1),s.isLoading||(s.isLoading=!0),a.show(s,e).then(function(){return t.isAccessibility?(s.initialWidth=s.width,s.width=12):s.initialWidth?s.width=s.initialWidth:void 0})["finally"](function(){return s.isLoading=!1})},t.initSettings=function(){return a.initWidgetSettings(s)},t.updateSettings=function(t){return null==t&&(t=!0),a.updateWidgetSettings(s,t)},s.getColClass=function(){return"col-md-"+s.width}}]),t.directive("impacWidget",["$templateCache",function(t){return{restrict:"A",scope:{parentDashboard:"=",widget:"=",isAccessibility:"=",onDisplayAlerts:"&"},controller:"ImpacWidgetCtrl",link:function(e){return e.widget.isLoading=!0,e.widget.settings=[],e.widget.hasEditAbility=!0,e.widget.hasDeleteAbility=!0,e.widgetContentTemplate=function(){var n,i;return e.widget.metadata.template?e.templateName=e.widget.metadata.template.replace(/\/|_/g,"-"):(n=angular.copy(e.widget.category).split("/"),n.length=2,e.templateName=n.join("-").replace(/_/g,"-")),i="widgets/"+e.templateName+".tmpl.html",e.isAccessibility&&(t.get("widgets/"+e.templateName+".accessible.tmpl.html")&&(i="widgets/"+e.templateName+".accessible.tmpl.html"),e.templateName=e.templateName+" accessible"),i}},template:t.get("widget/widget.tmpl.html")}}])}.call(this),function(){"use strict";angular.module("impac.services.widgets",[]).service("ImpacWidgetsSvc",["$q","$http","$log","ImpacRoutes","ImpacMainSvc","ImpacDashboardsSvc",function(t,e,n,i,a,s){var r,o;return r=this,this.config={},this.config.ssoSessionId="",this.load=function(e){var n;return null==e&&(e=!1),n=t.defer(),_.isEmpty(r.config.ssoSessionId)||e?t.all([a.loadUserData(e),s.load(e)]).then(function(t){return r.config.ssoSessionId=t[0].sso_session,n.resolve(r.config)},function(t){return n.reject(t)}):n.resolve(r.config),n.promise},this.create=function(a){var o;return o=t.defer(),r.load().then(function(){var t,r;return t=s.getCurrentDashboard(),r={widget:a},e.post(i.widgets.create(t.id),r).then(function(e){var n;return n=e.data,t.widgets.push(n),s.callbacks.widgetAdded.notify(n),o.resolve(n)},function(e){return n.error("ImpacWidgetsSvc: cannot create widget on dashboard "+t.id),o.reject(e)})},function(t){return n.error("ImpacWidgetsSvc: error while trying to load the service"),o.reject(t)}),o.promise},o=function(t){var e;return e=s.getCurrentDashboard(),_.isEmpty(e)||_.isEmpty(e.widgets)?!1:_.contains(_.pluck(e.widgets,"id"),t)},this.initWidgetSettings=function(t){var e,n,i,a;if(t.isEditMode=!1,!_.isEmpty(t.settings)){for(i=t.settings,e=0,n=i.length;n>e;e++)a=i[e],a.initialize();return!0}},this.updateWidgetSettings=function(e,n){var i,a,s,o,l,d;if(null==n&&(n=!0),e.isEditMode=!1,i=t.defer(),_.isEmpty(e.settings))i.reject("no setting to update");else{for(n&&(e.isLoading=!0),o={},l=e.settings,a=0,s=l.length;s>a;a++)d=l[a],angular.merge(o,d.toMetadata());r.update(e,{metadata:o}).then(function(t){return n?r.show(t).then(function(t){return t.isLoading=!1,i.resolve(t)},function(e){return t.isLoading=!1,i.reject(e)}):i.resolve(t)},function(t){return i.reject(t)})}return i.promise},this.massAssignAll=function(e){return _.isEmpty(e)?void 0:r.load().then(function(){var i,a,o,l,d,c,u;if(i=s.getCurrentDashboard(),d=[],null!=i&&null!=i.widgets){if(_.isEmpty(i.widgets))return t.resolve([]);for(c=i.widgets,a=0,o=c.length;o>a;a++)u=c[a],l=angular.merge({},u.metadata,e),_.isEqual(u.metadata,l)||d.push(r.update(u,{metadata:l}).then(function(t){return t.isLoading=!0,r.show(t).then(function(t){return t.isLoading=!1})}));return t.all(d)}return n.error("ImpacWidgetsSvc - currentDhb.widgets is null",i),t.reject(null)})},this.refreshAll=function(){return s.load().then(function(t){var e;return e=t.currentDashboard.widgets,_.forEach(e,function(t){return t.isLoading||(t.isLoading=!0),r.show(t,!0).then(function(){return t.isLoading=!1},function(e){return t.isLoading=!1,null!=e.data&&e.data.error?n.error(e.data.error):void 0})})})},this.show=function(a,l){var d;return null==l&&(l=!1),d=t.defer(),r.load().then(function(){var t,c;return o(a.id)?(c={owner:a.owner,sso_session:r.config.ssoSessionId,metadata:a.metadata,engine:a.category},l&&angular.extend(c,{refresh_cache:!0}),t=s.getCurrentDashboard(),e.post(i.widgets.show(t.id,a.id),c).then(function(t){var e,n,i,s,r,o;for(e=t.data.content||{},s=t.data.name,angular.extend(a,{content:e,originalName:s}),angular.isDefined(a.initContext)&&a.initContext(),r=a.settings,n=0,i=r.length;i>n;n++)o=r[n],angular.isDefined(o.initialize)&&o.initialize();return angular.isDefined(a.format)&&a.format(),d.resolve(a)},function(t){var e,n,i,s;for(angular.isDefined(a.initContext)&&a.initContext(),i=a.settings,e=0,n=i.length;n>e;e++)s=i[e],angular.isDefined(s.initialize)&&s.initialize();return angular.isDefined(a.processError)&&null!=t.data&&t.data.error&&a.processError(t.data.error),d.reject(t)})):(n.info("ImpacWidgetsSvc: trying to load a widget (id: "+a.id+") that is not in currentDashboard"),d.reject("trying to load a widget (id: "+a.id+") that is not in currentDashboard"))},function(t){return n.error("ImpacWidgetsSvc: error while trying to load the service"),d.reject(t)}),d.promise},this.update=function(a,l){var d,c,u;return u=t.defer(),r.load().then(function(){},o(a.id)?(c={widget:l},d=s.getCurrentDashboard(),e.put(i.widgets.update(d.id,a.id),c).then(function(t){var e;return e=t.data,angular.extend(a,e),u.resolve(a)},function(t){return n.error("ImpacWidgetsSvc: cannot update widget: "+a.id),u.reject(t)})):(n.info("ImpacWidgetsSvc: trying to update a widget (id: "+a.id+") that is not in currentDashboard"),u.reject("trying to update a widget (id: "+a.id+") that is not in currentDashboard")),function(t){return n.error("ImpacWidgetsSvc: error while trying to load the service"),u.reject(t)}),u.promise},this["delete"]=function(a){var o;return o=t.defer(),r.load().then(function(){var t;return t=s.getCurrentDashboard(),e["delete"](i.widgets["delete"](t.id,a.id)).then(function(e){return _.remove(t.widgets,function(t){return t.id===a.id}),o.resolve(e)},function(t){return n.error("ImpacWidgetsSvc: error while trying to delete widget: "+a.id),o.reject(t)})},function(t){return n.error("ImpacWidgetsSvc: error while trying to load the service"),o.reject(t)}),o.promise},r}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.dashboard-settings.currency",[]),t.directive("dashboardSettingCurrency",["$templateCache","$log","ImpacMainSvc","ImpacDashboardsSvc","ImpacWidgetsSvc","ImpacTheming",function(t,e,n,i,a,s){return{restrict:"A",scope:{currency:"="},link:function(t){return t.locked=s.get().dhbSettings.currency.locked,n.load().then(function(e){return i.load().then(function(){return t.currentDhb=i.getCurrentDashboard(),t.currencies=e.currencies})}),t.massAssignCurrency=function(){var e;return e={currency:t.currency},i.update(t.currentDhb.id,e),a.massAssignAll(e)}},template:t.get("dashboard-settings/currency.tmpl.html")}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.dashboard-settings.sync-apps",[]),t.directive("dashboardSettingSyncApps",["$templateCache","$log","$http","$filter","$modal","ImpacMainSvc","ImpacRoutes","ImpacWidgetsSvc","ImpacTheming","poller","$timeout",function(t,e,n,i,a,s,r,o,l,d,c){return{restrict:"A",scope:{},template:t.get("dashboard-settings/sync-apps.tmpl.html"),link:function(t){var l,u,g;return t.isSyncing=!1,t.hasConnectors=!1,u=function(e){var n,i,a,s;if(t.isSyncing=e.is_syncing,t.hasConnectors=e.connectors&&e.connectors.length>0,t.hasConnectors)for(t.lastConnector=e.connectors[0],t.otherConnectors=_.slice(e.connectors,1),t.failedConnectors=[],t.disconnectedConnectors=[],s=e.connectors,i=0,a=s.length;a>i;i++)n=s[i],"FAILED"===n.status?t.failedConnectors.push(angular.copy(n)):"DISCONNECTED"===n.status&&t.disconnectedConnectors.push(angular.copy(n));else t.lastConnector={status:"SUCCESS",last_sync_date:new Date};return t.isSyncing?void 0:g()},g=function(){var e;return t.syncingPoller.stop(),t.isDashboardRefreshAuthorized?(o.refreshAll(),_.isEmpty(t.failedConnectors)&&_.isEmpty(t.disconnectedConnectors)||(e=a.open({animation:!0,size:"md",templateUrl:"alerts.tmpl.html",appendTo:angular.element("impac-dashboard"),controller:["$scope","connectors",function(t,n){return t.failedConnectors=n.failed,t.disconnectedConnectors=n.disconnected,t.ok=function(){return e.close()}}],resolve:{connectors:function(){return{disconnected:t.disconnectedConnectors,failed:t.failedConnectors}}}})),t.isDashboardRefreshAuthorized=!1):void 0},l=function(){var t,e,n,i;return i=(new Date).getTimezoneOffset(),n=["+","00","00"],0>i||(n[0]="-"),t=""+Math.abs(Math.floor(i/60)),n[1]=t.length<2?"0"+t:t,e=""+Math.abs(i%60),n[2]=e.length<2?"0"+e:e,n.join("")},t.synchronize=function(){return t.isSyncing?void 0:(t.isSyncing=!0,t.isDashboardRefreshAuthorized=!0,n.post(r.organizations.appInstancesSync(t.orgUID)).then(function(e){return u(e.data),e.data.is_syncing?c(function(){return t.syncingPoller.start()},5e3):void 0},function(n){return e.error("Unable to sync apps",n),t.isSyncing=!1}))},t.formatStatus=function(t){var e,n,a;if(t){if(n=t.name,a="",t.last_sync_date)switch(e=i("date")(t.last_sync_date,"yyyy-MM-dd 'at' h:mma",l()),t.status){case"SUCCESS":a="Last sync: "+e;break;case"FAILED":a="Last sync failed: "+e;break;case"DISCONNECTED":a="Disconnected - previous sync was: "+e}else switch(t.status){case"FAILED":a="Sync failed";break;case"DISCONNECTED":a="Sync failed - Disconnected";break;case"NOT SYNCED":a="Not synced yet"}return _.isEmpty(a)||_.isEmpty(n)||(a=a+" ("+n+")"),a}},s.load(!0).then(function(e){return t.orgUID=e.currentOrganization.uid,t.syncingPoller=d.get(r.organizations.appInstancesSync(t.orgUID),{delay:5e3,smart:!0}),t.syncingPoller.promise.then(null,null,function(t){return u(t.data)})}),t.$on("$destroy",function(){return t.syncingPoller?t.syncingPoller.stop()&&t.syncingPoller.remove():void 0})}}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-common.data-not-found",[]),t.directive("commonDataNotFound",["$templateCache","$log","$http","ImpacAssets","ImpacTheming","ImpacMainSvc",function(t,e,n,i,a,s){return{restrict:"A",scope:{widgetEngine:"=",onDisplayAlerts:"&"},link:function(t,n){var r,o,l,d;return t.content=a.get().dataNotFoundConfig,r=i.get("dataNotFound"),t.widgetEngine&&r.length>0&&(o=r.split(""),o="/"!==o[o.length-1]?o.concat("/").join(""):o.join(""),d=_.find(n.children().first().children(),function(t){return"not-found-bg"===t.id}),d.onerror=function(){return e.warn("Missing data-not-found image for "+t.widgetEngine),d.remove()},d.src=o+t.widgetEngine+".png"),l=s.config.currentOrganization.has_myob_essentials_only,t.showAlertsTrigger=l&&t.widgetEngine.match(/.*accounts\/.*/),t.hasCallbackUrl=null!=t.content.linkUrlCallback},template:t.get("widgets-common/data-not-found.tmpl.html")}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-common.editable-title",[]),t.controller("CommonEditableTitleCtrl",["$scope","ImpacWidgetsSvc",function(t,e){var n;return n=t.parentWidget,t.updateName=function(){var t;return 0===n.name.length?(n.name=n.originalName,"Incorrect name"):(t={name:n.name},e.update(n,t).then(function(){return!0},function(){return n.name=n.originalName}))}}]),t.directive("commonEditableTitle",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"="},template:t.get("widgets-common/editable-title.tmpl.html"),controller:"CommonEditableTitleCtrl"}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-common.top-buttons",[]),t.controller("CommonTopButtonsCtrl",["$scope","$rootScope","$log","ImpacWidgetsSvc","ImpacAssets","ImpacUtilities",function(t,e,n,i,a,s){var r;return r=t.parentWidget,t.showConfirmDelete=!1,t.isDeletePopoverLoading=!1,r.isEditMode=!1,t.deleteWidget=function(){return t.isDeletePopoverLoading=!0,i["delete"](r).then(function(){return!0},function(t){return r.errors=s.processRailsError(t)})["finally"](function(){return t.isDeletePopoverLoading=!1})},t.toggleEditMode=function(){return r.isLoading?void 0:r.isEditMode?(r.isEditMode=!1,i.initWidgetSettings(r)):r.isEditMode=!0}}]),t.directive("commonTopButtons",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"=",onRefresh:"="},template:t.get("widgets-common/top-buttons.tmpl.html"),controller:"CommonTopButtonsCtrl"}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-accounting-values",[]),t.controller("WidgetAccountsAccountingValuesCtrl",["$scope","$q","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s;return s=t.widget,t.orgDeferred=e.defer(),t.timeRangeDeferred=e.defer(),t.histModeDeferred=e.defer(),t.chartDeferred=e.defer(),a=[t.orgDeferred.promise,t.timeRangeDeferred.promise,t.histModeDeferred.promise,t.chartDeferred.promise],s.initContext=function(){return t.isDataFound=null!=s.content&&null!=s.content.accounting},t.getCurrentPrice=function(){return t.isDataFound?_.last(s.content.accounting.values):void 0},t.getCurrency=function(){return t.isDataFound?s.content.accounting.currency:void 0},t.getLegend=function(){return t.isDataFound?s.content.accounting.legend:void 0},t.drawTrigger=e.defer(),s.format=function(){var e,a,r,o,l,d,c;return t.isDataFound?(r=angular.copy(s.content.accounting),c=null,null!=s.metadata&&null!=s.metadata.hist_parameters&&(c=s.metadata.hist_parameters.period),o=_.map(r.dates,function(t){return i("mnoDate")(t,c)}),l={title:r.type,labels:o,values:r.values},e=!0,angular.forEach(r.values,function(t){return e&&(e=t>=0)}),d={scaleBeginAtZero:e,showXLabels:!1,currency:r.currency},a=n.lineChart([l],d),t.drawTrigger.notify(a)):void 0},t.widgetDeferred.resolve(a)}]),t.directive("widgetAccountsAccountingValues",function(){return{restrict:"A",controller:"WidgetAccountsAccountingValuesCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-assets-liability-summary",[]),t.controller("WidgetAccountsAssetsLiabilitySummaryCtrl",["$scope","$q","ChartFormatterSvc",function(t,e,n){var i,a;return a=t.widget,t.orgDeferred=e.defer(),t.chartDeferred=e.defer(),t.paramSelectorDeferred=e.defer(),i=[t.orgDeferred.promise,t.chartDeferred.promise,t.paramSelectorDeferred.promise],a.initContext=function(){switch(t.isDataFound=angular.isDefined(a.content)&&!_.isEmpty(a.content.summary),(a.metadata.classification||"asset").toLowerCase()){case"liability":t.classification="Liabilities";break;default:t.classification="Assets"}return t.accountsOptions=[{label:"Assets Accounts",value:"ASSET"},{label:"Liability Accounts",value:"LIABILITY"}],t.selectedAccountsOption||(t.selectedAccountsOption=angular.copy(_.find(t.accountsOptions,{value:a.metadata.classification||"ASSET"}))),t.isDataFound?t.dataSource=a.metadata.organization_ids.length>1?a.content.repartition:a.content.summary:void 0},t.getCurrency=function(){return t.isDataFound?a.content.currency:void 0},t.getAccountColor=function(e){return t.isDataFound?n.getColor(_.indexOf(t.dataSource,e)):void 0},t.drawTrigger=e.defer(),a.format=function(){var e,i,a;return t.isDataFound?(i=_.map(t.dataSource,function(t){return{label:t.label,value:t.total}}),a={percentageInnerCutout:50,tooltipFontSize:12},e=n.pieChart(i,a),t.drawTrigger.notify(e)):void 0},t.widgetDeferred.resolve(i)}]),t.directive("widgetAccountsAssetsLiabilitySummary",function(){return{restrict:"A",controller:"WidgetAccountsAssetsLiabilitySummaryCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-assets-summary",[]),t.controller("WidgetAccountsAssetsSummaryCtrl",["$scope","$q","ChartFormatterSvc",function(t,e,n){var i,a;return a=t.widget,t.orgDeferred=e.defer(),t.chartDeferred=e.defer(),i=[t.orgDeferred.promise,t.chartDeferred.promise],a.initContext=function(){switch(t.isDataFound=angular.isDefined(a.content)&&!_.isEmpty(a.content.summary),t.isDataFound&&(t.dataSource=a.metadata.organization_ids.length>1?a.content.repartition:a.content.summary),(a.metadata.classification||"assets").toLowerCase()){case"liability":return t.classification="Liabilities";default:return t.classification="Assets"}},t.getCurrency=function(){return t.isDataFound?a.content.currency:void 0},t.getAccountColor=function(e){return t.isDataFound?n.getColor(_.indexOf(t.dataSource,e)):void 0},t.drawTrigger=e.defer(),a.format=function(){var e,i,a;return t.isDataFound?(i=_.map(t.dataSource,function(t){return{label:t.label,value:t.total}}),a={percentageInnerCutout:50,tooltipFontSize:12},e=n.pieChart(i,a),t.drawTrigger.notify(e)):void 0},t.widgetDeferred.resolve(i)}]),t.directive("widgetAccountsAssetsSummary",function(){return{restrict:"A",controller:"WidgetAccountsAssetsSummaryCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-assets-vs-liabilities",[]),t.controller("WidgetAccountsAssetsVsLiabilitiesCtrl",["$scope","$q","ChartFormatterSvc","$filter",function(t,e,n){var i,a;return a=t.widget,t.orgDeferred=e.defer(),t.chartDeferred=e.defer(),i=[t.orgDeferred.promise,t.chartDeferred.promise],a.initContext=function(){var e;return t.isDataFound=null!=a.content&&!_.isEmpty(a.content.summary)&&!_.isEmpty(a.content.companies),t.isDataFound?(e=0,t.companiesList=_.map(a.content.companies,function(t){var n,i,s;return n=_.find(a.content.summary,function(t){return"ASSET"===t.classification}),i=_.find(a.content.summary,function(t){return"LIABILITY"===t.classification}),s={company:t,assets:null!=n?n.totals[e]:0,liabilities:null!=i?i.totals[e]:0,currency:a.content.currency},e++,s})):void 0},t.assetsColor=n.getColor(0),t.liabilitiesColor=n.getColor(1),t.drawTrigger=e.defer(),a.format=function(){var e,i,s,r;return t.isDataFound?(i=_.map(a.content.summary,function(t){return _.includes(["ASSET","LIABILITY"],t.classification)?{title:t.classification,values:t.totals}:void 0}),i=_.sortByOrder(i,["title"]),s={labels:a.content.companies,datasets:_.compact(i)},r={showTooltips:!1,showXLabels:!1,barValueSpacing:Math.max(8-a.content.companies.length,1)},e=n.combinedBarChart(s,r),t.drawTrigger.notify(e)):void 0},t.widgetDeferred.resolve(i)}]),t.directive("widgetAccountsAssetsVsLiabilities",function(){return{restrict:"A",controller:"WidgetAccountsAssetsVsLiabilitiesCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-balance",[]),t.controller("WidgetAccountsBalanceCtrl",["$scope","$q","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s;return s=t.widget,t.orgDeferred=e.defer(),t.accountBackDeferred=e.defer(),t.accountFrontDeferred=e.defer(),t.timeRangeDeferred=e.defer(),t.histModeDeferred=e.defer(),t.chartDeferred=e.defer(),a=[t.orgDeferred.promise,t.accountBackDeferred,t.accountFrontDeferred,t.timeRangeDeferred.promise,t.histModeDeferred.promise,t.chartDeferred.promise],t.isDataFound=!0,s.initContext=function(){return t.isDataFound=null!=s.content&&!_.isEmpty(s.content.account_list)},t.getName=function(){return null!=s.selectedAccount?s.selectedAccount.name:void 0},t.getCurrentBalance=function(){return null!=s.selectedAccount?s.selectedAccount.current_balance:void 0},t.getCurrency=function(){return null!=s.selectedAccount?s.selectedAccount.currency:void 0},t.displayAccount=function(){return t.updateSettings(!1),s.format()},t.drawTrigger=e.defer(),s.format=function(){var e,a,r,o,l,d,c;return t.isDataFound&&null!=s.selectedAccount?(r=angular.copy(s.selectedAccount),c=null,null!=s.metadata&&null!=s.metadata.hist_parameters&&(c=s.metadata.hist_parameters.period),o=_.map(s.content.dates,function(t){return i("mnoDate")(t,c)}),l={title:r.name,labels:o,values:r.balances},e=!0,angular.forEach(r.balances,function(t){return e&&(e=t>=0)}),d={scaleBeginAtZero:e,showXLabels:!1},a=n.lineChart([l],d),t.drawTrigger.notify(a)):void 0},t.widgetDeferred.resolve(a)}]),t.directive("widgetAccountsBalance",function(){return{restrict:"A",controller:"WidgetAccountsBalanceCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-balance-sheet",[]),t.controller("WidgetAccountsBalanceSheetCtrl",["$scope","$q","ImpacWidgetsSvc",function(t,e,n){var i,a,s;return s=t.widget,t.orgDeferred=e.defer(),t.paramSelectorFrontDeferred=e.defer(),t.paramSelectorBackDeferred=e.defer(),i=[t.orgDeferred.promise,t.paramSelectorFrontDeferred.promise,t.paramSelectorBackDeferred.promise],t.periodOptions=[{label:"Year",value:"YEARLY"},{label:"Quarter",value:"QUARTERLY"},{label:"Month",value:"MONTHLY"},{label:"Week",value:"WEEKLY"},{label:"Day",value:"DAILY"}],t.period=angular.copy(t.periodOptions[2]),s.initContext=function(){return null!=s.content&&null!=s.content.period&&_.contains(_.pluck(t.periodOptions,"value"),s.content.period)&&(t.period=angular.copy(_.find(t.periodOptions,function(t){return t.value===s.content.period}))),(t.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.summary)&&!_.isEmpty(s.content.dates))?(t.dates=s.content.dates,t.unCollapsed=s.metadata.unCollapsed||[],t.categories=Object.keys(s.content.summary)):void 0},t.toggleCollapsed=function(e){return null!=e?(_.find(t.unCollapsed,function(t){return e===t})?t.unCollapsed=_.reject(t.unCollapsed,function(t){return t===e}):t.unCollapsed.push(e),n.updateWidgetSettings(s,!1)):void 0},t.isCollapsed=function(e){return null!=e?_.find(t.unCollapsed,function(t){return e===t})?!1:!0:void 0},a={},a.initialized=!1,a.initialize=function(){return a.initialized=!0},a.toMetadata=function(){return{unCollapsed:t.unCollapsed}},s.settings.push(a),t.widgetDeferred.resolve(i)}]),t.directive("widgetAccountsBalanceSheet",function(){return{restrict:"A",controller:"WidgetAccountsBalanceSheetCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-cash-summary",[]),t.controller("WidgetAccountsCashSummaryCtrl",["$scope","$q","ChartFormatterSvc","$filter","ImpacWidgetsSvc",function(t,e,n,i,a){var s,r,o,l;return l=t.widget,t.orgDeferred=e.defer(),t.timeRangeDeferred=e.defer(),t.widthDeferred=e.defer(),t.chartDeferred=e.defer(),r=[t.orgDeferred.promise,t.timeRangeDeferred.promise,t.widthDeferred.promise,t.chartDeferred.promise],l.initContext=function(){return(t.isDataFound=angular.isDefined(l.content)&&!_.isEmpty(l.content.summary)&&!_.isEmpty(l.content.dates))&&(t.dates=l.content.dates,t.unCollapsed=l.metadata.unCollapsed||[],l.metadata.selectedElement&&(t.selectedElement=_.find(l.content.summary,function(t){return t.name===l.metadata.selectedElement.name}),!t.selectedElement))?angular.forEach(l.content.summary,function(e){return null!=e.accounts?t.selectedElement||(t.selectedElement=_.find(e.accounts,function(t){return t.id===l.metadata.selectedElement.id})):void 0}):void 0},t.getLastDate=function(){return null!=t.dates?t.dates[t.dates.length-1]:void 0},t.getPrevDate=function(){return null!=t.dates?t.dates[t.dates.length-2]:void 0},t.getLastValue=function(t){return null!=t.cash_flows?_.last(t.cash_flows):void 0
},t.formatVariance=function(t){return null!=t?t>0?"+"+t+" %":t+" %":"-"},t.getLastVariance=function(e){return null!=e.variances&&null!=_.last(e.variances)?t.formatVariance(_.last(e.variances)):"-"},t.getVarianceClassColor=function(t){return parseInt(t)>0?"positive":parseInt(t)<0?"negative":null},t.getName=function(t){return null!=t&&null!=t.name?t.name.replace(/_/g," "):void 0},t.toggleSelectedElement=function(e){return t.isSelected(e)?(t.selectedElement=null,l.isExpanded()?l.toggleExpanded():a.updateWidgetSettings(l,!1)):(t.selectedElement=angular.copy(e),l.format(),l.isExpanded()?a.updateWidgetSettings(l,!1):l.toggleExpanded())},t.isSelected=function(e){return null!=e&&null!=t.selectedElement?null!=e.id&&t.selectedElement.id&&e.id===t.selectedElement.id||e.name===t.selectedElement.name?!0:!1:!1},t.toggleCollapsed=function(e){return null!=e&&null!=e.name?(_.find(t.unCollapsed,function(t){return e.name===t})?t.unCollapsed=_.reject(t.unCollapsed,function(t){return t===e.name}):t.unCollapsed.push(e.name),a.updateWidgetSettings(l,!1)):void 0},t.isCollapsed=function(e){return null!=e&&null!=e.name?_.find(t.unCollapsed,function(t){return e.name===t})?!1:!0:void 0},t.drawTrigger=e.defer(),l.format=function(){var e,a,s,r,o,d,c;return t.isDataFound&&null!=t.selectedElement?(s=angular.copy(t.selectedElement),c=null,null!=l.metadata&&null!=l.metadata.hist_parameters&&(c=l.metadata.hist_parameters.period),r=_.map(l.content.dates,function(t){return i("mnoDate")(t,c)}),o={labels:r,datasets:[{title:s.name,values:s.cash_flows}]},e=!0,angular.forEach(s.cash_flows,function(t){return e&&(e=t>=0)}),d={scaleBeginAtZero:e,showXLabels:!0},a=n.combinedBarChart(o,d),t.drawTrigger.notify(a)):void 0},o={},o.initialized=!1,o.initialize=function(){return o.initialized=!0},o.toMetadata=function(){return{unCollapsed:t.unCollapsed}},l.settings.push(o),s={},s.initialized=!1,s.initialize=function(){return s.initialized=!0},s.toMetadata=function(){return{selectedElement:t.selectedElement}},l.settings.push(s),t.widgetDeferred.resolve(r)}]),t.directive("widgetAccountsCashSummary",function(){return{restrict:"A",controller:"WidgetAccountsCashSummaryCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-class-comparison",[]),t.controller("WidgetAccountsClassComparisonCtrl",["$scope","$q","$filter","ChartFormatterSvc",function(t,e,n,i){var a,s;return s=t.widget,t.orgDeferred=e.defer(),t.chartDeferred=e.defer(),t.paramSelectorDeferred=e.defer(),a=[t.orgDeferred.promise,t.chartDeferred.promise,t.paramSelectorDeferred.promise],s.initContext=function(){return t.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.summary)&&!_.isEmpty(s.content.companies),t.isDataFound&&(t.classifications=_.map(s.content.summary,function(t){var e;return e=t.classification,{label:_.capitalize(e.toLowerCase()),value:e}}),!t.selectedClassification)?t.selectedClassification=angular.copy(_.find(t.classifications,{value:s.metadata.classification||t.classifications[0].value})):void 0},t.getTotals=function(){var e;return e=_.find(s.content.summary,function(e){return e.classification===t.selectedClassification.value}).totals},t.getAmount=function(e){var i;return i=t.getTotals[e],n("mnoCurrency")(i,s.content.currency)},t.getAccountColor=function(t){return i.getColor(_.indexOf(s.content.companies,t))},t.drawTrigger=e.defer(),s.format=function(){var e,n,a;return t.isDataFound?(n={},n.labels=s.content.companies,n.values=t.getTotals(),n.labels.length>15&&(n.labels.length=15),n.values.length>15&&(n.values.length=15),a={showTooltips:!1,showXLabels:!1,barValueSpacing:Math.max(8-s.content.companies.length,1)},e=i.barChart(n,a),t.drawTrigger.notify(e)):void 0},t.widgetDeferred.resolve(a)}]),t.directive("widgetAccountsClassComparison",function(){return{restrict:"A",controller:"WidgetAccountsClassComparisonCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-comparison",[]),t.controller("WidgetAccountsComparisonCtrl",["$scope","$q","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s,r;return r=t.widget,t.orgDeferred=e.defer(),t.accountsListDeferred=e.defer(),t.chartDeferred=e.defer(),t.paramsCheckboxesDeferred=e.defer(),s=[t.orgDeferred.promise,t.accountsListDeferred.promise,t.chartDeferred.promise,t.paramsCheckboxesDeferred.promise],r.initContext=function(){return t.movedAccount={},t.comparisonModeOptions=[{id:"compare_accounts",label:"Compare matching accounts across your companies",value:!1,onChangeCallback:t.updateSettings}],angular.isDefined(r.metadata.comparison_mode)&&null!=r.metadata.organization_ids&&r.metadata.organization_ids.length>1&&angular.merge(t.comparisonModeOptions,r.metadata.comparison_mode),t.isDataFound=null!=r.content&&!_.isEmpty(r.content.complete_list)||t.isComparisonMode(),t.noComparableAccounts=t.isComparisonMode()&&null!=r.content&&_.isEmpty(r.content.complete_list),t.canSelectComparisonMode=a()},a=function(){return null==r.content?!1:_.uniq(_.pluck(r.content.complete_list,"org_name")).length>1},t.isComparisonMode=function(){return _.result(_.find(t.comparisonModeOptions,"id","compare_accounts"),"value")||!1},t.hasAccountsSelected=function(){return r.selectedAccounts&&r.selectedAccounts.length>0},t.getAccountColor=function(e){return t.isComparisonMode()?n.getColor(_.indexOf(r.selectedAccounts[0].accounts,e)):n.getColor(_.indexOf(r.selectedAccounts,e))},t.addAccount=function(t){return r.moveAccountToAnotherList(t,r.remainingAccounts,r.selectedAccounts),r.format()},t.removeAccount=function(t){return r.moveAccountToAnotherList(t,r.selectedAccounts,r.remainingAccounts),r.format()},t.formatAmount=function(t){return i("mnoCurrency")(t.current_balance,t.currency)},t.drawTrigger=e.defer(),r.format=function(){var e,i,a;for(i={labels:[],values:[]},_.forEach(r.selectedAccounts,function(e){return t.isComparisonMode()?_.forEach(e.accounts,function(t){return i.labels.push(t.name),i.values.push(t.current_balance)}):(i.labels.push(e.name),i.values.push(e.current_balance))});i.values.length<15;)i.labels.push(""),i.values.push(null);return a={showTooltips:!1,showXLabels:!1,barDatasetSpacing:9},e=n.barChart(i,a),t.drawTrigger.notify(e)},t.widgetDeferred.resolve(s)}]),t.directive("widgetAccountsComparison",function(){return{restrict:"A",controller:"WidgetAccountsComparisonCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-custom-calculation",[]),t.controller("WidgetAccountsCustomCalculationCtrl",["$scope","$timeout","$modal","$q","$templateCache","ImpacWidgetsSvc",function(t,e,n,i,a,s){var r,o;return o=t.widget,t.orgDeferred=i.defer(),t.accountsListDeferred=i.defer(),t.formulaDeferred=i.defer(),r=[t.orgDeferred.promise,t.accountsListDeferred.promise,t.formulaDeferred.promise],o.initContext=function(){return t.movedAccount={},t.isDataFound=null!=o.content&&!_.isEmpty(o.content.complete_list)},t.addAccountToFormula=function(t){return null!=t?(o.selectedAccounts.length>0?o.formula+=" + {"+(o.selectedAccounts.length+1)+"}":o.formula="{1}",o.moveAccountToAnotherList(t,o.remainingAccounts,o.selectedAccounts,!1)):void 0},t.removeAccountFromFormula=function(t){var e,n,i,a,s,r,l,d;for(l=_.map(o.selectedAccounts,function(t){return t.uid}),r=_.reject(l,function(e){return e===t.uid}),n=_.first(_.difference(l,r)),e=_.indexOf(l,n)+1,d=1===e?"{"+e+"\\}\\s*(-|\\*|\\/|\\+)*\\s*":"\\s*(-|\\*|\\/|\\+)*\\s*\\{"+e+"\\}",s=angular.copy(o.formula).replace(new RegExp(d,"g"),""),i=e+1;i<=l.length;)a="\\{"+i+"\\}",s=s.replace(new RegExp(a,"g"),"{"+(i-1)+"}"),i++;return o.formula=angular.copy(s),o.moveAccountToAnotherList(t,o.selectedAccounts,o.remainingAccounts,!1)},t.formulaModal=t.$new(),t.formulaModal.config={backdrop:"static",template:a.get("widgets/accounts-custom-calculation/formula.modal.html"),size:"lg",scope:t.formulaModal,keyboard:!1},t.formulaModal.open=function(){var e;return e=t.formulaModal,e.modalOrgDeferred=i.defer(),_.remove(o.settings,function(t){return"organizations"===t.key}),e.instance=n.open(e.config),e.modalOrgDeferred.promise.then(function(){return t.initSettings()})},t.$watch(function(){return o.selectedOrganizations},function(t){return _.isEmpty(t)?void 0:s.updateWidgetSettings(o)},!0),t.formulaModal.cancel=function(){return t.initSettings(),t.formulaModal.close()},t.formulaModal.proceed=function(){return s.updateWidgetSettings(o,!1),t.formulaModal.close()},t.formulaModal.close=function(){return t.formulaModal.instance.close()},t.$watch(function(){return o.isEditMode},function(e,n){return e&&!n?t.formulaModal.open():void 0}),t.widgetDeferred.resolve(r)}]),t.directive("widgetAccountsCustomCalculation",function(){return{restrict:"A",controller:"WidgetAccountsCustomCalculationCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-detailed-classifications",[]),t.controller("WidgetAccountsDetailedClassificationsCtrl",["$scope","$q","ImpacWidgetsSvc",function(t,e,n){var i,a,s;return s=t.widget,t.orgDeferred=e.defer(),i=[t.orgDeferred.promise],s.initContext=function(){return t.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.companies),t.isDataFound?(t.unCollapsed=s.metadata.unCollapsed||[],1===s.content.companies.length?(t.multiEntity=!1,t.dataSource=_.map(s.content.companies[0].classifications,function(t){return{label:t.name,value:t.total,currency:t.currency,entries:_.map(t.accounts,function(t){return{label:t.name,value:t.balance,currency:t.currency}})}})):(t.multiEntity=!0,t.dataSource=_.map(s.content.companies,function(t){return{label:t.name,entries:_.map(t.classifications,function(t){return{label:t.name,value:t.total,currency:t.currency}})}}))):void 0},t.toggleCollapsed=function(e){return null!=e?(_.find(t.unCollapsed,function(t){return e===t})?t.unCollapsed=_.reject(t.unCollapsed,function(t){return t===e}):t.unCollapsed.push(e),n.updateWidgetSettings(s,!1)):void 0},t.isCollapsed=function(e){return null!=e?_.find(t.unCollapsed,function(t){return e===t})?!1:!0:void 0},a={},a.initialized=!1,a.initialize=function(){return a.initialized=!0},a.toMetadata=function(){return{unCollapsed:t.unCollapsed}},s.settings.push(a),t.widgetDeferred.resolve(i)}]),t.directive("widgetAccountsDetailedClassifications",function(){return{restrict:"A",controller:"WidgetAccountsDetailedClassificationsCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-expense-weight",[]),t.controller("WidgetAccountsExpenseWeightCtrl",["$scope","$q","ChartFormatterSvc",function(t,e,n){var i,a;return a=t.widget,t.orgDeferred=e.defer(),t.accountBackDeferred=e.defer(),t.accountFrontDeferred=e.defer(),t.chartDeferred=e.defer(),i=[t.orgDeferred.promise,t.accountBackDeferred,t.accountFrontDeferred,t.chartDeferred.promise],a.initContext=function(){return t.isDataFound=null!=a.content&&!_.isEmpty(a.content.account_list)},t.getName=function(){return null!=a.selectedAccount?a.selectedAccount.name:void 0},t.getComparator=function(){switch(a.metadata.comparator){case"turnover":return"turnover";default:return"total expenses"}},t.drawTrigger=e.defer(),a.format=function(){var e,i,s,r,o;return t.isDataFound&&null!=a.content.summary?(i=_.map(a.content.summary,function(t){return t.company}),o=_.map(a.content.summary,function(t){return t.ratio}),1===i.length&&(i.push(i[0]),o.push(o[0])),s={labels:i,values:o},r={scales:{yAxes:[{ticks:{suggestedMin:0,suggestedMax:100,maxTicksLimit:5}}]},showXLabels:!1,pointDot:!1,currency:"%"},e=n.lineChart([s],r),t.drawTrigger.notify(e)):void 0},t.widgetDeferred.resolve(i)}]),t.directive("widgetAccountsExpenseWeight",function(){return{restrict:"A",controller:"WidgetAccountsExpenseWeightCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-expenses-revenue",[]),t.controller("WidgetAccountsExpensesRevenueCtrl",["$scope","$q","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s;return s=t.widget,t.orgDeferred=e.defer(),t.timeRangeDeferred=e.defer(),t.histModeDeferred=e.defer(),t.chartDeferred=e.defer(),t.paramsCheckboxesDeferred=e.defer(),a=[t.orgDeferred.promise,t.timeRangeDeferred.promise,t.histModeDeferred.promise,t.chartDeferred.promise,t.paramsCheckboxesDeferred.promise],s.initContext=function(){return t.isDataFound=null!=s.content&&null!=s.content.values,t.displayOptions=[{id:"show_net_profit",label:"Show net profit",value:!1,onChangeCallback:t.toggleDisplayNetProfit}],angular.isDefined(null!=s.metadata&&null!=s.metadata.display)&&angular.merge(t.displayOptions,s.metadata.display),t.isNetProfitDisplayed=!!t.displayOptions[0].value},t.getCurrentRevenue=function(){return t.isDataFound?_.last(s.content.values.revenue):void 0},t.getCurrentExpenses=function(){return t.isDataFound?_.last(s.content.values.expenses):void 0},t.getCurrency=function(){return t.isDataFound?s.content.currency:void 0},t.toggleDisplayNetProfit=function(){return t.isNetProfitDisplayed=!!t.displayOptions[0].value,t.updateSettings(!1),s.format()},t.drawTrigger=e.defer(),s.format=function(){var e,a,r,o,l,d,c,u;return t.isDataFound?(s.isHistoryMode?(d=null,null!=s.metadata&&null!=s.metadata.hist_parameters&&(d=s.metadata.hist_parameters.period),r=_.map(s.content.dates,function(t){return i("mnoDate")(t,d)}),t.isNetProfitDisplayed?(o=[{title:"Net Profit ("+t.getCurrency()+")",labels:r,values:s.content.values.net_profit}],e=!0,angular.forEach(s.content.values.net_profit,function(t){return e&&(e=t>=0)})):(o=[{title:"Expenses ("+t.getCurrency()+")",labels:r,values:s.content.values.expenses},{title:"Revenue ("+t.getCurrency()+")",labels:r,values:s.content.values.revenue}],e=!0,angular.forEach(s.content.values.expenses,function(t){return e&&(e=t>=0)}),angular.forEach(s.content.values.revenue,function(t){return e&&(e=t>=0)})),l={scaleBeginAtZero:e,showXLabels:!1},a=n.lineChart(o,l,!0)):(c=[{label:"Expenses ("+t.getCurrency()+")",value:t.getCurrentExpenses()},{label:"Revenue ("+t.getCurrency()+")",value:t.getCurrentRevenue()}],u={tooltipFontSize:12,percentageInnerCutout:0},a=n.pieChart(c,u,!0)),t.drawTrigger.notify(a)):void 0},t.widgetDeferred.resolve(a)}]),t.directive("widgetAccountsExpensesRevenue",function(){return{restrict:"A",controller:"WidgetAccountsExpensesRevenueCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-payable-receivable",[]),t.controller("WidgetAccountsPayableReceivableCtrl",["$scope","$q","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s;return s=t.widget,t.orgDeferred=e.defer(),t.timeRangeDeferred=e.defer(),t.histModeDeferred=e.defer(),t.chartDeferred=e.defer(),a=[t.orgDeferred.promise,t.timeRangeDeferred.promise,t.histModeDeferred.promise,t.chartDeferred.promise],s.initContext=function(){return t.isDataFound=null!=s.content&&null!=s.content.values},t.getCurrentPayable=function(){return t.isDataFound?_.last(s.content.values.payables):void 0},t.getCurrentReceivable=function(){return t.isDataFound?_.last(s.content.values.receivables):void 0},t.getCurrency=function(){return t.isDataFound?s.content.currency:void 0},t.drawTrigger=e.defer(),s.format=function(){var e,a,r,o,l,d,c,u,g,h,p,m,f;if(t.isDataFound){for(h=null,null!=s.metadata&&null!=s.metadata.hist_parameters&&(h=s.metadata.hist_parameters.period),r=_.map(s.content.dates,function(t){return i("mnoDate")(t,h)}),u=[{title:"Payable",labels:r,values:s.content.values.payables},{title:"Receivable",labels:r,values:s.content.values.receivables}],e=!0,p=s.content.values.payables,o=0,d=p.length;d>o;o++)f=p[o],e&&(e=f>=0);for(m=s.content.values.receivables,l=0,c=m.length;c>l;l++)f=m[l],e&&(e=f>=0);return g={scaleBeginAtZero:e,showXLabels:!1},a=n.lineChart(u,g,!0),t.drawTrigger.notify(a)}},t.widgetDeferred.resolve(a)}]),t.directive("widgetAccountsPayableReceivable",function(){return{restrict:"A",controller:"WidgetAccountsPayableReceivableCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.accounts-profit-and-loss",[]),t.controller("WidgetAccountsProfitAndLossCtrl",["$scope","$q","ChartFormatterSvc","$filter","ImpacWidgetsSvc",function(t,e,n,i,a){var s,r,o,l;return l=t.widget,t.orgDeferred=e.defer(),t.timeRangeDeferred=e.defer(),t.widthDeferred=e.defer(),t.chartDeferred=e.defer(),r=[t.orgDeferred.promise,t.timeRangeDeferred.promise,t.widthDeferred.promise,t.chartDeferred.promise],l.initContext=function(){return!(t.isDataFound=angular.isDefined(l.content)&&!_.isEmpty(l.content.summary)&&!_.isEmpty(l.content.dates))||(t.dates=l.content.dates,t.unCollapsed=l.metadata.unCollapsed||[],l.metadata.selectedElements&&(t.selectedElements=[],angular.forEach(l.metadata.selectedElements,function(e){var n;return n=_.find(l.content.summary,function(t){return t.name===e.name}),n||angular.forEach(l.content.summary,function(t){return null!=t.accounts?n||(n=_.find(t.accounts,function(t){return e.id===t.id})):void 0}),n?t.selectedElements.push(n):void 0})),null!=t.selectedElements&&t.selectedElements.length>0)?void 0:l.width=6},t.getElementChartColor=function(t){return n.getColor(t)},t.getLastDate=function(){return null!=t.dates?t.dates[t.dates.length-1]:void 0},t.getPrevDate=function(){return null!=t.dates?t.dates[t.dates.length-2]:void 0},t.getLastValue=function(t){return null!=t.totals?_.last(t.totals):void 0},t.getPeriod=function(){var t;switch(t="MONTHLY",null!=l.metadata&&null!=l.metadata.hist_parameters&&null!=l.metadata.hist_parameters.period&&(t=l.metadata.hist_parameters.period),t.toUpperCase()){case"DAILY":return"day";default:return t.toLowerCase().replace("ly","")}},t.getClassColor=function(t){return parseInt(t)>0?"positive":parseInt(t)<0?"negative":null},t.getName=function(t){return null!=t&&null!=t.name?t.name.replace(/_/g," "):void 0},t.toggleSelectedElement=function(e){return t.isSelected(e)?(t.selectedElements=_.reject(t.selectedElements,function(t){return e.id?t.id===e.id:t.name===e.name}),l.format(),l.isExpanded()&&0===t.selectedElements.length?l.toggleExpanded():a.updateWidgetSettings(l,!1)):(t.selectedElements||(t.selectedElements=[]),t.selectedElements.push(e),l.format(),l.isExpanded()?a.updateWidgetSettings(l,!1):l.toggleExpanded())},t.isSelected=function(e){return null!=e&&null!=t.selectedElements?_.find(t.selectedElements,function(t){return e.id?t.id===e.id:t.name===e.name})?!0:!1:!1},t.toggleCollapsed=function(e){return null!=e&&null!=e.name?(_.find(t.unCollapsed,function(t){return e.name===t})?t.unCollapsed=_.reject(t.unCollapsed,function(t){return t===e.name}):t.unCollapsed.push(e.name),a.updateWidgetSettings(l,!1)):void 0},t.isCollapsed=function(e){return null!=e&&null!=e.name?_.find(t.unCollapsed,function(t){return e.name===t})?!1:!0:void 0},t.hasElements=function(){return null!=t.selectedElements&&t.selectedElements.length>0},t.drawTrigger=e.defer(),l.format=function(){var e,a,s,r;return t.isDataFound&&null!=t.selectedElements&&t.selectedElements.length>0?(e=!0,s=[],angular.forEach(t.selectedElements,function(t){var n,a,r;return n=angular.copy(t),r=null,null!=l.metadata&&null!=l.metadata.hist_parameters&&(r=l.metadata.hist_parameters.period),a=_.map(l.content.dates,function(t){return i("mnoDate")(t,r)}),s.push({title:n.name,labels:a,values:n.totals}),angular.forEach(n.totals,function(t){return e&&(e=t>=0)})}),r={scaleBeginAtZero:e,showXLabels:!0,datasetFill:1===t.selectedElements.length,pointDot:1===t.selectedElements.length},a=n.lineChart(s,r),t.drawTrigger.notify(a)):void 0},o={},o.initialized=!1,o.initialize=function(){return o.initialized=!0},o.toMetadata=function(){return{unCollapsed:t.unCollapsed}},l.settings.push(o),s={},s.initialized=!1,s.initialize=function(){return s.initialized=!0},s.toMetadata=function(){return{selectedElements:t.selectedElements}},l.settings.push(s),t.widgetDeferred.resolve(r)}]),t.directive("widgetAccountsProfitAndLoss",function(){return{restrict:"A",controller:"WidgetAccountsProfitAndLossCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.hr-employee-details",[]),t.controller("WidgetHrEmployeeDetailsCtrl",["$scope","$q","$filter",function(t,e,n){var i,a;return a=t.widget,t.orgDeferred=e.defer(),t.widthDeferred=e.defer(),t.paramSelectorDeferred1=e.defer(),t.paramSelectorDeferred2=e.defer(),i=[t.orgDeferred.promise,t.widthDeferred.promise,t.paramSelectorDeferred1.promise,t.paramSelectorDeferred2.promise],a.initContext=function(){return(t.isDataFound=!_.isEmpty(a.content)&&!_.isEmpty(a.content.employees))?(t.periodOptions=[{label:"Yearly",value:"yearly"},{label:"Monthly",value:"monthly"},{label:"Weekly",value:"weekly"},{label:"Hourly",value:"hourly"}],t.period=a.metadata&&a.metadata.period?angular.copy(_.find(t.periodOptions,function(t){return t.value===a.metadata.period.toLowerCase()})||t.periodOptions[0]):angular.copy(t.periodOptions[0]),t.employeesOptions=_.map(a.content.employees,function(t){return{value:t.uid,label:t.lastname+" "+t.firstname}}),t.selectedEmployee={value:t.getEmployee().uid,label:t.getEmployee().lastname+" "+t.getEmployee().firstname}):void 0},t.getSingleCompanyName=function(){var e,n;return a.content&&a.content.organizations&&(n=a.content.organizations[0],e=_.find(t.parentDashboard.data_sources,function(t){return t.uid===n}),null!=e)?e.label:void 0},t.getEmployee=function(){var e;return t.isDataFound?(e=a.metadata&&a.metadata.employee_uid?angular.copy(_.find(a.content.employees,function(t){return t.uid===a.metadata.employee_uid})||a.content.employees[0]):angular.copy(a.content.employees[0]),e.salary&&(e.salary=n("mnoCurrency")(e.salary.amount,e.salary.currency)),e):!1},t.formatAddress=function(t){return angular.isDefined(t)?t.replace(/, /g,",\n"):void 0},t.widgetDeferred.resolve(i)}]),t.directive("widgetHrEmployeeDetails",function(){return{restrict:"A",controller:"WidgetHrEmployeeDetailsCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.hr-employees-list",[]),t.controller("WidgetHrEmployeesListCtrl",["$scope","$q","$filter",function(t,e,n){var i,a;return a=t.widget,t.orgDeferred=e.defer(),t.paramSelectorDeferred=e.defer(),i=[t.orgDeferred.promise,t.paramSelectorDeferred.promise],a.initContext=function(){return(t.isDataFound=!_.isEmpty(a.content)&&!_.isEmpty(a.content.total)&&!_.isEmpty(a.content.employees))?(t.periodOptions=[{label:"Yearly",value:"yearly"},{label:"Monthly",value:"monthly"},{label:"Weekly",value:"weekly"},{label:"Hourly",value:"hourly"}],t.period=angular.copy(_.find(t.periodOptions,function(t){return t.value===a.content.total.period.toLowerCase()})||t.periodOptions[0])):void 0},t.getSingleCompanyName=function(){var e,n;return a.content&&a.content.organizations?(n=a.content.organizations[0],e=_.find(t.parentDashboard.data_sources,function(t){return t.uid===n}),e.label):void 0},t.getEmployeeSalary=function(t){return null!=t.salary?n("mnoCurrency")(t.salary.amount,a.content.total.currency):"-"},t.widgetDeferred.resolve(i)}]),t.directive("widgetHrEmployeesList",function(){return{restrict:"A",controller:"WidgetHrEmployeesListCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.hr-leaves-balance",[]),t.controller("WidgetHrLeavesBalanceCtrl",["$scope","$q",function(t,e){var n,i;return i=t.widget,t.orgDeferred=e.defer(),t.paramSelectorDeferred=e.defer(),n=[t.orgDeferred.promise,t.paramSelectorDeferred.promise],i.initContext=function(){return(t.isDataFound=!_.isEmpty(i.content)&&!_.isEmpty(i.content.employees))?(t.employeesOptions=_.map(i.content.employees,function(t){return{value:t.uid,label:t.lastname+" "+t.firstname}}),t.selectedEmployee={value:t.getEmployee().uid,label:t.getEmployee().lastname+" "+t.getEmployee().firstname}):void 0},t.getEmployee=function(){var e;return t.isDataFound?(e=i.content.employees[0],i.metadata&&i.metadata.employee_id&&(e=_.find(i.content.employees,function(t){return t.uid===i.metadata.employee_id})||i.content.employees[0]),angular.copy(e)):!1},t.widgetDeferred.resolve(n)}]),t.directive("widgetHrLeavesBalance",function(){return{restrict:"A",controller:"WidgetHrLeavesBalanceCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.hr-leaves-schedule",[]),t.controller("WidgetHrLeavesScheduleCtrl",["$scope","$q","ChartFormatterSvc",function(t,e){var n,i;return i=t.widget,t.orgDeferred=e.defer(),n=[t.orgDeferred.promise],i.initContext=function(){var e;return(t.isDataFound=angular.isDefined(i.content)&&!_.isEmpty(i.content.summary))?(e=[],angular.forEach(i.content.summary,function(t){return e.push({title:t.employee_name+" - "+t.title,start:t.start_date,end:t.end_date})}),t.eventSources=angular.copy(e)):void 0},t.widgetDeferred.resolve(n)}]),t.directive("widgetHrLeavesSchedule",function(){return{restrict:"A",controller:"WidgetHrLeavesScheduleCtrl"}}),t.directive("widgetComponentCalendar",function(){return{scope:{events:"=ngModel"},restrict:"A",link:function(t,e){var n,i;return t.eventSources=[],n={header:{left:"prev",center:"title",right:"next"},contentHeight:204},i=function(){return t.events},t.$watch(i,function(i){return i.length>0?(e.fullCalendar("destroy"),angular.extend(n,{events:t.events}),e.fullCalendar(n)):void 0},!0)}}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.hr-payroll-summary",[]),t.controller("WidgetHrPayrollSummaryCtrl",["$scope","$q","ChartFormatterSvc","$filter","ImpacWidgetsSvc",function(t,e,n,i,a){var s,r,o,l;return l=t.widget,t.orgDeferred=e.defer(),t.timeRangeDeferred=e.defer(),t.widthDeferred=e.defer(),t.histModeDeferred=e.defer(),t.chartDeferred=e.defer(),r=[t.orgDeferred.promise,t.timeRangeDeferred.promise,t.widthDeferred.promise,t.histModeDeferred.promise,t.chartDeferred.promise],l.initContext=function(){return!(t.isDataFound=angular.isDefined(l.content)&&!_.isEmpty(l.content.summary)&&!_.isEmpty(l.content.dates))||(t.unCollapsed=l.metadata.unCollapsed||[],l.metadata.selectedElements&&(t.selectedElements=[],angular.forEach(l.metadata.selectedElements,function(e){var n;return n=_.find(l.content.summary,function(t){return t.name===e.name}),n||angular.forEach(l.content.summary,function(t){return null!=t.employees?n||(n=_.find(t.employees,function(t){return e.id===t.id})):void 0}),n?t.selectedElements.push(n):void 0})),null!=t.selectedElements&&t.selectedElements.length>0)?void 0:l.width=6},t.getElementChartColor=function(t){return n.getColor(t)},t.getLastValue=function(t){return null!=t.totals?t.totals[t.totals.length-2]:void 0},t.getTotalSum=function(t){return null!=t.totals?_.reduce(t.totals,function(t,e){return t+e},0):void 0},t.getName=function(t){return null!=t&&null!=t.name?"total_leaves"===t.name?"Total Leaves Accruals":"total_super"===t.name?"Total Superannuation Accruals":"total_reimbursement"===t.name?"Total Reimbursements":"total_tax"===t.name?"Total Taxes":"total_timeoff"===t.name?"Total Time Off":t.name.replace(/_/g," "):void 0},t.getTrackedField=function(){var e,n;return null==t.selectedElements||_.isEmpty(t.selectedElements)||null==t.selectedElements[0].id?void 0:(n=t.selectedElements[0].id.split("-")[0],e=!0,angular.forEach(t.selectedElements,function(t){return e&&(e=t.id&&n===t.id.split("-")[0])}),e?t.getName({name:n}):null)},t.formatDate=function(t){if(null==l.content.hist_parameters)return i("date")(t,"MMM");switch(l.content.hist_parameters.period){case"DAILY":return i("date")(t,"dd-MMM");case"WEEKLY":return i("date")(t,"dd-MMM");case"MONTHLY":return i("date")(t,"MMM");case"QUARTERLY":return i("date")(t,"MMM-yy");case"YEARLY":return i("date")(t,"yyyy");default:return i("date")(t,"MMM")}},t.toggleSelectedElement=function(e){return t.isSelected(e)?(t.selectedElements=_.reject(t.selectedElements,function(t){return e.id?t.id===e.id:t.name===e.name}),l.format(),l.isExpanded()&&0===t.selectedElements.length?l.toggleExpanded():a.updateWidgetSettings(l,!1)):(t.selectedElements||(t.selectedElements=[]),t.selectedElements.push(e),l.format(),l.isExpanded()?a.updateWidgetSettings(l,!1):l.toggleExpanded())},t.isSelected=function(e){return null!=e&&null!=t.selectedElements?_.find(t.selectedElements,function(t){return e.id?t.id===e.id:t.name===e.name})?!0:!1:!1},t.toggleCollapsed=function(e){return null!=e&&null!=e.name?(_.find(t.unCollapsed,function(t){return e.name===t})?t.unCollapsed=_.reject(t.unCollapsed,function(t){return t===e.name}):t.unCollapsed.push(e.name),a.updateWidgetSettings(l,!1)):void 0},t.isCollapsed=function(e){return null!=e&&null!=e.name?_.find(t.unCollapsed,function(t){return e.name===t})?!1:!0:void 0},t.hasElements=function(){return null!=t.selectedElements&&t.selectedElements.length>0},t.drawTrigger=e.defer(),l.format=function(){var e,a,s,r,o,d,c;return t.isDataFound&&t.hasElements()?(l.isHistoryMode?(e=!0,s=[],r=_.map(l.content.dates,function(t){return l.metadata.hist_parameters&&"YEARLY"===l.metadata.hist_parameters.period?i("date")(t,"yyyy"):l.metadata.hist_parameters&&"QUARTERLY"===l.metadata.hist_parameters.period?i("date")(t,"MMM-yy"):!l.metadata.hist_parameters||"WEEKLY"!==l.metadata.hist_parameters.period&&"DAILY"!==l.metadata.hist_parameters.period?i("date")(t,"MMM"):i("date")(t,"dd-MMM")}),angular.forEach(t.selectedElements,function(t){var n;return n=angular.copy(t),s.push({title:n.name,labels:r,values:n.totals}),angular.forEach(n.totals,function(t){return e&&(e=t>=0)})}),o={scaleBeginAtZero:e,showXLabels:!0,datasetFill:1===t.selectedElements.length,pointDot:1===t.selectedElements.length,currency:"hide"},a=n.lineChart(s,o)):(d=_.map(t.selectedElements,function(e){return{label:i("titleize")(t.getName({name:e.name})),value:t.getLastValue(e)}}),c={showTooltips:!0,percentageInnerCutout:50,tooltipFontSize:12,currency:"hide"},a=n.pieChart(d,c)),t.drawTrigger.notify(a)):void 0},o={},o.initialized=!1,o.initialize=function(){return o.initialized=!0},o.toMetadata=function(){return{unCollapsed:t.unCollapsed}},l.settings.push(o),s={},s.initialized=!1,s.initialize=function(){return s.initialized=!0},s.toMetadata=function(){return{selectedElements:t.selectedElements}},l.settings.push(s),t.widgetDeferred.resolve(r)}]),t.directive("widgetHrPayrollSummary",function(){return{restrict:"A",controller:"WidgetHrPayrollSummaryCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.hr-payroll-taxes",[]),t.controller("WidgetHrPayrollTaxesCtrl",["$scope","$q","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s;return s=t.widget,t.orgDeferred=e.defer(),t.timeRangeDeferred=e.defer(),t.histModeDeferred=e.defer(),t.chartDeferred=e.defer(),a=[t.orgDeferred.promise,t.timeRangeDeferred.promise,t.histModeDeferred.promise,t.chartDeferred.promise],s.initContext=function(){return t.isDataFound=null!=s.content&&!_.isEmpty(s.content.total_tax)&&!_.isEmpty(s.content.dates)},t.getCurrentPrice=function(){return t.isDataFound?_.last(s.content.total_tax):void 0},t.getCurrency=function(){return t.isDataFound?s.content.currency||"USD":void 0},t.getPeriod=function(){var e,n;return t.isDataFound&&s.content.hist_parameters?(n=s.content.hist_parameters.period||"MONTHLY",e="day","DAILY"!==n&&(e=n.substr(0,n.length-2).toLowerCase()),"(current "+e+")"):void 0},t.drawTrigger=e.defer(),s.format=function(){var e,a,r,o,l,d;return t.isDataFound?(d=null,null!=s.metadata&&null!=s.metadata.hist_parameters&&(d=s.metadata.hist_parameters.period),r=_.map(s.content.dates,function(t){return i("mnoDate")(t,d)}),o={title:"Payroll Taxes",labels:r,values:s.content.total_tax},e=!0,angular.forEach(s.content.total_tax,function(t){return e&&(e=t>=0)}),l={scaleBeginAtZero:e,showXLabels:!1},a=n.lineChart([o],l),t.drawTrigger.notify(a)):void 0},t.widgetDeferred.resolve(a)}]),t.directive("widgetHrPayrollTaxes",function(){return{restrict:"A",controller:"WidgetHrPayrollTaxesCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.hr-salaries-summary",[]),t.controller("WidgetHrSalariesSummaryCtrl",["$scope","$q","ChartFormatterSvc",function(t,e,n){var i,a;return a=t.widget,t.orgDeferred=e.defer(),t.widthDeferred=e.defer(),t.paramSelectorDeferred1=e.defer(),t.paramSelectorDeferred2=e.defer(),t.chartDeferred=e.defer(),i=[t.orgDeferred.promise,t.widthDeferred.promise,t.paramSelectorDeferred1.promise,t.paramSelectorDeferred2.promise,t.chartDeferred.promise],a.initContext=function(){return(t.isDataFound=!_.isEmpty(a.content)&&null!=a.content.summary&&!_.isEmpty(a.content.summary.data))?(t.periodOptions=[{label:"Yearly",value:"yearly"},{label:"Monthly",value:"monthly"},{label:"Weekly",value:"weekly"},{label:"Hourly",value:"hourly"}],t.period=angular.copy(_.find(t.periodOptions,function(t){return t.value===a.content.total.period.toLowerCase()
})||t.periodOptions[0]),t.filterOptions=[{label:"Gender",value:"gender"},{label:"Age Range",value:"age_range"},{label:"Job Title",value:"job_title"}],t.filter=angular.copy(_.find(t.filterOptions,function(t){return t.value===a.content.summary.filter})||t.filterOptions[0])):void 0},t.getColorByIndex=function(t){return n.getColor(t)},t.drawTrigger=e.defer(),a.format=function(){var e,i,s,r,o;if(t.isDataFound){if(e={labels:_.map(a.content.summary.data,function(t){return t.label}),values:_.map(a.content.summary.data,function(t){return t.value})},"gender"===t.filter.value)i={showTooltips:!1},s=n.barChart(e,i);else if("job_title"===t.filter.value)i={showTooltips:!1,showXLabels:!1,barDatasetSpacing:15},s=n.barChart(e,i);else{if("age_range"!==t.filter.value)return{error:{message:"wrong filter",code:400}};"unknown"===_.last(e.labels)&&(e.labels.pop(),e.values.pop()),r=[{title:"Average salary",labels:e.labels,values:e.values}],o={scaleBeginAtZero:!0,showXLabels:!1},s=n.lineChart(r,o)}return t.drawTrigger.notify(s)}},t.widgetDeferred.resolve(i)}]),t.directive("widgetHrSalariesSummary",function(){return{restrict:"A",controller:"WidgetHrSalariesSummaryCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.hr-superannuation-accruals",[]),t.controller("WidgetHrSuperannuationAccrualsCtrl",["$scope","$q",function(t,e){var n,i;return i=t.widget,t.orgDeferred=e.defer(),t.paramSelectorDeferred=e.defer(),n=[t.orgDeferred.promise,t.paramSelectorDeferred.promise],i.initContext=function(){return(t.isDataFound=!_.isEmpty(i.content)&&!_.isEmpty(i.content.employees))?(t.employeesOptions=_.map(i.content.employees,function(t){return{value:t.uid,label:t.lastname+" "+t.firstname}}),t.selectedEmployee={value:t.getEmployee().uid,label:t.getEmployee().lastname+" "+t.getEmployee().firstname}):void 0},t.getEmployee=function(){var e;return t.isDataFound?(e=i.content.employees[0],i.metadata&&i.metadata.employee_id&&(e=_.find(i.content.employees,function(t){return t.uid===i.metadata.employee_id})||i.content.employees[0]),angular.copy(e)):!1},t.widgetDeferred.resolve(n)}]),t.directive("widgetHrSuperannuationAccruals",function(){return{restrict:"A",controller:"WidgetHrSuperannuationAccrualsCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.hr-timesheets",[]),t.controller("WidgetHrTimesheetsCtrl",["$scope","$q","ChartFormatterSvc","ImpacWidgetsSvc",function(t,e,n,i){var a,s,r;return r=t.widget,t.orgDeferred=e.defer(),t.timeRangeDeferred=e.defer(),t.paramSelectorDeferred=e.defer(),a=[t.orgDeferred.promise,t.timeRangeDeferred.promise,t.paramSelectorDeferred.promise],r.initContext=function(){return(t.isDataFound=angular.isDefined(r.content)&&!_.isEmpty(r.content.employees)&&!_.isEmpty(r.content.dates))?(t.employeesOptions=_.map(r.content.employees,function(t){return{value:t.id,label:t.lastname+" "+t.firstname}}),t.selectedEmployee={value:t.getEmployee().id,label:t.getEmployee().lastname+" "+t.getEmployee().firstname},t.unCollapsed=r.metadata.unCollapsed||[]):void 0},t.toggleCollapsed=function(e){return null!=e?(_.find(t.unCollapsed,function(t){return e===t})?t.unCollapsed=_.reject(t.unCollapsed,function(t){return t===e}):t.unCollapsed.push(e),i.updateWidgetSettings(r,!1)):void 0},t.isCollapsed=function(e){return null!=e?_.find(t.unCollapsed,function(t){return e===t})?!1:!0:void 0},t.getEmployee=function(){return t.isDataFound?r.metadata&&r.metadata.employee_id?_.find(r.content.employees,function(t){return t.id===r.metadata.employee_id})||r.content.employees[0]:r.content.employees[0]:!1},t.getEmployeeTimeWorked=function(){var e;return(e=t.getEmployee())?_.find(r.content.employees,function(t){return t.id===e.id}).total_time_worked:void 0},t.getEmployeeTimeOff=function(){var e;return(e=t.getEmployee())?_.find(r.content.employees,function(t){return t.id===e.id}).total_time_off:void 0},s={},s.initialized=!1,s.initialize=function(){return s.initialized=!0},s.toMetadata=function(){return{unCollapsed:t.unCollapsed}},r.settings.push(s),t.widgetDeferred.resolve(a)}]),t.directive("widgetHrTimesheets",function(){return{restrict:"A",controller:"WidgetHrTimesheetsCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.hr-workforce-summary",[]),t.controller("WidgetHrWorkforceSummaryCtrl",["$scope","$q","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s;return s=t.widget,t.orgDeferred=e.defer(),t.widthDeferred=e.defer(),t.paramSelectorDeferred1=e.defer(),t.paramSelectorDeferred2=e.defer(),t.chartDeferred=e.defer(),a=[t.orgDeferred.promise,t.widthDeferred.promise,t.paramSelectorDeferred1.promise,t.paramSelectorDeferred2.promise,t.chartDeferred.promise],s.initContext=function(){return(t.isDataFound=!_.isEmpty(s.content)&&null!=s.content.summary&&!_.isEmpty(s.content.summary.data))?(t.periodOptions=[{label:"Yearly",value:"yearly"},{label:"Monthly",value:"monthly"},{label:"Weekly",value:"weekly"},{label:"Hourly",value:"hourly"}],t.period=angular.copy(_.find(t.periodOptions,function(t){return t.value===s.content.total.period.toLowerCase()})||t.periodOptions[0]),t.filterOptions=[{label:"Gender",value:"gender"},{label:"Age Range",value:"age_range"},{label:"Salary Range",value:"salary_range"},{label:"Job Title",value:"job_title"}],t.filter=angular.copy(_.find(t.filterOptions,function(t){return t.value===s.content.summary.filter})||t.filterOptions[0])):void 0},t.getTotalWorkforce=function(){return t.isDataFound?s.content.total.amount:void 0},t.getNumberOfEmployees=function(){return t.isDataFound?s.content.total.employees:void 0},t.getCurrency=function(){return t.isDataFound?s.content.total.currency:void 0},t.formatSalaryRange=function(t){var e,n;return e=i("mnoCurrency")(t.label.split("-")[0],t.currency,!1),n=i("mnoCurrency")(t.label.split("-")[1],t.currency,!1),[e,n].join(" - ")},t.getColorByIndex=function(t){return n.getColor(t)},t.drawTrigger=e.defer(),s.format=function(){var e,i,a,r,o;return t.isDataFound?("salary_range"===t.filter.value?(e={labels:_.map(s.content.summary.data,function(e){return t.formatSalaryRange(e)}),values:_.map(s.content.summary.data,function(t){return t.value})},i={showTooltips:!1,showXLabels:!1,barDatasetSpacing:15},a=n.barChart(e,i)):(r=_.map(s.content.summary.data,function(t){return{label:t.label,value:t.value}}),o={showTooltips:!0,percentageInnerCutout:50,tooltipFontSize:12},a=n.pieChart(r,o)),t.drawTrigger.notify(a)):void 0},t.widgetDeferred.resolve(a)}]),t.directive("widgetHrWorkforceSummary",function(){return{restrict:"A",controller:"WidgetHrWorkforceSummaryCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.invoices-aged-payables-receivables",[]),t.controller("WidgetInvoicesAgedPayablesReceivablesCtrl",["$scope","$q","$log","$filter","ChartFormatterSvc","ImpacWidgetsSvc",function(t,e,n,i,a,s){var r,o,l,d;return d=t.widget,t.orgDeferred=e.defer(),t.timeRangeDeferred=e.defer(),t.widthDeferred=e.defer(),t.chartDeferred=e.defer(),o=[t.orgDeferred.promise,t.timeRangeDeferred.promise,t.widthDeferred.promise,t.chartDeferred.promise],d.initContext=function(){return!(t.isDataFound=!(!angular.isDefined(d.content)||_.isEmpty(d.content.payables)&&_.isEmpty(d.content.receivables)||_.isEmpty(d.content.dates)))||(t.unCollapsed=d.metadata.unCollapsed||[],d.metadata.selectedElements&&(t.selectedElements=[],angular.forEach(d.metadata.selectedElements,function(e){var n;return"aged_payables"===e.name&&(n=d.content.payables),"aged_receivables"!==e.name||n||(n=d.content.receivables),n||(n=_.find(d.content.payables.suppliers,function(t){return t.id===e.id})),n||(n=_.find(d.content.receivables.customers,function(t){return t.id===e.id})),n?t.selectedElements.push(n):void 0})),null!=t.selectedElements&&t.selectedElements.length>0)?void 0:d.width=6},t.getElementChartColor=function(t){return null!=t?a.getColor(t):void 0},t.getLastValue=function(t){return null!=t&&null!=t.totals?_.last(t.totals):void 0},t.getTotalSum=function(t){return null!=t&&null!=t.totals?_.reduce(t.totals,function(t,e){return t+e},0):void 0},t.getName=function(t){return null!=t&&null!=t.name?t.name.replace(/_/g," "):void 0},t.getPeriod=function(){var e,n;return t.isDataFound&&d.content.hist_parameters?(n=d.content.hist_parameters.period||"MONTHLY",e="day","DAILY"!==n&&(e=n.substr(0,n.length-2).toLowerCase()),"current "+e):"current month"},t.toggleSelectedElement=function(e){return t.isSelected(e)?(t.selectedElements=_.reject(t.selectedElements,function(t){return e.id?t.id===e.id:t.name===e.name}),d.format(),d.isExpanded()&&0===t.selectedElements.length?d.toggleExpanded():s.updateWidgetSettings(d,!1)):(t.selectedElements||(t.selectedElements=[]),t.selectedElements.push(e),d.format(),d.isExpanded()?s.updateWidgetSettings(d,!1):d.toggleExpanded())},t.isSelected=function(e){return null!=e&&null!=t.selectedElements?_.find(t.selectedElements,function(t){return e.id?t.id===e.id:t.name===e.name})?!0:!1:!1},t.toggleCollapsed=function(e){return null!=e&&null!=e.name?(_.find(t.unCollapsed,function(t){return e.name===t})?t.unCollapsed=_.reject(t.unCollapsed,function(t){return t===e.name}):t.unCollapsed.push(e.name),s.updateWidgetSettings(d,!1)):void 0},t.isCollapsed=function(e){return null!=e&&null!=e.name?_.find(t.unCollapsed,function(t){return e.name===t})?!1:!0:void 0},t.hasElements=function(){return null!=t.selectedElements&&t.selectedElements.length>0},t.drawTrigger=e.defer(),d.format=function(){var e,n,s,r,o,l;return t.isDataFound&&null!=t.selectedElements&&t.selectedElements.length>0?(e=!0,r=[],l=null,null!=d.metadata&&null!=d.metadata.hist_parameters&&(l=d.metadata.hist_parameters.period),s=_.map(d.content.dates,function(t){return i("mnoDate")(t,l)}),angular.forEach(t.selectedElements,function(t){var n;return n=angular.copy(t),r.push({title:n.name,labels:s,values:n.totals}),angular.forEach(n.totals,function(t){return e&&(e=t>=0)})}),o={scaleBeginAtZero:e,showXLabels:!0,datasetFill:1===t.selectedElements.length,pointDot:1===t.selectedElements.length},n=a.lineChart(r,o),t.drawTrigger.notify(n)):void 0},l={},l.initialized=!1,l.initialize=function(){return l.initialized=!0},l.toMetadata=function(){return{unCollapsed:t.unCollapsed}},d.settings.push(l),r={},r.initialized=!1,r.initialize=function(){return r.initialized=!0},r.toMetadata=function(){return{selectedElements:t.selectedElements}},d.settings.push(r),t.widgetDeferred.resolve(o)}]),t.directive("widgetInvoicesAgedPayablesReceivables",function(){return{restrict:"A",controller:"WidgetInvoicesAgedPayablesReceivablesCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.invoices-list",[]),t.controller("WidgetInvoicesListCtrl",["$scope","$q","$filter",function(t,e,n){var i,a;return a=t.widget,t.orgDeferred=e.defer(),t.limitEntriesDeferred=e.defer(),t.datesPickerDeferred=e.defer(),i=[t.orgDeferred.promise,t.limitEntriesDeferred.promise,t.datesPickerDeferred.promise],a.initContext=function(){var e,i,s,r,o,l,d,c,u,g,h;if(t.isDataFound=!_.isEmpty(a.content)&&!_.isEmpty(a.content.entities),t.isDataFound&&"due "===t.orderBy&&(t.limitEntriesLabel="suppliers"===t.entityType?"creditors":"debtors"),null!=a.metadata&&null!=a.metadata.limit_entries&&(t.limitEntriesSelected=a.metadata.limit_entries),t.isDataFound){for(d=new Date,c=!1,s=_.flatten(_.map(a.content.entities,function(t){return _.map(t.invoices,function(t){return t.invoice_date})})),r=0,o=s.length;o>r;r++)i=s[r],_.isEmpty(i)||(g=i.split("-"),h=g[0],l=g[1]-1,e=g[2],u=new Date(h,l,e),c||(c=u),c=Math.min(c,u),d=Math.max(d,u));return c||(c=new Date((new Date).getFullYear()-10,0,1)),t.defaultFrom=n("date")(c,"yyyy-MM-dd"),t.defaultTo=n("date")(d,"yyyy-MM-dd")}},t.entityType=a.metadata.entity,t.entityTypeCap=_.capitalize(a.metadata.entity),t.orderBy=_.isEmpty(a.metadata.order_by)||"name"===a.metadata.order_by||"total_invoiced"===a.metadata.order_by?"":_.last(a.metadata.order_by.split("_")).concat(" "),t.getInvoices=function(t){var e,i;return i=["<strong>"+t.name+"</strong>"],e=1,angular.forEach(t.invoices,function(t){var a,s;return s=""!==t.transaction_no?" ("+t.transaction_no+")":"",a="partially paid"===t.tooltip_status?" ("+n("mnoCurrency")(t.paid,t.currency,!1)+" over "+n("mnoCurrency")(t.invoiced,t.currency,!1)+")":" ("+n("mnoCurrency")(t.invoiced,t.currency,!1)+")",i.push("#"+e+s+" - "+t.tooltip_status+a),e++}),i.join("<br />")},t.widgetDeferred.resolve(i)}]),t.directive("widgetInvoicesList",function(){return{restrict:"A",controller:"WidgetInvoicesListCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.invoices-summary",[]),t.controller("WidgetInvoicesSummaryCtrl",["$scope","$q","ChartFormatterSvc",function(t,e,n){var i,a;return a=t.widget,t.orgDeferred=e.defer(),t.chartFiltersDeferred=e.defer(),t.chartDeferred=e.defer(),t.datesPickerDeferred=e.defer(),i=[t.orgDeferred.promise,t.chartFiltersDeferred.promise,t.chartDeferred.promise,t.datesPickerDeferred.promise],t.defaultFrom=(new Date).getFullYear()-10+"-01-01",a.initContext=function(){return t.isDataFound=!_.isEmpty(a.content)&&!_.isEmpty(a.content.summary)},t.drawTrigger=e.defer(),a.format=function(){var e,i,s;return t.isDataFound?(i=_.map(a.content.summary,function(t){return{label:t.name,value:t.total}}),s={percentageInnerCutout:50,tooltipFontSize:12},e=n.pieChart(i,s),t.drawTrigger.notify(e)):void 0},t.widgetDeferred.resolve(i)}]),t.directive("widgetInvoicesSummary",function(){return{restrict:"A",controller:"WidgetInvoicesSummaryCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-aged",[]),t.controller("WidgetSalesAgedCtrl",["$scope","$q","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s;return s=t.widget,t.orgDeferred=e.defer(),t.timeRangeDeferred=e.defer(),t.paramSelectorDeferred=e.defer(),t.chartDeferred=e.defer(),a=[t.orgDeferred.promise,t.timeRangeDeferred.promise,t.paramSelectorDeferred.promise,t.chartDeferred.promise],s.initContext=function(){return(t.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.aged_sales)&&!_.isEmpty(s.content.dates))?(t.filterOptions=[{label:"value sold (incl. taxes)",value:"gross_value_sold"},{label:"value sold (excl. taxes)",value:"net_value_sold"},{label:"quantity sold",value:"quantity_sold"}],t.filter=angular.copy(_.find(t.filterOptions,function(t){return s.metadata&&s.metadata.filter===t.value})||t.filterOptions[0])):void 0},t.getTotal=function(e){return t.isDataFound&&e>=0&&e<s.content.aged_sales[t.filter.value].length?s.content.aged_sales[t.filter.value][e]:void 0},t.getLastDate=function(){return t.isDataFound?_.last(s.content.dates):void 0},t.getClassColor=function(t,e){return t>e?"negative":e>t?"positive":null},t.drawTrigger=e.defer(),s.format=function(){var e,a,r,o,l,d;return t.isDataFound?(e=!0,r=[],d=s.content.aged_sales[t.filter.value],l=null,null!=s.metadata&&null!=s.metadata.hist_parameters&&(l=s.metadata.hist_parameters.period),t.formattedDates=_.map(s.content.dates,function(t){return i("mnoDate")(t,l)}),r.push({title:t.filter.label,labels:t.formattedDates,values:d}),angular.forEach(d,function(t){return e&&(e=t>=0)}),o={scaleBeginAtZero:e,showXLabels:!0,datasetFill:!0,pointDot:!0},t.filter.value.indexOf("quantity")>-1&&angular.merge(o,{currency:"hide"}),a=n.lineChart(r,o),t.drawTrigger.notify(a)):void 0},t.widgetDeferred.resolve(a)}]),t.directive("widgetSalesAged",function(){return{restrict:"A",controller:"WidgetSalesAgedCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-break-even",[]),t.controller("WidgetSalesBreakEvenCtrl",["$scope","$q","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s,r;return r=t.widget,t.orgDeferred=e.defer(),t.timeRangeDeferred=e.defer(),a=[t.orgDeferred.promise,t.timeRangeDeferred.promise],r.initContext=function(){return t.isDataFound=angular.isDefined(r.content)&&!_.isEmpty(r.content.sales),t.threshold=r.metadata.threshold},r.processError=function(e){return 404===e.code?t.isDataFound=!1:void 0},t.getProjectedDate=function(){var e;return t.isDataFound&&r.content.break_even?(""+r.content.break_even.projected_date).match("After")?(e=angular.copy(r.content.break_even.projected_date).replace("After ",""),"> "+i("date")(e,"d-MM-yy")):r.content.break_even.projected_date:void 0},t.getOpportunitiesToClose=function(){var e;return t.isDataFound&&r.content.break_even?(""+r.content.break_even.opportunities_to_close).match(">")?(e=angular.copy(r.content.break_even.opportunities_to_close).replace(">",""),"> "+e):r.content.break_even.opportunities_to_close:void 0},t.isTargetMet=function(){return t.isDataFound&&r.content.break_even?r.content.break_even.variance<0:void 0},t.getVariance=function(){return t.isDataFound&&r.content.break_even?Math.abs(r.content.break_even.variance):void 0},s={},s.initialized=!1,s.initialize=function(){return s.initialized=!0},s.toMetadata=function(){return{threshold:t.threshold}},r.settings.push(s),t.widgetDeferred.resolve(a)}]),t.directive("widgetSalesBreakEven",function(){return{restrict:"A",controller:"WidgetSalesBreakEvenCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-comparison",[]),t.controller("WidgetSalesComparisonCtrl",["$scope","$q","$filter","ChartFormatterSvc","ImpacWidgetsSvc",function(t,e,n,i,a){var s,r,o,l;return l=t.widget,t.orgDeferred=e.defer(),t.timeRangeDeferred=e.defer(),t.widthDeferred=e.defer(),t.paramSelectorDeferred1=e.defer(),t.paramSelectorDeferred2=e.defer(),t.chartDeferred=e.defer(),r=[t.orgDeferred.promise,t.timeRangeDeferred.promise,t.widthDeferred.promise,t.paramSelectorDeferred1,t.paramSelectorDeferred2,t.chartDeferred.promise],l.initContext=function(){return t.isDataFound=angular.isDefined(l.content)&&!_.isEmpty(l.content.sales_comparison)&&!_.isEmpty(l.content.dates),t.isDataFound&&(t.unCollapsed=l.metadata.unCollapsed||[],t.filterOptions=[{label:"value sold (incl. taxes)",value:"gross_value_sold"},{label:"value sold (excl. taxes)",value:"net_value_sold"},{label:"quantity sold",value:"quantity_sold"}],t.filter=angular.copy(_.find(t.filterOptions,function(t){return l.metadata&&l.metadata.filter===t.value})||t.filterOptions[0]),t.criteriaOptions=[{label:"products",value:"default"},{label:"locations",value:"location"},{label:"industries",value:"industry"},{label:"customers",value:"customer"}],t.criteria=angular.copy(_.find(t.criteriaOptions,function(t){return l.metadata&&l.metadata.criteria===t.value})||t.criteriaOptions[0]),l.metadata.selectedElements)?(t.selectedElements=[],angular.forEach(l.metadata.selectedElements,function(e){var n;return n=_.find(l.content.sales_comparison,function(t){return t.name===e.name}),n||angular.forEach(l.content.sales_comparison,function(t){return null!=t.sales?n||(n=_.find(t.sales,function(t){return e.id===t.id})):void 0}),n?t.selectedElements.push(n):void 0})):void 0},t.getLastDate=function(){return t.isDataFound?_.last(l.content.dates):void 0},t.getTotalForPeriod=function(e){return null!=e.totals&&t.filter?_.reduce(e.totals[t.filter.value],function(t,e){return t+e},0):void 0},t.getElementChartColor=function(t){return i.getColor(t)},t.toggleSelectedElement=function(e){return t.isSelected(e)?(t.selectedElements=_.reject(t.selectedElements,function(t){return e.id?t.id===e.id:t.name===e.name}),l.format(),l.isExpanded()&&0===t.selectedElements.length?l.toggleExpanded():a.updateWidgetSettings(l,!1)):(t.selectedElements||(t.selectedElements=[]),t.selectedElements.push(e),l.format(),l.isExpanded()?a.updateWidgetSettings(l,!1):l.toggleExpanded())},t.isSelected=function(e){return null!=e&&null!=t.selectedElements?_.find(t.selectedElements,function(t){return e.id?t.id===e.id:t.name===e.name})?!0:!1:!1},t.toggleCollapsed=function(e){return null!=e&&null!=e.name?(_.find(t.unCollapsed,function(t){return e.name===t})?t.unCollapsed=_.reject(t.unCollapsed,function(t){return t===e.name}):t.unCollapsed.push(e.name),a.updateWidgetSettings(l,!1)):void 0},t.isCollapsed=function(e){return null!=e&&null!=e.name?_.find(t.unCollapsed,function(t){return e.name===t})?!1:!0:void 0},t.hasElements=function(){return null!=t.selectedElements&&t.selectedElements.length>0},t.drawTrigger=e.defer(),l.format=function(){var e,a,s,r;return t.isDataFound&&null!=t.selectedElements&&t.selectedElements.length>0?(e=!0,s=[],angular.forEach(t.selectedElements,function(i){var a,r,o;return a=angular.copy(i),o=null,null!=l.metadata&&null!=l.metadata.hist_parameters&&(o=l.metadata.hist_parameters.period),r=_.map(l.content.dates,function(t){return n("mnoDate")(t,o)}),s.push({title:a.name,labels:r,values:a.totals[t.filter.value]}),angular.forEach(a.totals,function(t){return e&&(e=t>=0)})}),r={scaleBeginAtZero:e,showXLabels:!0,datasetFill:!1,pointDot:!1},t.filter.value.indexOf("quantity")>-1&&angular.merge(r,{currency:"hide"}),a=i.lineChart(s,r),t.drawTrigger.notify(a)):void 0},o={},o.initialized=!1,o.initialize=function(){return o.initialized=!0},o.toMetadata=function(){return{unCollapsed:t.unCollapsed}},l.settings.push(o),s={},s.initialized=!1,s.initialize=function(){return s.initialized=!0},s.toMetadata=function(){return{selectedElements:t.selectedElements}},l.settings.push(s),t.widgetDeferred.resolve(r)}]),t.directive("widgetSalesComparison",function(){return{restrict:"A",controller:"WidgetSalesComparisonCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-customer-details",[]),t.controller("WidgetSalesCustomerDetailsCtrl",["$scope","$q",function(t,e){var n,i;return i=t.widget,t.orgDeferred=e.defer(),t.timeRangeDeferred=e.defer(),t.widthDeferred=e.defer(),t.paramSelectorDeferred=e.defer(),n=[t.orgDeferred.promise,t.timeRangeDeferred.promise,t.widthDeferred.promise,t.paramSelectorDeferred.promise],i.initContext=function(){return t.isDataFound=null!=i.content&&!_.isEmpty(i.content.customers),t.isDataFound?(t.customersOptions=_.map(i.content.customers,function(t){return{value:t.uid,label:t.name}}),t.selectedCustomer={value:t.getCustomer().uid,label:t.getCustomer().name}):void 0},t.getCustomer=function(){var e;return t.isDataFound?e=i.metadata&&i.metadata.customer_uid?angular.copy(_.find(i.content.customers,function(t){return t.uid===i.metadata.customer_uid})||i.content.customers[0]):angular.copy(i.content.customers[0]):!1},t.formatAddress=function(t){return angular.isDefined(t)?t.replace(/, /g,",\n"):void 0},t.getFromDate=function(){return t.isDataFound?i.content.from:void 0},t.getToDate=function(){return t.isDataFound?i.content.to:void 0},t.widgetDeferred.resolve(n)}]),t.directive("widgetSalesCustomerDetails",function(){return{restrict:"A",controller:"WidgetSalesCustomerDetailsCtrl"}})}.call(this),function(){"use strict";var t,e=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};t=angular.module("impac.components.widgets.sales-cycle",[]),t.controller("WidgetSalesCycleCtrl",["$scope","$q","ChartFormatterSvc","$filter",function(t,n,i,a){var s,r;return r=t.widget,t.orgDeferred=n.defer(),t.paramsPickerDeferred=n.defer(),t.timeRangeDeferred=n.defer(),t.chartDeferred=n.defer(),s=[t.orgDeferred.promise,t.paramsPickerDeferred.promise,t.timeRangeDeferred.promise,t.chartDeferred.promise],r.initContext=function(){return(t.isDataFound=angular.isDefined(r.content)&&!_.isEmpty(r.content.status_average_durations))?(t.unit=(r.metadata.unit||r.content.unit||"days").toLowerCase(),t.statusOptions=_.compact(_.map(r.metadata.status_selection,function(t){return angular.isDefined(r.content.status_average_durations[t])?{label:t,selected:!0}:void 0})),angular.forEach(r.content.status_average_durations,function(n,i){return!r.metadata.status_selection||e.call(r.metadata.status_selection,i)>=0?_.isEmpty(r.metadata.status_selection)?t.statusOptions.push({label:i,selected:!0}):void 0:t.statusOptions.push({label:i,selected:!1})})):void 0},r.processError=function(e){return 404===e.code?t.isDataFound=!1:void 0},t.drawTrigger=n.defer(),r.format=function(){var e,n,s;return t.isDataFound?(n=_.compact(_.map(t.statusOptions,function(e){var n;return n=r.content.status_average_durations[e.label],e.selected&&angular.isDefined(n)?{label:a("titleize")(e.label)+": "+n+" "+t.unit,value:n}:void 0})),s={percentageInnerCutout:50,tooltipFontSize:12,currency:r.content.unit},e=i.pieChart(n,s),t.drawTrigger.notify(e)):void 0},t.widgetDeferred.resolve(s)}]),t.directive("widgetSalesCycle",function(){return{restrict:"A",controller:"WidgetSalesCycleCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-forecast",[]),t.controller("WidgetSalesForecastCtrl",["$scope","$q","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s;return s=t.widget,t.orgDeferred=e.defer(),t.chartDeferred=e.defer(),a=[t.orgDeferred.promise,t.chartDeferred.promise],s.initContext=function(){return t.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.dates)&&!_.isEmpty(s.content.totals)},s.processError=function(e){return 404===e.code?t.isDataFound=!1:void 0},t.getOpportunityAmount=function(e){return t.isDataFound&&!_.isEmpty(e)?e.amount&&e.amount.amount?e.amount.amount:"-":void 0},t.getOpportunityCurrency=function(e){return t.isDataFound&&!_.isEmpty(e)?e.amount&&e.amount.currency?e.amount.currency:s.content.currency?s.content.currency:"AUD":void 0},t.drawTrigger=e.defer(),s.format=function(){var e,a,r,o,l,d;return t.isDataFound?(e=!0,d=null,null!=s.metadata&&null!=s.metadata.hist_parameters&&(d=s.metadata.hist_parameters.period),r=_.map(s.content.dates,function(t){return i("mnoDate")(t,d)}),o=[{title:"Sales Performance",labels:r,values:s.content.totals}],angular.forEach(s.content.totals,function(t){return e&&(e=t>=0)}),l={scaleBeginAtZero:e,showXLabels:!0,datasetFill:!0,pointDot:!1},a=n.lineChart(o,l),t.drawTrigger.notify(a)):void 0},t.widgetDeferred.resolve(a)}]),t.directive("widgetSalesForecast",function(){return{restrict:"A",controller:"WidgetSalesForecastCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-growth",[]),t.controller("WidgetSalesGrowthCtrl",["$scope","$q","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s;return s=t.widget,t.orgDeferred=e.defer(),t.timeRangeDeferred=e.defer(),t.paramSelectorDeferred1=e.defer(),t.paramSelectorDeferred2=e.defer(),t.chartDeferred=e.defer(),a=[t.orgDeferred.promise,t.timeRangeDeferred.promise,t.paramSelectorDeferred1.promise,t.paramSelectorDeferred2.promise,t.chartDeferred.promise],t.isDataQuantity=!0,s.initContext=function(){return(t.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.summary)&&!_.isEmpty(s.content.dates))?(t.productOptions=_.flatten(_.map(s.content.summary,function(t){return{label:t.code,value:t.id}})),t.product=angular.copy(_.find(t.productOptions,function(t){return t.value===s.content.product})||{label:"SELECT PRODUCT",value:-1}),t.filterOptions=[{label:"value sold (incl. taxes)",value:"gross_value_sold"},{label:"value sold (excl. taxes)",value:"net_value_sold"},{label:"quantity sold",value:"quantity_sold"},{label:"value purchased (incl. taxes)",value:"gross_value_purchased"},{label:"value purchased (excl. taxes)",value:"net_value_purchased"},{label:"quantity purchased",value:"quantity_purchased"}],t.filter=angular.copy(_.find(t.filterOptions,function(t){return t.value===s.content.filter})||t.filterOptions[0]),t.isDataQuantity=t.filter.value.match("quantity")):void 0},t.getSelectedProduct=function(){return t.isDataFound?_.find(s.content.summary,function(e){return e.id===t.product.value}):void 0},t.getCurrentValue=function(){return null!=t.getSelectedProduct()?_.last(t.getSelectedProduct().totals):void 0},t.getCurrentDate=function(){return t.isDataFound?_.last(s.content.dates):void 0},t.drawTrigger=e.defer(),s.format=function(){var e,a,r,o,l,d,c;return t.isDataFound&&t.product&&(r=t.getSelectedProduct())?(c=null,null!=s.metadata&&null!=s.metadata.hist_parameters&&(c=s.metadata.hist_parameters.period),o=_.map(s.content.dates,function(t){return i("mnoDate")(t,c)}),l={title:r.name,labels:o,values:r.totals},e=!0,angular.forEach(r.totals,function(t){return e&&(e=t>=0)}),d={scaleBeginAtZero:e,showXLabels:!1},t.filter.value.indexOf("quantity")>-1&&angular.merge(d,{currency:"hide"}),a=n.lineChart([l],d),t.drawTrigger.notify(a)):void 0},t.widgetDeferred.resolve(a)}]),t.directive("widgetSalesGrowth",function(){return{restrict:"A",controller:"WidgetSalesGrowthCtrl"}})}.call(this),function(){"use strict";var t,e=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};t=angular.module("impac.components.widgets.sales-leads-funnel",[]),t.controller("WidgetSalesLeadsFunnelCtrl",["$scope","$q","ChartFormatterSvc","$filter","ImpacWidgetsSvc",function(t,n,i,a,s){var r,o,l,d;return d=t.widget,t.orgDeferred=n.defer(),t.timeRangeDeferred=n.defer(),t.paramsPickerDeferred=n.defer(),t.widthDeferred=n.defer(),l=[t.orgDeferred.promise,t.timeRangeDeferred.promise,t.paramsPickerDeferred.promise,t.widthDeferred.promise],r=function(t){var e,n,i;return e=_.mapValues(t,function(t){return t.total}),i=_.compact(_.values(e)),n=_.reduce(i,function(t,e){return null==t&&(t=0),t+e}),null!=n&&n>0},d.initContext=function(){return(t.isDataFound=angular.isDefined(d.content)&&!_.isEmpty(d.content.leads_per_status)&&r(d.content.leads_per_status))?(t.statusOptions=_.compact(_.map(d.metadata.status_selection,function(t){return angular.isDefined(d.content.leads_per_status[t])?{label:t,selected:!0}:void 0})),angular.forEach(d.content.leads_per_status,function(n,i){return!d.metadata.status_selection||e.call(d.metadata.status_selection,i)>=0?_.isEmpty(d.metadata.status_selection)?t.statusOptions.push({label:i,selected:!0}):void 0:t.statusOptions.push({label:i,selected:!1})})):void 0},d.processError=function(e){return 404===e.code?t.isDataFound=!1:void 0},t.getImpacColor=function(t){return i.getColor(t)},t.toggleSelectStatus=function(e){return t.selectedStatus=t.selectedStatus&&t.selectedStatus===e?null:e,!d.isExpanded()&&t.selectedStatus?d.toggleExpanded():s.updateWidgetSettings(d,!1)},t.isSelected=function(e){return t.selectedStatus&&e===t.selectedStatus},t.getSelectedLeads=function(){return t.isDataFound&&t.selectedStatus?d.content.leads_per_status[t.selectedStatus].leads:void 0},t.getLeadDescription=function(t){var e,n;return n=[],e=["<strong>"],t.first_name&&e.push(a("titleize")(t.first_name)),t.last_name&&e.push(a("titleize")(t.last_name)),e.push("</strong>"),n.push(e.join(" ")),n.push("Status: "+a("titleize")(t.lead_status)),t.organization&&n.push("Organization: "+a("titleize")(t.organization)),t.opportunities&&(n.push("<strong>Opportunities:</strong>"),angular.forEach(t.opportunities,function(t){var e;return e=[],t.code&&e.push("#"+t.code),t.name&&e.push(""+t.name),t.amount&&e.push(a("mnoCurrency")(t.amount.total_amount,"USD",!1)),t.probability&&e.push(t.probability+"%"),t.sales_stage&&e.push(""+t.sales_stage),n.push(e.join(" - "))})),n.join("<br />")},o={},o.initialized=!1,o.initialize=function(){return!_.isEmpty(d.content)&&angular.isDefined(d.content.leads_per_status[d.metadata.selected_status])&&(t.selectedStatus=d.metadata.selected_status),o.initialized=!0},o.toMetadata=function(){return{selected_status:t.selectedStatus}},d.settings.push(o),d.format=function(){var e;return t.isDataFound&&(e=0,angular.forEach(t.statusOptions,function(t){var n;return n=d.content.leads_per_status[t.label].total,t.selected&&angular.isDefined(n)&&n>e?e=n:void 0}),e>0)?t.funnel=_.compact(_.map(t.statusOptions,function(t){var n,i,a;return a=d.content.leads_per_status[t.label].total,n=(100*(a/e)-10).toFixed(),i=8>n?92:100-n,t.selected&&angular.isDefined(a)?{status:t.label,number:a,coloredWidth:{width:n+"%"},statusWidth:{width:i+"%"}}:void 0})):void 0},t.widgetDeferred.resolve(l)}]),t.directive("widgetSalesLeadsFunnel",function(){return{restrict:"A",controller:"WidgetSalesLeadsFunnelCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-leads-list",[]),t.controller("WidgetSalesLeadsListCtrl",["$scope","$q","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s;
return s=t.widget,t.orgDeferred=e.defer(),a=[t.orgDeferred.promise],s.initContext=function(){return t.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.leads)},s.processError=function(e){return 404===e.code?t.isDataFound=!1:void 0},t.getLeadDescription=function(t){var e,n;return n=[],e=["<strong>"],t.first_name&&e.push(i("titleize")(t.first_name)),t.last_name&&e.push(i("titleize")(t.last_name)),e.push("</strong>"),n.push(e.join(" ")),n.push("Status: "+i("titleize")(t.lead_status)),t.organization&&n.push("Organization: "+i("titleize")(t.organization)),t.opportunities&&(n.push("<strong>Opportunities:</strong>"),angular.forEach(t.opportunities,function(t){var e;return e=[],t.code&&e.push("#"+t.code),t.name&&e.push(""+t.name),t.amount&&e.push(i("mnoCurrency")(t.amount.total_amount,"USD",!1)),t.probability&&e.push(t.probability+"%"),t.sales_stage&&e.push(""+t.sales_stage),n.push(e.join(" - "))})),n.join("<br />")},t.widgetDeferred.resolve(a)}]),t.directive("widgetSalesLeadsList",function(){return{restrict:"A",controller:"WidgetSalesLeadsListCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-list",[]),t.controller("WidgetSalesListCtrl",["$scope","$q","ChartFormatterSvc","ImpacWidgetsSvc",function(t,e,n,i){var a,s,r;return r=t.widget,t.orgDeferred=e.defer(),t.paramSelectorDeferred=e.defer(),t.datesPickerDeferred=e.defer(),a=[t.orgDeferred.promise,t.paramSelectorDeferred.promise,t.datesPickerDeferred.promise],r.initContext=function(){return t.isDataFound=angular.isDefined(r.content)&&!_.isEmpty(r.content.summary),t.filterOptions=[{label:"value sold (incl. taxes)",value:"gross_value_sold"},{label:"value sold (excl. taxes)",value:"net_value_sold"},{label:"quantity sold",value:"quantity_sold"},{label:"value purchased (incl. taxes)",value:"gross_value_purchased"},{label:"value purchased (excl. taxes)",value:"net_value_purchased"},{label:"quantity purchased",value:"quantity_purchased"}],t.filter=angular.copy(_.find(t.filterOptions,function(t){return t.value===r.metadata.filter})||t.filterOptions[0]),t.unCollapsed=r.metadata.unCollapsed||[]},t.toggleCollapsed=function(e){return null!=e?(_.find(t.unCollapsed,function(t){return e===t})?t.unCollapsed=_.reject(t.unCollapsed,function(t){return t===e}):t.unCollapsed.push(e),i.updateWidgetSettings(r,!1)):void 0},t.isCollapsed=function(e){return null!=e?_.find(t.unCollapsed,function(t){return e===t})?!1:!0:void 0},s={},s.initialized=!1,s.initialize=function(){return s.initialized=!0},s.toMetadata=function(){return{unCollapsed:t.unCollapsed}},r.settings.push(s),t.widgetDeferred.resolve(a)}]),t.directive("widgetSalesList",function(){return{restrict:"A",controller:"WidgetSalesListCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-margin",[]),t.controller("WidgetSalesMarginCtrl",["$scope","$q","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s;return s=t.widget,t.orgDeferred=e.defer(),t.timeRangeDeferred=e.defer(),t.histModeDeferred=e.defer(),t.paramSelectorDeferred=e.defer(),t.chartDeferred=e.defer(),a=[t.orgDeferred.promise,t.timeRangeDeferred.promise,t.histModeDeferred.promise,t.paramSelectorDeferred.promise,t.chartDeferred.promise],s.initContext=function(){return t.isDataFound=null!=s.content&&null!=s.content.margins&&null!=s.content.dates,t.filterOptions=[{label:"Including taxes",value:"gross_margin"},{label:"Excluding taxes",value:"net_margin"}],t.filter=null!=s.metadata&&"net_margin"===s.metadata.filter?angular.copy(t.filterOptions[1]):angular.copy(t.filterOptions[0])},t.getTotalMargin=function(){return t.isDataFound?null!=s.metadata&&"net_margin"===s.metadata.filter?_.reduce(s.content.margins.net,function(t,e){return t+e},0):_.reduce(s.content.margins.gross,function(t,e){return t+e},0):void 0},t.getCurrency=function(){return t.isDataFound?s.content.currency||"USD":void 0},t.getTimeSpan=function(){var e;return t.isDataFound?(e=null,null!=s.metadata&&null!=s.metadata.hist_parameters&&(e=s.metadata.hist_parameters.period),"From "+i("mnoDate")(_.first(s.content.dates),e)+" to "+i("mnoDate")(_.last(s.content.dates),e)):void 0},t.drawTrigger=e.defer(),s.format=function(){var e,a,r,o,l,d,c;return t.isDataFound?(c=null!=s.metadata&&"net_margin"===s.metadata.filter?s.content.margins.net:s.content.margins.gross,d=null,null!=s.metadata&&null!=s.metadata.hist_parameters&&(d=s.metadata.hist_parameters.period),r=_.map(s.content.dates,function(t){return i("mnoDate")(t,d)}),o={title:"Gross margin",labels:r,values:c},e=!0,angular.forEach(c,function(t){return e&&(e=t>=0)}),l={scaleBeginAtZero:e,showXLabels:!1},a=n.lineChart([o],l),t.drawTrigger.notify(a)):void 0},t.widgetDeferred.resolve(a)}]),t.directive("widgetSalesMargin",function(){return{restrict:"A",controller:"WidgetSalesMarginCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-number-of-leads",[]),t.controller("WidgetSalesNumberOfLeadsCtrl",["$scope","$q","ChartFormatterSvc","$filter",function(t,e){var n,i,a;return a=t.widget,t.orgDeferred=e.defer(),t.paramSelectorDeferred=e.defer(),i=[t.orgDeferred.promise,t.paramSelectorDeferred.promise],a.initContext=function(){return(t.isDataFound=angular.isDefined(a.content)&&!_.isEmpty(a.content.number_of_leads))?(t.periodOptions=[{label:"year",value:"YEARLY"},{label:"quarter",value:"QUARTERLY"},{label:"month",value:"MONTHLY"},{label:"week",value:"WEEKLY"},{label:"day",value:"DAILY"}],t.period=angular.copy(_.find(t.periodOptions,function(t){return t.value===a.metadata.period})||t.periodOptions[3])):void 0},a.processError=function(e){return 404===e.code?t.isDataFound=!1:void 0},t.formatNumberOfLeads=function(e){var i,s,r,o,l,d;if(s=0,r="- %",!t.isDataFound)return{nominal:s,variation:r,color:""};if(o=angular.copy(a.content.number_of_leads),l=0,i="","new"===e&&o.total&&2===o.total.length)l=o.total[1]-o.total[0],d=n(o.total),d>0?i="green":0>d&&(i="red");else if("converted"===e&&o.converted&&2===o.converted.length)l=o.converted[1],d=n(o.converted),d>0?i="green":0>d&&(i="red");else{if("lost"!==e||!o.lost||2!==o.lost.length)return{nominal:s,variation:r,color:i};l=o.lost[1],d=n(o.lost),0>d?i="green":d>0&&(i="red")}return l>0?s="+"+l:0>l&&(s=l),d&&d>0?r="+"+d.toFixed(0)+"%":d&&0>d&&(r=d.toFixed(0)+"%"),{nominal:s,variation:r,color:i}},n=function(t){var e;return e=0!==t[0]?100*(t[1]/t[0]-1):"- "},t.widgetDeferred.resolve(i)}]),t.directive("widgetSalesNumberOfLeads",function(){return{restrict:"A",controller:"WidgetSalesNumberOfLeadsCtrl"}})}.call(this),function(){"use strict";var t,e=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};t=angular.module("impac.components.widgets.sales-opportunities-funnel",[]),t.controller("WidgetSalesOpportunitiesFunnelCtrl",["$scope","$q","ChartFormatterSvc","$filter","ImpacWidgetsSvc",function(t,n,i,a,s){var r,o,l,d;return d=t.widget,t.orgDeferred=n.defer(),t.paramsPickerDeferred=n.defer(),t.widthDeferred=n.defer(),l=[t.orgDeferred.promise,t.paramsPickerDeferred.promise,t.widthDeferred.promise],r=function(t){var e,n,i;return e=_.mapValues(t,function(t){return t.total}),i=_.compact(_.values(e)),n=_.reduce(i,function(t,e){return null==t&&(t=0),t+e}),null!=n&&n>0},d.initContext=function(){return(t.isDataFound=angular.isDefined(d.content)&&!_.isEmpty(d.content.opps_per_sales_stage)&&r(d.content.opps_per_sales_stage))?(t.statusOptions=_.compact(_.map(d.metadata.sales_stage_selection,function(t){return angular.isDefined(d.content.opps_per_sales_stage[t])?{label:t,selected:!0}:void 0})),angular.forEach(d.content.opps_per_sales_stage,function(n,i){return!d.metadata.sales_stage_selection||e.call(d.metadata.sales_stage_selection,i)>=0?_.isEmpty(d.metadata.sales_stage_selection)?t.statusOptions.push({label:i,selected:!0}):void 0:t.statusOptions.push({label:i,selected:!1})})):void 0},d.processError=function(e){return 404===e.code?t.isDataFound=!1:void 0},t.getImpacColor=function(t){return i.getColor(t)},t.toggleSelectStatus=function(e){return t.selectedStatus=t.selectedStatus&&t.selectedStatus===e?null:e,!d.isExpanded()&&t.selectedStatus?d.toggleExpanded():s.updateWidgetSettings(d,!1)},t.isSelected=function(e){return t.selectedStatus&&e===t.selectedStatus},t.getSelectedOpportunities=function(){return t.isDataFound&&t.selectedStatus?d.content.opps_per_sales_stage[t.selectedStatus].opps:void 0},t.getOppDetails=function(t){var e;return e=[],t.amount&&e.push(a("mnoCurrency")(t.amount.amount,t.amount.currency||"AUD")),t.probability&&e.push("prob. "+t.probability+"%"),e.join(" / ")},o={},o.initialized=!1,o.initialize=function(){return!_.isEmpty(d.content)&&angular.isDefined(d.content.opps_per_sales_stage[d.metadata.selected_status])&&(t.selectedStatus=d.metadata.selected_status),o.initialized=!0},o.toMetadata=function(){return{selected_status:t.selectedStatus}},d.settings.push(o),d.format=function(){var e;return t.isDataFound&&(e=0,angular.forEach(t.statusOptions,function(t){var n;return n=d.content.opps_per_sales_stage[t.label].total,t.selected&&angular.isDefined(n)&&n>e?e=n:void 0}),e>0)?t.funnel=_.compact(_.map(t.statusOptions,function(t){var n,i,a;return a=d.content.opps_per_sales_stage[t.label].total,n=(100*(a/e)-10).toFixed(),i=8>n?92:100-n,t.selected&&angular.isDefined(a)?{status:t.label,number:a,coloredWidth:{width:n+"%"},statusWidth:{width:i+"%"}}:void 0})):void 0},t.widgetDeferred.resolve(l)}]),t.directive("widgetSalesOpportunitiesFunnel",function(){return{restrict:"A",controller:"WidgetSalesOpportunitiesFunnelCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-performance",[]),t.controller("WidgetSalesPerformanceCtrl",["$scope","$q","$filter","ChartFormatterSvc","ImpacWidgetsSvc",function(t,e,n,i,a){var s,r,o;return o=t.widget,t.orgDeferred=e.defer(),t.widthDeferred=e.defer(),t.chartDeferred=e.defer(),r=[t.orgDeferred.promise,t.widthDeferred.promise,t.chartDeferred.promise],o.initContext=function(){return t.isDataFound=angular.isDefined(o.content)&&!_.isEmpty(o.content.assignees),t.isDataFound&&o.metadata.selectedElement?t.selectedElement=_.find(o.content.assignees,function(t){return t.name===o.metadata.selectedElement.name}):void 0},o.processError=function(e){return 404===e.code?t.isDataFound=!1:void 0},t.getWonOpportunities=function(t){return null!=t&&null!=t.opportunities?_.select(t.opportunities,function(t){return t.sales_stage.toLowerCase().match(/won/)}):void 0},t.getLostOpportunities=function(t){return null!=t&&null!=t.opportunities?_.select(t.opportunities,function(t){return!t.sales_stage.toLowerCase().match(/won/)}):void 0},t.getCloseDate=function(t){var e,i;return null!=t&&null!=t.sales_stage_changes&&t.sales_stage_changes.length>0?(i=t.sales_stage_changes[t.sales_stage_changes.length-1].updated_at,i.split(" ").length>0&&(i=i.split(" ")[0]),e=null,null!=o.metadata&&null!=o.metadata.hist_parameters&&(e=o.metadata.hist_parameters.period),n("mnoDate")(i,e)):void 0},t.toggleSelectedElement=function(e){return t.isSelected(e)?(t.selectedElement=null,o.isExpanded()?o.toggleExpanded():a.updateWidgetSettings(o,!1)):(t.selectedElement=angular.copy(e),o.format(),o.isExpanded()?a.updateWidgetSettings(o,!1):o.toggleExpanded())},t.isSelected=function(e){return null!=e&&null!=t.selectedElement&&null!=e.name&&e.name===t.selectedElement.name},s={},s.initialized=!1,s.initialize=function(){return s.initialized=!0},s.toMetadata=function(){return{selectedElement:t.selectedElement}},o.settings.push(s),t.drawTrigger=e.defer(),o.format=function(){var e,a,s,r,l,d,c;return t.isDataFound&&null!=t.selectedElement?(s=angular.copy(t.selectedElement),c=null,null!=o.metadata&&null!=o.metadata.hist_parameters&&(c=o.metadata.hist_parameters.period),r=_.map(o.content.dates,function(t){return n("mnoDate")(t,c)}),l={title:s.name,labels:r,values:s.totals},e=!0,angular.forEach(s.totals,function(t){return e&&(e=t>=0)}),d={scaleBeginAtZero:e,showXLabels:!0},a=i.lineChart([l],d),t.drawTrigger.notify(a)):void 0},t.widgetDeferred.resolve(r)}]),t.directive("widgetSalesPerformance",function(){return{restrict:"A",controller:"WidgetSalesPerformanceCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-segmented-turnover",[]),t.controller("WidgetSalesSegmentedTurnoverCtrl",["$scope","$q","$filter","ChartFormatterSvc",function(t,e,n,i){var a,s;return s=t.widget,t.orgDeferred=e.defer(),t.timeRangeDeferred=e.defer(),t.widthDeferred=e.defer(),t.paramSelectorDeferred=e.defer(),t.chartDeferred=e.defer(),a=[t.orgDeferred.promise,t.timeRangeDeferred.promise,t.widthDeferred.promise,t.paramSelectorDeferred.promise,t.chartDeferred.promise],s.initContext=function(){return(t.isDataFound=!_.isEmpty(s.content)&&!_.isEmpty(s.content.dates)&&!_.isEmpty(s.content.ranges))?(t.filterOptions=[{label:"Gross revenue (incl. taxes)",value:"gross"},{label:"Net revenue (excl. taxes)",value:"net"}],t.filter=angular.copy(_.find(t.filterOptions,function(t){return t.value===s.content.filter})||t.filterOptions[0])):void 0},t.getAnalysis=function(){return t.isDataFound?s.content.ranges[0].percentage+s.content.ranges[1].percentage>50?"Your less expensive products bring you most of your revenue.":s.content.ranges[3].percentage+s.content.ranges[4].percentage>50?"Your most expensive products bring you most of your revenue.":"Your revenue is balanced between your different products segments.":void 0},t.getColorByIndex=function(t){return i.getColor(t)},t.getRangeLabel=function(t){var e;return e=t.split("-"),_.map(e,function(t){return n("mnoCurrency")(t,s.content.currency,!1)}).join(" - ")},t.getMaxRange=function(){var e,n;return t.isDataFound?(e=0,n=s.content.ranges[0],angular.forEach(s.content.ranges,function(t){return t.percentage>e&&(n=angular.copy(t)),e=Math.max(e,t.percentage)}),n):void 0},t.drawTrigger=e.defer(),s.format=function(){var e,n,a;return t.isDataFound?(e={labels:_.map(s.content.ranges,function(t){return t.label}),values:_.map(s.content.ranges,function(t){return t.value})},n={showTooltips:!1,showXLabels:!1,barDatasetSpacing:15},a=i.barChart(e,n),t.drawTrigger.notify(a)):void 0},t.widgetDeferred.resolve(a)}]),t.directive("widgetSalesSegmentedTurnover",function(){return{restrict:"A",controller:"WidgetSalesSegmentedTurnoverCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-summary",[]),t.controller("WidgetSalesSummaryCtrl",["$scope","$q","ChartFormatterSvc",function(t,e,n){var i,a;return a=t.widget,t.orgDeferred=e.defer(),t.chartFiltersDeferred=e.defer(),t.paramSelectorDeferred=e.defer(),t.datesPickerDeferred=e.defer(),t.chartDeferred=e.defer(),i=[t.orgDeferred.promise,t.chartFiltersDeferred.promise,t.paramSelectorDeferred.promise,t.datesPickerDeferred.promise,t.chartDeferred.promise],a.initContext=function(){return t.isDataFound=!_.isEmpty(a.content)&&!_.isEmpty(a.content.hist_parameters),t.filterOptions=[{label:"value sold (incl. taxes)",value:"gross_value_sold"},{label:"value sold (excl. taxes)",value:"net_value_sold"},{label:"quantity sold",value:"quantity_sold"},{label:"value purchased (incl. taxes)",value:"gross_value_purchased"},{label:"value purchased (excl. taxes)",value:"net_value_purchased"},{label:"quantity purchased",value:"quantity_purchased"}],"customer"===a.metadata.criteria&&(t.filterOptions=[t.filterOptions[0],t.filterOptions[1],t.filterOptions[2]]),t.filter=angular.copy(_.find(t.filterOptions,function(t){return t.value===a.metadata.filter})||t.filterOptions[0])},t.drawTrigger=e.defer(),a.format=function(){var e,i,s;return t.isDataFound?(i=_.map(a.content.summary,function(t){var e;return e=t.company?(t.code||t.name||t.location||t.industry||t.customer)+" ("+t.company+")":t.code||t.name||t.location||t.industry||t.customer,{label:e,value:t.total}}),s={percentageInnerCutout:50,tooltipFontSize:12},t.filter.value.indexOf("quantity")>-1&&angular.merge(s,{currency:"hide"}),e=n.pieChart(i,s),t.drawTrigger.notify(e)):void 0},t.widgetDeferred.resolve(i)}]),t.directive("widgetSalesSummary",function(){return{restrict:"A",controller:"WidgetSalesSummaryCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets.sales-top-opportunities",[]),t.controller("WidgetSalesTopOpportunitiesCtrl",["$scope","$q","ChartFormatterSvc","$filter",function(t,e,n,i){var a,s;return s=t.widget,t.orgDeferred=e.defer(),a=[t.orgDeferred.promise],s.initContext=function(){return t.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.opportunities)},s.processError=function(e){return 404===e.code?t.isDataFound=!1:void 0},t.getOppDetails=function(t){var e;return e=[],t.amount&&e.push(i("mnoCurrency")(t.amount.amount,t.amount.currency||"AUD")),t.probability&&e.push("proba "+t.probability+"%"),t.sales_stage&&e.push(t.sales_stage),e.join(" / ")},t.getOppClass=function(t){switch(t){case 0:return"first";case 1:return"second";case 2:return"second";default:return""}},t.widgetDeferred.resolve(a)}]),t.directive("widgetSalesTopOpportunities",function(){return{restrict:"A",controller:"WidgetSalesTopOpportunitiesCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-settings.account",[]),t.controller("SettingAccountCtrl",["$scope","$filter",function(t,e){var n,i,a;return a=t.parentWidget,i={},i.key="account",i.isInitialized=!1,i.initialize=function(){return a.selectedAccount=a.selectedAccount||null,null!=a.content&&null!=a.content.account_list&&null!=a.metadata&&null!=a.metadata.account_uid?(a.selectedAccount=_.find(a.content.account_list,function(t){return t.uid===a.metadata.account_uid}),i.isInitialized=!0):void 0},i.toMetadata=function(){return null!=a.selectedAccount?{account_uid:a.selectedAccount.uid}:void 0},n=function(t){var n;return n=t.current_balance||t.balance,e("mnoCurrency")(n,t.currency)},t.formatLabel=function(t){return null!=t.company?t.company+" - "+t.name+" ("+n(t)+")":t.name+" ("+n(t)+")"},a.settings.push(i),t.deferred.resolve(t.parentWidget)}]),t.directive("settingAccount",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",label:"@",showLabel:"=?",onAccountSelected:"&"},link:function(t){return t.label?void 0:t.label="Account to monitor"},template:t.get("widgets-settings/account.tmpl.html"),controller:"SettingAccountCtrl"}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-settings.accounts-list",[]),t.controller("SettingAccountsListCtrl",["$scope","ImpacWidgetsSvc",function(t,e){var n,i;return i=t.parentWidget,i.moveAccountToAnotherList=function(t,n,a,s){return null==s&&(s=!0),_.isEmpty(n)||_.isEmpty(t)?void 0:(a||(a=[]),_.remove(n,function(e){return t.uid===e.uid}),a.push(t),s&&e.updateWidgetSettings(i,!1),null)},n={},n.key="accounts-list",n.initialize=function(){var t;return n.isInitialized=!1,i.remainingAccounts=[],i.selectedAccounts=[],null==i.content||_.isEmpty(i.content.complete_list)?void 0:(i.remainingAccounts=angular.copy(i.content.complete_list),_.isEmpty(i.metadata.accounts_list)||angular.forEach(i.metadata.accounts_list,function(t){var e;return e=_.find(i.content.complete_list,function(e){return e.uid===t}),i.moveAccountToAnotherList(e,i.remainingAccounts,i.selectedAccounts,!1)}),t=angular.copy(i.remainingAccounts),n.isInitialized=!0)},n.toMetadata=function(){return n.isInitialized?{accounts_list:_.map(i.selectedAccounts,function(t){return t.uid})}:void 0},i.settings.push(n),t.deferred.resolve(t.parentWidget)}]),t.directive("settingAccountsList",function(){return{restrict:"A",scope:{parentWidget:"=",deferred:"="},controller:"SettingAccountsListCtrl"}})}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-settings.chart-filters",[]),t.controller("SettingChartFiltersCtrl",["$scope",function(t){var e,n;return n=t.parentWidget,e={},e.key="chart-filters",e.isInitialized=!1,e.initialize=function(){return null!=n.content&&null!=n.content.chart_filter&&(t.filterCriteria=n.content.chart_filter.criteria)?(t.maxEntities=n.content.chart_filter.max,t.entityType=n.content.chart_filter.entity_type,t.filterLabel=n.content.chart_filter.filter_label.replace(/_/g," "),"number"===t.filterCriteria?(t.filterValuePercentage=80,t.filterValueNumber=n.content.chart_filter.value):(t.filterValuePercentage=n.content.chart_filter.value,t.filterValueNumber=Math.round(t.maxEntities/2)),e.isInitialized=!0):void 0},e.toMetadata=function(){var e;return null!=n.content&&null!=n.content.chart_filter?(e="percentage"===t.filterCriteria?t.filterValuePercentage:t.filterValueNumber,{chart_filter:{criteria:t.filterCriteria,value:e}}):{}},n.settings.push(e),t.deferred.resolve(t.parentWidget)}]),t.directive("settingChartFilters",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"=",deferred:"="},template:t.get("widgets-settings/chart-filters.tmpl.html"),controller:"SettingChartFiltersCtrl"}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-settings.dates-picker",[]),t.directive("settingDatesPicker",["$templateCache","$filter","ImpacWidgetsSvc","$timeout",function(t,e,n,i){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",fromDate:"=from",toDate:"=to",keepToday:"="},template:t.get("widgets-settings/dates-picker.tmpl.html"),link:function(t){var a,s,r;return r=t.parentWidget,s={},s.key="dates-picker",t.calendarFrom={opened:!1,value:new Date((new Date).getFullYear(),0,1),toggle:function(){return t.calendarFrom.opened=!t.calendarFrom.opened,t.calendarTo.opened=!1}},t.calendarTo={opened:!1,value:new Date,toggle:function(){return t.calendarFrom.opened=!1,t.calendarTo.opened=!t.calendarTo.opened}},s.initialize=function(){return i(function(){var e,n,i,a,s;return t.changed=!1,Date.parse(t.fromDate)?(i=t.fromDate.split("-"),s=i[0],n=i[1]-1,e=i[2],t.calendarFrom.value=new Date(s,n,e)):t.calendarFrom.value=new Date((new Date).getFullYear(),0,1),Date.parse(t.toDate)&&!t.keepToday?(a=t.toDate.split("-"),s=a[0],n=a[1]-1,e=a[2],t.calendarTo.value=new Date(s,n,e)):t.calendarTo.value=new Date})},a=function(){return t.calendarTo.value.getFullYear()===(new Date).getFullYear()&&t.calendarTo.value.getMonth()===(new Date).getMonth()&&t.calendarTo.value.getDate()===(new Date).getDate()},s.toMetadata=function(){return{hist_parameters:{from:e("date")(t.calendarFrom.value,"yyyy-MM-dd"),to:e("date")(t.calendarTo.value,"yyyy-MM-dd"),period:"RANGE",keep_today:a()}}},t.showApplyButton=function(){return t.changed=!0},t.applyChanges=function(){return n.updateWidgetSettings(r,!0),t.changed=!1},r.settings.push(s),t.deferred.resolve(s)}}}])}.call(this),function(){"use strict";var module;module=angular.module("impac.components.widgets-settings.formula",[]),module.controller("SettingFormulaCtrl",["$scope","$filter",function($scope,$filter){var authorized_regex,evaluateFormula,formatFormula,getFormula,setting,w;return w=$scope.parentWidget,w.formula="",authorized_regex=new RegExp("^(\\{|\\d|\\}|\\/|\\+|-|\\*|\\(|\\)|\\s|\\.)*$"),setting={},setting.key="formula",setting.isInitialized=!1,setting.initialize=function(){return null!=w.metadata&&null!=w.metadata.formula?(w.formula=w.metadata.formula,evaluateFormula(),setting.isInitialized=!0):w.formula=""},setting.toMetadata=function(){return evaluateFormula(),w.isFormulaCorrect?{formula:w.formula}:{formula:""}},getFormula=function(){return w.formula},w.formatAmount=function(t){return $filter("mnoCurrency")(t.current_balance,t.currency)},$scope.$watch(getFormula,function(){return evaluateFormula()}),evaluateFormula=function(){var e,error,i,legend,str;str=angular.copy(w.formula),legend=angular.copy(w.formula),i=1,angular.forEach(w.selectedAccounts,function(t){var e;return e="\\{"+i+"\\}",str=str.replace(new RegExp(e,"g")," "+t.current_balance_no_format+" "),legend=legend.replace(new RegExp(e,"g"),t.name),i++}),str.match(authorized_regex)||(w.isFormulaCorrect=!1,w.evaluatedFormula="invalid expression");try{w.evaluatedFormula=eval(str).toFixed(2)}catch(error){e=error,w.evaluatedFormula="invalid expression"}return null==w.evaluatedFormula||"invalid expression"===w.evaluatedFormula||"Infinity"===w.evaluatedFormula||"-Infinity"===w.evaluatedFormula?w.isFormulaCorrect=!1:(formatFormula(),w.legend=legend,w.isFormulaCorrect=!0)},formatFormula=function(){var t,e;return!w.formula.match(/\//g)&&null!=w.selectedAccounts&&(e=w.selectedAccounts[0])&&(t=e.currency)?w.evaluatedFormula=$filter("mnoCurrency")(w.evaluatedFormula,t):void 0},w.settings.push(setting),$scope.deferred.resolve($scope.parentWidget)}]),module.directive("settingFormula",function(){return{restrict:"A",scope:{parentWidget:"=",deferred:"="},controller:"SettingFormulaCtrl"}})}.call(this),function(){"use strict";var t,e=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};t=angular.module("impac.components.widgets-settings.hist-mode",[]),t.controller("SettingHistModeCtrl",["$scope","ImpacWidgetsSvc",function(t,n){var i,a;return a=t.parentWidget,a.isHistoryMode=!1,t.toggleHistMode=function(i){var s;if(!(a.isHistoryMode&&"history"===i||!a.isHistoryMode&&"current"===i))return a.isHistoryMode=!a.isHistoryMode,n.updateWidgetSettings(a,!1),s=t.onToggle(),e.call(angular.isDefined(t.onToggle),s)>=0},i={},i.key="hist-mode",i.isInitialized=!1,i.initialize=function(){var t;return null!=a.content&&null!=a.content.hist_parameters&&(t=a.content.hist_parameters.mode)?(a.isHistoryMode="history"===t?!0:!1,i.isInitialized=!0):void 0},i.toMetadata=function(){var t;return t=a.isHistoryMode?"history":"current",{hist_parameters:{mode:t}}},a.settings.push(i),t.deferred.resolve(t.parentWidget)}]),t.directive("settingHistMode",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",onToggle:"&"},template:t.get("widgets-settings/hist-mode.tmpl.html"),controller:"SettingHistModeCtrl"}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-settings.limit-entries",[]),t.controller("SettingLimitEntriesCtrl",["$scope",function(t){var e;return e={},e.key="limit-entries",e.initialize=function(){return!0},e.toMetadata=function(){return{limit_entries:t.selected}},t.parentWidget.settings.push(e),t.deferred.resolve(e)}]),t.directive("settingLimitEntries",["$templateCache","ImpacWidgetsSvc",function(t,e){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",options:"=",selected:"=",max:"=",entriesLabel:"="},link:function(t,n,i){return null!=i.options&&t.options.length>0||(t.options=[5,15,50]),t.selectOption=function(n){return t.selected=n,e.updateWidgetSettings(t.parentWidget,!1)},t.isOptionValid=function(e){return null==t.max||e<t.max}},controller:"SettingLimitEntriesCtrl",template:t.get("widgets-settings/limit-entries.tmpl.html")}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-settings.organizations",[]),t.controller("SettingOrganizationsCtrl",["$scope","$log","ImpacDashboardsSvc",function(t,e,n){var i,a;return a=t.parentWidget,a.selectedOrganizations={},t.isOrganizationSelected=function(t){return!!a.selectedOrganizations[t]},t.toggleSelectOrganization=function(t){return a.selectedOrganizations[t]=!a.selectedOrganizations[t]},i={},i.key="organizations",i.isInitialized=!1,i.initialize=function(){return n.load().then(function(e){var n,s,r,o;if(t.dashboardOrganizations=e.currentDashboard.data_sources,null!=a.metadata&&null!=a.metadata.organization_ids){for(o=t.dashboardOrganizations,n=0,s=o.length;s>n;n++)r=o[n],a.selectedOrganizations[r.uid]=_.contains(a.metadata.organization_ids,r.uid);return i.isInitialized=!0}})},i.toMetadata=function(){var e;return e=_.compact(_.map(a.selectedOrganizations,function(t,e){return t?e:void 0})),_.isEmpty(e)&&(e=[_.first(t.dashboardOrganizations).uid]),{organization_ids:e}},a.settings.push(i),t.deferred.resolve(t.parentWidget)}]),t.directive("settingOrganizations",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"=",deferred:"="},template:t.get("widgets-settings/organizations.tmpl.html"),controller:"SettingOrganizationsCtrl"}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-settings.param-selector",[]),t.controller("SettingParamSelectorCtrl",["$scope","ImpacWidgetsSvc",function(t,e){var n,i;return t.showOptions=!1,t.toggleShowOptions=function(){return t.showOptions=!t.showOptions},t.selectOption=function(n){return n.value!==t.selected.value&&(angular.extend(t.selected,n),t.noReload||(t.parentWidget.isLoading=!0),e.updateWidgetSettings(t.parentWidget,!t.noReload),angular.isDefined(t.onSelect)&&t.onSelect()),t.toggleShowOptions()},t.getTruncateValue=function(){return parseInt(t.truncateNo)||20},i=t.parentWidget,n={},n.key="param-selector",n.isInitialized=!1,n.initialize=function(){return null!=i.content?n.isInitialized=!0:void 0},n.toMetadata=function(){var e;return e={},_.isEmpty(t.selected)||(e[t.param]=t.selected.value),e},i.settings.push(n),t.deferred.resolve(t.parentWidget)}]),t.directive("settingParamSelector",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",param:"@",options:"=",selected:"=",truncateNo:"@",onSelect:"&"},link:function(t,e,n){return t.noReload="undefined"!=typeof n.noReload,t.truncateNo=n.truncateNo||20},template:t.get("widgets-settings/param-selector.tmpl.html"),controller:"SettingParamSelectorCtrl"}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-settings.params-checkboxes",[]),t.controller("SettingParamsCheckboxesCtrl",["$scope",function(t){var e,n;return n=t.parentWidget,e={},e.key="params-checkboxes",e.initialize=function(){},e.toMetadata=function(){var e;return e={},e[t.param]=_.map(t.options,function(t){return{id:t.id,value:t.value}}),e},n.settings.push(e),t.deferred.resolve(t.parentWidget)}]),t.directive("settingParamsCheckboxes",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",param:"@",options:"="},template:t.get("widgets-settings/params-checkboxes.tmpl.html"),controller:"SettingParamsCheckboxesCtrl"}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-settings.params-picker",[]),t.controller("SettingParamsPickerCtrl",["$scope",function(t){var e,n;return n=t.parentWidget,e={},e.key="params-picker",e.isInitialized=!1,e.initialize=function(){return t.sortableOptions={"ui-floating":!0,tolerance:"pointer"},_.isEmpty(t.options)?e.isInitialized=!0:void 0},e.toMetadata=function(){var e;return e={},e[t.param]=_.compact(_.map(t.options,function(t){return t.selected?t.label:void 0})),e},n.settings.push(e),t.deferred.resolve(t.parentWidget)}]),t.directive("settingParamsPicker",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",param:"@",options:"="},link:function(t){return t.formattedParam=t.param.replace("_"," ")},template:t.get("widgets-settings/params-picker.tmpl.html"),controller:"SettingParamsPickerCtrl"}}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-settings.time-range",[]),t.controller("SettingTimeRangeCtrl",["$scope","$log",function(t){var e,n;return n=t.parentWidget,t.numberOfPeriods=(new Date).getMonth()+1,t.selectedPeriod="MONTHLY",t.PERIODS=["DAILY","WEEKLY","MONTHLY","QUARTERLY","YEARLY"],t.periodToUnit=function(){var e,n,i;return e=t.numberOfPeriods,n=t.selectedPeriod,i="DAILY"!==n?n.substring(0,n.length-2).toLowerCase():"day",e>1&&(i=i.concat("s")),i},e={},e.key="time-range",e.isInitialized=!1,e.initialize=function(){var i;return null!=n.metadata&&(i=n.metadata.hist_parameters)?(null!=i.period&&(t.selectedPeriod=i.period),null!=i.number_of_periods&&(t.numberOfPeriods=i.number_of_periods),e.isInitialized=!0):void 0},e.toMetadata=function(){return{hist_parameters:{period:t.selectedPeriod,number_of_periods:t.numberOfPeriods}}},n.settings||(n.settings=[]),n.settings.push(e),t.deferred.resolve(t.parentWidget)}]),t.directive("settingTimeRange",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"=",deferred:"="},template:t.get("widgets-settings/time-range.tmpl.html"),controller:"SettingTimeRangeCtrl"}
}])}.call(this),function(){"use strict";var t;t=angular.module("impac.components.widgets-settings.width",[]),t.controller("SettingWidthCtrl",["$scope","$log","ImpacWidgetsSvc",function(t,e,n){var i,a;return a=t.parentWidget,a.toggleExpanded=function(){return t.expanded=!t.expanded,n.updateWidgetSettings(a,!1),a.width=t.expanded?parseInt(t.max):parseInt(t.min)},i={},i.key="width",i.isInitialized=!1,a.isExpanded=function(){return t.expanded},i.initialize=function(){return null!=a.width?(t.expanded=a.width===parseInt(t.max),i.isInitialized=!0):void 0},i.toMetadata=function(){var e;return e=t.expanded?t.max:t.min,{width:parseInt(e)}},a.settings.push(i),t.deferred.resolve(t.parentWidget)}]),t.directive("settingWidth",["$templateCache",function(t){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",min:"@",max:"@"},template:t.get("widgets-settings/width.tmpl.html"),controller:"SettingWidthCtrl"}}])}.call(this),!function t(e,n,i){function a(r,o){if(!n[r]){if(!e[r]){var l="function"==typeof require&&require;if(!o&&l)return l(r,!0);if(s)return s(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var c=n[r]={exports:{}};e[r][0].call(c.exports,function(t){var n=e[r][1][t];return a(n?n:t)},c,c.exports,t,e,n,i)}return n[r].exports}for(var s="function"==typeof require&&require,r=0;r<i.length;r++)a(i[r]);return a}({1:[function(t,e){!function(){var n=t("color-convert"),i=t("color-string"),a=function(t){if(t instanceof a)return t;if(!(this instanceof a))return new a(t);if(this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1},"string"==typeof t){var e=i.getRgba(t);if(e)this.setValues("rgb",e);else if(e=i.getHsla(t))this.setValues("hsl",e);else{if(!(e=i.getHwb(t)))throw new Error('Unable to parse color from string "'+t+'"');this.setValues("hwb",e)}}else if("object"==typeof t){var e=t;if(void 0!==e.r||void 0!==e.red)this.setValues("rgb",e);else if(void 0!==e.l||void 0!==e.lightness)this.setValues("hsl",e);else if(void 0!==e.v||void 0!==e.value)this.setValues("hsv",e);else if(void 0!==e.w||void 0!==e.whiteness)this.setValues("hwb",e);else{if(void 0===e.c&&void 0===e.cyan)throw new Error("Unable to parse color from object "+JSON.stringify(t));this.setValues("cmyk",e)}}};a.prototype={rgb:function(){return this.setSpace("rgb",arguments)},hsl:function(){return this.setSpace("hsl",arguments)},hsv:function(){return this.setSpace("hsv",arguments)},hwb:function(){return this.setSpace("hwb",arguments)},cmyk:function(){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){return 1!==this.values.alpha?this.values.hwb.concat([this.values.alpha]):this.values.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var t=this.values.rgb;return t.concat([this.values.alpha])},hslaArray:function(){var t=this.values.hsl;return t.concat([this.values.alpha])},alpha:function(t){return void 0===t?this.values.alpha:(this.setValues("alpha",t),this)},red:function(t){return this.setChannel("rgb",0,t)},green:function(t){return this.setChannel("rgb",1,t)},blue:function(t){return this.setChannel("rgb",2,t)},hue:function(t){return this.setChannel("hsl",0,t)},saturation:function(t){return this.setChannel("hsl",1,t)},lightness:function(t){return this.setChannel("hsl",2,t)},saturationv:function(t){return this.setChannel("hsv",1,t)},whiteness:function(t){return this.setChannel("hwb",1,t)},blackness:function(t){return this.setChannel("hwb",2,t)},value:function(t){return this.setChannel("hsv",2,t)},cyan:function(t){return this.setChannel("cmyk",0,t)},magenta:function(t){return this.setChannel("cmyk",1,t)},yellow:function(t){return this.setChannel("cmyk",2,t)},black:function(t){return this.setChannel("cmyk",3,t)},hexString:function(){return i.hexString(this.values.rgb)},rgbString:function(){return i.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return i.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return i.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return i.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return i.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return i.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return i.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){return this.values.rgb[0]<<16|this.values.rgb[1]<<8|this.values.rgb[2]},luminosity:function(){for(var t=this.values.rgb,e=[],n=0;n<t.length;n++){var i=t[n]/255;e[n]=.03928>=i?i/12.92:Math.pow((i+.055)/1.055,2.4)}return.2126*e[0]+.7152*e[1]+.0722*e[2]},contrast:function(t){var e=this.luminosity(),n=t.luminosity();return e>n?(e+.05)/(n+.05):(n+.05)/(e+.05)},level:function(t){var e=this.contrast(t);return e>=7.1?"AAA":e>=4.5?"AA":""},dark:function(){var t=this.values.rgb,e=(299*t[0]+587*t[1]+114*t[2])/1e3;return 128>e},light:function(){return!this.dark()},negate:function(){for(var t=[],e=0;3>e;e++)t[e]=255-this.values.rgb[e];return this.setValues("rgb",t),this},lighten:function(t){return this.values.hsl[2]+=this.values.hsl[2]*t,this.setValues("hsl",this.values.hsl),this},darken:function(t){return this.values.hsl[2]-=this.values.hsl[2]*t,this.setValues("hsl",this.values.hsl),this},saturate:function(t){return this.values.hsl[1]+=this.values.hsl[1]*t,this.setValues("hsl",this.values.hsl),this},desaturate:function(t){return this.values.hsl[1]-=this.values.hsl[1]*t,this.setValues("hsl",this.values.hsl),this},whiten:function(t){return this.values.hwb[1]+=this.values.hwb[1]*t,this.setValues("hwb",this.values.hwb),this},blacken:function(t){return this.values.hwb[2]+=this.values.hwb[2]*t,this.setValues("hwb",this.values.hwb),this},greyscale:function(){var t=this.values.rgb,e=.3*t[0]+.59*t[1]+.11*t[2];return this.setValues("rgb",[e,e,e]),this},clearer:function(t){return this.setValues("alpha",this.values.alpha-this.values.alpha*t),this},opaquer:function(t){return this.setValues("alpha",this.values.alpha+this.values.alpha*t),this},rotate:function(t){var e=this.values.hsl[0];return e=(e+t)%360,e=0>e?360+e:e,this.values.hsl[0]=e,this.setValues("hsl",this.values.hsl),this},mix:function(t,e){e=1-(null==e?.5:e);for(var n=2*e-1,i=this.alpha()-t.alpha(),a=((n*i==-1?n:(n+i)/(1+n*i))+1)/2,s=1-a,r=this.rgbArray(),o=t.rgbArray(),l=0;l<r.length;l++)r[l]=r[l]*a+o[l]*s;this.setValues("rgb",r);var d=this.alpha()*e+t.alpha()*(1-e);return this.setValues("alpha",d),this},toJSON:function(){return this.rgb()},clone:function(){return new a(this.rgb())}},a.prototype.getValues=function(t){for(var e={},n=0;n<t.length;n++)e[t.charAt(n)]=this.values[t][n];return 1!=this.values.alpha&&(e.a=this.values.alpha),e},a.prototype.setValues=function(t,e){var i={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]},a={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]},s=1;if("alpha"==t)s=e;else if(e.length)this.values[t]=e.slice(0,t.length),s=e[t.length];else if(void 0!==e[t.charAt(0)]){for(var r=0;r<t.length;r++)this.values[t][r]=e[t.charAt(r)];s=e.a}else if(void 0!==e[i[t][0]]){for(var o=i[t],r=0;r<t.length;r++)this.values[t][r]=e[o[r]];s=e.alpha}if(this.values.alpha=Math.max(0,Math.min(1,void 0!==s?s:this.values.alpha)),"alpha"!=t){for(var r=0;r<t.length;r++){var l=Math.max(0,Math.min(a[t][r],this.values[t][r]));this.values[t][r]=Math.round(l)}for(var d in i){d!=t&&(this.values[d]=n[t][d](this.values[t]));for(var r=0;r<d.length;r++){var l=Math.max(0,Math.min(a[d][r],this.values[d][r]));this.values[d][r]=Math.round(l)}}return!0}},a.prototype.setSpace=function(t,e){var n=e[0];return void 0===n?this.getValues(t):("number"==typeof n&&(n=Array.prototype.slice.call(e)),this.setValues(t,n),this)},a.prototype.setChannel=function(t,e,n){return void 0===n?this.values[t][e]:(this.values[t][e]=n,this.setValues(t,this.values[t]),this)},window.Color=e.exports=a}()},{"color-convert":3,"color-string":4}],2:[function(t,e){function n(t){var e,n,i,a=t[0]/255,s=t[1]/255,r=t[2]/255,o=Math.min(a,s,r),l=Math.max(a,s,r),d=l-o;return l==o?e=0:a==l?e=(s-r)/d:s==l?e=2+(r-a)/d:r==l&&(e=4+(a-s)/d),e=Math.min(60*e,360),0>e&&(e+=360),i=(o+l)/2,n=l==o?0:.5>=i?d/(l+o):d/(2-l-o),[e,100*n,100*i]}function i(t){var e,n,i,a=t[0],s=t[1],r=t[2],o=Math.min(a,s,r),l=Math.max(a,s,r),d=l-o;return n=0==l?0:d/l*1e3/10,l==o?e=0:a==l?e=(s-r)/d:s==l?e=2+(r-a)/d:r==l&&(e=4+(a-s)/d),e=Math.min(60*e,360),0>e&&(e+=360),i=l/255*1e3/10,[e,n,i]}function a(t){var e=t[0],i=t[1],a=t[2],s=n(t)[0],r=1/255*Math.min(e,Math.min(i,a)),a=1-1/255*Math.max(e,Math.max(i,a));return[s,100*r,100*a]}function s(t){var e,n,i,a,s=t[0]/255,r=t[1]/255,o=t[2]/255;return a=Math.min(1-s,1-r,1-o),e=(1-s-a)/(1-a)||0,n=(1-r-a)/(1-a)||0,i=(1-o-a)/(1-a)||0,[100*e,100*n,100*i,100*a]}function o(t){return Z[JSON.stringify(t)]}function l(t){var e=t[0]/255,n=t[1]/255,i=t[2]/255;e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92;var a=.4124*e+.3576*n+.1805*i,s=.2126*e+.7152*n+.0722*i,r=.0193*e+.1192*n+.9505*i;return[100*a,100*s,100*r]}function d(t){var e,n,i,a=l(t),s=a[0],r=a[1],o=a[2];return s/=95.047,r/=100,o/=108.883,s=s>.008856?Math.pow(s,1/3):7.787*s+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,o=o>.008856?Math.pow(o,1/3):7.787*o+16/116,e=116*r-16,n=500*(s-r),i=200*(r-o),[e,n,i]}function c(t){return O(d(t))}function u(t){var e,n,i,a,s,r=t[0]/360,o=t[1]/100,l=t[2]/100;if(0==o)return s=255*l,[s,s,s];n=.5>l?l*(1+o):l+o-l*o,e=2*l-n,a=[0,0,0];for(var d=0;3>d;d++)i=r+1/3*-(d-1),0>i&&i++,i>1&&i--,s=1>6*i?e+6*(n-e)*i:1>2*i?n:2>3*i?e+(n-e)*(2/3-i)*6:e,a[d]=255*s;return a}function h(t){var e,n,i=t[0],a=t[1]/100,s=t[2]/100;return s*=2,a*=1>=s?s:2-s,n=(s+a)/2,e=2*a/(s+a),[i,100*e,100*n]}function p(t){return a(u(t))}function m(t){return s(u(t))}function f(t){return o(u(t))}function v(t){var e=t[0]/60,n=t[1]/100,i=t[2]/100,a=Math.floor(e)%6,s=e-Math.floor(e),r=255*i*(1-n),o=255*i*(1-n*s),l=255*i*(1-n*(1-s)),i=255*i;switch(a){case 0:return[i,l,r];case 1:return[o,i,r];case 2:return[r,i,l];case 3:return[r,o,i];case 4:return[l,r,i];case 5:return[i,r,o]}}function w(t){var e,n,i=t[0],a=t[1]/100,s=t[2]/100;return n=(2-a)*s,e=a*s,e/=1>=n?n:2-n,e=e||0,n/=2,[i,100*e,100*n]}function y(t){return a(v(t))}function D(t){return s(v(t))}function x(t){return o(v(t))}function C(t){var e,n,i,a,s=t[0]/360,o=t[1]/100,l=t[2]/100,d=o+l;switch(d>1&&(o/=d,l/=d),e=Math.floor(6*s),n=1-l,i=6*s-e,0!=(1&e)&&(i=1-i),a=o+i*(n-o),e){default:case 6:case 0:r=n,g=a,b=o;break;case 1:r=a,g=n,b=o;break;case 2:r=o,g=n,b=a;break;case 3:r=o,g=a,b=n;break;case 4:r=a,g=o,b=n;break;case 5:r=n,g=o,b=a}return[255*r,255*g,255*b]}function _(t){return n(C(t))}function S(t){return i(C(t))}function k(t){return s(C(t))}function E(t){return o(C(t))}function A(t){var e,n,i,a=t[0]/100,s=t[1]/100,r=t[2]/100,o=t[3]/100;return e=1-Math.min(1,a*(1-o)+o),n=1-Math.min(1,s*(1-o)+o),i=1-Math.min(1,r*(1-o)+o),[255*e,255*n,255*i]}function M(t){return n(A(t))}function F(t){return i(A(t))}function T(t){return a(A(t))}function I(t){return o(A(t))}function W(t){var e,n,i,a=t[0]/100,s=t[1]/100,r=t[2]/100;return e=3.2406*a+-1.5372*s+r*-.4986,n=a*-.9689+1.8758*s+.0415*r,i=.0557*a+s*-.204+1.057*r,e=e>.0031308?1.055*Math.pow(e,1/2.4)-.055:e=12.92*e,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:n=12.92*n,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i=12.92*i,e=Math.min(Math.max(0,e),1),n=Math.min(Math.max(0,n),1),i=Math.min(Math.max(0,i),1),[255*e,255*n,255*i]}function z(t){var e,n,i,a=t[0],s=t[1],r=t[2];return a/=95.047,s/=100,r/=108.883,a=a>.008856?Math.pow(a,1/3):7.787*a+16/116,s=s>.008856?Math.pow(s,1/3):7.787*s+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,e=116*s-16,n=500*(a-s),i=200*(s-r),[e,n,i]}function L(t){return O(z(t))}function P(t){var e,n,i,a,s=t[0],r=t[1],o=t[2];return 8>=s?(n=100*s/903.3,a=7.787*(n/100)+16/116):(n=100*Math.pow((s+16)/116,3),a=Math.pow(n/100,1/3)),e=.008856>=e/95.047?e=95.047*(r/500+a-16/116)/7.787:95.047*Math.pow(r/500+a,3),i=.008859>=i/108.883?i=108.883*(a-o/200-16/116)/7.787:108.883*Math.pow(a-o/200,3),[e,n,i]}function O(t){var e,n,i,a=t[0],s=t[1],r=t[2];return e=Math.atan2(r,s),n=360*e/2/Math.PI,0>n&&(n+=360),i=Math.sqrt(s*s+r*r),[a,i,n]}function R(t){return W(P(t))}function $(t){var e,n,i,a=t[0],s=t[1],r=t[2];return i=r/360*2*Math.PI,e=s*Math.cos(i),n=s*Math.sin(i),[a,e,n]}function B(t){return P($(t))}function V(t){return R($(t))}function N(t){return X[t]}function H(t){return n(N(t))}function q(t){return i(N(t))}function j(t){return a(N(t))}function Y(t){return s(N(t))}function U(t){return d(N(t))}function K(t){return l(N(t))}e.exports={rgb2hsl:n,rgb2hsv:i,rgb2hwb:a,rgb2cmyk:s,rgb2keyword:o,rgb2xyz:l,rgb2lab:d,rgb2lch:c,hsl2rgb:u,hsl2hsv:h,hsl2hwb:p,hsl2cmyk:m,hsl2keyword:f,hsv2rgb:v,hsv2hsl:w,hsv2hwb:y,hsv2cmyk:D,hsv2keyword:x,hwb2rgb:C,hwb2hsl:_,hwb2hsv:S,hwb2cmyk:k,hwb2keyword:E,cmyk2rgb:A,cmyk2hsl:M,cmyk2hsv:F,cmyk2hwb:T,cmyk2keyword:I,keyword2rgb:N,keyword2hsl:H,keyword2hsv:q,keyword2hwb:j,keyword2cmyk:Y,keyword2lab:U,keyword2xyz:K,xyz2rgb:W,xyz2lab:z,xyz2lch:L,lab2xyz:P,lab2rgb:R,lab2lch:O,lch2lab:$,lch2xyz:B,lch2rgb:V};var X={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Z={};for(var Q in X)Z[JSON.stringify(X[Q])]=Q},{}],3:[function(t,e){var n=t("./conversions"),i=function(){return new l};for(var a in n){i[a+"Raw"]=function(t){return function(e){return"number"==typeof e&&(e=Array.prototype.slice.call(arguments)),n[t](e)}}(a);var s=/(\w+)2(\w+)/.exec(a),r=s[1],o=s[2];i[r]=i[r]||{},i[r][o]=i[a]=function(t){return function(e){"number"==typeof e&&(e=Array.prototype.slice.call(arguments));var i=n[t](e);if("string"==typeof i||void 0===i)return i;for(var a=0;a<i.length;a++)i[a]=Math.round(i[a]);return i}}(a)}var l=function(){this.convs={}};l.prototype.routeSpace=function(t,e){var n=e[0];return void 0===n?this.getValues(t):("number"==typeof n&&(n=Array.prototype.slice.call(e)),this.setValues(t,n))},l.prototype.setValues=function(t,e){return this.space=t,this.convs={},this.convs[t]=e,this},l.prototype.getValues=function(t){var e=this.convs[t];if(!e){var n=this.space,a=this.convs[n];e=i[n][t](a),this.convs[t]=e}return e},["rgb","hsl","hsv","cmyk","keyword"].forEach(function(t){l.prototype[t]=function(){return this.routeSpace(t,arguments)}}),e.exports=i},{"./conversions":2}],4:[function(t,e){function n(t){if(t){var e=/^#([a-fA-F0-9]{3})$/,n=/^#([a-fA-F0-9]{6})$/,i=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,a=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,s=/(\w+)/,r=[0,0,0],o=1,l=t.match(e);if(l){l=l[1];for(var d=0;d<r.length;d++)r[d]=parseInt(l[d]+l[d],16)}else if(l=t.match(n)){l=l[1];for(var d=0;d<r.length;d++)r[d]=parseInt(l.slice(2*d,2*d+2),16)}else if(l=t.match(i)){for(var d=0;d<r.length;d++)r[d]=parseInt(l[d+1]);o=parseFloat(l[4])}else if(l=t.match(a)){for(var d=0;d<r.length;d++)r[d]=Math.round(2.55*parseFloat(l[d+1]));o=parseFloat(l[4])}else if(l=t.match(s)){if("transparent"==l[1])return[0,0,0,0];if(r=w[l[1]],!r)return}for(var d=0;d<r.length;d++)r[d]=v(r[d],0,255);return o=o||0==o?v(o,0,1):1,r[3]=o,r}}function i(t){if(t){var e=/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/,n=t.match(e);if(n){var i=parseFloat(n[4]),a=v(parseInt(n[1]),0,360),s=v(parseFloat(n[2]),0,100),r=v(parseFloat(n[3]),0,100),o=v(isNaN(i)?1:i,0,1);return[a,s,r,o]}}}function a(t){if(t){var e=/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/,n=t.match(e);if(n){var i=parseFloat(n[4]),a=v(parseInt(n[1]),0,360),s=v(parseFloat(n[2]),0,100),r=v(parseFloat(n[3]),0,100),o=v(isNaN(i)?1:i,0,1);return[a,s,r,o]}}}function s(t){var e=n(t);return e&&e.slice(0,3)}function r(t){var e=i(t);return e&&e.slice(0,3)}function o(t){var e=n(t);return e?e[3]:(e=i(t))?e[3]:(e=a(t))?e[3]:void 0}function l(t){return"#"+b(t[0])+b(t[1])+b(t[2])}function d(t,e){return 1>e||t[3]&&t[3]<1?c(t,e):"rgb("+t[0]+", "+t[1]+", "+t[2]+")"}function c(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"rgba("+t[0]+", "+t[1]+", "+t[2]+", "+e+")"}function u(t,e){if(1>e||t[3]&&t[3]<1)return g(t,e);var n=Math.round(t[0]/255*100),i=Math.round(t[1]/255*100),a=Math.round(t[2]/255*100);return"rgb("+n+"%, "+i+"%, "+a+"%)"}function g(t,e){var n=Math.round(t[0]/255*100),i=Math.round(t[1]/255*100),a=Math.round(t[2]/255*100);return"rgba("+n+"%, "+i+"%, "+a+"%, "+(e||t[3]||1)+")"}function h(t,e){return 1>e||t[3]&&t[3]<1?p(t,e):"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)"}function p(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+e+")"}function m(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+(void 0!==e&&1!==e?", "+e:"")+")"}function f(t){return y[t.slice(0,3)]}function v(t,e,n){return Math.min(Math.max(e,t),n)}function b(t){var e=t.toString(16).toUpperCase();return e.length<2?"0"+e:e}var w=t("color-name");e.exports={getRgba:n,getHsla:i,getRgb:s,getHsl:r,getHwb:a,getAlpha:o,hexString:l,rgbString:d,rgbaString:c,percentString:u,percentaString:g,hslString:h,hslaString:p,hwbString:m,keyword:f};var y={};for(var D in w)y[w[D]]=D},{"color-name":5}],5:[function(t,e){e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}]},{},[1]),function(){"use strict";var t=this,e=t.Chart,n=function(t,e){this.config=e,t.length&&t[0].getContext&&(t=t[0]),t.getContext&&(t=t.getContext("2d")),this.ctx=t,this.canvas=t.canvas,this.width=t.canvas.width||parseInt(n.helpers.getStyle(t.canvas,"width"))||n.helpers.getMaximumWidth(t.canvas),this.height=t.canvas.height||parseInt(n.helpers.getStyle(t.canvas,"height"))||n.helpers.getMaximumHeight(t.canvas),this.aspectRatio=this.width/this.height,(isNaN(this.aspectRatio)||isFinite(this.aspectRatio)===!1)&&(this.aspectRatio=void 0!==e.aspectRatio?e.aspectRatio:2),this.originalCanvasStyleWidth=t.canvas.style.width,this.originalCanvasStyleHeight=t.canvas.style.height,n.helpers.retinaScale(this),e&&(this.controller=new n.Controller(this));var i=this;return n.helpers.addResizeListener(t.canvas.parentNode,function(){i.controller&&i.controller.config.options.responsive&&i.controller.resize()}),this.controller?this.controller:this};n.defaults={global:{responsive:!0,responsiveAnimationDuration:0,maintainAspectRatio:!0,events:["mousemove","mouseout","click","touchstart","touchmove","touchend"],hover:{onHover:null,mode:"single",animationDuration:400},onClick:null,defaultColor:"rgba(0,0,0,0.1)",elements:{},legendCallback:function(t){var e=[];e.push('<ul class="'+t.id+'-legend">');for(var n=0;n<t.data.datasets.length;n++)e.push('<li><span style="background-color:'+t.data.datasets[n].backgroundColor+'">'),t.data.datasets[n].label&&e.push(t.data.datasets[n].label),e.push("</span></li>");return e.push("</ul>"),e.join("")}}},"undefined"!=typeof amd?define(function(){return n}):"object"==typeof module&&module.exports&&(module.exports=n),t.Chart=n,n.noConflict=function(){return t.Chart=e,n}}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers={},i=n.each=function(t,e,n,i){var a=Array.prototype.slice.call(arguments,3);if(t)if(t.length===+t.length){var s;if(i)for(s=t.length-1;s>=0;s--)e.apply(n,[t[s],s].concat(a));else for(s=0;s<t.length;s++)e.apply(n,[t[s],s].concat(a))}else for(var r in t)e.apply(n,[t[r],r].concat(a))},a=n.clone=function(t){var e={};return i(t,function(i,s){t.hasOwnProperty(s)&&(e[s]=n.isArray(i)?i.slice(0):"object"==typeof i&&null!==i?a(i):i)}),e},s=n.extend=function(t){return i(Array.prototype.slice.call(arguments,1),function(e){i(e,function(n,i){e.hasOwnProperty(i)&&(t[i]=n)})}),t},r=(n.configMerge=function(t){var i=a(t);return n.each(Array.prototype.slice.call(arguments,1),function(t){n.each(t,function(a,s){if(t.hasOwnProperty(s))if("scales"===s)i[s]=n.scaleMerge(i.hasOwnProperty(s)?i[s]:{},a);else if("scale"===s)i[s]=n.configMerge(i.hasOwnProperty(s)?i[s]:{},e.scaleService.getScaleDefaults(a.type),a);else if(i.hasOwnProperty(s)&&n.isArray(i[s])&&n.isArray(a)){var r=i[s];n.each(a,function(t,e){e<r.length?r[e]="object"==typeof r[e]&&null!==r[e]&&"object"==typeof t&&null!==t?n.configMerge(r[e],t):t:r.push(t)})}else i[s]=i.hasOwnProperty(s)&&"object"==typeof i[s]&&null!==i[s]&&"object"==typeof a?n.configMerge(i[s],a):a})}),i},n.extendDeep=function(){function t(e){return n.each(arguments,function(i){i!==e&&n.each(i,function(n,i){e[i]&&e[i].constructor&&e[i].constructor===Object?t(e[i],n):e[i]=n})}),e}return t.apply(this,arguments)},n.scaleMerge=function(t,i){var s=a(t);return n.each(i,function(t,a){i.hasOwnProperty(a)&&("xAxes"===a||"yAxes"===a?s.hasOwnProperty(a)?n.each(t,function(t,i){i>=s[a].length||!s[a][i].type?s[a].push(n.configMerge(t.type?e.scaleService.getScaleDefaults(t.type):{},t)):s[a][i]=t.type!==s[a][i].type?n.configMerge(s[a][i],t.type?e.scaleService.getScaleDefaults(t.type):{},t):n.configMerge(s[a][i],t)}):(s[a]=[],n.each(t,function(t){s[a].push(n.configMerge(t.type?e.scaleService.getScaleDefaults(t.type):{},t))})):s[a]=s.hasOwnProperty(a)&&"object"==typeof s[a]&&null!==s[a]&&"object"==typeof t?n.configMerge(s[a],t):t)}),s},n.getValueAtIndexOrDefault=function(t,e,i){return void 0===t||null===t?i:n.isArray(t)?e<t.length?t[e]:i:t},n.indexOf=function(t,e){if(Array.prototype.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1},n.where=function(t,e){var i=[];return n.each(t,function(t){e(t)&&i.push(t)}),i},n.findNextWhere=function(t,e,n){(void 0===n||null===n)&&(n=-1);for(var i=n+1;i<t.length;i++){var a=t[i];if(e(a))return a}},n.findPreviousWhere=function(t,e,n){(void 0===n||null===n)&&(n=t.length);for(var i=n-1;i>=0;i--){var a=t[i];if(e(a))return a}},n.inherits=function(t){var e=this,n=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)},i=function(){this.constructor=n};return i.prototype=e.prototype,n.prototype=new i,n.extend=r,t&&s(n.prototype,t),n.__super__=e.prototype,n}),o=n.noop=function(){},l=(n.uid=function(){var t=0;return function(){return"chart-"+t++}}(),n.warn=function(t){window.console&&"function"==typeof window.console.warn&&console.warn(t)},n.amd="function"==typeof define&&define.amd,n.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)}),d=(n.max=function(t){return Math.max.apply(Math,t)},n.min=function(t){return Math.min.apply(Math,t)},n.sign=function(t){return Math.sign?Math.sign(t):(t=+t,0===t||isNaN(t)?t:t>0?1:-1)},n.log10=function(t){return Math.log10?Math.log10(t):Math.log(t)/Math.LN10},n.getDecimalPlaces=function(t){if(t%1!==0&&l(t)){var e=t.toString();if(e.indexOf("e-")<0)return e.split(".")[1].length;if(e.indexOf(".")<0)return parseInt(e.split("e-")[1]);var n=e.split(".")[1].split("e-");return n[0].length+parseInt(n[1])}return 0},n.toRadians=function(t){return t*(Math.PI/180)},n.toDegrees=function(t){return t*(180/Math.PI)},n.getAngleFromPoint=function(t,e){var n=e.x-t.x,i=e.y-t.y,a=Math.sqrt(n*n+i*i),s=Math.atan2(i,n);return s<-.5*Math.PI&&(s+=2*Math.PI),{angle:s,distance:a}},n.aliasPixel=function(t){return t%2===0?0:.5},n.splineCurve=function(t,e,n,i){var a=t,s=e,r=n;a.skip&&(a=s),r.skip&&(r=s);var o=Math.sqrt(Math.pow(s.x-a.x,2)+Math.pow(s.y-a.y,2)),l=Math.sqrt(Math.pow(r.x-s.x,2)+Math.pow(r.y-s.y,2)),d=i*o/(o+l),c=i*l/(o+l);return{previous:{x:s.x-d*(r.x-a.x),y:s.y-d*(r.y-a.y)},next:{x:s.x+c*(r.x-a.x),y:s.y+c*(r.y-a.y)}}},n.nextItem=function(t,e,n){return n?e>=t.length-1?t[0]:t[e+1]:e>=t.length-1?t[t.length-1]:t[e+1]},n.previousItem=function(t,e,n){return n?0>=e?t[t.length-1]:t[e-1]:0>=e?t[0]:t[e-1]},n.niceNum=function(t,e){var i,a=Math.floor(n.log10(t)),s=t/Math.pow(10,a);return i=e?1.5>s?1:3>s?2:7>s?5:10:1>=s?1:2>=s?2:5>=s?5:10,i*Math.pow(10,a)},n.easingEffects={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-1*t*(t-2)},easeInOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return 1*((t=t/1-1)*t*t+1)},easeInOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-1*((t=t/1-1)*t*t*t-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},easeInQuint:function(t){return 1*(t/=1)*t*t*t*t},easeOutQuint:function(t){return 1*((t=t/1-1)*t*t*t*t+1)},easeInOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return-1*Math.cos(t/1*(Math.PI/2))+1},easeOutSine:function(t){return 1*Math.sin(t/1*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t/1)-1)},easeInExpo:function(t){return 0===t?1:1*Math.pow(2,10*(t/1-1))},easeOutExpo:function(t){return 1===t?1:1*(-Math.pow(2,-10*t/1)+1)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},easeInCirc:function(t){return t>=1?t:-1*(Math.sqrt(1-(t/=1)*t)-1)},easeOutCirc:function(t){return 1*Math.sqrt(1-(t=t/1-1)*t)},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var e=1.70158,n=0,i=1;
return 0===t?0:1==(t/=1)?1:(n||(n=.3),i<Math.abs(1)?(i=1,e=n/4):e=n/(2*Math.PI)*Math.asin(1/i),-(i*Math.pow(2,10*(t-=1))*Math.sin(2*(1*t-e)*Math.PI/n)))},easeOutElastic:function(t){var e=1.70158,n=0,i=1;return 0===t?0:1==(t/=1)?1:(n||(n=.3),i<Math.abs(1)?(i=1,e=n/4):e=n/(2*Math.PI)*Math.asin(1/i),i*Math.pow(2,-10*t)*Math.sin(2*(1*t-e)*Math.PI/n)+1)},easeInOutElastic:function(t){var e=1.70158,n=0,i=1;return 0===t?0:2==(t/=.5)?1:(n||(n=.3*1.5),i<Math.abs(1)?(i=1,e=n/4):e=n/(2*Math.PI)*Math.asin(1/i),1>t?-.5*i*Math.pow(2,10*(t-=1))*Math.sin(2*(1*t-e)*Math.PI/n):i*Math.pow(2,-10*(t-=1))*Math.sin(2*(1*t-e)*Math.PI/n)*.5+1)},easeInBack:function(t){var e=1.70158;return 1*(t/=1)*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return 1*((t=t/1-1)*t*((e+1)*t+e)+1)},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?.5*t*t*(((e*=1.525)+1)*t-e):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:function(t){return 1-d.easeOutBounce(1-t)},easeOutBounce:function(t){return(t/=1)<1/2.75?7.5625*t*t:2/2.75>t?1*(7.5625*(t-=1.5/2.75)*t+.75):2.5/2.75>t?1*(7.5625*(t-=2.25/2.75)*t+.9375):1*(7.5625*(t-=2.625/2.75)*t+.984375)},easeInOutBounce:function(t){return.5>t?.5*d.easeInBounce(2*t):.5*d.easeOutBounce(2*t-1)+.5}}),c=(n.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}(),n.cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return window.clearTimeout(t,1e3/60)}}(),n.getRelativePosition=function(t,e){var n,i,a=t.originalEvent||t,s=t.currentTarget||t.srcElement,r=s.getBoundingClientRect();return a.touches?(n=a.touches[0].clientX,i=a.touches[0].clientY):(n=a.clientX,i=a.clientY),n=Math.round((n-r.left)/(r.right-r.left)*s.width/e.currentDevicePixelRatio),i=Math.round((i-r.top)/(r.bottom-r.top)*s.height/e.currentDevicePixelRatio),{x:n,y:i}},n.addEvent=function(t,e,n){t.addEventListener?t.addEventListener(e,n):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n}),u=n.removeEvent=function(t,e,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent?t.detachEvent("on"+e,n):t["on"+e]=o},g=(n.bindEvents=function(t,e,n){t.events||(t.events={}),i(e,function(e){t.events[e]=function(){n.apply(t,arguments)},c(t.chart.canvas,e,t.events[e])})},n.unbindEvents=function(t,e){i(e,function(e,n){u(t.chart.canvas,n,e)})},n.getConstraintWidth=function(t){var e,n=document.defaultView.getComputedStyle(t)["max-width"],i=document.defaultView.getComputedStyle(t.parentNode)["max-width"],a=null!==n&&"none"!==n,s=null!==i&&"none"!==i;return(a||s)&&(e=Math.min(a?parseInt(n,10):Number.POSITIVE_INFINITY,s?parseInt(i,10):Number.POSITIVE_INFINITY)),e}),h=n.getConstraintHeight=function(t){var e,n=document.defaultView.getComputedStyle(t)["max-height"],i=document.defaultView.getComputedStyle(t.parentNode)["max-height"],a=null!==n&&"none"!==n,s=null!==i&&"none"!==i;return(n||i)&&(e=Math.min(a?parseInt(n,10):Number.POSITIVE_INFINITY,s?parseInt(i,10):Number.POSITIVE_INFINITY)),e},p=(n.getMaximumWidth=function(t){var e=t.parentNode,n=parseInt(p(e,"padding-left"))+parseInt(p(e,"padding-right")),i=e.clientWidth-n,a=g(t);return void 0!==a&&(i=Math.min(i,a)),i},n.getMaximumHeight=function(t){var e=t.parentNode,n=parseInt(p(e,"padding-top"))+parseInt(p(e,"padding-bottom")),i=e.clientHeight-n,a=h(t);return void 0!==a&&(i=Math.min(i,a)),i},n.getStyle=function(t,e){return t.currentStyle?t.currentStyle[e]:document.defaultView.getComputedStyle(t,null).getPropertyValue(e)});n.getMaximumSize=n.getMaximumWidth,n.retinaScale=function(t){var e=t.ctx,n=t.canvas.width,i=t.canvas.height;t.currentDevicePixelRatio=window.devicePixelRatio||1,1!==window.devicePixelRatio&&(e.canvas.height=i*window.devicePixelRatio,e.canvas.width=n*window.devicePixelRatio,e.scale(window.devicePixelRatio,window.devicePixelRatio),e.canvas.style.width=n+"px",e.canvas.style.height=i+"px",t.originalDevicePixelRatio=t.originalDevicePixelRatio||window.devicePixelRatio)},n.clear=function(t){t.ctx.clearRect(0,0,t.width,t.height)},n.fontString=function(t,e,n){return e+" "+t+"px "+n},n.longestText=function(t,e,n){t.font=e;var a=0;return i(n,function(e){var n=t.measureText(e).width;a=n>a?n:a}),a},n.drawRoundedRectangle=function(t,e,n,i,a,s){t.beginPath(),t.moveTo(e+s,n),t.lineTo(e+i-s,n),t.quadraticCurveTo(e+i,n,e+i,n+s),t.lineTo(e+i,n+a-s),t.quadraticCurveTo(e+i,n+a,e+i-s,n+a),t.lineTo(e+s,n+a),t.quadraticCurveTo(e,n+a,e,n+a-s),t.lineTo(e,n+s),t.quadraticCurveTo(e,n,e+s,n),t.closePath()},n.color=function(t){return window.Color?window.Color(t):(console.log("Color.js not found!"),t)},n.addResizeListener=function(t,e){var n=document.createElement("iframe"),i="chartjs-hidden-iframe";n.classlist?n.classlist.add(i):n.setAttribute("class",i),n.style.width="100%",n.style.display="block",n.style.border=0,n.style.height=0,n.style.margin=0,n.style.position="absolute",n.style.left=0,n.style.right=0,n.style.top=0,n.style.bottom=0,t.insertBefore(n,t.firstChild),(n.contentWindow||n).onresize=function(){e&&e()}},n.removeResizeListener=function(t){var e=t.querySelector(".chartjs-hidden-iframe");e&&e.parentNode.removeChild(e)},n.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(arg)},n.isDatasetVisible=function(t){return!t.hidden}}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers;e.elements={},e.Element=function(t){n.extend(this,t),this.initialize.apply(this,arguments)},n.extend(e.Element.prototype,{initialize:function(){},pivot:function(){return this._view||(this._view=n.clone(this._model)),this._start=n.clone(this._view),this},transition:function(t){return this._view||(this._view=n.clone(this._model)),this._start||this.pivot(),n.each(this._model,function(e,i){if("_"!==i[0]&&this._model.hasOwnProperty(i))if(this._view[i])if(this._model[i]===this._view[i]);else if("string"==typeof e)try{var a=n.color(this._start[i]).mix(n.color(this._model[i]),t);this._view[i]=a.rgbString()}catch(s){this._view[i]=e}else if("number"==typeof e){var r=void 0!==this._start[i]?this._start[i]:0;this._view[i]=(this._model[i]-r)*t+r}else this._view[i]=e;else this._view[i]="number"==typeof e?e*t:e||null},this),1===t&&delete this._start,this},tooltipPosition:function(){return{x:this._model.x,y:this._model.y}},hasValue:function(){return n.isNumber(this._model.x)&&n.isNumber(this._model.y)}}),e.Element.extend=n.inherits}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers;e.defaults.global.animation={duration:1e3,easing:"easeOutQuart",onProgress:function(){},onComplete:function(){}},e.Animation=e.Element.extend({currentStep:null,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null}),e.animationService={frameDuration:17,animations:[],dropFrames:0,addAnimation:function(t,e,i,a){a||(t.animating=!0);for(var s=0;s<this.animations.length;++s)if(this.animations[s].chartInstance===t)return void(this.animations[s].animationObject=e);this.animations.push({chartInstance:t,animationObject:e}),1==this.animations.length&&n.requestAnimFrame.call(window,this.digestWrapper)},cancelAnimation:function(t){var e=n.findNextWhere(this.animations,function(e){return e.chartInstance===t});e&&(this.animations.splice(e,1),t.animating=!1)},digestWrapper:function(){e.animationService.startDigest.call(e.animationService)},startDigest:function(){var t=Date.now(),e=0;this.dropFrames>1&&(e=Math.floor(this.dropFrames),this.dropFrames=this.dropFrames%1);for(var i=0;i<this.animations.length;i++)null===this.animations[i].animationObject.currentStep&&(this.animations[i].animationObject.currentStep=0),this.animations[i].animationObject.currentStep+=1+e,this.animations[i].animationObject.currentStep>this.animations[i].animationObject.numSteps&&(this.animations[i].animationObject.currentStep=this.animations[i].animationObject.numSteps),this.animations[i].animationObject.render(this.animations[i].chartInstance,this.animations[i].animationObject),this.animations[i].animationObject.currentStep==this.animations[i].animationObject.numSteps&&(this.animations[i].chartInstance.animating=!1,this.animations.splice(i,1),i--);var a=Date.now(),s=(a-t)/this.frameDuration;this.dropFrames+=s,this.animations.length>0&&n.requestAnimFrame.call(window,this.digestWrapper)}}}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers;e.types={},e.instances={},e.controllers={},e.Controller=function(t){return this.chart=t,this.config=t.config,this.data=this.config.data,this.options=this.config.options=n.configMerge(e.defaults.global,e.defaults[this.config.type],this.config.options||{}),this.id=n.uid(),e.instances[this.id]=this,this.options.responsive&&this.resize(!0),this.initialize.call(this),this},n.extend(e.Controller.prototype,{initialize:function(){return this.bindEvents(),this.ensureScalesHaveIDs(),this.buildOrUpdateControllers(),this.buildScales(),this.resetElements(),this.initToolTip(),this.update(),this},clear:function(){return n.clear(this.chart),this},stop:function(){return e.animationService.cancelAnimation(this),this},resize:function(t){this.stop();var e=this.chart.canvas,i=n.getMaximumWidth(this.chart.canvas),a=this.options.maintainAspectRatio&&isNaN(this.chart.aspectRatio)===!1&&isFinite(this.chart.aspectRatio)&&0!==this.chart.aspectRatio?i/this.chart.aspectRatio:n.getMaximumHeight(this.chart.canvas);return e.width=this.chart.width=i,e.height=this.chart.height=a,n.retinaScale(this.chart),t||this.update(this.options.responsiveAnimationDuration),this},ensureScalesHaveIDs:function(){var t="x-axis-",e="y-axis-";this.options.scales&&(this.options.scales.xAxes&&this.options.scales.xAxes.length&&n.each(this.options.scales.xAxes,function(e,n){e.id=e.id||t+n},this),this.options.scales.yAxes&&this.options.scales.yAxes.length&&n.each(this.options.scales.yAxes,function(t,n){t.id=t.id||e+n},this))},buildScales:function(){if(this.scales={},this.options.scales&&(this.options.scales.xAxes&&this.options.scales.xAxes.length&&n.each(this.options.scales.xAxes,function(t){var n=e.scaleService.getScaleConstructor(t.type),i=new n({ctx:this.chart.ctx,options:t,data:this.data,id:t.id});this.scales[i.id]=i},this),this.options.scales.yAxes&&this.options.scales.yAxes.length&&n.each(this.options.scales.yAxes,function(t){var n=e.scaleService.getScaleConstructor(t.type),i=new n({ctx:this.chart.ctx,options:t,data:this.data,id:t.id});this.scales[i.id]=i},this)),this.options.scale){var t=e.scaleService.getScaleConstructor(this.options.scale.type),i=new t({ctx:this.chart.ctx,options:this.options.scale,data:this.data,chart:this.chart});this.scale=i,this.scales.radialScale=i}e.scaleService.update(this,this.chart.width,this.chart.height)},buildOrUpdateControllers:function(t){var i=[];if(n.each(this.data.datasets,function(n,a){n.type||(n.type=this.config.type);var s=n.type;return i.push(s),n.controller?void n.controller.updateIndex(a):(n.controller=new e.controllers[s](this,a),void(t&&n.controller.reset()))},this),i.length>1)for(var a=1;a<i.length;a++)if(i[a]!=i[a-1]){this.isCombo=!0;break}},resetElements:function(){n.each(this.data.datasets,function(t){t.controller.reset()},this)},update:function(t,i){e.scaleService.update(this,this.chart.width,this.chart.height),this.buildOrUpdateControllers(!0),n.each(this.data.datasets,function(t){t.controller.buildOrUpdateElements()},this),n.each(this.data.datasets,function(t){t.controller.update()},this),this.render(t,i)},render:function(t,i){if("undefined"!=typeof t&&0!==t||"undefined"==typeof t&&0!==this.options.animation.duration){var a=new e.Animation;a.numSteps=(t||this.options.animation.duration)/16.66,a.easing=this.options.animation.easing,a.render=function(t,e){var i=n.easingEffects[e.easing],a=e.currentStep/e.numSteps,s=i(a);t.draw(s,a,e.currentStep)},a.onAnimationProgress=this.options.onAnimationProgress,a.onAnimationComplete=this.options.onAnimationComplete,e.animationService.addAnimation(this,a,t,i)}else this.draw(),this.options.onAnimationComplete&&this.options.onAnimationComplete.call&&this.options.onAnimationComplete.call(this);return this},draw:function(t){var e=t||1;this.clear(),n.each(this.scales,function(t){t.draw(this.chartArea)},this),this.scale&&this.scale.draw(),n.each(this.data.datasets,function(e){n.isDatasetVisible(e)&&e.controller.draw(t)},this),this.tooltip.transition(e).draw()},getElementAtEvent:function(t){var e=n.getRelativePosition(t,this.chart),i=[];return n.each(this.data.datasets,function(t){n.isDatasetVisible(t)&&n.each(t.metaData,function(t){return t.inRange(e.x,e.y)?(i.push(t),i):void 0},this)},this),i},getElementsAtEvent:function(t){var e=n.getRelativePosition(t,this.chart),i=[],a=function(){for(var t=0;t<this.data.datasets.length;t++)if(n.isDatasetVisible(this.data.datasets[t]))for(var i=0;i<this.data.datasets[t].metaData.length;i++)if(this.data.datasets[t].metaData[i].inRange(e.x,e.y))return this.data.datasets[t].metaData[i]}.call(this);return a?(n.each(this.data.datasets,function(t){n.isDatasetVisible(t)&&i.push(t.metaData[a._index])},this),i):i},getDatasetAtEvent:function(t){var e=n.getRelativePosition(t,this.chart),i=[];return n.each(this.data.datasets,function(t){n.isDatasetVisible(t)&&n.each(t.metaData,function(a){a.inLabelRange(e.x,e.y)&&n.each(t.metaData,function(t){i.push(t)},this)},this)},this),i.length?i:[]},generateLegend:function(){return this.options.legendCallback(this)},destroy:function(){this.clear(),n.unbindEvents(this,this.events),n.removeResizeListener(this.chart.canvas.parentNode);var t=this.chart.canvas;t.width=this.chart.width,t.height=this.chart.height,void 0!==this.chart.originalDevicePixelRatio&&this.chart.ctx.scale(1/this.chart.originalDevicePixelRatio,1/this.chart.originalDevicePixelRatio),t.style.width=this.chart.originalCanvasStyleWidth,t.style.height=this.chart.originalCanvasStyleHeight,delete e.instances[this.id]},toBase64Image:function(){return this.chart.canvas.toDataURL.apply(this.chart.canvas,arguments)},initToolTip:function(){this.tooltip=new e.Tooltip({_chart:this.chart,_data:this.data,_options:this.options},this)},bindEvents:function(){n.bindEvents(this,this.options.events,function(t){this.eventHandler(t)})},eventHandler:function(t){if(this.lastActive=this.lastActive||[],this.lastTooltipActive=this.lastTooltipActive||[],"mouseout"==t.type?(this.active=[],this.tooltipActive=[]):(this.active=function(){switch(this.options.hover.mode){case"single":return this.getElementAtEvent(t);case"label":return this.getElementsAtEvent(t);case"dataset":return this.getDatasetAtEvent(t);default:return t}}.call(this),this.tooltipActive=function(){switch(this.options.tooltips.mode){case"single":return this.getElementAtEvent(t);case"label":return this.getElementsAtEvent(t);case"dataset":return this.getDatasetAtEvent(t);default:return t}}.call(this)),this.options.hover.onHover&&this.options.hover.onHover.call(this,this.active),("mouseup"==t.type||"click"==t.type)&&this.options.onClick&&this.options.onClick.call(this,t,this.active),this.lastActive.length)switch(this.options.hover.mode){case"single":this.data.datasets[this.lastActive[0]._datasetIndex].controller.removeHoverStyle(this.lastActive[0],this.lastActive[0]._datasetIndex,this.lastActive[0]._index);break;case"label":case"dataset":for(var e=0;e<this.lastActive.length;e++)this.data.datasets[this.lastActive[e]._datasetIndex].controller.removeHoverStyle(this.lastActive[e],this.lastActive[e]._datasetIndex,this.lastActive[e]._index)}if(this.active.length&&this.options.hover.mode)switch(this.options.hover.mode){case"single":this.data.datasets[this.active[0]._datasetIndex].controller.setHoverStyle(this.active[0]);break;case"label":case"dataset":for(var i=0;i<this.active.length;i++)this.data.datasets[this.active[i]._datasetIndex].controller.setHoverStyle(this.active[i])}if((this.options.tooltips.enabled||this.options.tooltips.custom)&&(this.tooltip.initialize(),this.tooltip._active=this.tooltipActive,this.tooltip.update()),this.tooltip.pivot(),!this.animating){var a;n.each(this.active,function(t,e){t!==this.lastActive[e]&&(a=!0)},this),n.each(this.tooltipActive,function(t,e){t!==this.lastTooltipActive[e]&&(a=!0)},this),(this.lastActive.length!==this.active.length||this.lastTooltipActive.length!==this.tooltipActive.length||a)&&(this.stop(),(this.options.tooltips.enabled||this.options.tooltips.custom)&&this.tooltip.update(!0),this.render(this.options.hover.animationDuration,!0))}return this.lastActive=this.active,this.lastTooltipActive=this.tooltipActive,this}})}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers;e.defaults.scale={display:!0,gridLines:{show:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1,drawOnChartArea:!0,drawTicks:!0,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",offsetGridLines:!1},scaleLabel:{fontColor:"#666",fontFamily:"Helvetica Neue",fontSize:12,fontStyle:"normal",labelString:"",show:!1},ticks:{beginAtZero:!1,fontSize:12,fontStyle:"normal",fontColor:"#666",fontFamily:"Helvetica Neue",maxRotation:90,minRotation:20,mirror:!1,padding:10,reverse:!1,show:!0,callback:function(t){return""+t}}},e.Scale=e.Element.extend({beforeUpdate:n.noop,update:function(t,e,n){return this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this.margins=n,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this.beforeBuildTicks(),this.buildTicks(),this.afterBuildTicks(),this.beforeTickToLabelConversion(),this.convertTicksToLabels(),this.afterTickToLabelConversion(),this.beforeCalculateTickRotation(),this.calculateTickRotation(),this.afterCalculateTickRotation(),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate(),this.minSize},afterUpdate:n.noop,beforeSetDimensions:n.noop,setDimensions:function(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0},afterSetDimensions:n.noop,beforeBuildTicks:n.noop,buildTicks:n.noop,afterBuildTicks:n.noop,beforeTickToLabelConversion:n.noop,convertTicksToLabels:function(){this.ticks=this.ticks.map(function(t,e,n){return this.options.ticks.userCallback?this.options.ticks.userCallback(t,e,n):this.options.ticks.callback(t,e,n)},this)},afterTickToLabelConversion:n.noop,beforeCalculateTickRotation:n.noop,calculateTickRotation:function(){var t=n.fontString(this.options.ticks.fontSize,this.options.ticks.fontStyle,this.options.ticks.fontFamily);this.ctx.font=t;var e,i,a=this.ctx.measureText(this.ticks[0]).width,s=this.ctx.measureText(this.ticks[this.ticks.length-1]).width;if(this.paddingRight=s/2+3,this.paddingLeft=a/2+3,this.labelRotation=0,this.options.display&&this.isHorizontal()){var r,o,l=n.longestText(this.ctx,t,this.ticks);this.labelWidth=l;for(var d=this.getPixelForTick(1)-this.getPixelForTick(0)-6;this.labelWidth>d&&this.labelRotation<=this.options.ticks.maxRotation;){if(r=Math.cos(n.toRadians(this.labelRotation)),o=Math.sin(n.toRadians(this.labelRotation)),e=r*a,i=r*s,e+this.options.ticks.fontSize/2>this.yLabelWidth&&(this.paddingLeft=e+this.options.ticks.fontSize/2),this.paddingRight=this.options.ticks.fontSize/2,o*l>this.maxHeight){this.labelRotation--;break}this.labelRotation++,this.labelWidth=r*l}}else this.labelWidth=0,this.paddingRight=0,this.paddingLeft=0;this.margins&&(this.paddingLeft-=this.margins.left,this.paddingRight-=this.margins.right,this.paddingLeft=Math.max(this.paddingLeft,0),this.paddingRight=Math.max(this.paddingRight,0))},afterCalculateTickRotation:n.noop,beforeFit:n.noop,fit:function(){if(this.minSize={width:0,height:0},this.minSize.width=this.isHorizontal()?this.maxWidth:this.options.gridLines.show&&this.options.display?10:0,this.minSize.height=this.isHorizontal()?this.options.gridLines.show&&this.options.display?10:0:this.maxHeight,this.options.scaleLabel.show&&(this.isHorizontal()?this.minSize.height+=1.5*this.options.scaleLabel.fontSize:this.minSize.width+=1.5*this.options.scaleLabel.fontSize),this.options.ticks.show&&this.options.display){var t=n.fontString(this.options.ticks.fontSize,this.options.ticks.fontStyle,this.options.ticks.fontFamily);if(this.isHorizontal()){var e=(this.maxHeight-this.minSize.height,n.longestText(this.ctx,t,this.ticks)),i=Math.sin(n.toRadians(this.labelRotation))*e+1.5*this.options.ticks.fontSize;this.minSize.height=Math.min(this.maxHeight,this.minSize.height+i),t=n.fontString(this.options.ticks.fontSize,this.options.ticks.fontStyle,this.options.ticks.fontFamily),this.ctx.font=t;var a=this.ctx.measureText(this.ticks[0]).width,s=this.ctx.measureText(this.ticks[this.ticks.length-1]).width,r=Math.cos(n.toRadians(this.labelRotation)),o=Math.sin(n.toRadians(this.labelRotation));this.paddingLeft=0!==this.labelRotation?r*a+3:a/2+3,this.paddingRight=0!==this.labelRotation?o*(this.options.ticks.fontSize/2)+3:s/2+3}else{var l=this.maxWidth-this.minSize.width,d=n.longestText(this.ctx,t,this.ticks);l>d?this.minSize.width+=d:this.minSize.width=this.maxWidth,this.paddingTop=this.options.ticks.fontSize/2,this.paddingBottom=this.options.ticks.fontSize/2}}this.margins&&(this.paddingLeft-=this.margins.left,this.paddingTop-=this.margins.top,this.paddingRight-=this.margins.right,this.paddingBottom-=this.margins.bottom,this.paddingLeft=Math.max(this.paddingLeft,0),this.paddingTop=Math.max(this.paddingTop,0),this.paddingRight=Math.max(this.paddingRight,0),this.paddingBottom=Math.max(this.paddingBottom,0)),this.width=this.minSize.width,this.height=this.minSize.height},afterFit:n.noop,isHorizontal:function(){return"top"==this.options.position||"bottom"==this.options.position},getRightValue:function i(t){return null===t||"undefined"==typeof t?0/0:"number"==typeof t&&isNaN(t)?0/0:"object"==typeof t?i(this.isHorizontal()?t.x:t.y):t},getLabelForIndex:n.noop,getPixelForValue:n.noop,getPixelForTick:function(t,e){if(this.isHorizontal()){var n=this.width-(this.paddingLeft+this.paddingRight),i=n/Math.max(this.ticks.length-(this.options.gridLines.offsetGridLines?0:1),1),a=i*t+this.paddingLeft;return e&&(a+=i/2),this.left+Math.round(a)}var s=this.height-(this.paddingTop+this.paddingBottom);return this.top+t*(s/(this.ticks.length-1))},getPixelForDecimal:function(t){if(this.isHorizontal()){var e=this.width-(this.paddingLeft+this.paddingRight),n=e*t+this.paddingLeft;return this.left+Math.round(n)}return this.top+t*this.height},draw:function(t){if(this.options.display){var e,i,a,s,r=0!==this.labelRotation;this.ctx.fillStyle=this.options.ticks.fontColor;var o=n.fontString(this.options.ticks.fontSize,this.options.ticks.fontStyle,this.options.ticks.fontFamily);if(this.isHorizontal()){e=!0;var l="bottom"==this.options.position?this.top:this.bottom-10,d="bottom"==this.options.position?this.top+10:this.bottom;i=!1,(this.options.ticks.fontSize+4)*this.ticks.length>this.width-(this.paddingLeft+this.paddingRight)&&(i=1+Math.floor((this.options.ticks.fontSize+4)*this.ticks.length/(this.width-(this.paddingLeft+this.paddingRight)))),n.each(this.ticks,function(a,s){if(!(i>1&&s%i>0||void 0===a||null===a)){var c=this.getPixelForTick(s),u=this.getPixelForTick(s,this.options.gridLines.offsetGridLines);this.options.gridLines.show&&(s===("undefined"!=typeof this.zeroLineIndex?this.zeroLineIndex:0)?(this.ctx.lineWidth=this.options.gridLines.zeroLineWidth,this.ctx.strokeStyle=this.options.gridLines.zeroLineColor,e=!0):e&&(this.ctx.lineWidth=this.options.gridLines.lineWidth,this.ctx.strokeStyle=this.options.gridLines.color,e=!1),c+=n.aliasPixel(this.ctx.lineWidth),this.ctx.beginPath(),this.options.gridLines.drawTicks&&(this.ctx.moveTo(c,l),this.ctx.lineTo(c,d)),this.options.gridLines.drawOnChartArea&&(this.ctx.moveTo(c,t.top),this.ctx.lineTo(c,t.bottom)),this.ctx.stroke()),this.options.ticks.show&&(this.ctx.save(),this.ctx.translate(u,r?this.top+12:"top"===this.options.position?this.bottom-10:this.top+10),this.ctx.rotate(-1*n.toRadians(this.labelRotation)),this.ctx.font=o,this.ctx.textAlign=r?"right":"center",this.ctx.textBaseline=r?"middle":"top"===this.options.position?"bottom":"top",this.ctx.fillText(a,0,0),this.ctx.restore())}},this),this.options.scaleLabel.show&&(this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle=this.options.scaleLabel.fontColor,this.ctx.font=n.fontString(this.options.scaleLabel.fontSize,this.options.scaleLabel.fontStyle,this.options.scaleLabel.fontFamily),a=this.left+(this.right-this.left)/2,s="bottom"==this.options.position?this.bottom-this.options.scaleLabel.fontSize/2:this.top+this.options.scaleLabel.fontSize/2,this.ctx.fillText(this.options.scaleLabel.labelString,a,s))}else{e=!0;var c="right"==this.options.position?this.left:this.right-5,u="right"==this.options.position?this.left+5:this.right;if(n.each(this.ticks,function(i,a){var s=this.getPixelForTick(a);if(this.options.gridLines.show&&(a===("undefined"!=typeof this.zeroLineIndex?this.zeroLineIndex:0)?(this.ctx.lineWidth=this.options.gridLines.zeroLineWidth,this.ctx.strokeStyle=this.options.gridLines.zeroLineColor,e=!0):e&&(this.ctx.lineWidth=this.options.gridLines.lineWidth,this.ctx.strokeStyle=this.options.gridLines.color,e=!1),s+=n.aliasPixel(this.ctx.lineWidth),this.ctx.beginPath(),this.options.gridLines.drawTicks&&(this.ctx.moveTo(c,s),this.ctx.lineTo(u,s)),this.options.gridLines.drawOnChartArea&&(this.ctx.moveTo(t.left,s),this.ctx.lineTo(t.right,s)),this.ctx.stroke()),this.options.ticks.show){var r,l=this.getPixelForTick(a,this.options.gridLines.offsetGridLines);this.ctx.save(),"left"==this.options.position?this.options.ticks.mirror?(r=this.right+this.options.ticks.padding,this.ctx.textAlign="left"):(r=this.right-this.options.ticks.padding,this.ctx.textAlign="right"):this.options.ticks.mirror?(r=this.left-this.options.ticks.padding,this.ctx.textAlign="right"):(r=this.left+this.options.ticks.padding,this.ctx.textAlign="left"),this.ctx.translate(r,l),this.ctx.rotate(-1*n.toRadians(this.labelRotation)),this.ctx.font=o,this.ctx.textBaseline="middle",this.ctx.fillText(i,0,0),this.ctx.restore()}},this),this.options.scaleLabel.show){a="left"==this.options.position?this.left+this.options.scaleLabel.fontSize/2:this.right-this.options.scaleLabel.fontSize/2,s=this.top+(this.bottom-this.top)/2;var g="left"==this.options.position?-.5*Math.PI:.5*Math.PI;this.ctx.save(),this.ctx.translate(a,s),this.ctx.rotate(g),this.ctx.textAlign="center",this.ctx.fillStyle=this.options.scaleLabel.fontColor,this.ctx.font=n.fontString(this.options.scaleLabel.fontSize,this.options.scaleLabel.fontStyle,this.options.scaleLabel.fontFamily),this.ctx.textBaseline="middle",this.ctx.fillText(this.options.scaleLabel.labelString,0,0),this.ctx.restore()}}}}})}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers;e.scaleService={constructors:{},defaults:{},registerScaleType:function(t,e,i){this.constructors[t]=e,this.defaults[t]=n.clone(i)},getScaleConstructor:function(t){return this.constructors.hasOwnProperty(t)?this.constructors[t]:void 0},getScaleDefaults:function(t){return this.defaults.hasOwnProperty(t)?n.scaleMerge(e.defaults.scale,this.defaults[t]):{}},update:function(t,e,i){var a=e>30?5:2,s=i>30?5:2;if(t){var r=n.where(t.scales,function(t){return"left"==t.options.position}),o=n.where(t.scales,function(t){return"right"==t.options.position}),l=n.where(t.scales,function(t){return"top"==t.options.position}),d=n.where(t.scales,function(t){return"bottom"==t.options.position}),c=n.where(t.scales,function(t){return"chartArea"==t.options.position}),u=e/2,g=i/2;u-=2*a,g-=2*s;var h=(e-u)/(r.length+o.length),p=(i-g)/(l.length+d.length),m=[],f=function(t){var e=t.update(h,g);m.push({horizontal:!1,minSize:e,scale:t})},v=function(t){var e=t.update(u,p);m.push({horizontal:!0,minSize:e,scale:t})};n.each(r,f),n.each(o,f),n.each(l,v),n.each(d,v);var b=i-2*s,w=e-2*a;n.each(m,function(t){t.horizontal?b-=t.minSize.height:w-=t.minSize.width});var y=function(t){var e=n.findNextWhere(m,function(e){return e.scale===t});e&&t.update(e.minSize.width,b)},D=function(t){var e=n.findNextWhere(m,function(e){return e.scale===t}),i={left:x,right:C,top:0,bottom:0};e&&t.update(w,e.minSize.height,i)},x=a,C=a,_=s,S=s;n.each(r,y),n.each(o,y),n.each(r,function(t){x+=t.width}),n.each(o,function(t){C+=t.width}),n.each(l,D),n.each(d,D),n.each(l,function(t){_+=t.height}),n.each(d,function(t){S+=t.height}),n.each(r,function(t){var e=n.findNextWhere(m,function(e){return e.scale===t}),i={left:0,right:0,top:_,bottom:S};e&&t.update(e.minSize.width,b,i)}),n.each(o,function(t){var e=n.findNextWhere(m,function(e){return e.scale===t}),i={left:0,right:0,top:_,bottom:S};e&&t.update(e.minSize.width,b,i)}),x=a,C=a,_=s,S=s,n.each(r,function(t){x+=t.width}),n.each(o,function(t){C+=t.width}),n.each(l,function(t){_+=t.height}),n.each(d,function(t){S+=t.height});var k=i-_-S,E=e-x-C;(E!==w||k!==b)&&(n.each(r,function(t){t.height=k}),n.each(o,function(t){t.height=k}),n.each(l,function(t){t.width=E}),n.each(d,function(t){t.width=E}),b=k,w=E);var A=a,M=s,F=function(t){t.left=A,t.right=A+t.width,t.top=_,t.bottom=_+b,A=t.right},T=function(t){t.left=x,t.right=x+w,t.top=M,t.bottom=M+t.height,M=t.bottom};n.each(r,F),n.each(l,T),A+=w,M+=b,n.each(o,F),n.each(d,T),t.chartArea={left:x,top:_,right:x+w,bottom:_+b},n.each(c,function(e){e.left=t.chartArea.left,e.top=t.chartArea.top,e.right=t.chartArea.right,e.bottom=t.chartArea.bottom,e.update(w,b)})}}}}.call(this),function(){"use strict";function t(t,e){return e&&(i.isArray(e)?t=t.concat(e):t.push(e)),t}var e=this,n=e.Chart,i=n.helpers;n.defaults.global.tooltips={enabled:!0,custom:null,mode:"single",backgroundColor:"rgba(0,0,0,0.8)",titleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",titleFontSize:12,titleFontStyle:"bold",titleSpacing:2,titleMarginBottom:6,titleColor:"#fff",titleAlign:"left",bodyFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",bodyFontSize:12,bodyFontStyle:"normal",bodySpacing:2,bodyColor:"#fff",bodyAlign:"left",footerFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",footerFontSize:12,footerFontStyle:"bold",footerSpacing:2,footerMarginTop:6,footerColor:"#fff",footerAlign:"left",yPadding:6,xPadding:6,caretSize:5,cornerRadius:6,xOffset:10,multiKeyBackground:"#fff",callbacks:{beforeTitle:i.noop,title:function(t,e){var n="";return t.length>0&&(t[0].xLabel?n=t[0].xLabel:e.labels.length>0&&t[0].index<e.labels.length&&(n=e.labels[t[0].index])),n},afterTitle:i.noop,beforeBody:i.noop,beforeLabel:i.noop,label:function(t,e){var n=e.datasets[t.datasetIndex].label||"";return n+": "+t.yLabel},afterLabel:i.noop,afterBody:i.noop,beforeFooter:i.noop,footer:i.noop,afterFooter:i.noop}},n.Tooltip=n.Element.extend({initialize:function(){var t=this._options;i.extend(this,{_model:{xPadding:t.tooltips.xPadding,yPadding:t.tooltips.yPadding,xOffset:t.tooltips.xOffset,bodyColor:t.tooltips.bodyColor,_bodyFontFamily:t.tooltips.bodyFontFamily,_bodyFontStyle:t.tooltips.bodyFontStyle,_bodyAlign:t.tooltips.bodyAlign,bodyFontSize:t.tooltips.bodyFontSize,bodySpacing:t.tooltips.bodySpacing,titleColor:t.tooltips.titleColor,_titleFontFamily:t.tooltips.titleFontFamily,_titleFontStyle:t.tooltips.titleFontStyle,titleFontSize:t.tooltips.titleFontSize,_titleAlign:t.tooltips.titleAlign,titleSpacing:t.tooltips.titleSpacing,titleMarginBottom:t.tooltips.titleMarginBottom,footerColor:t.tooltips.footerColor,_footerFontFamily:t.tooltips.footerFontFamily,_footerFontStyle:t.tooltips.footerFontStyle,footerFontSize:t.tooltips.footerFontSize,_footerAlign:t.tooltips.footerAlign,footerSpacing:t.tooltips.footerSpacing,footerMarginTop:t.tooltips.footerMarginTop,caretSize:t.tooltips.caretSize,cornerRadius:t.tooltips.cornerRadius,backgroundColor:t.tooltips.backgroundColor,opacity:0,legendColorBackground:t.tooltips.multiKeyBackground}})},getTitle:function(){var e=this._options.tooltips.callbacks.beforeTitle.apply(this,arguments),n=this._options.tooltips.callbacks.title.apply(this,arguments),i=this._options.tooltips.callbacks.afterTitle.apply(this,arguments),a=[];
return a=t(a,e),a=t(a,n),a=t(a,i)},getBeforeBody:function(){var t=this._options.tooltips.callbacks.beforeBody.call(this,arguments);return i.isArray(t)?t:[t]},getBody:function(t,e){var n=[];return i.each(t,function(t){var i=this._options.tooltips.callbacks.beforeLabel.call(this,t,e)||"",a=this._options.tooltips.callbacks.label.call(this,t,e)||"",s=this._options.tooltips.callbacks.afterLabel.call(this,t,e)||"";n.push(i+a+s)},this),n},getAfterBody:function(){var t=this._options.tooltips.callbacks.afterBody.call(this,arguments);return i.isArray(t)?t:[t]},getFooter:function(){var e=this._options.tooltips.callbacks.beforeFooter.apply(this,arguments),n=this._options.tooltips.callbacks.footer.apply(this,arguments),i=this._options.tooltips.callbacks.afterFooter.apply(this,arguments),a=[];return a=t(a,e),a=t(a,n),a=t(a,i)},getAveragePosition:function(t){if(!t.length)return!1;var e=[],n=[];i.each(t,function(t){var i=t.tooltipPosition();e.push(i.x),n.push(i.y)});for(var a=0,s=0,r=0;r<e.length;r++)a+=e[r],s+=n[r];return{x:Math.round(a/e.length),y:Math.round(s/e.length)}},update:function(t){if(this._chart.ctx,this._active.length){this._model.opacity=1;var e,n=this._active[0],a=[],s=[];if("single"==this._options.tooltips.mode){var r=n._yScale||n._scale;s.push({xLabel:n._xScale?n._xScale.getLabelForIndex(n._index,n._datasetIndex):"",yLabel:r?r.getLabelForIndex(n._index,n._datasetIndex):"",index:n._index,datasetIndex:n._datasetIndex}),e=this.getAveragePosition(this._active)}else i.each(this._data.datasets,function(t,e){if(i.isDatasetVisible(t)){var a=t.metaData[n._index],r=n._yScale||n._scale;s.push({xLabel:a._xScale?a._xScale.getLabelForIndex(a._index,a._datasetIndex):"",yLabel:r?r.getLabelForIndex(a._index,a._datasetIndex):"",index:n._index,datasetIndex:e})}}),i.each(this._active,function(t){a.push({borderColor:t._view.borderColor,backgroundColor:t._view.backgroundColor})},this),e=this.getAveragePosition(this._active),e.y=this._active[0]._yScale.getPixelForDecimal(.5);i.extend(this._model,{title:this.getTitle(s,this._data),beforeBody:this.getBeforeBody(s,this._data),body:this.getBody(s,this._data),afterBody:this.getAfterBody(s,this._data),footer:this.getFooter(s,this._data)}),i.extend(this._model,{x:Math.round(e.x),y:Math.round(e.y),caretPadding:e.padding,labelColors:a})}else this._model.opacity=0;return t&&this._options.tooltips.custom&&this._options.tooltips.custom.call(this,this._model),this},draw:function(){var t=this._chart.ctx,e=this._view;if(0!==this._view.opacity){e.position="top";var n=e.caretPadding||2,a=e.body.length+e.beforeBody.length+e.afterBody.length,s=2*e.yPadding;s+=e.title.length*e.titleFontSize,s+=(e.title.length-1)*e.titleSpacing,s+=e.title.length?e.titleMarginBottom:0,s+=a*e.bodyFontSize,s+=(a-1)*e.bodySpacing,s+=e.footer.length?e.footerMarginTop:0,s+=e.footer.length*e.footerFontSize,s+=(e.footer.length-1)*e.footerSpacing;var r=0;i.each(e.title,function(n){t.font=i.fontString(e.titleFontSize,e._titleFontStyle,e._titleFontFamily),r=Math.max(r,t.measureText(n).width)}),i.each(e.body,function(n){t.font=i.fontString(e.bodyFontSize,e._bodyFontStyle,e._bodyFontFamily),r=Math.max(r,t.measureText(n).width+("single"!=this._options.tooltips.mode?e.bodyFontSize+2:0))},this),i.each(e.footer,function(n){t.font=i.fontString(e.footerFontSize,e._footerFontStyle,e._footerFontFamily),r=Math.max(r,t.measureText(n).width)}),r+=2*e.xPadding;var o=r+e.caretSize+n;e.yAlign="center",e.y-s/2<0?e.yAlign="top":e.y+s/2>this._chart.height&&(e.yAlign="bottom"),e.xAlign="right",e.x+o>this._chart.width&&(e.xAlign="left");var l=e.x,d=e.y;if(d="top"==e.yAlign?e.y-e.caretSize-e.cornerRadius:"bottom"==e.yAlign?e.y-s+e.caretSize+e.cornerRadius:e.y-s/2,l="left"==e.xAlign?e.x-o:"right"==e.xAlign?e.x+n+e.caretSize:e.x+o/2,this._options.tooltips.enabled&&(t.fillStyle=i.color(e.backgroundColor).alpha(e.opacity).rgbString(),i.drawRoundedRectangle(t,l,d,r,s,e.cornerRadius),t.fill()),this._options.tooltips.enabled&&(t.fillStyle=i.color(e.backgroundColor).alpha(e.opacity).rgbString(),"left"==e.xAlign?(t.beginPath(),t.moveTo(e.x-n,e.y),t.lineTo(e.x-n-e.caretSize,e.y-e.caretSize),t.lineTo(e.x-n-e.caretSize,e.y+e.caretSize),t.closePath(),t.fill()):(t.beginPath(),t.moveTo(e.x+n,e.y),t.lineTo(e.x+n+e.caretSize,e.y-e.caretSize),t.lineTo(e.x+n+e.caretSize,e.y+e.caretSize),t.closePath(),t.fill())),this._options.tooltips.enabled){var c=d+e.yPadding,u=l+e.xPadding;e.title.length&&(t.textAlign=e._titleAlign,t.textBaseline="top",t.fillStyle=i.color(e.titleColor).alpha(e.opacity).rgbString(),t.font=i.fontString(e.titleFontSize,e._titleFontStyle,e._titleFontFamily),i.each(e.title,function(n,i){t.fillText(n,u,c),c+=e.titleFontSize+e.titleSpacing,i+1==e.title.length&&(c+=e.titleMarginBottom-e.titleSpacing)},this)),t.textAlign=e._bodyAlign,t.textBaseline="top",t.fillStyle=i.color(e.bodyColor).alpha(e.opacity).rgbString(),t.font=i.fontString(e.bodyFontSize,e._bodyFontStyle,e._bodyFontFamily),i.each(e.beforeBody,function(){t.fillText(e.beforeBody,u,c),c+=e.bodyFontSize+e.bodySpacing}),i.each(e.body,function(n,a){"single"!=this._options.tooltips.mode&&(t.fillStyle=i.color(e.labelColors[a].borderColor).alpha(e.opacity).rgbString(),t.fillRect(u,c,e.bodyFontSize,e.bodyFontSize),t.fillStyle=i.color(e.labelColors[a].backgroundColor).alpha(e.opacity).rgbString(),t.fillRect(u+1,c+1,e.bodyFontSize-2,e.bodyFontSize-2),t.fillStyle=i.color(e.bodyColor).alpha(e.opacity).rgbString()),t.fillText(n,u+("single"!=this._options.tooltips.mode?e.bodyFontSize+2:0),c),c+=e.bodyFontSize+e.bodySpacing},this),i.each(e.afterBody,function(){t.fillText(e.afterBody,u,c),c+=e.bodyFontSize}),c-=e.bodySpacing,e.footer.length&&(c+=e.footerMarginTop,t.textAlign=e._footerAlign,t.textBaseline="top",t.fillStyle=i.color(e.footerColor).alpha(e.opacity).rgbString(),t.font=i.fontString(e.footerFontSize,e._footerFontStyle,e._footerFontFamily),i.each(e.footer,function(n){t.fillText(n,u,c),c+=e.footerFontSize+e.footerSpacing},this))}}}})}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers;e.defaults.bar={hover:{mode:"label"},scales:{xAxes:[{type:"category",categoryPercentage:.8,barPercentage:.9,gridLines:{offsetGridLines:!0}}],yAxes:[{type:"linear"}]}},e.controllers.bar=function(t,e){this.initialize.call(this,t,e)},n.extend(e.controllers.bar.prototype,{initialize:function(t,e){this.chart=t,this.index=e,this.linkScales(),this.addElements()},updateIndex:function(t){this.index=t},linkScales:function(){this.getDataset().xAxisID||(this.getDataset().xAxisID=this.chart.options.scales.xAxes[0].id),this.getDataset().yAxisID||(this.getDataset().yAxisID=this.chart.options.scales.yAxes[0].id)},getDataset:function(){return this.chart.data.datasets[this.index]},getScaleForID:function(t){return this.chart.scales[t]},getBarCount:function(){var t=0;return n.each(this.chart.data.datasets,function(e){n.isDatasetVisible(e)&&("bar"===e.type?++t:void 0===e.type&&"bar"===this.chart.config.type&&++t)},this),t},addElements:function(){this.getDataset().metaData=this.getDataset().metaData||[],n.each(this.getDataset().data,function(t,n){this.getDataset().metaData[n]=this.getDataset().metaData[n]||new e.elements.Rectangle({_chart:this.chart.chart,_datasetIndex:this.index,_index:n})},this)},addElementAndReset:function(t){this.getDataset().metaData=this.getDataset().metaData||[];var n=new e.elements.Rectangle({_chart:this.chart.chart,_datasetIndex:this.index,_index:t}),i=this.getBarCount();this.updateElement(n,t,!0,i),this.getDataset().metaData.splice(t,0,n)},removeElement:function(t){this.getDataset().metaData.splice(t,1)},reset:function(){this.update(!0)},buildOrUpdateElements:function(){var t=this.getDataset().data.length,e=this.getDataset().metaData.length;if(e>t)this.getDataset().metaData.splice(t,e-t);else if(t>e)for(var n=e;t>n;++n)this.addElementAndReset(n)},update:function(t){var e=this.getBarCount();n.each(this.getDataset().metaData,function(n,i){this.updateElement(n,i,t,e)},this)},updateElement:function(t,e,i,a){var s,r=this.getScaleForID(this.getDataset().xAxisID),o=this.getScaleForID(this.getDataset().yAxisID);s=o.min<0&&o.max<0?o.getPixelForValue(o.max):o.min>0&&o.max>0?o.getPixelForValue(o.min):o.getPixelForValue(0),n.extend(t,{_chart:this.chart.chart,_xScale:r,_yScale:o,_datasetIndex:this.index,_index:e,_model:{x:this.calculateBarX(e,this.index),y:i?s:this.calculateBarY(e,this.index),label:this.chart.data.labels[e],datasetLabel:this.getDataset().label,base:this.calculateBarBase(this.index,e),width:this.calculateBarWidth(a),backgroundColor:t.custom&&t.custom.backgroundColor?t.custom.backgroundColor:n.getValueAtIndexOrDefault(this.getDataset().backgroundColor,e,this.chart.options.elements.rectangle.backgroundColor),borderColor:t.custom&&t.custom.borderColor?t.custom.borderColor:n.getValueAtIndexOrDefault(this.getDataset().borderColor,e,this.chart.options.elements.rectangle.borderColor),borderWidth:t.custom&&t.custom.borderWidth?t.custom.borderWidth:n.getValueAtIndexOrDefault(this.getDataset().borderWidth,e,this.chart.options.elements.rectangle.borderWidth)}}),t.pivot()},calculateBarBase:function(t,e){var i=(this.getScaleForID(this.getDataset().xAxisID),this.getScaleForID(this.getDataset().yAxisID)),a=0;if(i.options.stacked){var s=this.chart.data.datasets[t].data[e];if(0>s)for(var r=0;t>r;r++){var o=this.chart.data.datasets[r];n.isDatasetVisible(o)&&o.yAxisID===i.id&&(a+=o.data[e]<0?o.data[e]:0)}else for(var l=0;t>l;l++){var d=this.chart.data.datasets[l];n.isDatasetVisible(d)&&d.yAxisID===i.id&&(a+=d.data[e]>0?d.data[e]:0)}return i.getPixelForValue(a)}return a=i.getPixelForValue(i.min),i.beginAtZero||i.min<=0&&i.max>=0||i.min>=0&&i.max<=0?a=i.getPixelForValue(0,0):i.min<0&&i.max<0&&(a=i.getPixelForValue(i.max)),a},getRuler:function(){var t=this.getScaleForID(this.getDataset().xAxisID),e=(this.getScaleForID(this.getDataset().yAxisID),this.getBarCount()),n=function(){for(var e=t.getPixelForValue(null,1)-t.getPixelForValue(null,0),n=2;n<this.getDataset().data.length;n++)e=Math.min(t.getPixelForValue(null,n)-t.getPixelForValue(null,n-1),e);return e}.call(this),i=n*t.options.categoryPercentage,a=(n-n*t.options.categoryPercentage)/2,s=i/e,r=s*t.options.barPercentage,o=s-s*t.options.barPercentage;return{datasetCount:e,tickWidth:n,categoryWidth:i,categorySpacing:a,fullBarWidth:s,barWidth:r,barSpacing:o}},calculateBarWidth:function(){var t=this.getScaleForID(this.getDataset().xAxisID),e=this.getRuler();return t.options.stacked?e.categoryWidth:e.barWidth},getBarIndex:function(t){for(var e=0,i=0;t>i;++i)n.isDatasetVisible(this.chart.data.datasets[i])&&("bar"===this.chart.data.datasets[i].type||void 0===this.chart.data.datasets[i].type&&"bar"===this.chart.config.type)&&++e;return e},calculateBarX:function(t,e){var n=(this.getScaleForID(this.getDataset().yAxisID),this.getScaleForID(this.getDataset().xAxisID)),i=this.getBarIndex(e),a=this.getRuler(),s=n.getPixelForValue(null,t,i,this.chart.isCombo);return s-=this.chart.isCombo?a.tickWidth/2:0,n.options.stacked?s+a.categoryWidth/2+a.categorySpacing:s+a.barWidth/2+a.categorySpacing+a.barWidth*i+a.barSpacing/2+a.barSpacing*i},calculateBarY:function(t,e){var i=(this.getScaleForID(this.getDataset().xAxisID),this.getScaleForID(this.getDataset().yAxisID)),a=this.getDataset().data[t];if(i.options.stacked){for(var s=0,r=0,o=0;e>o;o++){var l=this.chart.data.datasets[o];n.isDatasetVisible(l)&&(l.data[t]<0?r+=l.data[t]||0:s+=l.data[t]||0)}return 0>a?i.getPixelForValue(r+a):i.getPixelForValue(s+a)}return i.getPixelForValue(a)},draw:function(t){var e=t||1;n.each(this.getDataset().metaData,function(t){t.transition(e).draw()},this)},setHoverStyle:function(t){var e=this.chart.data.datasets[t._datasetIndex],i=t._index;t._model.backgroundColor=t.custom&&t.custom.hoverBackgroundColor?t.custom.hoverBackgroundColor:n.getValueAtIndexOrDefault(e.hoverBackgroundColor,i,n.color(t._model.backgroundColor).saturate(.5).darken(.1).rgbString()),t._model.borderColor=t.custom&&t.custom.hoverBorderColor?t.custom.hoverBorderColor:n.getValueAtIndexOrDefault(e.hoverBorderColor,i,n.color(t._model.borderColor).saturate(.5).darken(.1).rgbString()),t._model.borderWidth=t.custom&&t.custom.hoverBorderWidth?t.custom.hoverBorderWidth:n.getValueAtIndexOrDefault(e.hoverBorderWidth,i,t._model.borderWidth)},removeHoverStyle:function(t){var e=(this.chart.data.datasets[t._datasetIndex],t._index);t._model.backgroundColor=t.custom&&t.custom.backgroundColor?t.custom.backgroundColor:n.getValueAtIndexOrDefault(this.getDataset().backgroundColor,e,this.chart.options.elements.rectangle.backgroundColor),t._model.borderColor=t.custom&&t.custom.borderColor?t.custom.borderColor:n.getValueAtIndexOrDefault(this.getDataset().borderColor,e,this.chart.options.elements.rectangle.borderColor),t._model.borderWidth=t.custom&&t.custom.borderWidth?t.custom.borderWidth:n.getValueAtIndexOrDefault(this.getDataset().borderWidth,e,this.chart.options.elements.rectangle.borderWidth)}})}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers;e.defaults.bubble={hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{template:"(<%= value.x %>, <%= value.y %>, <%= value.r %>)",multiTemplate:"<%if (datasetLabel){%><%=datasetLabel%>: <%}%>(<%= value.x %>, <%= value.y %>, <%= value.r %>)"}},e.controllers.bubble=function(t,e){this.initialize.call(this,t,e)},n.extend(e.controllers.bubble.prototype,{initialize:function(t,e){this.chart=t,this.index=e,this.linkScales(),this.addElements()},updateIndex:function(t){this.index=t},linkScales:function(){this.getDataset().xAxisID||(this.getDataset().xAxisID=this.chart.options.scales.xAxes[0].id),this.getDataset().yAxisID||(this.getDataset().yAxisID=this.chart.options.scales.yAxes[0].id)},getDataset:function(){return this.chart.data.datasets[this.index]},getScaleForId:function(t){return this.chart.scales[t]},addElements:function(){this.getDataset().metaData=this.getDataset().metaData||[],n.each(this.getDataset().data,function(t,n){this.getDataset().metaData[n]=this.getDataset().metaData[n]||new e.elements.Point({_chart:this.chart.chart,_datasetIndex:this.index,_index:n})},this)},addElementAndReset:function(t){this.getDataset().metaData=this.getDataset().metaData||[];var n=new e.elements.Point({_chart:this.chart.chart,_datasetIndex:this.index,_index:t});this.updateElement(n,t,!0),this.getDataset().metaData.splice(t,0,n)},removeElement:function(t){this.getDataset().metaData.splice(t,1)},reset:function(){this.update(!0)},buildOrUpdateElements:function(){var t=this.getDataset().data.length,e=this.getDataset().metaData.length;if(e>t)this.getDataset().metaData.splice(t,e-t);else if(t>e)for(var n=e;t>n;++n)this.addElementAndReset(n)},update:function(t){var e,i=this.getDataset().metaData,a=this.getScaleForId(this.getDataset().yAxisID);this.getScaleForId(this.getDataset().xAxisID),e=a.min<0&&a.max<0?a.getPixelForValue(a.max):a.min>0&&a.max>0?a.getPixelForValue(a.min):a.getPixelForValue(0),n.each(i,function(e,n){this.updateElement(e,n,t)},this)},updateElement:function(t,e,i){var a,s=this.getScaleForId(this.getDataset().yAxisID),r=this.getScaleForId(this.getDataset().xAxisID);a=s.min<0&&s.max<0?s.getPixelForValue(s.max):s.min>0&&s.max>0?s.getPixelForValue(s.min):s.getPixelForValue(0),n.extend(t,{_chart:this.chart.chart,_xScale:r,_yScale:s,_datasetIndex:this.index,_index:e,_model:{x:i?r.getPixelForDecimal(.5):r.getPixelForValue(this.getDataset().data[e],e,this.index,this.chart.isCombo),y:i?a:s.getPixelForValue(this.getDataset().data[e],e,this.index),radius:i?0:t.custom&&t.custom.radius?t.custom.radius:this.getRadius(this.getDataset().data[e]),backgroundColor:t.custom&&t.custom.backgroundColor?t.custom.backgroundColor:n.getValueAtIndexOrDefault(this.getDataset().backgroundColor,e,this.chart.options.elements.point.backgroundColor),borderColor:t.custom&&t.custom.borderColor?t.custom.borderColor:n.getValueAtIndexOrDefault(this.getDataset().borderColor,e,this.chart.options.elements.point.borderColor),borderWidth:t.custom&&t.custom.borderWidth?t.custom.borderWidth:n.getValueAtIndexOrDefault(this.getDataset().borderWidth,e,this.chart.options.elements.point.borderWidth),hitRadius:t.custom&&t.custom.hitRadius?t.custom.hitRadius:n.getValueAtIndexOrDefault(this.getDataset().hitRadius,e,this.chart.options.elements.point.hitRadius)}}),t._model.skip=t.custom&&t.custom.skip?t.custom.skip:isNaN(t._model.x)||isNaN(t._model.y),t.pivot()},getRadius:function(t){return t.r||this.chart.options.elements.point.radius},draw:function(t){var e=t||1;n.each(this.getDataset().metaData,function(t){t.transition(e),t.draw()},this)},setHoverStyle:function(t){var e=this.chart.data.datasets[t._datasetIndex],i=t._index;t._model.radius=t.custom&&t.custom.hoverRadius?t.custom.hoverRadius:n.getValueAtIndexOrDefault(e.hoverRadius,i,this.chart.options.elements.point.hoverRadius)+this.getRadius(this.getDataset().data[t._index]),t._model.backgroundColor=t.custom&&t.custom.hoverBackgroundColor?t.custom.hoverBackgroundColor:n.getValueAtIndexOrDefault(e.hoverBackgroundColor,i,n.color(t._model.backgroundColor).saturate(.5).darken(.1).rgbString()),t._model.borderColor=t.custom&&t.custom.hoverBorderColor?t.custom.hoverBorderColor:n.getValueAtIndexOrDefault(e.hoverBorderColor,i,n.color(t._model.borderColor).saturate(.5).darken(.1).rgbString()),t._model.borderWidth=t.custom&&t.custom.hoverBorderWidth?t.custom.hoverBorderWidth:n.getValueAtIndexOrDefault(e.hoverBorderWidth,i,t._model.borderWidth)},removeHoverStyle:function(t){var e=(this.chart.data.datasets[t._datasetIndex],t._index);t._model.radius=t.custom&&t.custom.radius?t.custom.radius:this.getRadius(this.getDataset().data[t._index]),t._model.backgroundColor=t.custom&&t.custom.backgroundColor?t.custom.backgroundColor:n.getValueAtIndexOrDefault(this.getDataset().backgroundColor,e,this.chart.options.elements.point.backgroundColor),t._model.borderColor=t.custom&&t.custom.borderColor?t.custom.borderColor:n.getValueAtIndexOrDefault(this.getDataset().borderColor,e,this.chart.options.elements.point.borderColor),t._model.borderWidth=t.custom&&t.custom.borderWidth?t.custom.borderWidth:n.getValueAtIndexOrDefault(this.getDataset().borderWidth,e,this.chart.options.elements.point.borderWidth)}})}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers;e.defaults.doughnut={animation:{animateRotate:!0,animateScale:!1},hover:{mode:"single"},cutoutPercentage:50,tooltips:{callbacks:{title:function(){return""},label:function(t,e){return e.labels[t.index]+": "+e.datasets[t.datasetIndex].data[t.index]}}}},e.defaults.pie=n.clone(e.defaults.doughnut),n.extend(e.defaults.pie,{cutoutPercentage:0}),e.controllers.doughnut=e.controllers.pie=function(t,e){this.initialize.call(this,t,e)},n.extend(e.controllers.doughnut.prototype,{initialize:function(t,e){this.chart=t,this.index=e,this.linkScales(),this.addElements()},updateIndex:function(t){this.index=t},linkScales:function(){},getDataset:function(){return this.chart.data.datasets[this.index]},addElements:function(){this.getDataset().metaData=this.getDataset().metaData||[],n.each(this.getDataset().data,function(t,n){this.getDataset().metaData[n]=this.getDataset().metaData[n]||new e.elements.Arc({_chart:this.chart.chart,_datasetIndex:this.index,_index:n})},this)},addElementAndReset:function(t,i){this.getDataset().metaData=this.getDataset().metaData||[];var a=new e.elements.Arc({_chart:this.chart.chart,_datasetIndex:this.index,_index:t});i&&n.isArray(this.getDataset().backgroundColor)&&this.getDataset().backgroundColor.splice(t,0,i),this.updateElement(a,t,!0),this.getDataset().metaData.splice(t,0,a)},removeElement:function(t){this.getDataset().metaData.splice(t,1)},reset:function(){this.update(!0)},buildOrUpdateElements:function(){var t=this.getDataset().data.length,e=this.getDataset().metaData.length;if(e>t)this.getDataset().metaData.splice(t,e-t);else if(t>e)for(var n=e;t>n;++n)this.addElementAndReset(n)},getVisibleDatasetCount:function(){return n.where(this.chart.data.datasets,function(t){return n.isDatasetVisible(t)}).length},getRingIndex:function(t){for(var e=0,i=0;t>i;++i)n.isDatasetVisible(this.chart.data.datasets[i])&&++e;return e},update:function(t){this.chart.outerRadius=Math.max(n.min([this.chart.chart.width,this.chart.chart.height])/2-this.chart.options.elements.arc.borderWidth/2,0),this.chart.innerRadius=Math.max(this.chart.options.cutoutPercentage?this.chart.outerRadius/100*this.chart.options.cutoutPercentage:1,0),this.chart.radiusLength=(this.chart.outerRadius-this.chart.innerRadius)/this.getVisibleDatasetCount(),this.getDataset().total=0,n.each(this.getDataset().data,function(t){this.getDataset().total+=Math.abs(t)},this),this.outerRadius=this.chart.outerRadius-this.chart.radiusLength*this.getRingIndex(this.index),this.innerRadius=this.outerRadius-this.chart.radiusLength,n.each(this.getDataset().metaData,function(e,n){this.updateElement(e,n,t)},this)},updateElement:function(t,e,i){var a={x:this.chart.chart.width/2,y:this.chart.chart.height/2,startAngle:Math.PI*-.5,circumference:this.chart.options.animation.animateRotate?0:this.calculateCircumference(this.getDataset().data[e]),outerRadius:this.chart.options.animation.animateScale?0:this.outerRadius,innerRadius:this.chart.options.animation.animateScale?0:this.innerRadius};n.extend(t,{_chart:this.chart.chart,_datasetIndex:this.index,_index:e,_model:i?a:{x:this.chart.chart.width/2,y:this.chart.chart.height/2,circumference:this.calculateCircumference(this.getDataset().data[e]),outerRadius:this.outerRadius,innerRadius:this.innerRadius,backgroundColor:t.custom&&t.custom.backgroundColor?t.custom.backgroundColor:n.getValueAtIndexOrDefault(this.getDataset().backgroundColor,e,this.chart.options.elements.arc.backgroundColor),hoverBackgroundColor:t.custom&&t.custom.hoverBackgroundColor?t.custom.hoverBackgroundColor:n.getValueAtIndexOrDefault(this.getDataset().hoverBackgroundColor,e,this.chart.options.elements.arc.hoverBackgroundColor),borderWidth:t.custom&&t.custom.borderWidth?t.custom.borderWidth:n.getValueAtIndexOrDefault(this.getDataset().borderWidth,e,this.chart.options.elements.arc.borderWidth),borderColor:t.custom&&t.custom.borderColor?t.custom.borderColor:n.getValueAtIndexOrDefault(this.getDataset().borderColor,e,this.chart.options.elements.arc.borderColor),label:n.getValueAtIndexOrDefault(this.getDataset().label,e,this.chart.data.labels[e])}}),i||(t._model.startAngle=0===e?Math.PI*-.5:this.getDataset().metaData[e-1]._model.endAngle,t._model.endAngle=t._model.startAngle+t._model.circumference,e<this.getDataset().data.length-1&&(this.getDataset().metaData[e+1]._model.startAngle=t._model.endAngle)),t.pivot()},draw:function(t){var e=t||1;n.each(this.getDataset().metaData,function(t){t.transition(e).draw()},this)},setHoverStyle:function(t){var e=this.chart.data.datasets[t._datasetIndex],i=t._index;t._model.backgroundColor=t.custom&&t.custom.hoverBackgroundColor?t.custom.hoverBackgroundColor:n.getValueAtIndexOrDefault(e.hoverBackgroundColor,i,n.color(t._model.backgroundColor).saturate(.5).darken(.1).rgbString()),t._model.borderColor=t.custom&&t.custom.hoverBorderColor?t.custom.hoverBorderColor:n.getValueAtIndexOrDefault(e.hoverBorderColor,i,n.color(t._model.borderColor).saturate(.5).darken(.1).rgbString()),t._model.borderWidth=t.custom&&t.custom.hoverBorderWidth?t.custom.hoverBorderWidth:n.getValueAtIndexOrDefault(e.hoverBorderWidth,i,t._model.borderWidth)},removeHoverStyle:function(t){var e=(this.chart.data.datasets[t._datasetIndex],t._index);t._model.backgroundColor=t.custom&&t.custom.backgroundColor?t.custom.backgroundColor:n.getValueAtIndexOrDefault(this.getDataset().backgroundColor,e,this.chart.options.elements.arc.backgroundColor),t._model.borderColor=t.custom&&t.custom.borderColor?t.custom.borderColor:n.getValueAtIndexOrDefault(this.getDataset().borderColor,e,this.chart.options.elements.arc.borderColor),t._model.borderWidth=t.custom&&t.custom.borderWidth?t.custom.borderWidth:n.getValueAtIndexOrDefault(this.getDataset().borderWidth,e,this.chart.options.elements.arc.borderWidth)},calculateCircumference:function(t){return this.getDataset().total>0?1.999999*Math.PI*(t/this.getDataset().total):0}})}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers;e.defaults.line={hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}},e.controllers.line=function(t,e){this.initialize.call(this,t,e)},n.extend(e.controllers.line.prototype,{initialize:function(t,e){this.chart=t,this.index=e,this.linkScales(),this.addElements()},updateIndex:function(t){this.index=t},linkScales:function(){this.getDataset().xAxisID||(this.getDataset().xAxisID=this.chart.options.scales.xAxes[0].id),this.getDataset().yAxisID||(this.getDataset().yAxisID=this.chart.options.scales.yAxes[0].id)},getDataset:function(){return this.chart.data.datasets[this.index]},getScaleForId:function(t){return this.chart.scales[t]},addElements:function(){this.getDataset().metaData=this.getDataset().metaData||[],this.getDataset().metaDataset=this.getDataset().metaDataset||new e.elements.Line({_chart:this.chart.chart,_datasetIndex:this.index,_points:this.getDataset().metaData}),n.each(this.getDataset().data,function(t,n){this.getDataset().metaData[n]=this.getDataset().metaData[n]||new e.elements.Point({_chart:this.chart.chart,_datasetIndex:this.index,_index:n})},this)},addElementAndReset:function(t){this.getDataset().metaData=this.getDataset().metaData||[];var n=new e.elements.Point({_chart:this.chart.chart,_datasetIndex:this.index,_index:t});this.updateElement(n,t,!0),this.getDataset().metaData.splice(t,0,n),this.updateBezierControlPoints()},removeElement:function(t){this.getDataset().metaData.splice(t,1)},reset:function(){this.update(!0)},buildOrUpdateElements:function(){var t=this.getDataset().data.length,e=this.getDataset().metaData.length;if(e>t)this.getDataset().metaData.splice(t,e-t);else if(t>e)for(var n=e;t>n;++n)this.addElementAndReset(n)},update:function(t){var e,i=this.getDataset().metaDataset,a=this.getDataset().metaData,s=this.getScaleForId(this.getDataset().yAxisID);this.getScaleForId(this.getDataset().xAxisID),e=s.min<0&&s.max<0?s.getPixelForValue(s.max):s.min>0&&s.max>0?s.getPixelForValue(s.min):s.getPixelForValue(0),n.extend(i,{_scale:s,_datasetIndex:this.index,_children:a,_model:{tension:i.custom&&i.custom.tension?i.custom.tension:this.getDataset().tension||this.chart.options.elements.line.tension,backgroundColor:i.custom&&i.custom.backgroundColor?i.custom.backgroundColor:this.getDataset().backgroundColor||this.chart.options.elements.line.backgroundColor,borderWidth:i.custom&&i.custom.borderWidth?i.custom.borderWidth:this.getDataset().borderWidth||this.chart.options.elements.line.borderWidth,borderColor:i.custom&&i.custom.borderColor?i.custom.borderColor:this.getDataset().borderColor||this.chart.options.elements.line.borderColor,borderCapStyle:i.custom&&i.custom.borderCapStyle?i.custom.borderCapStyle:this.getDataset().borderCapStyle||this.chart.options.elements.line.borderCapStyle,borderDash:i.custom&&i.custom.borderDash?i.custom.borderDash:this.getDataset().borderDash||this.chart.options.elements.line.borderDash,borderDashOffset:i.custom&&i.custom.borderDashOffset?i.custom.borderDashOffset:this.getDataset().borderDashOffset||this.chart.options.elements.line.borderDashOffset,borderJoinStyle:i.custom&&i.custom.borderJoinStyle?i.custom.borderJoinStyle:this.getDataset().borderJoinStyle||this.chart.options.elements.line.borderJoinStyle,fill:i.custom&&i.custom.fill?i.custom.fill:void 0!==this.getDataset().fill?this.getDataset().fill:this.chart.options.elements.line.fill,scaleTop:s.top,scaleBottom:s.bottom,scaleZero:e}}),i.pivot(),n.each(a,function(e,n){this.updateElement(e,n,t)},this),this.updateBezierControlPoints()},updateElement:function(t,e,i){var a,s=this.getScaleForId(this.getDataset().yAxisID),r=this.getScaleForId(this.getDataset().xAxisID);a=s.min<0&&s.max<0?s.getPixelForValue(s.max):s.min>0&&s.max>0?s.getPixelForValue(s.min):s.getPixelForValue(0),n.extend(t,{_chart:this.chart.chart,_xScale:r,_yScale:s,_datasetIndex:this.index,_index:e,_model:{x:r.getPixelForValue(this.getDataset().data[e],e,this.index,this.chart.isCombo),y:i?a:this.calculatePointY(this.getDataset().data[e],e,this.index,this.chart.isCombo),tension:t.custom&&t.custom.tension?t.custom.tension:this.getDataset().tension||this.chart.options.elements.line.tension,radius:t.custom&&t.custom.radius?t.custom.radius:n.getValueAtIndexOrDefault(this.getDataset().radius,e,this.chart.options.elements.point.radius),backgroundColor:t.custom&&t.custom.backgroundColor?t.custom.backgroundColor:n.getValueAtIndexOrDefault(this.getDataset().pointBackgroundColor,e,this.chart.options.elements.point.backgroundColor),borderColor:t.custom&&t.custom.borderColor?t.custom.borderColor:n.getValueAtIndexOrDefault(this.getDataset().pointBorderColor,e,this.chart.options.elements.point.borderColor),borderWidth:t.custom&&t.custom.borderWidth?t.custom.borderWidth:n.getValueAtIndexOrDefault(this.getDataset().pointBorderWidth,e,this.chart.options.elements.point.borderWidth),hitRadius:t.custom&&t.custom.hitRadius?t.custom.hitRadius:n.getValueAtIndexOrDefault(this.getDataset().hitRadius,e,this.chart.options.elements.point.hitRadius)}}),t._model.skip=t.custom&&t.custom.skip?t.custom.skip:isNaN(t._model.x)||isNaN(t._model.y)},calculatePointY:function(t,e,i){var a=(this.getScaleForId(this.getDataset().xAxisID),this.getScaleForId(this.getDataset().yAxisID));if(a.options.stacked){for(var s=0,r=0,o=this.chart.data.datasets.length-1;o>i;o--){var l=this.chart.data.datasets[o];n.isDatasetVisible(l)&&(l.data[e]<0?r+=l.data[e]||0:s+=l.data[e]||0)}return 0>t?a.getPixelForValue(r+t):a.getPixelForValue(s+t)}return a.getPixelForValue(t)},updateBezierControlPoints:function(){n.each(this.getDataset().metaData,function(t,e){var i=n.splineCurve(n.previousItem(this.getDataset().metaData,e)._model,t._model,n.nextItem(this.getDataset().metaData,e)._model,t._model.tension);t._model.controlPointPreviousX=i.previous.x,t._model.controlPointNextX=i.next.x,t._model.controlPointNextY=i.next.y>this.chart.chartArea.bottom?this.chart.chartArea.bottom:i.next.y<this.chart.chartArea.top?this.chart.chartArea.top:i.next.y,t._model.controlPointPreviousY=i.previous.y>this.chart.chartArea.bottom?this.chart.chartArea.bottom:i.previous.y<this.chart.chartArea.top?this.chart.chartArea.top:i.previous.y,t.pivot()},this)},draw:function(t){var e=t||1;n.each(this.getDataset().metaData,function(t){t.transition(e)},this),this.getDataset().metaDataset.transition(e).draw(),n.each(this.getDataset().metaData,function(t){t.draw()})},setHoverStyle:function(t){var e=this.chart.data.datasets[t._datasetIndex],i=t._index;t._model.radius=t.custom&&t.custom.hoverRadius?t.custom.hoverRadius:n.getValueAtIndexOrDefault(e.pointHoverRadius,i,this.chart.options.elements.point.hoverRadius),t._model.backgroundColor=t.custom&&t.custom.hoverBackgroundColor?t.custom.hoverBackgroundColor:n.getValueAtIndexOrDefault(e.pointHoverBackgroundColor,i,n.color(t._model.backgroundColor).saturate(.5).darken(.1).rgbString()),t._model.borderColor=t.custom&&t.custom.hoverBorderColor?t.custom.hoverBorderColor:n.getValueAtIndexOrDefault(e.pointHoverBorderColor,i,n.color(t._model.borderColor).saturate(.5).darken(.1).rgbString()),t._model.borderWidth=t.custom&&t.custom.hoverBorderWidth?t.custom.hoverBorderWidth:n.getValueAtIndexOrDefault(e.pointHoverBorderWidth,i,t._model.borderWidth)},removeHoverStyle:function(t){var e=(this.chart.data.datasets[t._datasetIndex],t._index);t._model.radius=t.custom&&t.custom.radius?t.custom.radius:n.getValueAtIndexOrDefault(this.getDataset().radius,e,this.chart.options.elements.point.radius),t._model.backgroundColor=t.custom&&t.custom.backgroundColor?t.custom.backgroundColor:n.getValueAtIndexOrDefault(this.getDataset().pointBackgroundColor,e,this.chart.options.elements.point.backgroundColor),t._model.borderColor=t.custom&&t.custom.borderColor?t.custom.borderColor:n.getValueAtIndexOrDefault(this.getDataset().pointBorderColor,e,this.chart.options.elements.point.borderColor),t._model.borderWidth=t.custom&&t.custom.borderWidth?t.custom.borderWidth:n.getValueAtIndexOrDefault(this.getDataset().pointBorderWidth,e,this.chart.options.elements.point.borderWidth)
}})}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers;e.defaults.polarArea={scale:{type:"radialLinear",lineArc:!0},animateRotate:!0,animateScale:!0,tooltips:{callbacks:{title:function(){return""},label:function(t,e){return e.labels[t.index]+": "+t.yLabel}}}},e.controllers.polarArea=function(t,e){this.initialize.call(this,t,e)},n.extend(e.controllers.polarArea.prototype,{initialize:function(t,e){this.chart=t,this.index=e,this.linkScales(),this.addElements()},updateIndex:function(t){this.index=t},linkScales:function(){},getDataset:function(){return this.chart.data.datasets[this.index]},getScaleForId:function(t){return this.chart.scales[t]},addElements:function(){this.getDataset().metaData=this.getDataset().metaData||[],n.each(this.getDataset().data,function(t,n){this.getDataset().metaData[n]=this.getDataset().metaData[n]||new e.elements.Arc({_chart:this.chart.chart,_datasetIndex:this.index,_index:n})},this)},addElementAndReset:function(t){this.getDataset().metaData=this.getDataset().metaData||[];var n=new e.elements.Arc({_chart:this.chart.chart,_datasetIndex:this.index,_index:t});this.updateElement(n,t,!0),this.getDataset().metaData.splice(t,0,n)},removeElement:function(t){this.getDataset().metaData.splice(t,1)},reset:function(){this.update(!0)},buildOrUpdateElements:function(){var t=this.getDataset().data.length,e=this.getDataset().metaData.length;if(e>t)this.getDataset().metaData.splice(t,e-t);else if(t>e)for(var n=e;t>n;++n)this.addElementAndReset(n)},getVisibleDatasetCount:function(){return n.where(this.chart.data.datasets,function(t){return n.isDatasetVisible(t)}).length},update:function(t){this.chart.outerRadius=Math.max((n.min([this.chart.chart.width,this.chart.chart.height])-this.chart.options.elements.arc.borderWidth/2)/2,0),this.chart.innerRadius=Math.max(this.chart.options.cutoutPercentage?this.chart.outerRadius/100*this.chart.options.cutoutPercentage:1,0),this.chart.radiusLength=(this.chart.outerRadius-this.chart.innerRadius)/this.getVisibleDatasetCount(),this.getDataset().total=0,n.each(this.getDataset().data,function(t){this.getDataset().total+=Math.abs(t)},this),this.outerRadius=this.chart.outerRadius-this.chart.radiusLength*this.index,this.innerRadius=this.outerRadius-this.chart.radiusLength,n.each(this.getDataset().metaData,function(e,n){this.updateElement(e,n,t)},this)},updateElement:function(t,e,i){var a=1/this.getDataset().data.length*2,s=-.5*Math.PI+Math.PI*a*e,r=s+a*Math.PI,o={x:this.chart.chart.width/2,y:this.chart.chart.height/2,innerRadius:0,outerRadius:this.chart.options.animateScale?0:this.chart.scale.getDistanceFromCenterForValue(this.getDataset().data[e]),startAngle:this.chart.options.animateRotate?Math.PI*-.5:s,endAngle:this.chart.options.animateRotate?Math.PI*-.5:r,backgroundColor:t.custom&&t.custom.backgroundColor?t.custom.backgroundColor:n.getValueAtIndexOrDefault(this.getDataset().backgroundColor,e,this.chart.options.elements.arc.backgroundColor),hoverBackgroundColor:t.custom&&t.custom.hoverBackgroundColor?t.custom.hoverBackgroundColor:n.getValueAtIndexOrDefault(this.getDataset().hoverBackgroundColor,e,this.chart.options.elements.arc.hoverBackgroundColor),borderWidth:t.custom&&t.custom.borderWidth?t.custom.borderWidth:n.getValueAtIndexOrDefault(this.getDataset().borderWidth,e,this.chart.options.elements.arc.borderWidth),borderColor:t.custom&&t.custom.borderColor?t.custom.borderColor:n.getValueAtIndexOrDefault(this.getDataset().borderColor,e,this.chart.options.elements.arc.borderColor),label:n.getValueAtIndexOrDefault(this.chart.data.labels,e,this.chart.data.labels[e])};n.extend(t,{_chart:this.chart.chart,_datasetIndex:this.index,_index:e,_scale:this.chart.scale,_model:i?o:{x:this.chart.chart.width/2,y:this.chart.chart.height/2,innerRadius:0,outerRadius:this.chart.scale.getDistanceFromCenterForValue(this.getDataset().data[e]),startAngle:s,endAngle:r,backgroundColor:t.custom&&t.custom.backgroundColor?t.custom.backgroundColor:n.getValueAtIndexOrDefault(this.getDataset().backgroundColor,e,this.chart.options.elements.arc.backgroundColor),hoverBackgroundColor:t.custom&&t.custom.hoverBackgroundColor?t.custom.hoverBackgroundColor:n.getValueAtIndexOrDefault(this.getDataset().hoverBackgroundColor,e,this.chart.options.elements.arc.hoverBackgroundColor),borderWidth:t.custom&&t.custom.borderWidth?t.custom.borderWidth:n.getValueAtIndexOrDefault(this.getDataset().borderWidth,e,this.chart.options.elements.arc.borderWidth),borderColor:t.custom&&t.custom.borderColor?t.custom.borderColor:n.getValueAtIndexOrDefault(this.getDataset().borderColor,e,this.chart.options.elements.arc.borderColor),label:n.getValueAtIndexOrDefault(this.chart.data.labels,e,this.chart.data.labels[e])}}),t.pivot()},draw:function(t){var e=t||1;n.each(this.getDataset().metaData,function(t){t.transition(e).draw()},this)},setHoverStyle:function(t){var e=this.chart.data.datasets[t._datasetIndex],i=t._index;t._model.backgroundColor=t.custom&&t.custom.hoverBackgroundColor?t.custom.hoverBackgroundColor:n.getValueAtIndexOrDefault(e.hoverBackgroundColor,i,n.color(t._model.backgroundColor).saturate(.5).darken(.1).rgbString()),t._model.borderColor=t.custom&&t.custom.hoverBorderColor?t.custom.hoverBorderColor:n.getValueAtIndexOrDefault(e.hoverBorderColor,i,n.color(t._model.borderColor).saturate(.5).darken(.1).rgbString()),t._model.borderWidth=t.custom&&t.custom.hoverBorderWidth?t.custom.hoverBorderWidth:n.getValueAtIndexOrDefault(e.borderWidth,i,t._model.borderWidth)},removeHoverStyle:function(t){var e=(this.chart.data.datasets[t._datasetIndex],t._index);t._model.backgroundColor=t.custom&&t.custom.backgroundColor?t.custom.backgroundColor:n.getValueAtIndexOrDefault(this.getDataset().backgroundColor,e,this.chart.options.elements.arc.backgroundColor),t._model.borderColor=t.custom&&t.custom.borderColor?t.custom.borderColor:n.getValueAtIndexOrDefault(this.getDataset().borderColor,e,this.chart.options.elements.arc.borderColor),t._model.borderWidth=t.custom&&t.custom.borderWidth?t.custom.borderWidth:n.getValueAtIndexOrDefault(this.getDataset().borderWidth,e,this.chart.options.elements.arc.borderWidth)},calculateCircumference:function(t){return this.getDataset().total>0?2*Math.PI*(t/this.getDataset().total):0},updateScaleRange:function(){n.extend(this.chart.scale,{size:n.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2})}})}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers;e.defaults.radar={scale:{type:"radialLinear"},elements:{line:{tension:0}}},e.controllers.radar=function(t,e){this.initialize.call(this,t,e)},n.extend(e.controllers.radar.prototype,{initialize:function(t,e){this.chart=t,this.index=e,this.linkScales(),this.addElements()},updateIndex:function(t){this.index=t},linkScales:function(){},getDataset:function(){return this.chart.data.datasets[this.index]},getScaleForId:function(t){return this.chart.scales[t]},addElements:function(){this.getDataset().metaData=this.getDataset().metaData||[],this.getDataset().metaDataset=this.getDataset().metaDataset||new e.elements.Line({_chart:this.chart.chart,_datasetIndex:this.index,_points:this.getDataset().metaData,_loop:!0}),n.each(this.getDataset().data,function(t,n){this.getDataset().metaData[n]=this.getDataset().metaData[n]||new e.elements.Point({_chart:this.chart.chart,_datasetIndex:this.index,_index:n,_model:{x:0,y:0}})},this)},addElementAndReset:function(t){this.getDataset().metaData=this.getDataset().metaData||[];var n=new e.elements.Point({_chart:this.chart.chart,_datasetIndex:this.index,_index:t});this.updateElement(n,t,!0),this.getDataset().metaData.splice(t,0,n),this.updateBezierControlPoints()},removeElement:function(t){this.getDataset().metaData.splice(t,1)},reset:function(){this.update(!0)},buildOrUpdateElements:function(){var t=this.getDataset().data.length,e=this.getDataset().metaData.length;if(e>t)this.getDataset().metaData.splice(t,e-t);else if(t>e)for(var n=e;t>n;++n)this.addElementAndReset(n)},update:function(t){var e,i=(this.getDataset().metaDataset,this.getDataset().metaData),a=this.chart.scale;e=a.min<0&&a.max<0?a.getPointPositionForValue(0,a.max):a.min>0&&a.max>0?a.getPointPositionForValue(0,a.min):a.getPointPositionForValue(0,0),n.extend(this.getDataset().metaDataset,{_datasetIndex:this.index,_children:this.getDataset().metaData,_model:{tension:this.getDataset().tension||this.chart.options.elements.line.tension,backgroundColor:this.getDataset().backgroundColor||this.chart.options.elements.line.backgroundColor,borderWidth:this.getDataset().borderWidth||this.chart.options.elements.line.borderWidth,borderColor:this.getDataset().borderColor||this.chart.options.elements.line.borderColor,fill:void 0!==this.getDataset().fill?this.getDataset().fill:this.chart.options.elements.line.fill,scaleTop:a.top,scaleBottom:a.bottom,scaleZero:e}}),this.getDataset().metaDataset.pivot(),n.each(i,function(e,n){this.updateElement(e,n,t)},this),this.updateBezierControlPoints()},updateElement:function(t,e,i){var a=this.chart.scale.getPointPositionForValue(e,this.getDataset().data[e]);n.extend(t,{_datasetIndex:this.index,_index:e,_scale:this.chart.scale,_model:{x:i?this.chart.scale.xCenter:a.x,y:i?this.chart.scale.yCenter:a.y,tension:t.custom&&t.custom.tension?t.custom.tension:this.chart.options.elements.line.tension,radius:t.custom&&t.custom.radius?t.custom.pointRadius:n.getValueAtIndexOrDefault(this.getDataset().pointRadius,e,this.chart.options.elements.point.radius),backgroundColor:t.custom&&t.custom.backgroundColor?t.custom.backgroundColor:n.getValueAtIndexOrDefault(this.getDataset().pointBackgroundColor,e,this.chart.options.elements.point.backgroundColor),borderColor:t.custom&&t.custom.borderColor?t.custom.borderColor:n.getValueAtIndexOrDefault(this.getDataset().pointBorderColor,e,this.chart.options.elements.point.borderColor),borderWidth:t.custom&&t.custom.borderWidth?t.custom.borderWidth:n.getValueAtIndexOrDefault(this.getDataset().pointBorderWidth,e,this.chart.options.elements.point.borderWidth),hitRadius:t.custom&&t.custom.hitRadius?t.custom.hitRadius:n.getValueAtIndexOrDefault(this.getDataset().hitRadius,e,this.chart.options.elements.point.hitRadius)}}),t._model.skip=t.custom&&t.custom.skip?t.custom.skip:isNaN(t._model.x)||isNaN(t._model.y)},updateBezierControlPoints:function(){n.each(this.getDataset().metaData,function(t,e){var i=n.splineCurve(n.previousItem(this.getDataset().metaData,e,!0)._model,t._model,n.nextItem(this.getDataset().metaData,e,!0)._model,t._model.tension);t._model.controlPointPreviousX=i.previous.x,t._model.controlPointNextX=i.next.x,t._model.controlPointNextY=i.next.y>this.chart.chartArea.bottom?this.chart.chartArea.bottom:i.next.y<this.chart.chartArea.top?this.chart.chartArea.top:i.next.y,t._model.controlPointPreviousY=i.previous.y>this.chart.chartArea.bottom?this.chart.chartArea.bottom:i.previous.y<this.chart.chartArea.top?this.chart.chartArea.top:i.previous.y,t.pivot()},this)},draw:function(t){var e=t||1;n.each(this.getDataset().metaData,function(t){t.transition(e)},this),this.getDataset().metaDataset.transition(e).draw(),n.each(this.getDataset().metaData,function(t){t.draw()})},setHoverStyle:function(t){var e=this.chart.data.datasets[t._datasetIndex],i=t._index;t._model.radius=t.custom&&t.custom.radius?t.custom.radius:n.getValueAtIndexOrDefault(e.pointHoverRadius,i,this.chart.options.elements.point.hoverRadius),t._model.backgroundColor=t.custom&&t.custom.hoverBackgroundColor?t.custom.hoverBackgroundColor:n.getValueAtIndexOrDefault(e.pointHoverBackgroundColor,i,n.color(t._model.backgroundColor).saturate(.5).darken(.1).rgbString()),t._model.borderColor=t.custom&&t.custom.hoverBorderColor?t.custom.hoverBorderColor:n.getValueAtIndexOrDefault(e.pointHoverBorderColor,i,n.color(t._model.borderColor).saturate(.5).darken(.1).rgbString()),t._model.borderWidth=t.custom&&t.custom.hoverBorderWidth?t.custom.hoverBorderWidth:n.getValueAtIndexOrDefault(e.pointBorderWidth,i,t._model.borderWidth)},removeHoverStyle:function(t){var e=(this.chart.data.datasets[t._datasetIndex],t._index);t._model.radius=t.custom&&t.custom.radius?t.custom.radius:n.getValueAtIndexOrDefault(this.getDataset().radius,e,this.chart.options.elements.point.radius),t._model.backgroundColor=t.custom&&t.custom.backgroundColor?t.custom.backgroundColor:n.getValueAtIndexOrDefault(this.getDataset().pointBackgroundColor,e,this.chart.options.elements.point.backgroundColor),t._model.borderColor=t.custom&&t.custom.borderColor?t.custom.borderColor:n.getValueAtIndexOrDefault(this.getDataset().pointBorderColor,e,this.chart.options.elements.point.borderColor),t._model.borderWidth=t.custom&&t.custom.borderWidth?t.custom.borderWidth:n.getValueAtIndexOrDefault(this.getDataset().pointBorderWidth,e,this.chart.options.elements.point.borderWidth)}})}.call(this),function(){"use strict";var t=this,e=t.Chart,n=(e.helpers,{position:"bottom"}),i=e.Scale.extend({buildTicks:function(){this.ticks=this.data.labels},getLabelForIndex:function(t){return this.ticks[t]},getPixelForValue:function(t,e,n,i){if(this.isHorizontal()){var a=this.width-(this.paddingLeft+this.paddingRight),s=a/Math.max(this.data.labels.length-(this.options.gridLines.offsetGridLines?0:1),1),r=s*e+this.paddingLeft;return this.options.gridLines.offsetGridLines&&i&&(r+=s/2),this.left+Math.round(r)}var o=this.height-(this.paddingTop+this.paddingBottom),l=o/Math.max(this.data.labels.length-(this.options.gridLines.offsetGridLines?0:1),1),d=l*e+this.paddingTop;return this.options.gridLines.offsetGridLines&&i&&(d+=l/2),this.top+Math.round(d)}});e.scaleService.registerScaleType("category",i,n)}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers,i={position:"left",ticks:{callback:function(t,e,i){var a=i[1]-i[0];Math.abs(a)>1&&t!==Math.floor(t)&&(a=t-Math.floor(t));var s=n.log10(Math.abs(a)),r="";if(0!==t){var o=-1*Math.floor(s);o=Math.max(Math.min(o,20),0),r=t.toFixed(o)}else r="0";return r}}},a=e.Scale.extend({buildTicks:function(){if(this.min=null,this.max=null,this.options.stacked){var t={};n.each(this.data.datasets,function(e){void 0===t[e.type]&&(t[e.type]={positiveValues:[],negativeValues:[]});var i=t[e.type].positiveValues,a=t[e.type].negativeValues;n.isDatasetVisible(e)&&(this.isHorizontal()?e.xAxisID===this.id:e.yAxisID===this.id)&&n.each(e.data,function(t,e){var n=this.getRightValue(t);isNaN(n)||(i[e]=i[e]||0,a[e]=a[e]||0,this.options.relativePoints?i[e]=100:0>n?a[e]+=n:i[e]+=n)},this)},this),n.each(t,function(t){var e=t.positiveValues.concat(t.negativeValues),i=n.min(e),a=n.max(e);this.min=null===this.min?i:Math.min(this.min,i),this.max=null===this.max?a:Math.max(this.max,a)},this)}else n.each(this.data.datasets,function(t){n.isDatasetVisible(t)&&(this.isHorizontal()?t.xAxisID===this.id:t.yAxisID===this.id)&&n.each(t.data,function(t){var e=this.getRightValue(t);isNaN(e)||(null===this.min?this.min=e:e<this.min&&(this.min=e),null===this.max?this.max=e:e>this.max&&(this.max=e))},this)},this);this.ticks=[];var e;if(e=this.isHorizontal()?Math.min(this.options.ticks.maxTicksLimit?this.options.ticks.maxTicksLimit:11,Math.ceil(this.width/50)):Math.min(this.options.ticks.maxTicksLimit?this.options.ticks.maxTicksLimit:11,Math.ceil(this.height/(2*this.options.ticks.fontSize))),e=Math.max(2,e),this.options.ticks.beginAtZero){var i=n.sign(this.min),a=n.sign(this.max);0>i&&0>a?this.max=0:i>0&&a>0&&(this.min=0)}this.options.ticks.suggestedMin&&(this.min=Math.min(this.min,this.options.ticks.suggestedMin)),this.options.ticks.suggestedMax&&(this.max=Math.max(this.max,this.options.ticks.suggestedMax)),this.min===this.max&&(this.min--,this.max++);for(var s=n.niceNum(this.max-this.min,!1),r=n.niceNum(s/(e-1),!0),o=Math.floor(this.min/r)*r,l=Math.ceil(this.max/r)*r,d=Math.ceil((l-o)/r),c=0;d>=c;++c)this.ticks.push(o+c*r);("left"==this.options.position||"right"==this.options.position)&&this.ticks.reverse(),this.max=n.max(this.ticks),this.min=n.min(this.ticks),this.options.ticks.reverse?(this.ticks.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),this.zeroLineIndex=this.ticks.indexOf(0)},getLabelForIndex:function(t,e){return this.getRightValue(this.data.datasets[e].data[t])},getPixelForValue:function(t){var e,n=this.getRightValue(t),i=this.end-this.start;if(this.isHorizontal()){var a=this.width-(this.paddingLeft+this.paddingRight);return e=this.left+a/i*(n-this.start),Math.round(e+this.paddingLeft)}var s=this.height-(this.paddingTop+this.paddingBottom);return e=this.bottom-this.paddingBottom-s/i*(n-this.start),Math.round(e)}});e.scaleService.registerScaleType("linear",a,i)}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers,i={position:"left",ticks:{callback:function(t){var n=t/Math.pow(10,Math.floor(e.helpers.log10(t)));return 1===n||2===n||5===n?t.toExponential():""}}},a=e.Scale.extend({buildTicks:function(){if(this.min=null,this.max=null,this.options.stacked){var t={};n.each(this.data.datasets,function(e){n.isDatasetVisible(e)&&(this.isHorizontal()?e.xAxisID===this.id:e.yAxisID===this.id)&&(void 0===t[e.type]&&(t[e.type]=[]),n.each(e.data,function(n,i){var a=t[e.type],s=this.getRightValue(n);isNaN(s)||(a[i]=a[i]||0,this.options.relativePoints?a[i]=100:a[i]+=s)},this))},this),n.each(t,function(t){var e=n.min(t),i=n.max(t);this.min=null===this.min?e:Math.min(this.min,e),this.max=null===this.max?i:Math.max(this.max,i)},this)}else n.each(this.data.datasets,function(t){n.isDatasetVisible(t)&&(this.isHorizontal()?t.xAxisID===this.id:t.yAxisID===this.id)&&n.each(t.data,function(t){var e=this.getRightValue(t);isNaN(e)||(null===this.min?this.min=e:e<this.min&&(this.min=e),null===this.max?this.max=e:e>this.max&&(this.max=e))},this)},this);this.min===this.max&&(0!==this.min&&null!==this.min?(this.min=Math.pow(10,Math.floor(n.log10(this.min))-1),this.max=Math.pow(10,Math.floor(n.log10(this.max))+1)):(this.min=1,this.max=10)),this.tickValues=[];for(var e=Math.floor(n.log10(this.min)),i=Math.ceil(n.log10(this.max)),a=e;i>a;++a)for(var s=1;10>s;++s)this.tickValues.push(s*Math.pow(10,a));this.tickValues.push(1*Math.pow(10,i)),("left"==this.options.position||"right"==this.options.position)&&this.tickValues.reverse(),this.max=n.max(this.tickValues),this.min=n.min(this.tickValues),this.options.ticks.reverse?(this.tickValues.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),this.ticks=this.tickValues.slice()},getLabelForIndex:function(t,e){return this.getRightValue(this.data.datasets[e].data[t])},getPixelForTick:function(t,e){return this.getPixelForValue(this.tickValues[t],null,null,e)},getPixelForValue:function(t){var e,i=this.getRightValue(t),a=n.log10(this.end)-n.log10(this.start);if(this.isHorizontal()){if(0!==i){var s=this.width-(this.paddingLeft+this.paddingRight);return e=this.left+s/a*(n.log10(i)-n.log10(this.start)),e+this.paddingLeft}e=this.left+this.paddingLeft}else{if(0!==i){var r=this.height-(this.paddingTop+this.paddingBottom);return this.bottom-this.paddingBottom-r/a*(n.log10(i)-n.log10(this.start))}e=this.top+this.paddingTop}}});e.scaleService.registerScaleType("logarithmic",a,i)}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers,i={display:!0,animate:!0,lineArc:!1,position:"chartArea",angleLines:{show:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1},ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2},pointLabels:{fontFamily:"'Arial'",fontStyle:"normal",fontSize:10,fontColor:"#666"}},a=e.Scale.extend({getValueCount:function(){return this.data.labels.length},setDimensions:function(){this.width=this.maxWidth,this.height=this.maxHeight,this.xCenter=Math.round(this.width/2),this.yCenter=Math.round(this.height/2);var t=n.min([this.height,this.width]);this.drawingArea=this.options.display?t/2-(this.options.ticks.fontSize/2+this.options.ticks.backdropPaddingY):t/2},buildTicks:function(){this.min=null,this.max=null,n.each(this.data.datasets,function(t){n.isDatasetVisible(t)&&n.each(t.data,function(t){var e=this.getRightValue(t);isNaN(e)||(null===this.min?this.min=e:e<this.min&&(this.min=e),null===this.max?this.max=e:e>this.max&&(this.max=e))},this)},this),this.min===this.max&&(this.min--,this.max++),this.ticks=[];var t=Math.min(this.options.ticks.maxTicksLimit?this.options.ticks.maxTicksLimit:11,Math.ceil(this.drawingArea/(1.5*this.options.ticks.fontSize)));if(t=Math.max(2,t),this.options.ticks.beginAtZero){var e=n.sign(this.min),i=n.sign(this.max);0>e&&0>i?this.max=0:e>0&&i>0&&(this.min=0)}for(var a=n.niceNum(this.max-this.min,!1),s=n.niceNum(a/(t-1),!0),r=Math.floor(this.min/s)*s,o=Math.ceil(this.max/s)*s,l=r;o>=l;l+=s)this.ticks.push(l);this.max=n.max(this.ticks),this.min=n.min(this.ticks),this.options.ticks.reverse?(this.ticks.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),this.zeroLineIndex=this.ticks.indexOf(0)},getLabelForIndex:function(t,e){return this.getRightValue(this.data.datasets[e].data[t])},getCircumference:function(){return 2*Math.PI/this.getValueCount()},fit:function(){var t,e,i,a,s,r,o,l,d,c,u,g,h=n.min([this.height/2-this.options.pointLabels.fontSize-5,this.width/2]),p=this.width,m=0;for(this.ctx.font=n.fontString(this.options.pointLabels.fontSize,this.options.pointLabels.fontStyle,this.options.pointLabels.fontFamily),e=0;e<this.getValueCount();e++)t=this.getPointPosition(e,h),i=this.ctx.measureText(this.options.ticks.callback(this.data.labels[e])).width+5,0===e||e===this.getValueCount()/2?(a=i/2,t.x+a>p&&(p=t.x+a,s=e),t.x-a<m&&(m=t.x-a,o=e)):e<this.getValueCount()/2?t.x+i>p&&(p=t.x+i,s=e):e>this.getValueCount()/2&&t.x-i<m&&(m=t.x-i,o=e);d=m,c=Math.ceil(p-this.width),r=this.getIndexAngle(s),l=this.getIndexAngle(o),u=c/Math.sin(r+Math.PI/2),g=d/Math.sin(l+Math.PI/2),u=n.isNumber(u)?u:0,g=n.isNumber(g)?g:0,this.drawingArea=Math.round(h-(g+u)/2),this.setCenterPoint(g,u)},setCenterPoint:function(t,e){var n=this.width-e-this.drawingArea,i=t+this.drawingArea;this.xCenter=Math.round((i+n)/2+this.left),this.yCenter=Math.round(this.height/2+this.top)},getIndexAngle:function(t){var e=2*Math.PI/this.getValueCount();return t*e-Math.PI/2},getDistanceFromCenterForValue:function(t){if(null===t)return 0;var e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e},getPointPosition:function(t,e){var n=this.getIndexAngle(t);return{x:Math.round(Math.cos(n)*e)+this.xCenter,y:Math.round(Math.sin(n)*e)+this.yCenter}},getPointPositionForValue:function(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))},draw:function(){if(this.options.display){var t=this.ctx;if(n.each(this.ticks,function(e,i){if(i>0||this.options.reverse){var a=this.getDistanceFromCenterForValue(this.ticks[i]),s=this.yCenter-a;if(this.options.gridLines.show)if(t.strokeStyle=this.options.gridLines.color,t.lineWidth=this.options.gridLines.lineWidth,this.options.lineArc)t.beginPath(),t.arc(this.xCenter,this.yCenter,a,0,2*Math.PI),t.closePath(),t.stroke();else{t.beginPath();for(var r=0;r<this.getValueCount();r++){var o=this.getPointPosition(r,this.getDistanceFromCenterForValue(this.ticks[i]));0===r?t.moveTo(o.x,o.y):t.lineTo(o.x,o.y)}t.closePath(),t.stroke()}if(this.options.ticks.show){if(t.font=n.fontString(this.options.ticks.fontSize,this.options.ticks.fontStyle,this.options.ticks.fontFamily),this.options.ticks.showLabelBackdrop){var l=t.measureText(e).width;t.fillStyle=this.options.ticks.backdropColor,t.fillRect(this.xCenter-l/2-this.options.ticks.backdropPaddingX,s-this.options.ticks.fontSize/2-this.options.ticks.backdropPaddingY,l+2*this.options.ticks.backdropPaddingX,this.options.ticks.fontSize+2*this.options.ticks.backdropPaddingY)}t.textAlign="center",t.textBaseline="middle",t.fillStyle=this.options.ticks.fontColor,t.fillText(e,this.xCenter,s)}}},this),!this.options.lineArc){t.lineWidth=this.options.angleLines.lineWidth,t.strokeStyle=this.options.angleLines.color;for(var e=this.getValueCount()-1;e>=0;e--){if(this.options.angleLines.show){var i=this.getPointPosition(e,this.getDistanceFromCenterForValue(this.options.reverse?this.min:this.max));t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(i.x,i.y),t.stroke(),t.closePath()}var a=this.getPointPosition(e,this.getDistanceFromCenterForValue(this.options.reverse?this.min:this.max)+5);t.font=n.fontString(this.options.pointLabels.fontSize,this.options.pointLabels.fontStyle,this.options.pointLabels.fontFamily),t.fillStyle=this.options.pointLabels.fontColor;var s=this.data.labels.length,r=this.data.labels.length/2,o=r/2,l=o>e||e>s-o,d=e===o||e===s-o;t.textAlign=0===e?"center":e===r?"center":r>e?"left":"right",t.textBaseline=d?"middle":l?"bottom":"top",t.fillText(this.data.labels[e],a.x,a.y)}}}}});e.scaleService.registerScaleType("radialLinear",a,i)}.call(this),function(){"use strict";if(!window.moment)return void console.warn("Chart.js - Moment.js could not be found! You must include it before Chart.js to use the time scale. Download at http://momentjs.com/");var t=this,e=t.Chart,n=e.helpers,i={units:["millisecond","second","minute","hour","day","week","month","quarter","year"],unit:{millisecond:{display:"SSS [ms]",maxStep:1e3},second:{display:"h:mm:ss a",maxStep:60},minute:{display:"h:mm:ss a",maxStep:60},hour:{display:"MMM D, hA",maxStep:24},day:{display:"ll",maxStep:7},week:{display:"ll",maxStep:4.3333},month:{display:"MMM YYYY",maxStep:12},quarter:{display:"[Q]Q - YYYY",maxStep:4},year:{display:"YYYY",maxStep:!1}}},a={position:"bottom",time:{format:!1,unit:!1,round:!1,displayFormat:!1}},s=e.Scale.extend({getLabelMoment:function(t,e){return this.labelMoments[t][e]},buildLabelMoments:function(){var t=[];this.data.labels&&this.data.labels.length>0?(n.each(this.data.labels,function(e){var n=this.parseTime(e);this.options.time.round&&n.startOf(this.options.time.round),t.push(n)},this),this.firstTick=this.options.time.min?this.parseTime(this.options.time.min):moment.min.call(this,t),this.lastTick=this.options.time.max?this.parseTime(this.options.time.max):moment.max.call(this,t)):(this.firstTick=null,this.lastTick=null),n.each(this.data.datasets,function(e){var i=[];"object"==typeof e.data[0]?n.each(e.data,function(t){var e=this.parseTime(this.getRightValue(t));this.options.time.round&&e.startOf(this.options.time.round),i.push(e),this.firstTick=null!==this.firstTick?moment.min(this.firstTick,e):e,this.lastTick=null!==this.lastTick?moment.max(this.lastTick,e):e},this):i=t,this.labelMoments.push(i)},this),this.firstTick=this.firstTick.clone(),this.lastTick=this.lastTick.clone()},buildTicks:function(){if(this.ticks=[],this.labelMoments=[],this.buildLabelMoments(),this.options.time.unit)this.tickUnit=this.options.time.unit||"day",this.displayFormat=i.unit[this.tickUnit].display,this.tickRange=Math.ceil(this.lastTick.diff(this.firstTick,this.tickUnit,!0));else{var t=this.width-(this.paddingLeft+this.paddingRight),e=t/this.options.ticks.fontSize+4,a=this.options.time.round?0:2;this.tickUnit="millisecond",this.tickRange=Math.ceil(this.lastTick.diff(this.firstTick,this.tickUnit,!0)+a),this.displayFormat=i.unit[this.tickUnit].display,n.each(i.units,function(t){this.tickRange<=e||(this.tickUnit=t,this.tickRange=Math.ceil(this.lastTick.diff(this.firstTick,this.tickUnit)+a),this.displayFormat=i.unit[t].display)},this)}this.firstTick.startOf(this.tickUnit),this.lastTick.endOf(this.tickUnit),this.smallestLabelSeparation=this.width,n.each(this.data.datasets,function(t,e){for(var n=1;n<this.labelMoments[e].length;n++)this.smallestLabelSeparation=Math.min(this.smallestLabelSeparation,this.labelMoments[e][n].diff(this.labelMoments[e][n-1],this.tickUnit,!0))},this),this.options.time.displayFormat&&(this.displayFormat=this.options.time.displayFormat);for(var s=0;s<=this.tickRange;++s)this.ticks.push(this.firstTick.clone().add(s,this.tickUnit))},getLabelForIndex:function(t,e){var n=this.data.labels&&t<this.data.labels.length?this.data.labels[t]:"";return"object"==typeof this.data.datasets[e].data[0]&&(n=this.getRightValue(this.data.datasets[e].data[t])),n},convertTicksToLabels:function(){this.ticks=this.ticks.map(function(t,e,n){var a=t.format(this.options.time.displayFormat?this.options.time.displayFormat:i.unit[this.tickUnit].display);return this.options.ticks.userCallback?this.options.ticks.userCallback(a,e,n):a},this)},getPixelForValue:function(t,e,n){var i=this.getLabelMoment(n,e),a=i.diff(this.firstTick,this.tickUnit,!0),s=a/this.tickRange;if(this.isHorizontal()){var r=this.width-(this.paddingLeft+this.paddingRight),o=(r/Math.max(this.ticks.length-1,1),r*s+this.paddingLeft);return this.left+Math.round(o)}var l=this.height-(this.paddingTop+this.paddingBottom),d=(l/Math.max(this.ticks.length-1,1),l*s+this.paddingTop);return this.top+Math.round(d)},parseTime:function(t){return"function"==typeof t.getMonth||"number"==typeof t?moment(t):t.isValid&&t.isValid()?t:"string"!=typeof this.options.time.format&&this.options.time.format.call?this.options.time.format(t):moment(t,this.options.time.format)}});e.scaleService.registerScaleType("time",s,a)}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers;e.defaults.global.elements.arc={backgroundColor:e.defaults.global.defaultColor,borderColor:"#fff",borderWidth:2},e.elements.Arc=e.Element.extend({inLabelRange:function(t){var e=this._view;return e?Math.pow(t-e.x,2)<Math.pow(e.radius+e.hoverRadius,2):!1},inRange:function(t,e){var i=this._view;if(i){var a=n.getAngleFromPoint(i,{x:t,y:e}),s=i.startAngle<-.5*Math.PI?i.startAngle+2*Math.PI:i.startAngle>1.5*Math.PI?i.startAngle-2*Math.PI:i.startAngle,r=i.endAngle<-.5*Math.PI?i.endAngle+2*Math.PI:i.endAngle>1.5*Math.PI?i.endAngle-2*Math.PI:i.endAngle,o=a.angle>=s&&a.angle<=r,l=a.distance>=i.innerRadius&&a.distance<=i.outerRadius;return o&&l}return!1},tooltipPosition:function(){var t=this._view,e=t.startAngle+(t.endAngle-t.startAngle)/2,n=(t.outerRadius-t.innerRadius)/2+t.innerRadius;return{x:t.x+Math.cos(e)*n,y:t.y+Math.sin(e)*n}},draw:function(){var t=this._chart.ctx,e=this._view;t.beginPath(),t.arc(e.x,e.y,e.outerRadius,e.startAngle,e.endAngle),t.arc(e.x,e.y,e.innerRadius,e.endAngle,e.startAngle,!0),t.closePath(),t.strokeStyle=e.borderColor,t.lineWidth=e.borderWidth,t.fillStyle=e.backgroundColor,t.fill(),t.lineJoin="bevel",e.borderWidth&&t.stroke()}})}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers;e.defaults.global.elements.line={tension:.4,backgroundColor:e.defaults.global.defaultColor,borderWidth:3,borderColor:e.defaults.global.defaultColor,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",fill:!0},e.elements.Line=e.Element.extend({draw:function(){var t=this._view,i=this._chart.ctx,a=this._children[0],s=this._children[this._children.length-1];if(i.save(),n.each(this._children,function(e,a){var s=n.previousItem(this._children,a),r=n.nextItem(this._children,a);return a||i.moveTo(e._view.x,t.scaleZero),e._view.skip&&!this.loop?(i.lineTo(s._view.x,t.scaleZero),void i.moveTo(r._view.x,t.scaleZero)):s._view.skip?void i.lineTo(e._view.x,e._view.y):t.tension>0&&a?void i.bezierCurveTo(s._view.controlPointNextX,s._view.controlPointNextY,e._view.controlPointPreviousX,e._view.controlPointPreviousY,e._view.x,e._view.y):void i.lineTo(e._view.x,e._view.y)},this),this._loop){if(t.tension>0&&!a._view.skip)return void i.bezierCurveTo(s._view.controlPointNextX,s._view.controlPointNextY,a._view.controlPointPreviousX,a._view.controlPointPreviousY,a._view.x,a._view.y);i.lineTo(a._view.x,a._view.y)}if(this._children.length>0&&t.fill&&(i.lineTo(this._children[this._children.length-1]._view.x,t.scaleZero),i.lineTo(this._children[0]._view.x,t.scaleZero),i.fillStyle=t.backgroundColor||e.defaults.global.defaultColor,i.closePath(),i.fill()),i.lineCap=t.borderCapStyle||e.defaults.global.elements.line.borderCapStyle,i.setLineDash&&i.setLineDash(t.borderDash||e.defaults.global.elements.line.borderDash),i.lineDashOffset=t.borderDashOffset||e.defaults.global.elements.line.borderDashOffset,i.lineJoin=t.borderJoinStyle||e.defaults.global.elements.line.borderJoinStyle,i.lineWidth=t.borderWidth||e.defaults.global.elements.line.borderWidth,i.strokeStyle=t.borderColor||e.defaults.global.defaultColor,i.beginPath(),n.each(this._children,function(e,a){var s=n.previousItem(this._children,a),r=n.nextItem(this._children,a);
return a||i.moveTo(e._view.x,t.scaleZero),e._view.skip&&!this.loop?void i.moveTo(r._view.x,t.scaleZero):s._view.skip?void i.moveTo(e._view.x,e._view.y):(a||i.moveTo(e._view.x,e._view.y),t.tension>0&&a?void i.bezierCurveTo(s._view.controlPointNextX,s._view.controlPointNextY,e._view.controlPointPreviousX,e._view.controlPointPreviousY,e._view.x,e._view.y):void i.lineTo(e._view.x,e._view.y))},this),this._loop&&!a._view.skip){if(t.tension>0)return void i.bezierCurveTo(s._view.controlPointNextX,s._view.controlPointNextY,a._view.controlPointPreviousX,a._view.controlPointPreviousY,a._view.x,a._view.y);i.lineTo(a._view.x,a._view.y)}i.stroke(),i.restore()}})}.call(this),function(){"use strict";var t=this,e=t.Chart;e.helpers,e.defaults.global.elements.point={radius:3,backgroundColor:e.defaults.global.defaultColor,borderWidth:1,borderColor:e.defaults.global.defaultColor,hitRadius:1,hoverRadius:4,hoverBorderWidth:1},e.elements.Point=e.Element.extend({inRange:function(t,e){var n=this._view;if(n){var i=n.hitRadius+n.radius;return Math.pow(t-n.x,2)+Math.pow(e-n.y,2)<Math.pow(i,2)}return!1},inLabelRange:function(t){var e=this._view;return e?Math.pow(t-e.x,2)<Math.pow(e.radius+e.hitRadius,2):!1},tooltipPosition:function(){var t=this._view;return{x:t.x,y:t.y,padding:t.radius+t.borderWidth}},draw:function(){var t=this._view,n=this._chart.ctx;t.skip||(t.radius>0||t.borderWidth>0)&&(n.beginPath(),n.arc(t.x,t.y,t.radius||e.defaults.global.elements.point.radius,0,2*Math.PI),n.closePath(),n.strokeStyle=t.borderColor||e.defaults.global.defaultColor,n.lineWidth=t.borderWidth||e.defaults.global.elements.point.borderWidth,n.fillStyle=t.backgroundColor||e.defaults.global.defaultColor,n.fill(),n.stroke())}})}.call(this),function(){"use strict";var t=this,e=t.Chart;e.helpers,e.defaults.global.elements.rectangle={backgroundColor:e.defaults.global.defaultColor,borderWidth:0,borderColor:e.defaults.global.defaultColor},e.elements.Rectangle=e.Element.extend({draw:function(){var t=this._chart.ctx,e=this._view,n=e.width/2,i=e.x-n,a=e.x+n,s=e.base-(e.base-e.y),r=e.borderWidth/2;e.borderWidth&&(i+=r,a-=r,s+=r),t.beginPath(),t.fillStyle=e.backgroundColor,t.strokeStyle=e.borderColor,t.lineWidth=e.borderWidth,t.moveTo(i,e.base),t.lineTo(i,s),t.lineTo(a,s),t.lineTo(a,e.base),t.fill(),e.borderWidth&&t.stroke()},height:function(){var t=this._view;return t.base-t.y},inRange:function(t,e){var n=this._view,i=!1;return n&&(i=n.y<n.base?t>=n.x-n.width/2&&t<=n.x+n.width/2&&e>=n.y&&e<=n.base:t>=n.x-n.width/2&&t<=n.x+n.width/2&&e>=n.base&&e<=n.y),i},inLabelRange:function(t){var e=this._view;return e?t>=e.x-e.width/2&&t<=e.x+e.width/2:!1},tooltipPosition:function(){var t=this._view;return t.y<t.base?{x:t.x,y:t.y}:{x:t.x,y:t.base}}})}.call(this),function(){"use strict";var t=this,e=t.Chart;e.helpers,e.Bar=function(t,n){return n.type="bar",new e(t,n)}}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers,i={hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{template:"(<%= value.x %>, <%= value.y %>)",multiTemplate:"<%if (datasetLabel){%><%=datasetLabel%>: <%}%>(<%= value.x %>, <%= value.y %>)"}};e.Bubble=function(t,a){return a.options=n.configMerge(i,a.options),a.type="bubble",new e(t,a)}}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers,i={aspectRatio:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i = 0; i < data.datasets[0].data.length; i++){%><li><span style="background-color:<%=data.datasets[0].backgroundColor[i]%>"><%if(data.labels && i < data.labels.length){%><%=data.labels[i]%><%}%></span></li><%}%></ul>'};e.Doughnut=function(t,a){return a.options=n.configMerge(i,a.options),a.type="doughnut",new e(t,a)}}.call(this),function(){"use strict";var t=this,e=t.Chart;e.helpers,e.Line=function(t,n){return n.type="line",new e(t,n)}}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers,i={aspectRatio:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i = 0; i < data.datasets[0].data.length; i++){%><li><span style="background-color:<%=data.datasets[0].backgroundColor[i]%>"><%if(data.labels && i < data.labels.length){%><%=data.labels[i]%><%}%></span></li><%}%></ul>'};e.PolarArea=function(t,a){return a.options=n.configMerge(i,a.options),a.type="polarArea",new e(t,a)}}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers,i={aspectRatio:1};e.Radar=function(t,a){return a.options=n.configMerge(i,a.options),a.type="radar",new e(t,a)}}.call(this),function(){"use strict";var t=this,e=t.Chart,n=e.helpers,i={hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-1"}],yAxes:[{type:"linear",position:"left",id:"y-axis-1"}]},tooltips:{template:"(<%= value.x %>, <%= value.y %>)",multiTemplate:"<%if (datasetLabel){%><%=datasetLabel%>: <%}%>(<%= value.x %>, <%= value.y %>)"}};e.Scatter=function(t,a){return a.options=n.configMerge(i,a.options),a.type="line",new e(t,a)}}.call(this);