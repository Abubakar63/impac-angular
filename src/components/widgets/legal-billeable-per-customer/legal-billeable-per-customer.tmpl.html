<!--
  Component generated by Impac! Widget Generator!
-->
<div widget-legal-billeable-per-customer>
  <!-- Settings Panel -->
  <div ng-show="widget.isEditMode" class="edit">
    <h4>Widget settings</h4>

    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />

    <!-- Buttons displayed on the lower  -->
    <div class="bottom-buttons" align="right">
      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>
      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>
    </div>
  </div>

  <!-- Content Panel -->
  <div ng-hide="widget.isEditMode">
    <div class="row">
      <div class="col-md-6 left-panel">
        <div class="table-container">
          <table class="table">
            <tr class="header">
              <th>Customers</th>
            </tr>
            <tr ng-repeat="customer in customers.list" ng-click="toggleCustomer(customer)" class="entry clickable" ng-class="{ selected: customer.display }">
              <td>{{customer.name}}</td>
            </tr>
          </table>
        </div>
      </div>

      <div class="col-md-6 right-panel">
        <div ng-if="customers.selected">
          <div class="row period-container">
            <div class="col-xs-6 text-left price">
              {{ customers.selected.billed[periods.selected] | mnoCurrency : widget.metadata.currency }}
            </div>

            <div class="col-xs-6 text-right">
              Show total billed for current
              <select ng-model="periods.selected" ng-options="period.value as period.label for period in periods.list" ng-change="widget.format()" />
            </div>
          </div>

          <div class="table-container">
            <table class="table">
              <tr class="header">
                <th>Employees</th>
                <th>Title</th>
                <th class="text-right">Total billed</th>
              </tr>
              <tr ng-repeat="employee in customers.selected.employees" class="entry">
                <td>{{ employee.firstname }} {{ employee.lastname }}</td>
                <td>{{ employee.title }}</td>
                <td class="text-right">{{ employee.billed[periods.selected] | mnoCurrency : widget.metadata.currency }}</td>
              </tr>
            </table>
          </div>

          <div class="table-container" ng-show="customers.selected.suppliers.length > 0">
            <table class="table">
              <tr class="header">
                <th>Disbursments and charges</th>
                <th class="text-right">Total billed</th>
              </tr>
              <tr ng-repeat="supplier in customers.selected.suppliers" class="entry">
                <td>{{ supplier.name }}</td>
                <td class="text-right">{{ supplier.billed[periods.selected] | mnoCurrency : widget.metadata.currency }}</td>
              </tr>
            </table>
          </div>
        </div>

        <div ng-hide="customers.selected" class="text-center">
          <p>Click on a customer to display its billeable details</p>
        </div>
      </div>
    </div>
  </div>
</div>
