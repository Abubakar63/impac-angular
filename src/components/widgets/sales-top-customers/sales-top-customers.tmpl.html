<div widget-sales-top-customers>
  <div class="edit" ng-show="widget.isEditMode">
    <h4>Widget settings</h4>

    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />
    <div setting-dates-picker parent-widget="widget" class="part" from="(widget.metadata.hist_parameters.from || defaultFrom)" to="(widget.metadata.hist_parameters.to || defaultTo)" keep-today="widget.metadata.hist_parameters.keep_today" deferred="::datesPickerDeferred"/>

    <div class="bottom-buttons" align="right">
      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>
      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>
    </div>
  </div>

  <div ng-hide="widget.isEditMode" class="widget-lines-container">

    <div class="row settings-bar" ng-show="(isDataFound==true)">
      <div class="col-sm-4 col-sm-offset-8">
        <div setting-param-selector parent-widget="widget" param="limit_entries" options="limitEntriesOptions" selected="limitEntriesSelected" class="row param-selector" deferred="::paramSelectorDeferred" no-reload/>
      </div>
    </div>

    <!-- Header line -->
    <div class="row widget-line header">
      <div class="col-sm-1 col-xs-1">#</div>
      <div class="col-sm-2 col-xs-2">Name</div>
      <div class="col-sm-3 col-xs-3">Total Sales</div>
      <div class="col-sm-6 col-xs-6">
        <div class="row">
          <p>Transactions</p>
          <div class="col-sm-1 col-xs-1">#</div>
          <div class="col-sm-5 col-xs-3">Avg</div>
          <div class="col-sm-5 col-xs-3">Last</div>
        </div>
      </div>
    </div>

    <!-- Data not found line -->
    <div class="row widget-line" ng-show="(isDataFound==false)">
      <div class="col-xs-11">No sales data found for your customers</div>
    </div>

    <div class="row widget-line" ng-show="(isDataFound==true)" ng-repeat="entity in widget.content.entities | limitTo: limitEntriesSelected.value">
      <div class="col-sm-1 col-xs-1">{{$index + 1}}</div>
      <div class="col-sm-2 col-xs-2">{{entity.name}}</div>
      <div class="col-sm-3 col-xs-3"><i>{{entity.total_invoiced | mnoCurrency : entity.currency}}</i></div>
      <div class="col-sm-6 col-xs-6">
        <div class="row">
          <div class="col-sm-1 col-xs-1"><i>{{entity.invoices.length}}</i></div>
          <div class="col-sm-5 col-xs-3"><i>{{(entity.total_invoiced / entity.invoices.length) | mnoCurrency : entity.currency}}</i></div>
          <div class="col-sm-5 col-xs-3"><i>{{entity.invoices[entity.invoices.length - 1].invoiced | mnoCurrency : entity.currency}}</i></div>
        </div>
      </div>
    </div>

  </div>

</div>
